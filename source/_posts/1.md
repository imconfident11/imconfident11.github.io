---
title: 明文攻击--不是非得两个文件
date: 2025-02-20
tags: 
  - CTF
  - Misc
---

### 题目描述
没有通常会给的已知文件，只给了一个压缩包，里面是被加密的一张png图片

#### 了解一下 `明文攻击`
- 符合哪些特征可以使用明文攻击
  1. Zip文件
  2. 文件均为ZipCrypto加密
  3. 已知加密文件的部分明文（8字节，12字节）
 **但这一条不是必须的内容,当只给出一张图片，且为ZipCrypto（Store）加密时，也能使用明文攻击，如本题**
### 解题思路

1. 获取png文件头,得到png_hearder文件
```python
# 十六进制字符串
hex_string = "89504E470D0A1A0A0000000D49484452"

# 将十六进制字符串转换为字节数据
binary_data = bytes.fromhex(hex_string)

# 将字节数据写入文件
with open("png_header", "wb") as f:
    f.write(binary_data)

print("文件 'png_header' 已成功创建！")
```
2. 使用工具`bkcrack`得到密钥
```
PS D:\CTF\tool\bkcrack> .\bkcrack.exe -C bkcrack_advanced.zip -c a.png -p png_header
```
>Keys: b53dcc5c 19c8786e f0298d20
3. 利用密钥破解文件
```
PS D:\CTF\tool\bkcrack> .\bkcrack.exe -C bkcrack_advanced.zip -c a.png -k b53dcc5c 19c8786e f0298d20 -d 1.png
```

得到解密后的文件`1.png`
